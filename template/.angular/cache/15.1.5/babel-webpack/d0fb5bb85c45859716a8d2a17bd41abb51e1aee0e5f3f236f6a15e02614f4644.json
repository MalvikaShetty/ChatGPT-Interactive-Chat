{"ast":null,"code":"/* ods.js (C) 2014-present  SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint -W041 */\nvar ODS = {};\n(function make_ods(ODS) {\n  /* Open Document Format for Office Applications (OpenDocument) Version 1.2 */\n  var get_utils = function () {\n    if (typeof XLSX !== 'undefined') return XLSX.utils;\n    if (typeof module !== \"undefined\" && typeof require !== 'undefined') try {\n      return require('../xlsx.js').utils;\n    } catch (e) {\n      return require('./xlsx.js').utils;\n    }\n    throw new Error(\"Cannot find XLSX utils\");\n  };\n  var has_buf = typeof Buffer !== 'undefined';\n  function cc2str(arr) {\n    var o = \"\";\n    for (var i = 0; i != arr.length; ++i) o += String.fromCharCode(arr[i]);\n    return o;\n  }\n  function dup(o) {\n    if (typeof JSON != 'undefined') return JSON.parse(JSON.stringify(o));\n    if (typeof o != 'object' || !o) return o;\n    var out = {};\n    for (var k in o) if (o.hasOwnProperty(k)) out[k] = dup(o[k]);\n    return out;\n  }\n  function getdatastr(data) {\n    if (!data) return null;\n    if (data.data) return data.data;\n    if (data.asNodeBuffer && has_buf) return data.asNodeBuffer().toString('binary');\n    if (data.asBinary) return data.asBinary();\n    if (data._data && data._data.getContent) return cc2str(Array.prototype.slice.call(data._data.getContent(), 0));\n    return null;\n  }\n\n  /* ODS and friends only use text files in container */\n  function getdata(data) {\n    return getdatastr(data);\n  }\n\n  /* NOTE: unlike ECMA-376, OASIS does not comment on filename case sensitivity */\n  function safegetzipfile(zip, file) {\n    var f = file;\n    if (zip.files[f]) return zip.files[f];\n    f = file.toLowerCase();\n    if (zip.files[f]) return zip.files[f];\n    f = f.replace(/\\//g, '\\\\');\n    if (zip.files[f]) return zip.files[f];\n    return null;\n  }\n  function getzipfile(zip, file) {\n    var o = safegetzipfile(zip, file);\n    if (o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n    return o;\n  }\n  function getzipdata(zip, file, safe) {\n    if (!safe) return getdata(getzipfile(zip, file));\n    if (!file) return null;\n    try {\n      return getzipdata(zip, file);\n    } catch (e) {\n      return null;\n    }\n  }\n  var _fs, jszip;\n  if (typeof JSZip !== 'undefined') jszip = JSZip;\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      if (typeof jszip === 'undefined') jszip = require('./jszip.js');\n      _fs = require('fs');\n    }\n  }\n  var attregexg = /[^\\s?>\\/]+=[\"'][^\"]*['\"]/g;\n  var tagregex = /<[^>]*>/g;\n  var nsregex = /<\\w*:/,\n    nsregex2 = /<(\\/?)\\w+:/;\n  function parsexmltag(tag, skip_root) {\n    var z = [];\n    var eq = 0,\n      c = 0;\n    for (; eq !== tag.length; ++eq) if ((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n    if (!skip_root) z[0] = tag.substr(0, eq);\n    if (eq === tag.length) return z;\n    var m = tag.match(attregexg),\n      j = 0,\n      v = \"\",\n      i = 0,\n      q = \"\",\n      cc = \"\";\n    if (m) for (i = 0; i != m.length; ++i) {\n      cc = m[i];\n      for (c = 0; c != cc.length; ++c) if (cc.charCodeAt(c) === 61) break;\n      q = cc.substr(0, c);\n      v = cc.substring(c + 2, cc.length - 1);\n      for (j = 0; j != q.length; ++j) if (q.charCodeAt(j) === 58) break;\n      if (j === q.length) {\n        if (q.indexOf(\"_\") > 0) q = q.substr(0, q.indexOf(\"_\"));\n        z[q] = v;\n      } else {\n        var k = (j === 5 && q.substr(0, 5) === \"xmlns\" ? \"xmlns\" : \"\") + q.substr(j + 1);\n        if (z[k] && q.substr(j - 3, 3) == \"ext\") continue;\n        z[k] = v;\n      }\n    }\n    return z;\n  }\n  function strip_ns(x) {\n    return x.replace(nsregex2, \"<$1\");\n  }\n  var encodings = {\n    '&quot;': '\"',\n    '&apos;': \"'\",\n    '&gt;': '>',\n    '&lt;': '<',\n    '&amp;': '&'\n  };\n  var rencoding = {\n    '\"': '&quot;',\n    \"'\": '&apos;',\n    '>': '&gt;',\n    '<': '&lt;',\n    '&': '&amp;'\n  };\n  var rencstr = \"&<>'\\\"\".split(\"\");\n\n  // TODO: CP remap (need to read file version to determine OS)\n  /* 22.4.2.4 bstr (Basic String) */\n  var encregex = /&[a-z]*;/g,\n    coderegex = /_x([\\da-fA-F]{4})_/g;\n  function unescapexml(text) {\n    var s = text + '';\n    return s.replace(encregex, function ($$) {\n      return encodings[$$];\n    }).replace(coderegex, function (m, c) {\n      return String.fromCharCode(parseInt(c, 16));\n    });\n  }\n  var decregex = /[&<>'\"]/g,\n    charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\n  function escapexml(text) {\n    var s = text + '';\n    return s.replace(decregex, function (y) {\n      return rencoding[y];\n    }).replace(charegex, function (s) {\n      return \"_x\" + (\"000\" + s.charCodeAt(0).toString(16)).substr(-4) + \"_\";\n    });\n  }\n  function parsexmlbool(value) {\n    switch (value) {\n      case '1':\n      case 'true':\n      case 'TRUE':\n        return true;\n      /* case '0': case 'false': case 'FALSE':*/\n      default:\n        return false;\n    }\n  }\n  function datenum(v, date1904) {\n    var epoch = v.getTime();\n    if (date1904) epoch += 1462 * 24 * 60 * 60 * 1000;\n    return (epoch + 2209161600000) / (24 * 60 * 60 * 1000);\n  }\n\n  /* ISO 8601 Duration */\n  function parse_isodur(s) {\n    var sec = 0,\n      mt = 0,\n      time = false;\n    var m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n    if (!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n    for (var i = 1; i != m.length; ++i) {\n      if (!m[i]) continue;\n      mt = 1;\n      if (i > 3) time = true;\n      switch (m[i].substr(m[i].length - 1)) {\n        case 'Y':\n          throw new Error(\"Unsupported ISO Duration Field: \" + m[i].substr(m[i].length - 1));\n        case 'D':\n          mt *= 24;\n        /* falls through */\n        case 'H':\n          mt *= 60;\n        /* falls through */\n        case 'M':\n          if (!time) throw new Error(\"Unsupported ISO Duration Field: M\");else mt *= 60;\n        /* falls through */\n        case 'S':\n          break;\n      }\n      sec += mt * parseInt(m[i], 10);\n    }\n    return sec;\n  }\n  var XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\n  /* copied from js-xls (C) SheetJS Apache2 license */\n  function xlml_normalize(d) {\n    if (has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n    if (typeof d === 'string') return d;\n    throw \"badf\";\n  }\n\n  /* UOS uses CJK in tags, original regex /<(\\/?)([a-z0-9]*:|)([\\w-]+)[^>]*>/ */\n  var xlmlregex = /<(\\/?)([^\\s?>\\/:]*:|)([^\\s?>]*[^\\s?>\\/])[^>]*>/mg;\n  /* Part 3 Section 4 Manifest File */\n  var CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\n  function parse_manifest(d, opts) {\n    var str = xlml_normalize(d);\n    var Rn;\n    var FEtag;\n    while (Rn = xlmlregex.exec(str)) switch (Rn[3]) {\n      case 'manifest':\n        break;\n      // 4.2 <manifest:manifest>\n      case 'file-entry':\n        // 4.3 <manifest:file-entry>\n        FEtag = parsexmltag(Rn[0], false);\n        if (FEtag.path == '/' && FEtag.type !== CT_ODS) throw new Error(\"This OpenDocument is not a spreadsheet\");\n        break;\n      case 'encryption-data': // 4.4 <manifest:encryption-data>\n      case 'algorithm': // 4.5 <manifest:algorithm>\n      case 'start-key-generation': // 4.6 <manifest:start-key-generation>\n      case 'key-derivation':\n        // 4.7 <manifest:key-derivation>\n        throw new Error(\"Unsupported ODS Encryption\");\n      default:\n        if (opts && opts.WTF) throw Rn;\n    }\n  }\n  function write_manifest(manifest, opts) {\n    var o = [XML_HEADER];\n    o.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\n    o.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\n    for (var i = 0; i < manifest.length; ++i) o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\n    o.push('</manifest:manifest>');\n    return o.join(\"\");\n  }\n  /* Part 3 Section 6 Metadata Manifest File */\n  function write_rdf_type(file, res, tag) {\n    return ['  <rdf:Description rdf:about=\"' + file + '\">\\n', '    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + '#' + res + '\"/>\\n', '  </rdf:Description>\\n'].join(\"\");\n  }\n  function write_rdf_has(base, file) {\n    return ['  <rdf:Description rdf:about=\"' + base + '\">\\n', '    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n', '  </rdf:Description>\\n'].join(\"\");\n  }\n  function write_rdf(rdf, opts) {\n    var o = [XML_HEADER];\n    o.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\n    for (var i = 0; i != rdf.length; ++i) {\n      o.push(write_rdf_type(rdf[i][0], rdf[i][1]));\n      o.push(write_rdf_has(\"\", rdf[i][0]));\n    }\n    o.push(write_rdf_type(\"\", \"Document\", \"pkg\"));\n    o.push('</rdf:RDF>');\n    return o.join(\"\");\n  }\n  var parse_text_p = function (text, tag) {\n    return unescapexml(text.replace(/<text:s\\/>/g, \" \").replace(/<[^>]*>/g, \"\"));\n  };\n  var utf8read = function utf8reada(orig) {\n    var out = \"\",\n      i = 0,\n      c = 0,\n      d = 0,\n      e = 0,\n      f = 0,\n      w = 0;\n    while (i < orig.length) {\n      c = orig.charCodeAt(i++);\n      if (c < 128) {\n        out += String.fromCharCode(c);\n        continue;\n      }\n      d = orig.charCodeAt(i++);\n      if (c > 191 && c < 224) {\n        out += String.fromCharCode((c & 31) << 6 | d & 63);\n        continue;\n      }\n      e = orig.charCodeAt(i++);\n      if (c < 240) {\n        out += String.fromCharCode((c & 15) << 12 | (d & 63) << 6 | e & 63);\n        continue;\n      }\n      f = orig.charCodeAt(i++);\n      w = ((c & 7) << 18 | (d & 63) << 12 | (e & 63) << 6 | f & 63) - 65536;\n      out += String.fromCharCode(0xD800 + (w >>> 10 & 1023));\n      out += String.fromCharCode(0xDC00 + (w & 1023));\n    }\n    return out;\n  };\n  /* Part 3 TODO: actually parse formulae */\n  function ods_to_csf_formula(f) {\n    if (f.substr(0, 3) == \"of:\") f = f.substr(3);\n    /* 5.2 Basic Expressions */\n    if (f.charCodeAt(0) == 61) {\n      f = f.substr(1);\n      if (f.charCodeAt(0) == 61) f = f.substr(1);\n    }\n    /* Part 3 Section 5.8 References */\n    return f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, \"$1\").replace(/\\./g, \"\");\n  }\n  var parse_content_xml = function () {\n    var number_formats = {\n      /* ods name: [short ssf fmt, long ssf fmt] */\n      day: [\"d\", \"dd\"],\n      month: [\"m\", \"mm\"],\n      year: [\"y\", \"yy\"],\n      hours: [\"h\", \"hh\"],\n      minutes: [\"m\", \"mm\"],\n      seconds: [\"s\", \"ss\"],\n      \"am-pm\": [\"A/P\", \"AM/PM\"],\n      \"day-of-week\": [\"ddd\", \"dddd\"]\n    };\n    return function pcx(d, _opts) {\n      var opts = _opts || {};\n      var str = xlml_normalize(d);\n      var state = [],\n        tmp;\n      var tag;\n      var NFtag = {\n          name: \"\"\n        },\n        NF = \"\",\n        pidx = 0;\n      var sheetag;\n      var rowtag;\n      var Sheets = {},\n        SheetNames = [],\n        ws = {};\n      var Rn, q;\n      var ctag = {\n        value: \"\"\n      };\n      var textp = \"\",\n        textpidx = 0,\n        textptag;\n      var R = -1,\n        C = -1,\n        range = {\n          s: {\n            r: 1000000,\n            c: 10000000\n          },\n          e: {\n            r: 0,\n            c: 0\n          }\n        };\n      var number_format_map = {};\n      var merges = [],\n        mrange = {},\n        mR = 0,\n        mC = 0;\n      var arrayf = [];\n      var rept = 1,\n        isstub = false;\n      var i = 0;\n      xlmlregex.lastIndex = 0;\n      while (Rn = xlmlregex.exec(str)) switch (Rn[3] = Rn[3].replace(/_.*$/, \"\")) {\n        case 'table':\n        case '工作表':\n          // 9.1.2 <table:table>\n          if (Rn[1] === '/') {\n            if (range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = get_utils().encode_range(range);\n            if (merges.length) ws['!merges'] = merges;\n            sheetag.name = utf8read(sheetag['名称'] || sheetag.name);\n            SheetNames.push(sheetag.name);\n            Sheets[sheetag.name] = ws;\n          } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n            sheetag = parsexmltag(Rn[0], false);\n            R = C = -1;\n            range.s.r = range.s.c = 10000000;\n            range.e.r = range.e.c = 0;\n            ws = {};\n            merges = [];\n          }\n          break;\n        case 'table-row':\n        case '行':\n          // 9.1.3 <table:table-row>\n          if (Rn[1] === '/') break;\n          rowtag = parsexmltag(Rn[0], false);\n          if (rowtag['行号']) R = rowtag['行号'] - 1;else ++R;\n          C = -1;\n          break;\n        case 'covered-table-cell':\n          // 9.1.5 table:covered-table-cell\n          ++C;\n          break;\n        /* stub */\n        case 'table-cell':\n        case '数据':\n          if (Rn[0].charAt(Rn[0].length - 2) === '/') {\n            ctag = parsexmltag(Rn[0], false);\n            if (ctag['number-columns-repeated']) C += parseInt(ctag['number-columns-repeated'], 10);else ++C;\n          } else if (Rn[1] !== '/') {\n            ++C;\n            rept = 1;\n            if (C > range.e.c) range.e.c = C;\n            if (R > range.e.r) range.e.r = R;\n            if (C < range.s.c) range.s.c = C;\n            if (R < range.s.r) range.s.r = R;\n            ctag = parsexmltag(Rn[0], false);\n            q = {\n              t: ctag['数据类型'] || ctag['value-type'],\n              v: null\n            };\n            if (opts.cellFormula) {\n              if (ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n                mR = parseInt(ctag['number-matrix-rows-spanned'], 10) || 0;\n                mC = parseInt(ctag['number-matrix-columns-spanned'], 10) || 0;\n                mrange = {\n                  s: {\n                    r: R,\n                    c: C\n                  },\n                  e: {\n                    r: R + mR - 1,\n                    c: C + mC - 1\n                  }\n                };\n                q.F = get_utils().encode_range(mrange);\n                arrayf.push([mrange, q.F]);\n              }\n              if (ctag.formula) q.f = ods_to_csf_formula(ctag.formula);else for (i = 0; i < arrayf.length; ++i) if (R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r) if (C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c) q.F = arrayf[i][1];\n            }\n            if (ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n              mR = parseInt(ctag['number-rows-spanned'], 10) || 0;\n              mC = parseInt(ctag['number-columns-spanned'], 10) || 0;\n              mrange = {\n                s: {\n                  r: R,\n                  c: C\n                },\n                e: {\n                  r: R + mR - 1,\n                  c: C + mC - 1\n                }\n              };\n              merges.push(mrange);\n            }\n\n            /* 19.675.2 table:number-columns-repeated */\n            if (ctag['number-columns-repeated']) rept = parseInt(ctag['number-columns-repeated'], 10);\n\n            /* 19.385 office:value-type */\n            switch (q.t) {\n              case 'boolean':\n                q.t = 'b';\n                q.v = parsexmlbool(ctag['boolean-value']);\n                break;\n              case 'float':\n                q.t = 'n';\n                q.v = parseFloat(ctag.value);\n                break;\n              case 'percentage':\n                q.t = 'n';\n                q.v = parseFloat(ctag.value);\n                break;\n              case 'currency':\n                q.t = 'n';\n                q.v = parseFloat(ctag.value);\n                break;\n              case 'date':\n                q.t = 'n';\n                q.v = datenum(new Date(ctag['date-value']));\n                q.z = 'm/d/yy';\n                break;\n              case 'time':\n                q.t = 'n';\n                q.v = parse_isodur(ctag['time-value']) / 86400;\n                break;\n              case 'number':\n                q.t = 'n';\n                q.v = parseFloat(ctag['数据数值']);\n                break;\n              default:\n                if (q.t === 'string' || q.t === 'text' || !q.t) {\n                  q.t = 's';\n                  if (ctag['string-value'] != null) textp = ctag['string-value'];\n                } else throw new Error('Unsupported value type ' + q.t);\n            }\n          } else {\n            isstub = false;\n            if (q.t === 's') {\n              q.v = textp || '';\n              isstub = textpidx == 0;\n            }\n            if (textp) q.w = textp;\n            if (!isstub || opts.cellStubs) {\n              if (!(opts.sheetRows && opts.sheetRows < R)) {\n                ws[get_utils().encode_cell({\n                  r: R,\n                  c: C\n                })] = q;\n                while (--rept > 0) ws[get_utils().encode_cell({\n                  r: R,\n                  c: ++C\n                })] = dup(q);\n                if (range.e.c <= C) range.e.c = C;\n              }\n            } else {\n              C += rept;\n              rept = 0;\n            }\n            q = {};\n            textp = \"\";\n          }\n          break;\n        // 9.1.4 <table:table-cell>\n\n        /* pure state */\n        case 'document': // TODO: <office:document> is the root for FODS\n        case 'document-content':\n        case '电子表格文档': // 3.1.3.2 <office:document-content>\n        case 'spreadsheet':\n        case '主体': // 3.7 <office:spreadsheet>\n        case 'scripts': // 3.12 <office:scripts>\n        case 'styles': // TODO <office:styles>\n        case 'font-face-decls':\n          // 3.14 <office:font-face-decls>\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n          break;\n\n        /* ignore state */\n        case 'meta':\n        case '元数据': // TODO: <office:meta> <uof:元数据> FODS/UOF\n        case 'settings': // TODO: <office:settings>\n        case 'config-item-set': // TODO: <office:config-item-set>\n        case 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n        case 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n        case 'config-item-map-named': // TODO: <office:config-item-map-entry>\n        case 'shapes': // 9.2.8 <table:shapes>\n        case 'frame': // 10.4.2 <draw:frame>\n        case 'text-box': // 10.4.3 <draw:text-box>\n        case 'image': // 10.4.4 <draw:image>\n        case 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n        case 'list-style': // 16.30 <text:list-style>\n        case 'form': // 13.13 <form:form>\n        case 'dde-links': // 9.8 <table:dde-links>\n        case 'annotation': // 14.1 <office:annotation>\n        case 'event-listeners':\n          // TODO\n          if (Rn[1] === '/') {\n            if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], false]);\n          textp = \"\";\n          textpidx = 0;\n          break;\n        case 'scientific-number':\n          // TODO: <number:scientific-number>\n          break;\n        case 'currency-symbol':\n          // TODO: <number:currency-symbol>\n          break;\n        case 'currency-style':\n          // TODO: <number:currency-style>\n          break;\n        case 'number-style': // 16.27.2 <number:number-style>\n        case 'percentage-style': // 16.27.9 <number:percentage-style>\n        case 'date-style': // 16.27.10 <number:date-style>\n        case 'time-style':\n          // 16.27.18 <number:time-style>\n          if (Rn[1] === '/') {\n            number_format_map[NFtag.name] = NF;\n            if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') {\n            NF = \"\";\n            NFtag = parsexmltag(Rn[0], false);\n            state.push([Rn[3], true]);\n          }\n          break;\n        case 'script':\n          break;\n        // 3.13 <office:script>\n        case 'libraries':\n          break;\n        // TODO: <ooo:libraries>\n        case 'automatic-styles':\n          break;\n        // 3.15.3 <office:automatic-styles>\n        case 'master-styles':\n          break;\n        // TODO: <office:automatic-styles>\n\n        case 'default-style': // TODO: <style:default-style>\n        case 'page-layout':\n          break;\n        // TODO: <style:page-layout>\n        case 'style':\n          break;\n        // 16.2 <style:style>\n        case 'map':\n          break;\n        // 16.3 <style:map>\n        case 'font-face':\n          break;\n        // 16.21 <style:font-face>\n\n        case 'paragraph-properties':\n          break;\n        // 17.6 <style:paragraph-properties>\n        case 'table-properties':\n          break;\n        // 17.15 <style:table-properties>\n        case 'table-column-properties':\n          break;\n        // 17.16 <style:table-column-properties>\n        case 'table-row-properties':\n          break;\n        // 17.17 <style:table-row-properties>\n        case 'table-cell-properties':\n          break;\n        // 17.18 <style:table-cell-properties>\n\n        case 'number':\n          // 16.27.3 <number:number>\n          switch (state[state.length - 1][0]) {\n            case 'time-style':\n            case 'date-style':\n              tag = parsexmltag(Rn[0], false);\n              NF += number_formats[Rn[3]][tag.style === 'long' ? 1 : 0];\n              break;\n          }\n          break;\n        case 'fraction':\n          break;\n        // TODO 16.27.6 <number:fraction>\n\n        case 'day': // 16.27.11 <number:day>\n        case 'month': // 16.27.12 <number:month>\n        case 'year': // 16.27.13 <number:year>\n        case 'era': // 16.27.14 <number:era>\n        case 'day-of-week': // 16.27.15 <number:day-of-week>\n        case 'week-of-year': // 16.27.16 <number:week-of-year>\n        case 'quarter': // 16.27.17 <number:quarter>\n        case 'hours': // 16.27.19 <number:hours>\n        case 'minutes': // 16.27.20 <number:minutes>\n        case 'seconds': // 16.27.21 <number:seconds>\n        case 'am-pm':\n          // 16.27.22 <number:am-pm>\n          switch (state[state.length - 1][0]) {\n            case 'time-style':\n            case 'date-style':\n              tag = parsexmltag(Rn[0], false);\n              NF += number_formats[Rn[3]][tag.style === 'long' ? 1 : 0];\n              break;\n          }\n          break;\n        case 'boolean-style':\n          break;\n        // 16.27.23 <number:boolean-style>\n        case 'boolean':\n          break;\n        // 16.27.24 <number:boolean>\n        case 'text-style':\n          break;\n        // 16.27.25 <number:text-style>\n        case 'text':\n          // 16.27.26 <number:text>\n          if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") switch (state[state.length - 1][0]) {\n            case 'number-style':\n            case 'date-style':\n            case 'time-style':\n              NF += str.slice(pidx, Rn.index);\n              break;\n          } else pidx = Rn.index + Rn[0].length;\n          break;\n        case 'text-content':\n          break;\n        // 16.27.27 <number:text-content>\n        case 'text-properties':\n          break;\n        // 16.27.27 <style:text-properties>\n\n        case 'body':\n        case '电子表格':\n          break;\n        // 3.3 16.9.6 19.726.3\n\n        case 'forms':\n          break;\n        // 12.25.2 13.2\n        case 'table-column':\n          break;\n        // 9.1.6 <table:table-column>\n\n        case 'null-date':\n          break;\n        // 9.4.2 <table:null-date> TODO: date1904\n\n        case 'graphic-properties':\n          break;\n        // 17.21 <style:graphic-properties>\n        case 'calculation-settings':\n          break;\n        // 9.4.1 <table:calculation-settings>\n        case 'named-expressions':\n          break;\n        // 9.4.11 <table:named-expressions>\n        case 'named-range':\n          break;\n        // 9.4.12 <table:named-range>\n        case 'named-expression':\n          break;\n        // 9.4.13 <table:named-expression>\n        case 'sort':\n          break;\n        // 9.4.19 <table:sort>\n        case 'sort-by':\n          break;\n        // 9.4.20 <table:sort-by>\n        case 'sort-groups':\n          break;\n        // 9.4.22 <table:sort-groups>\n\n        case 'span':\n          break;\n        // <text:span>\n        case 'line-break':\n          break;\n        // 6.1.5 <text:line-break>\n        case 'p':\n        case '文本串':\n          if (Rn[1] === '/') textp = parse_text_p(str.slice(textpidx, Rn.index), textptag);else {\n            textptag = parsexmltag(Rn[0], false);\n            textpidx = Rn.index + Rn[0].length;\n          }\n          break;\n        // <text:p>\n        case 's':\n          break;\n        // <text:s>\n        case 'date':\n          break;\n        // <*:date>\n\n        case 'object':\n          break;\n        // 10.4.6.2 <draw:object>\n        case 'title':\n        case '标题':\n          break;\n        // <*:title> OR <uof:标题>\n        case 'desc':\n          break;\n        // <*:desc>\n\n        case 'table-source':\n          break;\n        // 9.2.6\n\n        case 'iteration':\n          break;\n        // 9.4.3 <table:iteration>\n        case 'content-validations':\n          break;\n        // 9.4.4 <table:\n        case 'content-validation':\n          break;\n        // 9.4.5 <table:\n        case 'error-message':\n          break;\n        // 9.4.7 <table:\n        case 'database-ranges':\n          break;\n        // 9.4.14 <table:database-ranges>\n        case 'database-range':\n          break;\n        // 9.4.15 <table:database-range>\n        case 'filter':\n          break;\n        // 9.5.2 <table:filter>\n        case 'filter-and':\n          break;\n        // 9.5.3 <table:filter-and>\n        case 'filter-or':\n          break;\n        // 9.5.4 <table:filter-or>\n        case 'filter-condition':\n          break;\n        // 9.5.5 <table:filter-condition>\n\n        case 'list-level-style-bullet':\n          break;\n        // 16.31 <text:\n        case 'list-level-style-number':\n          break;\n        // 16.32 <text:\n        case 'list-level-properties':\n          break;\n        // 17.19 <style:\n\n        /* 7.3 Document Fields */\n        case 'sender-firstname': // 7.3.6.2\n        case 'sender-lastname': // 7.3.6.3\n        case 'sender-initials': // 7.3.6.4\n        case 'sender-title': // 7.3.6.5\n        case 'sender-position': // 7.3.6.6\n        case 'sender-email': // 7.3.6.7\n        case 'sender-phone-private': // 7.3.6.8\n        case 'sender-fax': // 7.3.6.9\n        case 'sender-company': // 7.3.6.10\n        case 'sender-phone-work': // 7.3.6.11\n        case 'sender-street': // 7.3.6.12\n        case 'sender-city': // 7.3.6.13\n        case 'sender-postal-code': // 7.3.6.14\n        case 'sender-country': // 7.3.6.15\n        case 'sender-state-or-province': // 7.3.6.16\n        case 'author-name': // 7.3.7.1\n        case 'author-initials': // 7.3.7.2\n        case 'chapter': // 7.3.8\n        case 'file-name': // 7.3.9\n        case 'template-name': // 7.3.9\n        case 'sheet-name':\n          // 7.3.9\n          break;\n        case 'event-listener': // TODO\n        /* TODO: FODS Properties */\n        case 'initial-creator':\n        case 'creator':\n        case 'creation-date':\n        case 'generator':\n        case 'document-statistic':\n        case 'user-defined':\n          break;\n\n        /* TODO: FODS Config */\n        case 'config-item':\n          break;\n\n        /* TODO: style tokens */\n        case 'page-number':\n          break;\n        // TODO <text:page-number>\n        case 'page-count':\n          break;\n        // TODO <text:page-count>\n        case 'time':\n          break;\n        // TODO <text:time>\n\n        /* 9.6 Data Pilot Tables <table: */\n        case 'data-pilot-table': // 9.6.3\n        case 'source-cell-range': // 9.6.5\n        case 'source-service': // 9.6.6\n        case 'data-pilot-field': // 9.6.7\n        case 'data-pilot-level': // 9.6.8\n        case 'data-pilot-subtotals': // 9.6.9\n        case 'data-pilot-subtotal': // 9.6.10\n        case 'data-pilot-members': // 9.6.11\n        case 'data-pilot-member': // 9.6.12\n        case 'data-pilot-display-info': // 9.6.13\n        case 'data-pilot-sort-info': // 9.6.14\n        case 'data-pilot-layout-info': // 9.6.15\n        case 'data-pilot-field-reference': // 9.6.16\n        case 'data-pilot-groups': // 9.6.17\n        case 'data-pilot-group': // 9.6.18\n        case 'data-pilot-group-member':\n          // 9.6.19\n          break;\n\n        /* 10.3 Drawing Shapes */\n        case 'rect':\n          // 10.3.2\n          break;\n\n        /* 14.6 DDE Connections */\n        case 'dde-connection-decls': // 14.6.2 <text:\n        case 'dde-connection-decl': // 14.6.3 <text:\n        case 'dde-link': // 14.6.4 <table:\n        case 'dde-source':\n          // 14.6.5 <office:\n          break;\n        case 'properties':\n          break;\n        // 13.7 <form:properties>\n        case 'property':\n          break;\n        // 13.8 <form:property>\n\n        case 'a':\n          break;\n        // 6.1.8 hyperlink\n\n        /* non-standard */\n        case 'table-protection':\n          break;\n        case 'data-pilot-grand-total':\n          break;\n        // <table:\n        default:\n          if (Rn[2] === 'dc:') break; // TODO: properties\n          if (Rn[2] === 'draw:') break; // TODO: drawing\n          if (Rn[2] === 'style:') break; // TODO: styles\n          if (Rn[2] === 'calcext:') break; // ignore undocumented extensions\n          if (Rn[2] === 'loext:') break; // ignore undocumented extensions\n          if (Rn[2] === 'uof:') break; // TODO: uof\n          if (Rn[2] === '表:') break; // TODO: uof\n          if (Rn[2] === '字:') break; // TODO: uof\n          if (opts.WTF) throw Rn;\n      }\n      var out = {\n        Sheets: Sheets,\n        SheetNames: SheetNames\n      };\n      return out;\n    };\n  }();\n  var write_content_xml = function () {\n    var null_cell_xml = '          <table:table-cell />\\n';\n    var write_ws = function (ws, wb, i, opts) {\n      /* Section 9 Tables */\n      var o = [];\n      o.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\">\\n');\n      var R = 0,\n        C = 0,\n        range = get_utils().decode_range(ws['!ref']);\n      for (R = 0; R < range.s.r; ++R) o.push('        <table:table-row></table:table-row>\\n');\n      for (; R <= range.e.r; ++R) {\n        o.push('        <table:table-row>\\n');\n        for (C = 0; C < range.s.c; ++C) o.push(null_cell_xml);\n        for (; C <= range.e.c; ++C) {\n          var ref = get_utils().encode_cell({\n              r: R,\n              c: C\n            }),\n            cell = ws[ref];\n          if (cell) switch (cell.t) {\n            case 'b':\n              o.push('          <table:table-cell office:value-type=\"boolean\" office:boolean-value=\"' + (cell.v ? 'true' : 'false') + '\"><text:p>' + (cell.v ? 'TRUE' : 'FALSE') + '</text:p></table:table-cell>\\n');\n              break;\n            case 'n':\n              o.push('          <table:table-cell office:value-type=\"float\" office:value=\"' + cell.v + '\"><text:p>' + (cell.w || cell.v) + '</text:p></table:table-cell>\\n');\n              break;\n            case 's':\n            case 'str':\n              o.push('          <table:table-cell office:value-type=\"string\"><text:p>' + escapexml(cell.v) + '</text:p></table:table-cell>\\n');\n              break;\n            //case 'd': // TODO\n            //case 'e':\n            default:\n              o.push(null_cell_xml);\n          } else o.push(null_cell_xml);\n        }\n        o.push('        </table:table-row>\\n');\n      }\n      o.push('      </table:table>\\n');\n      return o.join(\"\");\n    };\n    return function wcx(wb, opts) {\n      var o = [XML_HEADER];\n      /* 3.1.3.2 */\n      if (opts.bookType == \"fods\") o.push('<office:document xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:style=\"urn:oasis:names:tc:opendocument:xmlns:style:1.0\" xmlns:text=\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\" xmlns:table=\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\" xmlns:draw=\"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\" xmlns:fo=\"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:number=\"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\" xmlns:presentation=\"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\" xmlns:svg=\"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\" xmlns:chart=\"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\" xmlns:dr3d=\"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\" xmlns:math=\"http://www.w3.org/1998/Math/MathML\" xmlns:form=\"urn:oasis:names:tc:opendocument:xmlns:form:1.0\" xmlns:script=\"urn:oasis:names:tc:opendocument:xmlns:script:1.0\" xmlns:config=\"urn:oasis:names:tc:opendocument:xmlns:config:1.0\" xmlns:ooo=\"http://openoffice.org/2004/office\" xmlns:ooow=\"http://openoffice.org/2004/writer\" xmlns:oooc=\"http://openoffice.org/2004/calc\" xmlns:dom=\"http://www.w3.org/2001/xml-events\" xmlns:xforms=\"http://www.w3.org/2002/xforms\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:rpt=\"http://openoffice.org/2005/report\" xmlns:of=\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:grddl=\"http://www.w3.org/2003/g/data-view#\" xmlns:tableooo=\"http://openoffice.org/2009/table\" xmlns:drawooo=\"http://openoffice.org/2010/draw\" xmlns:calcext=\"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\" xmlns:loext=\"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\" xmlns:field=\"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\" xmlns:formx=\"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\" xmlns:css3t=\"http://www.w3.org/TR/css3-text/\" office:version=\"1.2\" office:mimetype=\"application/vnd.oasis.opendocument.spreadsheet\">');else o.push('<office:document-content office:version=\"1.2\" xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:table=\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\" xmlns:text=\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\">\\n'); // TODO\n      o.push('  <office:body>\\n');\n      o.push('    <office:spreadsheet>\\n');\n      for (var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts));\n      o.push('    </office:spreadsheet>\\n');\n      o.push('  </office:body>\\n');\n      if (opts.bookType == \"fods\") o.push('</office:document>');else o.push('</office:document-content>');\n      return o.join(\"\");\n    };\n  }();\n  /* Part 3: Packages */\n  function parse_ods(zip, opts) {\n    opts = opts || {};\n    var ods = !!safegetzipfile(zip, 'objectdata');\n    if (ods) var manifest = parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n    var content = getzipdata(zip, 'content.xml');\n    if (!content) throw new Error(\"Missing content.xml in \" + (ods ? \"ODS\" : \"UOF\") + \" file\");\n    return parse_content_xml(ods ? content : utf8read(content), opts);\n  }\n  function parse_fods(data, opts) {\n    return parse_content_xml(data, opts);\n  }\n  function write_ods(wb, opts) {\n    if (opts.bookType == \"fods\") return write_content_xml(wb, opts);\n    var zip = new jszip();\n    var f = \"\";\n    var manifest = [];\n    var rdf = [];\n\n    /* 3:3.3 and 2:2.2.4 */\n    f = \"mimetype\";\n    zip.file(f, \"application/vnd.oasis.opendocument.spreadsheet\");\n\n    /* Part 1 Section 2.2 Documents */\n    f = \"content.xml\";\n    zip.file(f, write_content_xml(wb, opts));\n    manifest.push([f, \"text/xml\"]);\n    rdf.push([f, \"ContentFile\"]);\n\n    /* Part 3 Section 6 Metadata Manifest File */\n    f = \"manifest.rdf\";\n    zip.file(f, write_rdf(rdf, opts));\n    manifest.push([f, \"application/rdf+xml\"]);\n\n    /* Part 3 Section 4 Manifest File */\n    f = \"META-INF/manifest.xml\";\n    zip.file(f, write_manifest(manifest, opts));\n    return zip;\n  }\n  ODS.parse_ods = parse_ods;\n  ODS.write_ods = write_ods;\n  ODS.parse_fods = parse_fods;\n})(typeof exports !== 'undefined' ? exports : ODS);","map":{"version":3,"names":["ODS","make_ods","get_utils","XLSX","utils","module","require","e","Error","has_buf","Buffer","cc2str","arr","o","i","length","String","fromCharCode","dup","JSON","parse","stringify","out","k","hasOwnProperty","getdatastr","data","asNodeBuffer","toString","asBinary","_data","getContent","Array","prototype","slice","call","getdata","safegetzipfile","zip","file","f","files","toLowerCase","replace","getzipfile","getzipdata","safe","_fs","jszip","JSZip","exports","attregexg","tagregex","nsregex","nsregex2","parsexmltag","tag","skip_root","z","eq","c","charCodeAt","substr","m","match","j","v","q","cc","substring","indexOf","strip_ns","x","encodings","rencoding","rencstr","split","encregex","coderegex","unescapexml","text","s","$$","parseInt","decregex","charegex","escapexml","y","parsexmlbool","value","datenum","date1904","epoch","getTime","parse_isodur","sec","mt","time","XML_HEADER","xlml_normalize","d","isBuffer","xlmlregex","CT_ODS","parse_manifest","opts","str","Rn","FEtag","exec","path","type","WTF","write_manifest","manifest","push","join","write_rdf_type","res","write_rdf_has","base","write_rdf","rdf","parse_text_p","utf8read","utf8reada","orig","w","ods_to_csf_formula","parse_content_xml","number_formats","day","month","year","hours","minutes","seconds","pcx","_opts","state","tmp","NFtag","name","NF","pidx","sheetag","rowtag","Sheets","SheetNames","ws","ctag","textp","textpidx","textptag","R","C","range","r","number_format_map","merges","mrange","mR","mC","arrayf","rept","isstub","lastIndex","encode_range","charAt","t","cellFormula","F","formula","parseFloat","Date","cellStubs","sheetRows","encode_cell","pop","style","index","write_content_xml","null_cell_xml","write_ws","wb","decode_range","ref","cell","wcx","bookType","parse_ods","ods","content","parse_fods","write_ods"],"sources":["C:/Users/malvi/Angular/template/node_modules/alasql/node_modules/xlsx/ods.js"],"sourcesContent":["/* ods.js (C) 2014-present  SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint -W041 */\nvar ODS = {};\n(function make_ods(ODS) {\n/* Open Document Format for Office Applications (OpenDocument) Version 1.2 */\nvar get_utils = function() {\n\tif(typeof XLSX !== 'undefined') return XLSX.utils;\n\tif(typeof module !== \"undefined\" && typeof require !== 'undefined') try {\n\t\treturn require('../xlsx.js').utils;\n\t} catch(e) {\n\t\treturn require('./xlsx.js').utils;\n\t}\n\tthrow new Error(\"Cannot find XLSX utils\");\n};\nvar has_buf = (typeof Buffer !== 'undefined');\n\nfunction cc2str(arr) {\n\tvar o = \"\";\n\tfor(var i = 0; i != arr.length; ++i) o += String.fromCharCode(arr[i]);\n\treturn o;\n}\n\nfunction dup(o) {\n\tif(typeof JSON != 'undefined') return JSON.parse(JSON.stringify(o));\n\tif(typeof o != 'object' || !o) return o;\n\tvar out = {};\n\tfor(var k in o) if(o.hasOwnProperty(k)) out[k] = dup(o[k]);\n\treturn out;\n}\nfunction getdatastr(data) {\n\tif(!data) return null;\n\tif(data.data) return data.data;\n\tif(data.asNodeBuffer && has_buf) return data.asNodeBuffer().toString('binary');\n\tif(data.asBinary) return data.asBinary();\n\tif(data._data && data._data.getContent) return cc2str(Array.prototype.slice.call(data._data.getContent(),0));\n\treturn null;\n}\n\n/* ODS and friends only use text files in container */\nfunction getdata(data) { return getdatastr(data); }\n\n/* NOTE: unlike ECMA-376, OASIS does not comment on filename case sensitivity */\nfunction safegetzipfile(zip, file) {\n\tvar f = file; if(zip.files[f]) return zip.files[f];\n\tf = file.toLowerCase(); if(zip.files[f]) return zip.files[f];\n\tf = f.replace(/\\//g,'\\\\'); if(zip.files[f]) return zip.files[f];\n\treturn null;\n}\n\nfunction getzipfile(zip, file) {\n\tvar o = safegetzipfile(zip, file);\n\tif(o == null) throw new Error(\"Cannot find file \" + file + \" in zip\");\n\treturn o;\n}\n\nfunction getzipdata(zip, file, safe) {\n\tif(!safe) return getdata(getzipfile(zip, file));\n\tif(!file) return null;\n\ttry { return getzipdata(zip, file); } catch(e) { return null; }\n}\n\nvar _fs, jszip;\nif(typeof JSZip !== 'undefined') jszip = JSZip;\nif (typeof exports !== 'undefined') {\n\tif (typeof module !== 'undefined' && module.exports) {\n\t\tif(typeof jszip === 'undefined') jszip = require('./jszip.js');\n\t\t_fs = require('fs');\n\t}\n}\nvar attregexg=/[^\\s?>\\/]+=[\"'][^\"]*['\"]/g;\nvar tagregex=/<[^>]*>/g;\nvar nsregex=/<\\w*:/, nsregex2 = /<(\\/?)\\w+:/;\nfunction parsexmltag(tag, skip_root) {\n\tvar z = [];\n\tvar eq = 0, c = 0;\n\tfor(; eq !== tag.length; ++eq) if((c = tag.charCodeAt(eq)) === 32 || c === 10 || c === 13) break;\n\tif(!skip_root) z[0] = tag.substr(0, eq);\n\tif(eq === tag.length) return z;\n\tvar m = tag.match(attregexg), j=0, v=\"\", i=0, q=\"\", cc=\"\";\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\tcc = m[i];\n\t\tfor(c=0; c != cc.length; ++c) if(cc.charCodeAt(c) === 61) break;\n\t\tq = cc.substr(0,c); v = cc.substring(c+2, cc.length-1);\n\t\tfor(j=0;j!=q.length;++j) if(q.charCodeAt(j) === 58) break;\n\t\tif(j===q.length) {\n\t\t\tif(q.indexOf(\"_\") > 0) q = q.substr(0, q.indexOf(\"_\"));\n\t\t\tz[q] = v;\n\t\t}\n\t\telse {\n\t\t\tvar k = (j===5 && q.substr(0,5)===\"xmlns\"?\"xmlns\":\"\")+q.substr(j+1);\n\t\t\tif(z[k] && q.substr(j-3,3) == \"ext\") continue;\n\t\t\tz[k] = v;\n\t\t}\n\t}\n\treturn z;\n}\nfunction strip_ns(x) { return x.replace(nsregex2, \"<$1\"); }\n\nvar encodings = {\n\t'&quot;': '\"',\n\t'&apos;': \"'\",\n\t'&gt;': '>',\n\t'&lt;': '<',\n\t'&amp;': '&'\n};\nvar rencoding = {\n\t'\"': '&quot;',\n\t\"'\": '&apos;',\n\t'>': '&gt;',\n\t'<': '&lt;',\n\t'&': '&amp;'\n};\nvar rencstr = \"&<>'\\\"\".split(\"\");\n\n// TODO: CP remap (need to read file version to determine OS)\n/* 22.4.2.4 bstr (Basic String) */\nvar encregex = /&[a-z]*;/g, coderegex = /_x([\\da-fA-F]{4})_/g;\nfunction unescapexml(text){\n\tvar s = text + '';\n\treturn s.replace(encregex, function($$) { return encodings[$$]; }).replace(coderegex,function(m,c) {return String.fromCharCode(parseInt(c,16));});\n}\nvar decregex=/[&<>'\"]/g, charegex = /[\\u0000-\\u0008\\u000b-\\u001f]/g;\nfunction escapexml(text){\n\tvar s = text + '';\n\treturn s.replace(decregex, function(y) { return rencoding[y]; }).replace(charegex,function(s) { return \"_x\" + (\"000\"+s.charCodeAt(0).toString(16)).substr(-4) + \"_\";});\n}\n\nfunction parsexmlbool(value) {\n\tswitch(value) {\n\t\tcase '1': case 'true': case 'TRUE': return true;\n\t\t/* case '0': case 'false': case 'FALSE':*/\n\t\tdefault: return false;\n\t}\n}\n\nfunction datenum(v, date1904) {\n\tvar epoch = v.getTime();\n\tif(date1904) epoch += 1462*24*60*60*1000;\n\treturn (epoch + 2209161600000) / (24 * 60 * 60 * 1000);\n}\n\n/* ISO 8601 Duration */\nfunction parse_isodur(s) {\n\tvar sec = 0, mt = 0, time = false;\n\tvar m = s.match(/P([0-9\\.]+Y)?([0-9\\.]+M)?([0-9\\.]+D)?T([0-9\\.]+H)?([0-9\\.]+M)?([0-9\\.]+S)?/);\n\tif(!m) throw new Error(\"|\" + s + \"| is not an ISO8601 Duration\");\n\tfor(var i = 1; i != m.length; ++i) {\n\t\tif(!m[i]) continue;\n\t\tmt = 1;\n\t\tif(i > 3) time = true;\n\t\tswitch(m[i].substr(m[i].length-1)) {\n\t\t\tcase 'Y':\n\t\t\t\tthrow new Error(\"Unsupported ISO Duration Field: \" + m[i].substr(m[i].length-1));\n\t\t\tcase 'D': mt *= 24;\n\t\t\t\t/* falls through */\n\t\t\tcase 'H': mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'M':\n\t\t\t\tif(!time) throw new Error(\"Unsupported ISO Duration Field: M\");\n\t\t\t\telse mt *= 60;\n\t\t\t\t/* falls through */\n\t\t\tcase 'S': break;\n\t\t}\n\t\tsec += mt * parseInt(m[i], 10);\n\t}\n\treturn sec;\n}\n\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\n/* copied from js-xls (C) SheetJS Apache2 license */\nfunction xlml_normalize(d) {\n\tif(has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n\tif(typeof d === 'string') return d;\n\tthrow \"badf\";\n}\n\n/* UOS uses CJK in tags, original regex /<(\\/?)([a-z0-9]*:|)([\\w-]+)[^>]*>/ */\nvar xlmlregex = /<(\\/?)([^\\s?>\\/:]*:|)([^\\s?>]*[^\\s?>\\/])[^>]*>/mg;\n/* Part 3 Section 4 Manifest File */\nvar CT_ODS = \"application/vnd.oasis.opendocument.spreadsheet\";\nfunction parse_manifest(d, opts) {\n\tvar str = xlml_normalize(d);\n\tvar Rn;\n\tvar FEtag;\n\twhile((Rn = xlmlregex.exec(str))) switch(Rn[3]) {\n\t\tcase 'manifest': break; // 4.2 <manifest:manifest>\n\t\tcase 'file-entry': // 4.3 <manifest:file-entry>\n\t\t\tFEtag = parsexmltag(Rn[0], false);\n\t\t\tif(FEtag.path == '/' && FEtag.type !== CT_ODS) throw new Error(\"This OpenDocument is not a spreadsheet\");\n\t\t\tbreak;\n\t\tcase 'encryption-data': // 4.4 <manifest:encryption-data>\n\t\tcase 'algorithm': // 4.5 <manifest:algorithm>\n\t\tcase 'start-key-generation': // 4.6 <manifest:start-key-generation>\n\t\tcase 'key-derivation': // 4.7 <manifest:key-derivation>\n\t\t\tthrow new Error(\"Unsupported ODS Encryption\");\n\t\tdefault: if(opts && opts.WTF) throw Rn;\n\t}\n}\n\nfunction write_manifest(manifest, opts) {\n\tvar o = [XML_HEADER];\n\to.push('<manifest:manifest xmlns:manifest=\"urn:oasis:names:tc:opendocument:xmlns:manifest:1.0\" manifest:version=\"1.2\">\\n');\n\to.push('  <manifest:file-entry manifest:full-path=\"/\" manifest:version=\"1.2\" manifest:media-type=\"application/vnd.oasis.opendocument.spreadsheet\"/>\\n');\n\tfor(var i = 0; i < manifest.length; ++i) o.push('  <manifest:file-entry manifest:full-path=\"' + manifest[i][0] + '\" manifest:media-type=\"' + manifest[i][1] + '\"/>\\n');\n\to.push('</manifest:manifest>');\n\treturn o.join(\"\");\n}\n/* Part 3 Section 6 Metadata Manifest File */\nfunction write_rdf_type(file, res, tag) {\n\treturn [\n\t\t'  <rdf:Description rdf:about=\"' + file + '\">\\n',\n\t\t'    <rdf:type rdf:resource=\"http://docs.oasis-open.org/ns/office/1.2/meta/' + (tag || \"odf\") + '#' + res + '\"/>\\n',\n\t\t'  </rdf:Description>\\n'\n\t].join(\"\");\n}\nfunction write_rdf_has(base, file) {\n\treturn [\n\t\t'  <rdf:Description rdf:about=\"' + base + '\">\\n',\n\t\t'    <ns0:hasPart xmlns:ns0=\"http://docs.oasis-open.org/ns/office/1.2/meta/pkg#\" rdf:resource=\"' + file + '\"/>\\n',\n\t\t'  </rdf:Description>\\n'\n\t].join(\"\");\n}\nfunction write_rdf(rdf, opts) {\n\tvar o = [XML_HEADER];\n\to.push('<rdf:RDF xmlns:rdf=\"http://www.w3.org/1999/02/22-rdf-syntax-ns#\">\\n');\n\tfor(var i = 0; i != rdf.length; ++i) {\n\t\to.push(write_rdf_type(rdf[i][0], rdf[i][1]));\n\t\to.push(write_rdf_has(\"\",rdf[i][0]));\n\t}\n\to.push(write_rdf_type(\"\",\"Document\", \"pkg\"));\n\to.push('</rdf:RDF>');\n\treturn o.join(\"\");\n}\nvar parse_text_p = function(text, tag) {\n\treturn unescapexml(text.replace(/<text:s\\/>/g,\" \").replace(/<[^>]*>/g,\"\"));\n};\n\nvar utf8read = function utf8reada(orig) {\n\tvar out = \"\", i = 0, c = 0, d = 0, e = 0, f = 0, w = 0;\n\twhile (i < orig.length) {\n\t\tc = orig.charCodeAt(i++);\n\t\tif (c < 128) { out += String.fromCharCode(c); continue; }\n\t\td = orig.charCodeAt(i++);\n\t\tif (c>191 && c<224) { out += String.fromCharCode(((c & 31) << 6) | (d & 63)); continue; }\n\t\te = orig.charCodeAt(i++);\n\t\tif (c < 240) { out += String.fromCharCode(((c & 15) << 12) | ((d & 63) << 6) | (e & 63)); continue; }\n\t\tf = orig.charCodeAt(i++);\n\t\tw = (((c & 7) << 18) | ((d & 63) << 12) | ((e & 63) << 6) | (f & 63))-65536;\n\t\tout += String.fromCharCode(0xD800 + ((w>>>10)&1023));\n\t\tout += String.fromCharCode(0xDC00 + (w&1023));\n\t}\n\treturn out;\n};\n/* Part 3 TODO: actually parse formulae */\nfunction ods_to_csf_formula(f) {\n\tif(f.substr(0,3) == \"of:\") f = f.substr(3);\n\t/* 5.2 Basic Expressions */\n\tif(f.charCodeAt(0) == 61) {\n\t\tf = f.substr(1);\n\t\tif(f.charCodeAt(0) == 61) f = f.substr(1);\n\t}\n\t/* Part 3 Section 5.8 References */\n\treturn f.replace(/\\[((?:\\.[A-Z]+[0-9]+)(?::\\.[A-Z]+[0-9]+)?)\\]/g, \"$1\").replace(/\\./g, \"\");\n}\nvar parse_content_xml = (function() {\n\n\tvar number_formats = {\n\t\t/* ods name: [short ssf fmt, long ssf fmt] */\n\t\tday: [\"d\", \"dd\"],\n\t\tmonth: [\"m\", \"mm\"],\n\t\tyear: [\"y\", \"yy\"],\n\t\thours: [\"h\", \"hh\"],\n\t\tminutes: [\"m\", \"mm\"],\n\t\tseconds: [\"s\", \"ss\"],\n\t\t\"am-pm\": [\"A/P\", \"AM/PM\"],\n\t\t\"day-of-week\": [\"ddd\", \"dddd\"]\n\t};\n\n\treturn function pcx(d, _opts) {\n\t\tvar opts = _opts || {};\n\t\tvar str = xlml_normalize(d);\n\t\tvar state = [], tmp;\n\t\tvar tag;\n\t\tvar NFtag = {name:\"\"}, NF = \"\", pidx = 0;\n\t\tvar sheetag;\n\t\tvar rowtag;\n\t\tvar Sheets = {}, SheetNames = [], ws = {};\n\t\tvar Rn, q;\n\t\tvar ctag = {value:\"\"};\n\t\tvar textp = \"\", textpidx = 0, textptag;\n\t\tvar R = -1, C = -1, range = {s: {r:1000000,c:10000000}, e: {r:0, c:0}};\n\t\tvar number_format_map = {};\n\t\tvar merges = [], mrange = {}, mR = 0, mC = 0;\n\t\tvar arrayf = [];\n\t\tvar rept = 1, isstub = false;\n\t\tvar i = 0;\n\t\txlmlregex.lastIndex = 0;\n\t\twhile((Rn = xlmlregex.exec(str))) switch((Rn[3]=Rn[3].replace(/_.*$/,\"\"))) {\n\n\t\t\tcase 'table': case '工作表': // 9.1.2 <table:table>\n\t\t\t\tif(Rn[1]==='/') {\n\t\t\t\t\tif(range.e.c >= range.s.c && range.e.r >= range.s.r) ws['!ref'] = get_utils().encode_range(range);\n\t\t\t\t\tif(merges.length) ws['!merges'] = merges;\n\t\t\t\t\tsheetag.name = utf8read(sheetag['名称'] || sheetag.name);\n\t\t\t\t\tSheetNames.push(sheetag.name);\n\t\t\t\t\tSheets[sheetag.name] = ws;\n\t\t\t\t}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tsheetag = parsexmltag(Rn[0], false);\n\t\t\t\t\tR = C = -1;\n\t\t\t\t\trange.s.r = range.s.c = 10000000; range.e.r = range.e.c = 0;\n\t\t\t\t\tws = {}; merges = [];\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\tcase 'table-row': case '行': // 9.1.3 <table:table-row>\n\t\t\t\tif(Rn[1] === '/') break;\n\t\t\t\trowtag = parsexmltag(Rn[0], false);\n\t\t\t\tif(rowtag['行号']) R = rowtag['行号'] - 1; else ++R;\n\t\t\t\tC = -1; break;\n\t\t\tcase 'covered-table-cell': // 9.1.5 table:covered-table-cell\n\t\t\t\t++C; break; /* stub */\n\t\t\tcase 'table-cell': case '数据':\n\t\t\t\tif(Rn[0].charAt(Rn[0].length-2) === '/') {\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tif(ctag['number-columns-repeated']) C+= parseInt(ctag['number-columns-repeated'], 10);\n\t\t\t\t\telse ++C;\n\t\t\t\t}\n\t\t\t\telse if(Rn[1]!=='/') {\n\t\t\t\t\t++C;\n\t\t\t\t\trept = 1;\n\t\t\t\t\tif(C > range.e.c) range.e.c = C;\n\t\t\t\t\tif(R > range.e.r) range.e.r = R;\n\t\t\t\t\tif(C < range.s.c) range.s.c = C;\n\t\t\t\t\tif(R < range.s.r) range.s.r = R;\n\t\t\t\t\tctag = parsexmltag(Rn[0], false);\n\t\t\t\t\tq = ({t:ctag['数据类型'] || ctag['value-type'], v:null});\n\t\t\t\t\tif(opts.cellFormula) {\n\t\t\t\t\t\tif(ctag['number-matrix-columns-spanned'] && ctag['number-matrix-rows-spanned']) {\n\t\t\t\t\t\t\tmR = parseInt(ctag['number-matrix-rows-spanned'],10) || 0;\n\t\t\t\t\t\t\tmC = parseInt(ctag['number-matrix-columns-spanned'],10) || 0;\n\t\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\t\tq.F = get_utils().encode_range(mrange);\n\t\t\t\t\t\t\tarrayf.push([mrange, q.F]);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(ctag.formula) q.f = ods_to_csf_formula(ctag.formula);\n\t\t\t\t\t\telse for(i = 0; i < arrayf.length; ++i)\n\t\t\t\t\t\t\tif(R >= arrayf[i][0].s.r && R <= arrayf[i][0].e.r)\n\t\t\t\t\t\t\t\tif(C >= arrayf[i][0].s.c && C <= arrayf[i][0].e.c)\n\t\t\t\t\t\t\t\t\tq.F = arrayf[i][1];\n\t\t\t\t\t}\n\t\t\t\t\tif(ctag['number-columns-spanned'] || ctag['number-rows-spanned']) {\n\t\t\t\t\t\tmR = parseInt(ctag['number-rows-spanned'],10) || 0;\n\t\t\t\t\t\tmC = parseInt(ctag['number-columns-spanned'],10) || 0;\n\t\t\t\t\t\tmrange = {s: {r:R,c:C}, e:{r:R + mR-1,c:C + mC-1}};\n\t\t\t\t\t\tmerges.push(mrange);\n\t\t\t\t\t}\n\n\t\t\t\t\t/* 19.675.2 table:number-columns-repeated */\n\t\t\t\t\tif(ctag['number-columns-repeated']) rept = parseInt(ctag['number-columns-repeated'], 10);\n\n\t\t\t\t\t/* 19.385 office:value-type */\n\t\t\t\t\tswitch(q.t) {\n\t\t\t\t\t\tcase 'boolean': q.t = 'b'; q.v = parsexmlbool(ctag['boolean-value']); break;\n\t\t\t\t\t\tcase 'float': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'percentage': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'currency': q.t = 'n'; q.v = parseFloat(ctag.value); break;\n\t\t\t\t\t\tcase 'date': q.t = 'n'; q.v = datenum(new Date(ctag['date-value'])); q.z = 'm/d/yy'; break;\n\t\t\t\t\t\tcase 'time': q.t = 'n'; q.v = parse_isodur(ctag['time-value'])/86400; break;\n\t\t\t\t\t\tcase 'number': q.t = 'n'; q.v = parseFloat(ctag['数据数值']); break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif(q.t === 'string' || q.t === 'text' || !q.t) {\n\t\t\t\t\t\t\t\tq.t = 's';\n\t\t\t\t\t\t\t\tif(ctag['string-value'] != null) textp = ctag['string-value'];\n\t\t\t\t\t\t\t} else throw new Error('Unsupported value type ' + q.t);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tisstub = false;\n\t\t\t\t\tif(q.t === 's') {\n\t\t\t\t\t\tq.v = textp || '';\n\t\t\t\t\t\tisstub = textpidx == 0;\n\t\t\t\t\t}\n\t\t\t\t\tif(textp) q.w = textp;\n\t\t\t\t\tif(!isstub || opts.cellStubs) {\n\t\t\t\t\t\tif(!(opts.sheetRows && opts.sheetRows < R)) {\n\t\t\t\t\t\t\tws[get_utils().encode_cell({r:R,c:C})] = q;\n\t\t\t\t\t\t\twhile(--rept > 0) ws[get_utils().encode_cell({r:R,c:++C})] = dup(q);\n\t\t\t\t\t\t\tif(range.e.c <= C) range.e.c = C;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else { C += rept; rept = 0; }\n\t\t\t\t\tq = {};\n\t\t\t\t\ttextp = \"\";\n\t\t\t\t}\n\t\t\t\tbreak; // 9.1.4 <table:table-cell>\n\n\t\t\t/* pure state */\n\t\t\tcase 'document': // TODO: <office:document> is the root for FODS\n\t\t\tcase 'document-content': case '电子表格文档': // 3.1.3.2 <office:document-content>\n\t\t\tcase 'spreadsheet': case '主体': // 3.7 <office:spreadsheet>\n\t\t\tcase 'scripts': // 3.12 <office:scripts>\n\t\t\tcase 'styles': // TODO <office:styles>\n\t\t\tcase 'font-face-decls': // 3.14 <office:font-face-decls>\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\t\tbreak;\n\n\t\t\t/* ignore state */\n\t\t\tcase 'meta': case '元数据': // TODO: <office:meta> <uof:元数据> FODS/UOF\n\t\t\tcase 'settings': // TODO: <office:settings>\n\t\t\tcase 'config-item-set': // TODO: <office:config-item-set>\n\t\t\tcase 'config-item-map-indexed': // TODO: <office:config-item-map-indexed>\n\t\t\tcase 'config-item-map-entry': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'config-item-map-named': // TODO: <office:config-item-map-entry>\n\t\t\tcase 'shapes': // 9.2.8 <table:shapes>\n\t\t\tcase 'frame': // 10.4.2 <draw:frame>\n\t\t\tcase 'text-box': // 10.4.3 <draw:text-box>\n\t\t\tcase 'image': // 10.4.4 <draw:image>\n\t\t\tcase 'data-pilot-tables': // 9.6.2 <table:data-pilot-tables>\n\t\t\tcase 'list-style': // 16.30 <text:list-style>\n\t\t\tcase 'form': // 13.13 <form:form>\n\t\t\tcase 'dde-links': // 9.8 <table:dde-links>\n\t\t\tcase 'annotation': // 14.1 <office:annotation>\n\t\t\tcase 'event-listeners': // TODO\n\t\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], false]);\n\t\t\t\ttextp = \"\"; textpidx = 0;\n\t\t\t\tbreak;\n\n\t\t\tcase 'scientific-number': // TODO: <number:scientific-number>\n\t\t\t\tbreak;\n\t\t\tcase 'currency-symbol': // TODO: <number:currency-symbol>\n\t\t\t\tbreak;\n\t\t\tcase 'currency-style': // TODO: <number:currency-style>\n\t\t\t\tbreak;\n\t\t\tcase 'number-style': // 16.27.2 <number:number-style>\n\t\t\tcase 'percentage-style': // 16.27.9 <number:percentage-style>\n\t\t\tcase 'date-style': // 16.27.10 <number:date-style>\n\t\t\tcase 'time-style': // 16.27.18 <number:time-style>\n\t\t\t\tif(Rn[1]==='/'){\n\t\t\t\t\tnumber_format_map[NFtag.name] = NF;\n\t\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\t} else if(Rn[0].charAt(Rn[0].length-2) !== '/') {\n\t\t\t\t\tNF = \"\";\n\t\t\t\t\tNFtag = parsexmltag(Rn[0], false);\n\t\t\t\t\tstate.push([Rn[3], true]);\n\t\t\t\t} break;\n\n\t\t\tcase 'script': break; // 3.13 <office:script>\n\t\t\tcase 'libraries': break; // TODO: <ooo:libraries>\n\t\t\tcase 'automatic-styles': break; // 3.15.3 <office:automatic-styles>\n\t\t\tcase 'master-styles': break; // TODO: <office:automatic-styles>\n\n\t\t\tcase 'default-style': // TODO: <style:default-style>\n\t\t\tcase 'page-layout': break; // TODO: <style:page-layout>\n\t\t\tcase 'style': break; // 16.2 <style:style>\n\t\t\tcase 'map': break; // 16.3 <style:map>\n\t\t\tcase 'font-face': break; // 16.21 <style:font-face>\n\n\t\t\tcase 'paragraph-properties': break; // 17.6 <style:paragraph-properties>\n\t\t\tcase 'table-properties': break; // 17.15 <style:table-properties>\n\t\t\tcase 'table-column-properties': break; // 17.16 <style:table-column-properties>\n\t\t\tcase 'table-row-properties': break; // 17.17 <style:table-row-properties>\n\t\t\tcase 'table-cell-properties': break; // 17.18 <style:table-cell-properties>\n\n\t\t\tcase 'number': // 16.27.3 <number:number>\n\t\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t\t\tNF += number_formats[Rn[3]][tag.style==='long'?1:0]; break;\n\t\t\t\t} break;\n\n\t\t\tcase 'fraction': break; // TODO 16.27.6 <number:fraction>\n\n\t\t\tcase 'day': // 16.27.11 <number:day>\n\t\t\tcase 'month': // 16.27.12 <number:month>\n\t\t\tcase 'year': // 16.27.13 <number:year>\n\t\t\tcase 'era': // 16.27.14 <number:era>\n\t\t\tcase 'day-of-week': // 16.27.15 <number:day-of-week>\n\t\t\tcase 'week-of-year': // 16.27.16 <number:week-of-year>\n\t\t\tcase 'quarter': // 16.27.17 <number:quarter>\n\t\t\tcase 'hours': // 16.27.19 <number:hours>\n\t\t\tcase 'minutes': // 16.27.20 <number:minutes>\n\t\t\tcase 'seconds': // 16.27.21 <number:seconds>\n\t\t\tcase 'am-pm': // 16.27.22 <number:am-pm>\n\t\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\t\ttag = parsexmltag(Rn[0], false);\n\t\t\t\t\t\tNF += number_formats[Rn[3]][tag.style==='long'?1:0]; break;\n\t\t\t\t} break;\n\n\t\t\tcase 'boolean-style': break; // 16.27.23 <number:boolean-style>\n\t\t\tcase 'boolean': break; // 16.27.24 <number:boolean>\n\t\t\tcase 'text-style': break; // 16.27.25 <number:text-style>\n\t\t\tcase 'text': // 16.27.26 <number:text>\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") switch(state[state.length-1][0]) {\n\t\t\t\t\tcase 'number-style':\n\t\t\t\t\tcase 'date-style':\n\t\t\t\t\tcase 'time-style':\n\t\t\t\t\t\tNF += str.slice(pidx, Rn.index);\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\t\tbreak;\n\t\t\tcase 'text-content': break; // 16.27.27 <number:text-content>\n\t\t\tcase 'text-properties': break; // 16.27.27 <style:text-properties>\n\n\t\t\tcase 'body': case '电子表格': break; // 3.3 16.9.6 19.726.3\n\n\t\t\tcase 'forms': break; // 12.25.2 13.2\n\t\t\tcase 'table-column': break; // 9.1.6 <table:table-column>\n\n\t\t\tcase 'null-date': break; // 9.4.2 <table:null-date> TODO: date1904\n\n\t\t\tcase 'graphic-properties': break; // 17.21 <style:graphic-properties>\n\t\t\tcase 'calculation-settings': break; // 9.4.1 <table:calculation-settings>\n\t\t\tcase 'named-expressions': break; // 9.4.11 <table:named-expressions>\n\t\t\tcase 'named-range': break; // 9.4.12 <table:named-range>\n\t\t\tcase 'named-expression': break; // 9.4.13 <table:named-expression>\n\t\t\tcase 'sort': break; // 9.4.19 <table:sort>\n\t\t\tcase 'sort-by': break; // 9.4.20 <table:sort-by>\n\t\t\tcase 'sort-groups': break; // 9.4.22 <table:sort-groups>\n\n\t\t\tcase 'span': break; // <text:span>\n\t\t\tcase 'line-break': break; // 6.1.5 <text:line-break>\n\t\t\tcase 'p': case '文本串':\n\t\t\t\tif(Rn[1]==='/') textp = parse_text_p(str.slice(textpidx,Rn.index), textptag);\n\t\t\t\telse { textptag = parsexmltag(Rn[0], false); textpidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak; // <text:p>\n\t\t\tcase 's': break; // <text:s>\n\t\t\tcase 'date': break; // <*:date>\n\n\t\t\tcase 'object': break; // 10.4.6.2 <draw:object>\n\t\t\tcase 'title': case '标题': break; // <*:title> OR <uof:标题>\n\t\t\tcase 'desc': break; // <*:desc>\n\n\t\t\tcase 'table-source': break; // 9.2.6\n\n\t\t\tcase 'iteration': break; // 9.4.3 <table:iteration>\n\t\t\tcase 'content-validations': break; // 9.4.4 <table:\n\t\t\tcase 'content-validation': break; // 9.4.5 <table:\n\t\t\tcase 'error-message': break; // 9.4.7 <table:\n\t\t\tcase 'database-ranges': break; // 9.4.14 <table:database-ranges>\n\t\t\tcase 'database-range': break; // 9.4.15 <table:database-range>\n\t\t\tcase 'filter': break; // 9.5.2 <table:filter>\n\t\t\tcase 'filter-and': break; // 9.5.3 <table:filter-and>\n\t\t\tcase 'filter-or': break; // 9.5.4 <table:filter-or>\n\t\t\tcase 'filter-condition': break; // 9.5.5 <table:filter-condition>\n\n\t\t\tcase 'list-level-style-bullet': break; // 16.31 <text:\n\t\t\tcase 'list-level-style-number': break; // 16.32 <text:\n\t\t\tcase 'list-level-properties': break; // 17.19 <style:\n\n\t\t\t/* 7.3 Document Fields */\n\t\t\tcase 'sender-firstname': // 7.3.6.2\n\t\t\tcase 'sender-lastname': // 7.3.6.3\n\t\t\tcase 'sender-initials': // 7.3.6.4\n\t\t\tcase 'sender-title': // 7.3.6.5\n\t\t\tcase 'sender-position': // 7.3.6.6\n\t\t\tcase 'sender-email': // 7.3.6.7\n\t\t\tcase 'sender-phone-private': // 7.3.6.8\n\t\t\tcase 'sender-fax': // 7.3.6.9\n\t\t\tcase 'sender-company': // 7.3.6.10\n\t\t\tcase 'sender-phone-work': // 7.3.6.11\n\t\t\tcase 'sender-street': // 7.3.6.12\n\t\t\tcase 'sender-city': // 7.3.6.13\n\t\t\tcase 'sender-postal-code': // 7.3.6.14\n\t\t\tcase 'sender-country': // 7.3.6.15\n\t\t\tcase 'sender-state-or-province': // 7.3.6.16\n\t\t\tcase 'author-name': // 7.3.7.1\n\t\t\tcase 'author-initials': // 7.3.7.2\n\t\t\tcase 'chapter': // 7.3.8\n\t\t\tcase 'file-name': // 7.3.9\n\t\t\tcase 'template-name': // 7.3.9\n\t\t\tcase 'sheet-name': // 7.3.9\n\t\t\t\tbreak;\n\n\t\t\tcase 'event-listener': // TODO\n\t\t\t/* TODO: FODS Properties */\n\t\t\tcase 'initial-creator':\n\t\t\tcase 'creator':\n\t\t\tcase 'creation-date':\n\t\t\tcase 'generator':\n\t\t\tcase 'document-statistic':\n\t\t\tcase 'user-defined':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: FODS Config */\n\t\t\tcase 'config-item':\n\t\t\t\tbreak;\n\n\t\t\t/* TODO: style tokens */\n\t\t\tcase 'page-number': break; // TODO <text:page-number>\n\t\t\tcase 'page-count': break; // TODO <text:page-count>\n\t\t\tcase 'time': break; // TODO <text:time>\n\n\t\t\t/* 9.6 Data Pilot Tables <table: */\n\t\t\tcase 'data-pilot-table': // 9.6.3\n\t\t\tcase 'source-cell-range': // 9.6.5\n\t\t\tcase 'source-service': // 9.6.6\n\t\t\tcase 'data-pilot-field': // 9.6.7\n\t\t\tcase 'data-pilot-level': // 9.6.8\n\t\t\tcase 'data-pilot-subtotals': // 9.6.9\n\t\t\tcase 'data-pilot-subtotal': // 9.6.10\n\t\t\tcase 'data-pilot-members': // 9.6.11\n\t\t\tcase 'data-pilot-member': // 9.6.12\n\t\t\tcase 'data-pilot-display-info': // 9.6.13\n\t\t\tcase 'data-pilot-sort-info': // 9.6.14\n\t\t\tcase 'data-pilot-layout-info': // 9.6.15\n\t\t\tcase 'data-pilot-field-reference': // 9.6.16\n\t\t\tcase 'data-pilot-groups': // 9.6.17\n\t\t\tcase 'data-pilot-group': // 9.6.18\n\t\t\tcase 'data-pilot-group-member': // 9.6.19\n\t\t\t\tbreak;\n\n\t\t\t/* 10.3 Drawing Shapes */\n\t\t\tcase 'rect': // 10.3.2\n\t\t\t\tbreak;\n\n\t\t\t/* 14.6 DDE Connections */\n\t\t\tcase 'dde-connection-decls': // 14.6.2 <text:\n\t\t\tcase 'dde-connection-decl': // 14.6.3 <text:\n\t\t\tcase 'dde-link': // 14.6.4 <table:\n\t\t\tcase 'dde-source': // 14.6.5 <office:\n\t\t\t\tbreak;\n\n\t\t\tcase 'properties': break; // 13.7 <form:properties>\n\t\t\tcase 'property': break; // 13.8 <form:property>\n\n\t\t\tcase 'a': break; // 6.1.8 hyperlink\n\n\t\t\t/* non-standard */\n\t\t\tcase 'table-protection': break;\n\t\t\tcase 'data-pilot-grand-total': break; // <table:\n\t\t\tdefault:\n\t\t\t\tif(Rn[2] === 'dc:') break; // TODO: properties\n\t\t\t\tif(Rn[2] === 'draw:') break; // TODO: drawing\n\t\t\t\tif(Rn[2] === 'style:') break; // TODO: styles\n\t\t\t\tif(Rn[2] === 'calcext:') break; // ignore undocumented extensions\n\t\t\t\tif(Rn[2] === 'loext:') break; // ignore undocumented extensions\n\t\t\t\tif(Rn[2] === 'uof:') break; // TODO: uof\n\t\t\t\tif(Rn[2] === '表:') break; // TODO: uof\n\t\t\t\tif(Rn[2] === '字:') break; // TODO: uof\n\t\t\t\tif(opts.WTF) throw Rn;\n\t\t}\n\t\tvar out = {\n\t\t\tSheets: Sheets,\n\t\t\tSheetNames: SheetNames\n\t\t};\n\t\treturn out;\n\t};\n})();\nvar write_content_xml = (function() {\n\tvar null_cell_xml = '          <table:table-cell />\\n';\n\tvar write_ws = function(ws, wb, i, opts) {\n\t\t/* Section 9 Tables */\n\t\tvar o = [];\n\t\to.push('      <table:table table:name=\"' + escapexml(wb.SheetNames[i]) + '\">\\n');\n\t\tvar R=0,C=0, range = get_utils().decode_range(ws['!ref']);\n\t\tfor(R = 0; R < range.s.r; ++R) o.push('        <table:table-row></table:table-row>\\n');\n\t\tfor(; R <= range.e.r; ++R) {\n\t\t\to.push('        <table:table-row>\\n');\n\t\t\tfor(C=0; C < range.s.c; ++C) o.push(null_cell_xml);\n\t\t\tfor(; C <= range.e.c; ++C) {\n\t\t\t\tvar ref = get_utils().encode_cell({r:R, c:C}), cell = ws[ref];\n\t\t\t\tif(cell) switch(cell.t) {\n\t\t\t\t\tcase 'b': o.push('          <table:table-cell office:value-type=\"boolean\" office:boolean-value=\"' + (cell.v ? 'true' : 'false') + '\"><text:p>' + (cell.v ? 'TRUE' : 'FALSE') + '</text:p></table:table-cell>\\n'); break;\n\t\t\t\t\tcase 'n': o.push('          <table:table-cell office:value-type=\"float\" office:value=\"' + cell.v + '\"><text:p>' + (cell.w||cell.v) + '</text:p></table:table-cell>\\n'); break;\n\t\t\t\t\tcase 's': case 'str': o.push('          <table:table-cell office:value-type=\"string\"><text:p>' + escapexml(cell.v) + '</text:p></table:table-cell>\\n'); break;\n\t\t\t\t\t//case 'd': // TODO\n\t\t\t\t\t//case 'e':\n\t\t\t\t\tdefault: o.push(null_cell_xml);\n\t\t\t\t} else o.push(null_cell_xml);\n\t\t\t}\n\t\t\to.push('        </table:table-row>\\n');\n\t\t}\n\t\to.push('      </table:table>\\n');\n\t\treturn o.join(\"\");\n\t};\n\n\treturn function wcx(wb, opts) {\n\t\tvar o = [XML_HEADER];\n\t\t/* 3.1.3.2 */\n\t\tif(opts.bookType == \"fods\") o.push('<office:document xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:style=\"urn:oasis:names:tc:opendocument:xmlns:style:1.0\" xmlns:text=\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\" xmlns:table=\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\" xmlns:draw=\"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0\" xmlns:fo=\"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0\" xmlns:xlink=\"http://www.w3.org/1999/xlink\" xmlns:dc=\"http://purl.org/dc/elements/1.1/\" xmlns:meta=\"urn:oasis:names:tc:opendocument:xmlns:meta:1.0\" xmlns:number=\"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0\" xmlns:presentation=\"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0\" xmlns:svg=\"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0\" xmlns:chart=\"urn:oasis:names:tc:opendocument:xmlns:chart:1.0\" xmlns:dr3d=\"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0\" xmlns:math=\"http://www.w3.org/1998/Math/MathML\" xmlns:form=\"urn:oasis:names:tc:opendocument:xmlns:form:1.0\" xmlns:script=\"urn:oasis:names:tc:opendocument:xmlns:script:1.0\" xmlns:config=\"urn:oasis:names:tc:opendocument:xmlns:config:1.0\" xmlns:ooo=\"http://openoffice.org/2004/office\" xmlns:ooow=\"http://openoffice.org/2004/writer\" xmlns:oooc=\"http://openoffice.org/2004/calc\" xmlns:dom=\"http://www.w3.org/2001/xml-events\" xmlns:xforms=\"http://www.w3.org/2002/xforms\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:rpt=\"http://openoffice.org/2005/report\" xmlns:of=\"urn:oasis:names:tc:opendocument:xmlns:of:1.2\" xmlns:xhtml=\"http://www.w3.org/1999/xhtml\" xmlns:grddl=\"http://www.w3.org/2003/g/data-view#\" xmlns:tableooo=\"http://openoffice.org/2009/table\" xmlns:drawooo=\"http://openoffice.org/2010/draw\" xmlns:calcext=\"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0\" xmlns:loext=\"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0\" xmlns:field=\"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0\" xmlns:formx=\"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0\" xmlns:css3t=\"http://www.w3.org/TR/css3-text/\" office:version=\"1.2\" office:mimetype=\"application/vnd.oasis.opendocument.spreadsheet\">');\n\t\telse o.push('<office:document-content office:version=\"1.2\" xmlns:office=\"urn:oasis:names:tc:opendocument:xmlns:office:1.0\" xmlns:table=\"urn:oasis:names:tc:opendocument:xmlns:table:1.0\" xmlns:text=\"urn:oasis:names:tc:opendocument:xmlns:text:1.0\">\\n'); // TODO\n\t\to.push('  <office:body>\\n');\n\t\to.push('    <office:spreadsheet>\\n');\n\t\tfor(var i = 0; i != wb.SheetNames.length; ++i) o.push(write_ws(wb.Sheets[wb.SheetNames[i]], wb, i, opts));\n\t\to.push('    </office:spreadsheet>\\n');\n\t\to.push('  </office:body>\\n');\n\t\tif(opts.bookType == \"fods\") o.push('</office:document>');\n\t\telse o.push('</office:document-content>');\n\t\treturn o.join(\"\");\n\t};\n})();\n/* Part 3: Packages */\nfunction parse_ods(zip, opts) {\n\topts = opts || ({});\n\tvar ods = !!safegetzipfile(zip, 'objectdata');\n\tif(ods) var manifest = parse_manifest(getzipdata(zip, 'META-INF/manifest.xml'), opts);\n\tvar content = getzipdata(zip, 'content.xml');\n\tif(!content) throw new Error(\"Missing content.xml in \" + (ods ? \"ODS\" : \"UOF\")+ \" file\");\n\treturn parse_content_xml(ods ? content : utf8read(content), opts);\n}\n\nfunction parse_fods(data, opts) {\n\treturn parse_content_xml(data, opts);\n}\nfunction write_ods(wb, opts) {\n\tif(opts.bookType == \"fods\") return write_content_xml(wb, opts);\n\nvar zip = new jszip();\n\tvar f = \"\";\n\n\tvar manifest = [];\n\tvar rdf = [];\n\n\t/* 3:3.3 and 2:2.2.4 */\n\tf = \"mimetype\";\n\tzip.file(f, \"application/vnd.oasis.opendocument.spreadsheet\");\n\n\t/* Part 1 Section 2.2 Documents */\n\tf = \"content.xml\";\n\tzip.file(f, write_content_xml(wb, opts));\n\tmanifest.push([f, \"text/xml\"]);\n\trdf.push([f, \"ContentFile\"]);\n\n\t/* Part 3 Section 6 Metadata Manifest File */\n\tf = \"manifest.rdf\";\n\tzip.file(f, write_rdf(rdf, opts));\n\tmanifest.push([f, \"application/rdf+xml\"]);\n\n\t/* Part 3 Section 4 Manifest File */\n\tf = \"META-INF/manifest.xml\";\n\tzip.file(f, write_manifest(manifest, opts));\n\n\treturn zip;\n}\nODS.parse_ods = parse_ods;\nODS.write_ods = write_ods;\nODS.parse_fods = parse_fods;\n})(typeof exports !== 'undefined' ? exports : ODS);\n"],"mappings":"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"},"metadata":{},"sourceType":"script","externalDependencies":[]}