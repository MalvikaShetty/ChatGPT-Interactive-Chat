{"ast":null,"code":"/* xls.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint -W041 */\n/*jshint funcscope:true, eqnull:true */\nvar XLS = {};\n(function make_xls(XLS) {\n  XLS.version = '0.7.6';\n  var current_codepage = 1200,\n    current_cptable;\n  if (typeof module !== \"undefined\" && typeof require !== 'undefined') {\n    if (typeof cptable === 'undefined') cptable = require('./dist/cpexcel');\n    current_cptable = cptable[current_codepage];\n  }\n  function reset_cp() {\n    set_cp(1200);\n  }\n  var set_cp = function (cp) {\n    current_codepage = cp;\n  };\n  function char_codes(data) {\n    var o = [];\n    for (var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i);\n    return o;\n  }\n  var debom = function (data) {\n    var c1 = data.charCodeAt(0),\n      c2 = data.charCodeAt(1);\n    if (c1 == 0xFF && c2 == 0xFE) return data.substr(2);\n    if (c1 == 0xFE && c2 == 0xFF) return data.substr(2);\n    if (c1 == 0xFEFF) return data.substr(1);\n    return data;\n  };\n  var _getchar = function _gc1(x) {\n    return String.fromCharCode(x);\n  };\n  if (typeof cptable !== 'undefined') {\n    set_cp = function (cp) {\n      current_codepage = cp;\n      current_cptable = cptable[cp];\n    };\n    debom = function (data) {\n      if (data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) {\n        return cptable.utils.decode(1200, char_codes(data.substr(2)));\n      }\n      return data;\n    };\n    _getchar = function _gc2(x) {\n      if (current_codepage === 1200) return String.fromCharCode(x);\n      return cptable.utils.decode(current_codepage, [x & 255, x >> 8])[0];\n    };\n  }\n  var Base64 = function make_b64() {\n    var map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n    return {\n      /* (will need this for writing) encode: function(input, utf8) {\n      \tvar o = \"\";\n      \tvar c1, c2, c3, e1, e2, e3, e4;\n      \tfor(var i = 0; i < input.length; ) {\n      \t\tc1 = input.charCodeAt(i++);\n      \t\tc2 = input.charCodeAt(i++);\n      \t\tc3 = input.charCodeAt(i++);\n      \t\te1 = c1 >> 2;\n      \t\te2 = (c1 & 3) << 4 | c2 >> 4;\n      \t\te3 = (c2 & 15) << 2 | c3 >> 6;\n      \t\te4 = c3 & 63;\n      \t\tif (isNaN(c2)) { e3 = e4 = 64; }\n      \t\telse if (isNaN(c3)) { e4 = 64; }\n      \t\to += map.charAt(e1) + map.charAt(e2) + map.charAt(e3) + map.charAt(e4);\n      \t}\n      \treturn o;\n      },*/\n      decode: function b64_decode(input, utf8) {\n        var o = \"\";\n        var c1, c2, c3;\n        var e1, e2, e3, e4;\n        input = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n        for (var i = 0; i < input.length;) {\n          e1 = map.indexOf(input.charAt(i++));\n          e2 = map.indexOf(input.charAt(i++));\n          e3 = map.indexOf(input.charAt(i++));\n          e4 = map.indexOf(input.charAt(i++));\n          c1 = e1 << 2 | e2 >> 4;\n          c2 = (e2 & 15) << 4 | e3 >> 2;\n          c3 = (e3 & 3) << 6 | e4;\n          o += String.fromCharCode(c1);\n          if (e3 != 64) {\n            o += String.fromCharCode(c2);\n          }\n          if (e4 != 64) {\n            o += String.fromCharCode(c3);\n          }\n        }\n        return o;\n      }\n    };\n  }();\n  var has_buf = typeof Buffer !== 'undefined';\n  function new_raw_buf(len) {\n    /* jshint -W056 */\n    return new (has_buf ? Buffer : Array)(len);\n    /* jshint +W056 */\n  }\n\n  function s2a(s) {\n    if (has_buf) return new Buffer(s, \"binary\");\n    return s.split(\"\").map(function (x) {\n      return x.charCodeAt(0) & 0xff;\n    });\n  }\n  var bconcat = function (bufs) {\n    return [].concat.apply([], bufs);\n  };\n  var chr0 = /\\u0000/g,\n    chr1 = /[\\u0001-\\u0006]/;\n  function read_double_le(b, idx) {\n    var s = 1 - 2 * (b[idx + 7] >>> 7);\n    var e = ((b[idx + 7] & 0x7f) << 4) + (b[idx + 6] >>> 4 & 0x0f);\n    var m = b[idx + 6] & 0x0f;\n    for (var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\n    if (e == 0x7ff) return m == 0 ? s * Infinity : NaN;\n    if (e == 0) e = -1022;else {\n      e -= 1023;\n      m += Math.pow(2, 52);\n    }\n    return s * Math.pow(2, e - 52) * m;\n  }\n  var __toBuffer, ___toBuffer;\n  __toBuffer = ___toBuffer = function toBuffer_(bufs) {\n    var x = [];\n    for (var i = 0; i < bufs[0].length; ++i) {\n      x.push.apply(x, bufs[0][i]);\n    }\n    return x;\n  };\n  var __utf16le, ___utf16le;\n  __utf16le = ___utf16le = function utf16le_(b, s, e) {\n    var ss = [];\n    for (var i = s; i < e; i += 2) ss.push(String.fromCharCode(__readUInt16LE(b, i)));\n    return ss.join(\"\");\n  };\n  var __hexlify, ___hexlify;\n  __hexlify = ___hexlify = function hexlify_(b, s, l) {\n    return b.slice(s, s + l).map(function (x) {\n      return (x < 16 ? \"0\" : \"\") + x.toString(16);\n    }).join(\"\");\n  };\n  var __utf8, ___utf8;\n  __utf8 = ___utf8 = function (b, s, e) {\n    var ss = [];\n    for (var i = s; i < e; i++) ss.push(String.fromCharCode(__readUInt8(b, i)));\n    return ss.join(\"\");\n  };\n  var __lpstr, ___lpstr;\n  __lpstr = ___lpstr = function lpstr_(b, i) {\n    var len = __readUInt32LE(b, i);\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n  var __lpwstr, ___lpwstr;\n  __lpwstr = ___lpwstr = function lpwstr_(b, i) {\n    var len = 2 * __readUInt32LE(b, i);\n    return len > 0 ? __utf8(b, i + 4, i + 4 + len - 1) : \"\";\n  };\n  var __double, ___double;\n  __double = ___double = function (b, idx) {\n    return read_double_le(b, idx);\n  };\n  if (typeof Buffer !== \"undefined\") {\n    __utf16le = function utf16le_b(b, s, e) {\n      if (!Buffer.isBuffer(b)) return ___utf16le(b, s, e);\n      return b.toString('utf16le', s, e);\n    };\n    __hexlify = function (b, s, l) {\n      return Buffer.isBuffer(b) ? b.toString('hex', s, s + l) : ___hexlify(b, s, l);\n    };\n    __lpstr = function lpstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpstr(b, i);\n      var len = b.readUInt32LE(i);\n      return len > 0 ? b.toString('utf8', i + 4, i + 4 + len - 1) : \"\";\n    };\n    __lpwstr = function lpwstr_b(b, i) {\n      if (!Buffer.isBuffer(b)) return ___lpwstr(b, i);\n      var len = 2 * b.readUInt32LE(i);\n      return b.toString('utf16le', i + 4, i + 4 + len - 1);\n    };\n    __utf8 = function utf8_b(b, s, e) {\n      return b.toString('utf8', s, e);\n    };\n    __toBuffer = function (bufs) {\n      return bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0]) ? Buffer.concat(bufs[0]) : ___toBuffer(bufs);\n    };\n    bconcat = function (bufs) {\n      return Buffer.isBuffer(bufs[0]) ? Buffer.concat(bufs) : [].concat.apply([], bufs);\n    };\n    __double = function double_(b, i) {\n      if (Buffer.isBuffer(b)) return b.readDoubleLE(i);\n      return ___double(b, i);\n    };\n  }\n  if (typeof cptable !== 'undefined') {\n    __utf16le = function (b, s, e) {\n      return cptable.utils.decode(1200, b.slice(s, e));\n    };\n    __utf8 = function (b, s, e) {\n      return cptable.utils.decode(65001, b.slice(s, e));\n    };\n    __lpstr = function (b, i) {\n      var len = __readUInt32LE(b, i);\n      return len > 0 ? cptable.utils.decode(current_codepage, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n    __lpwstr = function (b, i) {\n      var len = 2 * __readUInt32LE(b, i);\n      return len > 0 ? cptable.utils.decode(1200, b.slice(i + 4, i + 4 + len - 1)) : \"\";\n    };\n  }\n  var __readUInt8 = function (b, idx) {\n    return b[idx];\n  };\n  var __readUInt16LE = function (b, idx) {\n    return b[idx + 1] * (1 << 8) + b[idx];\n  };\n  var __readInt16LE = function (b, idx) {\n    var u = b[idx + 1] * (1 << 8) + b[idx];\n    return u < 0x8000 ? u : (0xffff - u + 1) * -1;\n  };\n  var __readUInt32LE = function (b, idx) {\n    return b[idx + 3] * (1 << 24) + (b[idx + 2] << 16) + (b[idx + 1] << 8) + b[idx];\n  };\n  var __readInt32LE = function (b, idx) {\n    return b[idx + 3] << 24 | b[idx + 2] << 16 | b[idx + 1] << 8 | b[idx];\n  };\n  var ___unhexlify = function (s) {\n    return s.match(/../g).map(function (x) {\n      return parseInt(x, 16);\n    });\n  };\n  var __unhexlify = typeof Buffer !== \"undefined\" ? function (s) {\n    return Buffer.isBuffer(s) ? new Buffer(s, 'hex') : ___unhexlify(s);\n  } : ___unhexlify;\n  function ReadShift(size, t) {\n    var o = \"\",\n      oI,\n      oR,\n      oo = [],\n      w,\n      vv,\n      i,\n      loc;\n    switch (t) {\n      case 'utf8':\n        o = __utf8(this, this.l, this.l + size);\n        break;\n      case 'utf16le':\n        size *= 2;\n        o = __utf16le(this, this.l, this.l + size);\n        break;\n\n      /* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n      case 'lpstr':\n        o = __lpstr(this, this.l);\n        size = 5 + o.length;\n        break;\n      /* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n      case 'lpwstr':\n        o = __lpwstr(this, this.l);\n        size = 5 + o.length;\n        if (o[o.length - 1] == '\\u0000') size += 2;\n        break;\n      case 'cstr':\n        size = 0;\n        o = \"\";\n        while ((w = __readUInt8(this, this.l + size++)) !== 0) oo.push(_getchar(w));\n        o = oo.join(\"\");\n        break;\n      case 'wstr':\n        size = 0;\n        o = \"\";\n        while ((w = __readUInt16LE(this, this.l + size)) !== 0) {\n          oo.push(_getchar(w));\n          size += 2;\n        }\n        size += 2;\n        o = oo.join(\"\");\n        break;\n\n      /* sbcs and dbcs support continue records in the SST way TODO codepages */\n      case 'dbcs-cont':\n        o = \"\";\n        loc = this.l;\n        for (i = 0; i != size; ++i) {\n          if (this.lens && this.lens.indexOf(loc) !== -1) {\n            w = __readUInt8(this, loc);\n            this.l = loc + 1;\n            vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n            return oo.join(\"\") + vv;\n          }\n          oo.push(_getchar(__readUInt16LE(this, loc)));\n          loc += 2;\n        }\n        o = oo.join(\"\");\n        size *= 2;\n        break;\n      case 'sbcs-cont':\n        o = \"\";\n        loc = this.l;\n        for (i = 0; i != size; ++i) {\n          if (this.lens && this.lens.indexOf(loc) !== -1) {\n            w = __readUInt8(this, loc);\n            this.l = loc + 1;\n            vv = ReadShift.call(this, size - i, w ? 'dbcs-cont' : 'sbcs-cont');\n            return oo.join(\"\") + vv;\n          }\n          oo.push(_getchar(__readUInt8(this, loc)));\n          loc += 1;\n        }\n        o = oo.join(\"\");\n        break;\n      default:\n        switch (size) {\n          case 1:\n            oI = __readUInt8(this, this.l);\n            this.l++;\n            return oI;\n          case 2:\n            oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l);\n            this.l += 2;\n            return oI;\n          case 4:\n            if (t === 'i' || (this[this.l + 3] & 0x80) === 0) {\n              oI = __readInt32LE(this, this.l);\n              this.l += 4;\n              return oI;\n            } else {\n              oR = __readUInt32LE(this, this.l);\n              this.l += 4;\n              return oR;\n            }\n            break;\n          case 8:\n            if (t === 'f') {\n              oR = __double(this, this.l);\n              this.l += 8;\n              return oR;\n            }\n          /* falls through */\n          case 16:\n            o = __hexlify(this, this.l, size);\n            break;\n        }\n    }\n    this.l += size;\n    return o;\n  }\n  function CheckField(hexstr, fld) {\n    var m = __hexlify(this, this.l, hexstr.length >> 1);\n    if (m !== hexstr) throw fld + 'Expected ' + hexstr + ' saw ' + m;\n    this.l += hexstr.length >> 1;\n  }\n  function prep_blob(blob, pos) {\n    blob.l = pos;\n    blob.read_shift = ReadShift;\n    blob.chk = CheckField;\n  }\n\n  /* ssf.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\n  var SSF = {};\n  var make_ssf = function make_ssf(SSF) {\n    SSF.version = '0.8.1';\n    function _strrev(x) {\n      var o = \"\",\n        i = x.length - 1;\n      while (i >= 0) o += x.charAt(i--);\n      return o;\n    }\n    function fill(c, l) {\n      var o = \"\";\n      while (o.length < l) o += c;\n      return o;\n    }\n    function pad0(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n    function pad_(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill(' ', d - t.length) + t;\n    }\n    function rpad_(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : t + fill(' ', d - t.length);\n    }\n    function pad0r1(v, d) {\n      var t = \"\" + Math.round(v);\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n    function pad0r2(v, d) {\n      var t = \"\" + v;\n      return t.length >= d ? t : fill('0', d - t.length) + t;\n    }\n    var p2_32 = Math.pow(2, 32);\n    function pad0r(v, d) {\n      if (v > p2_32 || v < -p2_32) return pad0r1(v, d);\n      var i = Math.round(v);\n      return pad0r2(i, d);\n    }\n    function isgeneral(s, i) {\n      return s.length >= 7 + i && (s.charCodeAt(i) | 32) === 103 && (s.charCodeAt(i + 1) | 32) === 101 && (s.charCodeAt(i + 2) | 32) === 110 && (s.charCodeAt(i + 3) | 32) === 101 && (s.charCodeAt(i + 4) | 32) === 114 && (s.charCodeAt(i + 5) | 32) === 97 && (s.charCodeAt(i + 6) | 32) === 108;\n    }\n    /* Options */\n    var opts_fmt = [[\"date1904\", 0], [\"output\", \"\"], [\"WTF\", false]];\n    function fixopts(o) {\n      for (var y = 0; y != opts_fmt.length; ++y) if (o[opts_fmt[y][0]] === undefined) o[opts_fmt[y][0]] = opts_fmt[y][1];\n    }\n    SSF.opts = opts_fmt;\n    var table_fmt = {\n      0: 'General',\n      1: '0',\n      2: '0.00',\n      3: '#,##0',\n      4: '#,##0.00',\n      9: '0%',\n      10: '0.00%',\n      11: '0.00E+00',\n      12: '# ?/?',\n      13: '# ??/??',\n      14: 'm/d/yy',\n      15: 'd-mmm-yy',\n      16: 'd-mmm',\n      17: 'mmm-yy',\n      18: 'h:mm AM/PM',\n      19: 'h:mm:ss AM/PM',\n      20: 'h:mm',\n      21: 'h:mm:ss',\n      22: 'm/d/yy h:mm',\n      37: '#,##0 ;(#,##0)',\n      38: '#,##0 ;[Red](#,##0)',\n      39: '#,##0.00;(#,##0.00)',\n      40: '#,##0.00;[Red](#,##0.00)',\n      45: 'mm:ss',\n      46: '[h]:mm:ss',\n      47: 'mmss.0',\n      48: '##0.0E+0',\n      49: '@',\n      56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"',\n      65535: 'General'\n    };\n    var days = [['Sun', 'Sunday'], ['Mon', 'Monday'], ['Tue', 'Tuesday'], ['Wed', 'Wednesday'], ['Thu', 'Thursday'], ['Fri', 'Friday'], ['Sat', 'Saturday']];\n    var months = [['J', 'Jan', 'January'], ['F', 'Feb', 'February'], ['M', 'Mar', 'March'], ['A', 'Apr', 'April'], ['M', 'May', 'May'], ['J', 'Jun', 'June'], ['J', 'Jul', 'July'], ['A', 'Aug', 'August'], ['S', 'Sep', 'September'], ['O', 'Oct', 'October'], ['N', 'Nov', 'November'], ['D', 'Dec', 'December']];\n    function frac(x, D, mixed) {\n      var sgn = x < 0 ? -1 : 1;\n      var B = x * sgn;\n      var P_2 = 0,\n        P_1 = 1,\n        P = 0;\n      var Q_2 = 1,\n        Q_1 = 0,\n        Q = 0;\n      var A = Math.floor(B);\n      while (Q_1 < D) {\n        A = Math.floor(B);\n        P = A * P_1 + P_2;\n        Q = A * Q_1 + Q_2;\n        if (B - A < 0.0000000005) break;\n        B = 1 / (B - A);\n        P_2 = P_1;\n        P_1 = P;\n        Q_2 = Q_1;\n        Q_1 = Q;\n      }\n      if (Q > D) {\n        Q = Q_1;\n        P = P_1;\n      }\n      if (Q > D) {\n        Q = Q_2;\n        P = P_2;\n      }\n      if (!mixed) return [0, sgn * P, Q];\n      if (Q === 0) throw \"Unexpected state: \" + P + \" \" + P_1 + \" \" + P_2 + \" \" + Q + \" \" + Q_1 + \" \" + Q_2;\n      var q = Math.floor(sgn * P / Q);\n      return [q, sgn * P - q * Q, Q];\n    }\n    function general_fmt_int(v, opts) {\n      return \"\" + v;\n    }\n    SSF._general_int = general_fmt_int;\n    var general_fmt_num = function make_general_fmt_num() {\n      var gnr1 = /\\.(\\d*[1-9])0+$/,\n        gnr2 = /\\.0*$/,\n        gnr4 = /\\.(\\d*[1-9])0+/,\n        gnr5 = /\\.0*[Ee]/,\n        gnr6 = /(E[+-])(\\d)$/;\n      function gfn2(v) {\n        var w = v < 0 ? 12 : 11;\n        var o = gfn5(v.toFixed(12));\n        if (o.length <= w) return o;\n        o = v.toPrecision(10);\n        if (o.length <= w) return o;\n        return v.toExponential(5);\n      }\n      function gfn3(v) {\n        var o = v.toFixed(11).replace(gnr1, \".$1\");\n        if (o.length > (v < 0 ? 12 : 11)) o = v.toPrecision(6);\n        return o;\n      }\n      function gfn4(o) {\n        for (var i = 0; i != o.length; ++i) if ((o.charCodeAt(i) | 0x20) === 101) return o.replace(gnr4, \".$1\").replace(gnr5, \"E\").replace(\"e\", \"E\").replace(gnr6, \"$10$2\");\n        return o;\n      }\n      function gfn5(o) {\n        //for(var i = 0; i != o.length; ++i) if(o.charCodeAt(i) === 46) return o.replace(gnr2,\"\").replace(gnr1,\".$1\");\n        //return o;\n        return o.indexOf(\".\") > -1 ? o.replace(gnr2, \"\").replace(gnr1, \".$1\") : o;\n      }\n      return function general_fmt_num(v, opts) {\n        var V = Math.floor(Math.log(Math.abs(v)) * Math.LOG10E),\n          o;\n        if (V >= -4 && V <= -1) o = v.toPrecision(10 + V);else if (Math.abs(V) <= 9) o = gfn2(v);else if (V === 10) o = v.toFixed(10).substr(0, 12);else o = gfn3(v);\n        return gfn5(gfn4(o));\n      };\n    }();\n    SSF._general_num = general_fmt_num;\n    function general_fmt(v, opts) {\n      switch (typeof v) {\n        case 'string':\n          return v;\n        case 'boolean':\n          return v ? \"TRUE\" : \"FALSE\";\n        case 'number':\n          return (v | 0) === v ? general_fmt_int(v, opts) : general_fmt_num(v, opts);\n      }\n      throw new Error(\"unsupported value in General format: \" + v);\n    }\n    SSF._general = general_fmt;\n    function fix_hijri(date, o) {\n      return 0;\n    }\n    function parse_date_code(v, opts, b2) {\n      if (v > 2958465 || v < 0) return null;\n      var date = v | 0,\n        time = Math.floor(86400 * (v - date)),\n        dow = 0;\n      var dout = [];\n      var out = {\n        D: date,\n        T: time,\n        u: 86400 * (v - date) - time,\n        y: 0,\n        m: 0,\n        d: 0,\n        H: 0,\n        M: 0,\n        S: 0,\n        q: 0\n      };\n      if (Math.abs(out.u) < 1e-6) out.u = 0;\n      fixopts(opts != null ? opts : opts = []);\n      if (opts.date1904) date += 1462;\n      if (out.u > 0.999) {\n        out.u = 0;\n        if (++time == 86400) {\n          time = 0;\n          ++date;\n        }\n      }\n      if (date === 60) {\n        dout = b2 ? [1317, 10, 29] : [1900, 2, 29];\n        dow = 3;\n      } else if (date === 0) {\n        dout = b2 ? [1317, 8, 29] : [1900, 1, 0];\n        dow = 6;\n      } else {\n        if (date > 60) --date;\n        /* 1 = Jan 1 1900 */\n        var d = new Date(1900, 0, 1);\n        d.setDate(d.getDate() + date - 1);\n        dout = [d.getFullYear(), d.getMonth() + 1, d.getDate()];\n        dow = d.getDay();\n        if (date < 60) dow = (dow + 6) % 7;\n        if (b2) dow = fix_hijri(d, dout);\n      }\n      out.y = dout[0];\n      out.m = dout[1];\n      out.d = dout[2];\n      out.S = time % 60;\n      time = Math.floor(time / 60);\n      out.M = time % 60;\n      time = Math.floor(time / 60);\n      out.H = time;\n      out.q = dow;\n      return out;\n    }\n    SSF.parse_date_code = parse_date_code;\n    /*jshint -W086 */\n    function write_date(type, fmt, val, ss0) {\n      var o = \"\",\n        ss = 0,\n        tt = 0,\n        y = val.y,\n        out,\n        outl = 0;\n      switch (type) {\n        case 98:\n          /* 'b' buddhist year */\n          y = val.y + 543;\n        /* falls through */\n        case 121:\n          /* 'y' year */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = y % 100;\n              outl = 2;\n              break;\n            default:\n              out = y % 10000;\n              outl = 4;\n              break;\n          }\n          break;\n        case 109:\n          /* 'm' month */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.m;\n              outl = fmt.length;\n              break;\n            case 3:\n              return months[val.m - 1][1];\n            case 5:\n              return months[val.m - 1][0];\n            default:\n              return months[val.m - 1][2];\n          }\n          break;\n        case 100:\n          /* 'd' day */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.d;\n              outl = fmt.length;\n              break;\n            case 3:\n              return days[val.q][0];\n            default:\n              return days[val.q][1];\n          }\n          break;\n        case 104:\n          /* 'h' 12-hour */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = 1 + (val.H + 11) % 12;\n              outl = fmt.length;\n              break;\n            default:\n              throw 'bad hour format: ' + fmt;\n          }\n          break;\n        case 72:\n          /* 'H' 24-hour */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.H;\n              outl = fmt.length;\n              break;\n            default:\n              throw 'bad hour format: ' + fmt;\n          }\n          break;\n        case 77:\n          /* 'M' minutes */\n          switch (fmt.length) {\n            case 1:\n            case 2:\n              out = val.M;\n              outl = fmt.length;\n              break;\n            default:\n              throw 'bad minute format: ' + fmt;\n          }\n          break;\n        case 115:\n          /* 's' seconds */\n          if (val.u === 0) switch (fmt) {\n            case 's':\n            case 'ss':\n              return pad0(val.S, fmt.length);\n            case '.0':\n            case '.00':\n            case '.000':\n          }\n          switch (fmt) {\n            case 's':\n            case 'ss':\n            case '.0':\n            case '.00':\n            case '.000':\n              if (ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;else tt = ss0 === 1 ? 10 : 1;\n              ss = Math.round(tt * (val.S + val.u));\n              if (ss >= 60 * tt) ss = 0;\n              if (fmt === 's') return ss === 0 ? \"0\" : \"\" + ss / tt;\n              o = pad0(ss, 2 + ss0);\n              if (fmt === 'ss') return o.substr(0, 2);\n              return \".\" + o.substr(2, fmt.length - 1);\n            default:\n              throw 'bad second format: ' + fmt;\n          }\n        case 90:\n          /* 'Z' absolute time */\n          switch (fmt) {\n            case '[h]':\n            case '[hh]':\n              out = val.D * 24 + val.H;\n              break;\n            case '[m]':\n            case '[mm]':\n              out = (val.D * 24 + val.H) * 60 + val.M;\n              break;\n            case '[s]':\n            case '[ss]':\n              out = ((val.D * 24 + val.H) * 60 + val.M) * 60 + Math.round(val.S + val.u);\n              break;\n            default:\n              throw 'bad abstime format: ' + fmt;\n          }\n          outl = fmt.length === 3 ? 1 : 2;\n          break;\n        case 101:\n          /* 'e' era */\n          out = y;\n          outl = 1;\n      }\n      if (outl > 0) return pad0(out, outl);else return \"\";\n    }\n    /*jshint +W086 */\n    function commaify(s) {\n      if (s.length <= 3) return s;\n      var j = s.length % 3,\n        o = s.substr(0, j);\n      for (; j != s.length; j += 3) o += (o.length > 0 ? \",\" : \"\") + s.substr(j, 3);\n      return o;\n    }\n    var write_num = function make_write_num() {\n      var pct1 = /%/g;\n      function write_num_pct(type, fmt, val) {\n        var sfmt = fmt.replace(pct1, \"\"),\n          mul = fmt.length - sfmt.length;\n        return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n      }\n      function write_num_cm(type, fmt, val) {\n        var idx = fmt.length - 1;\n        while (fmt.charCodeAt(idx - 1) === 44) --idx;\n        return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n      }\n      function write_num_exp(fmt, val) {\n        var o;\n        var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n        if (fmt.match(/^#+0.0E\\+0$/)) {\n          var period = fmt.indexOf(\".\");\n          if (period === -1) period = fmt.indexOf('E');\n          var ee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E) % period;\n          if (ee < 0) ee += period;\n          o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n          if (o.indexOf(\"e\") === -1) {\n            var fakee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E);\n            if (o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n            while (o.substr(0, 2) === \"0.\") {\n              o = o[0] + o.substr(2, period) + \".\" + o.substr(2 + period);\n              o = o.replace(/^0+([1-9])/, \"$1\").replace(/^0+\\./, \"0.\");\n            }\n            o = o.replace(/\\+-/, \"-\");\n          }\n          o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n            return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n          });\n        } else o = val.toExponential(idx);\n        if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o[o.length - 1];\n        if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n        return o.replace(\"e\", \"E\");\n      }\n      var frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\n      function write_num_f1(r, aval, sign) {\n        var den = parseInt(r[4]),\n          rr = Math.round(aval * den),\n          base = Math.floor(rr / den);\n        var myn = rr - base * den,\n          myd = den;\n        return sign + (base === 0 ? \"\" : \"\" + base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn, r[1].length) + r[2] + \"/\" + r[3] + pad0(myd, r[4].length));\n      }\n      function write_num_f2(r, aval, sign) {\n        return sign + (aval === 0 ? \"\" : \"\" + aval) + fill(\" \", r[1].length + 2 + r[4].length);\n      }\n      var dec1 = /^#*0*\\.(0+)/;\n      var closeparen = /\\).*[0#]/;\n      var phone = /\\(###\\) ###\\\\?-####/;\n      function hashq(str) {\n        var o = \"\",\n          cc;\n        for (var i = 0; i != str.length; ++i) switch (cc = str.charCodeAt(i)) {\n          case 35:\n            break;\n          case 63:\n            o += \" \";\n            break;\n          case 48:\n            o += \"0\";\n            break;\n          default:\n            o += String.fromCharCode(cc);\n        }\n        return o;\n      }\n      function rnd(val, d) {\n        var dd = Math.pow(10, d);\n        return \"\" + Math.round(val * dd) / dd;\n      }\n      function dec(val, d) {\n        return Math.round((val - Math.floor(val)) * Math.pow(10, d));\n      }\n      function flr(val) {\n        if (val < 2147483647 && val > -2147483648) return \"\" + (val >= 0 ? val | 0 : val - 1 | 0);\n        return \"\" + Math.floor(val);\n      }\n      function write_num_flt(type, fmt, val) {\n        if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n          var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n          if (val >= 0) return write_num_flt('n', ffmt, val);\n          return '(' + write_num_flt('n', ffmt, -val) + ')';\n        }\n        if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n        if (fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n        if (fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n        if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_flt(type, fmt.substr(fmt[1] == ' ' ? 2 : 1), val);\n        var o, oo;\n        var r,\n          ri,\n          ff,\n          aval = Math.abs(val),\n          sign = val < 0 ? \"-\" : \"\";\n        if (fmt.match(/^00+$/)) return sign + pad0r(aval, fmt.length);\n        if (fmt.match(/^[#?]+$/)) {\n          o = pad0r(val, 0);\n          if (o === \"0\") o = \"\";\n          return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n        if ((r = fmt.match(frac1)) !== null) return write_num_f1(r, aval, sign);\n        if (fmt.match(/^#+0+$/) !== null) return sign + pad0r(aval, fmt.length - fmt.indexOf(\"0\"));\n        if ((r = fmt.match(dec1)) !== null) {\n          o = rnd(val, r[1].length).replace(/^([^\\.]+)$/, \"$1.\" + r[1]).replace(/\\.$/, \".\" + r[1]).replace(/\\.(\\d*)$/, function ($$, $1) {\n            return \".\" + $1 + fill(\"0\", r[1].length - $1.length);\n          });\n          return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n        }\n        fmt = fmt.replace(/^#+([0.])/, \"$1\");\n        if ((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n          return sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n        }\n        if ((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(pad0r(aval, 0));\n        if ((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\" + Math.floor(val)) + \".\" + pad0(dec(val, r[1].length), r[1].length);\n        }\n        if ((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_flt(type, fmt.replace(/^#,#*,/, \"\"), val);\n        if ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n          o = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n          ri = 0;\n          return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n            return ri < o.length ? o[ri++] : x === '0' ? '0' : \"\";\n          }));\n        }\n        if (fmt.match(phone) !== null) {\n          o = write_num_flt(type, \"##########\", val);\n          return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n        }\n        var oa = \"\";\n        if ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(r[4].length, 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, false);\n          o = \"\" + sign;\n          oa = write_num(\"n\", r[1], ff[1]);\n          if (oa[oa.length - 1] == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n          o += oa + r[2] + \"/\" + r[3];\n          oa = rpad_(ff[2], ri);\n          if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n          o += oa;\n          return o;\n        }\n        if ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, true);\n          return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n        }\n        if ((r = fmt.match(/^[#0?]+$/)) !== null) {\n          o = pad0r(val, 0);\n          if (fmt.length <= o.length) return o;\n          return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n        if ((r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) !== null) {\n          o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n          ri = o.indexOf(\".\");\n          var lres = fmt.indexOf(\".\") - ri,\n            rres = fmt.length - o.length - lres;\n          return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n        }\n        if ((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n          ri = dec(val, r[1].length);\n          return val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n            return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n          }) + \".\" + pad0(ri, r[1].length);\n        }\n        switch (fmt) {\n          case \"#,###\":\n            var x = commaify(pad0r(aval, 0));\n            return x !== \"0\" ? sign + x : \"\";\n          default:\n        }\n        throw new Error(\"unsupported format |\" + fmt + \"|\");\n      }\n      function write_num_cm2(type, fmt, val) {\n        var idx = fmt.length - 1;\n        while (fmt.charCodeAt(idx - 1) === 44) --idx;\n        return write_num(type, fmt.substr(0, idx), val / Math.pow(10, 3 * (fmt.length - idx)));\n      }\n      function write_num_pct2(type, fmt, val) {\n        var sfmt = fmt.replace(pct1, \"\"),\n          mul = fmt.length - sfmt.length;\n        return write_num(type, sfmt, val * Math.pow(10, 2 * mul)) + fill(\"%\", mul);\n      }\n      function write_num_exp2(fmt, val) {\n        var o;\n        var idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n        if (fmt.match(/^#+0.0E\\+0$/)) {\n          var period = fmt.indexOf(\".\");\n          if (period === -1) period = fmt.indexOf('E');\n          var ee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E) % period;\n          if (ee < 0) ee += period;\n          o = (val / Math.pow(10, ee)).toPrecision(idx + 1 + (period + ee) % period);\n          if (!o.match(/[Ee]/)) {\n            var fakee = Math.floor(Math.log(Math.abs(val)) * Math.LOG10E);\n            if (o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length + ee);else o += \"E+\" + (fakee - ee);\n            o = o.replace(/\\+-/, \"-\");\n          }\n          o = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/, function ($$, $1, $2, $3) {\n            return $1 + $2 + $3.substr(0, (period + ee) % period) + \".\" + $3.substr(ee) + \"E\";\n          });\n        } else o = val.toExponential(idx);\n        if (fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0, o.length - 1) + \"0\" + o[o.length - 1];\n        if (fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/, \"e\");\n        return o.replace(\"e\", \"E\");\n      }\n      function write_num_int(type, fmt, val) {\n        if (type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n          var ffmt = fmt.replace(/\\( */, \"\").replace(/ \\)/, \"\").replace(/\\)/, \"\");\n          if (val >= 0) return write_num_int('n', ffmt, val);\n          return '(' + write_num_int('n', ffmt, -val) + ')';\n        }\n        if (fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n        if (fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n        if (fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n        if (fmt.charCodeAt(0) === 36) return \"$\" + write_num_int(type, fmt.substr(fmt[1] == ' ' ? 2 : 1), val);\n        var o;\n        var r,\n          ri,\n          ff,\n          aval = Math.abs(val),\n          sign = val < 0 ? \"-\" : \"\";\n        if (fmt.match(/^00+$/)) return sign + pad0(aval, fmt.length);\n        if (fmt.match(/^[#?]+$/)) {\n          o = \"\" + val;\n          if (val === 0) o = \"\";\n          return o.length > fmt.length ? o : hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n        if ((r = fmt.match(frac1)) !== null) return write_num_f2(r, aval, sign);\n        if (fmt.match(/^#+0+$/) !== null) return sign + pad0(aval, fmt.length - fmt.indexOf(\"0\"));\n        if ((r = fmt.match(dec1)) !== null) {\n          o = (\"\" + val).replace(/^([^\\.]+)$/, \"$1.\" + r[1]).replace(/\\.$/, \".\" + r[1]).replace(/\\.(\\d*)$/, function ($$, $1) {\n            return \".\" + $1 + fill(\"0\", r[1].length - $1.length);\n          });\n          return fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./, \".\");\n        }\n        fmt = fmt.replace(/^#+([0.])/, \"$1\");\n        if ((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n          return sign + (\"\" + aval).replace(/\\.(\\d*[1-9])0*$/, \".$1\").replace(/^(-?\\d*)$/, \"$1.\").replace(/^0\\./, r[1].length ? \"0.\" : \".\");\n        }\n        if ((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(\"\" + aval);\n        if ((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val) + \".\" + fill('0', r[1].length);\n        }\n        if ((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_int(type, fmt.replace(/^#,#*,/, \"\"), val);\n        if ((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n          o = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g, \"\"), val));\n          ri = 0;\n          return _strrev(_strrev(fmt.replace(/\\\\/g, \"\")).replace(/[0#]/g, function (x) {\n            return ri < o.length ? o[ri++] : x === '0' ? '0' : \"\";\n          }));\n        }\n        if (fmt.match(phone) !== null) {\n          o = write_num_int(type, \"##########\", val);\n          return \"(\" + o.substr(0, 3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n        }\n        var oa = \"\";\n        if ((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(r[4].length, 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, false);\n          o = \"\" + sign;\n          oa = write_num(\"n\", r[1], ff[1]);\n          if (oa[oa.length - 1] == \" \") oa = oa.substr(0, oa.length - 1) + \"0\";\n          o += oa + r[2] + \"/\" + r[3];\n          oa = rpad_(ff[2], ri);\n          if (oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length - oa.length)) + oa;\n          o += oa;\n          return o;\n        }\n        if ((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n          ri = Math.min(Math.max(r[1].length, r[4].length), 7);\n          ff = frac(aval, Math.pow(10, ri) - 1, true);\n          return sign + (ff[0] || (ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1], ri) + r[2] + \"/\" + r[3] + rpad_(ff[2], ri) : fill(\" \", 2 * ri + 1 + r[2].length + r[3].length));\n        }\n        if ((r = fmt.match(/^[#0?]+$/)) !== null) {\n          o = \"\" + val;\n          if (fmt.length <= o.length) return o;\n          return hashq(fmt.substr(0, fmt.length - o.length)) + o;\n        }\n        if ((r = fmt.match(/^([#0]+)\\.([#0]+)$/)) !== null) {\n          o = \"\" + val.toFixed(Math.min(r[2].length, 10)).replace(/([^0])0+$/, \"$1\");\n          ri = o.indexOf(\".\");\n          var lres = fmt.indexOf(\".\") - ri,\n            rres = fmt.length - o.length - lres;\n          return hashq(fmt.substr(0, lres) + o + fmt.substr(fmt.length - rres));\n        }\n        if ((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n          return val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\" + val).replace(/^\\d,\\d{3}$/, \"0$&\").replace(/^\\d*$/, function ($$) {\n            return \"00,\" + ($$.length < 3 ? pad0(0, 3 - $$.length) : \"\") + $$;\n          }) + \".\" + pad0(0, r[1].length);\n        }\n        switch (fmt) {\n          case \"#,###\":\n            var x = commaify(\"\" + aval);\n            return x !== \"0\" ? sign + x : \"\";\n          default:\n        }\n        throw new Error(\"unsupported format |\" + fmt + \"|\");\n      }\n      return function write_num(type, fmt, val) {\n        return (val | 0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n      };\n    }();\n    function split_fmt(fmt) {\n      var out = [];\n      var in_str = false,\n        cc;\n      for (var i = 0, j = 0; i < fmt.length; ++i) switch (cc = fmt.charCodeAt(i)) {\n        case 34:\n          /* '\"' */\n          in_str = !in_str;\n          break;\n        case 95:\n        case 42:\n        case 92:\n          /* '_' '*' '\\\\' */\n          ++i;\n          break;\n        case 59:\n          /* ';' */\n          out[out.length] = fmt.substr(j, i - j);\n          j = i + 1;\n      }\n      out[out.length] = fmt.substr(j);\n      if (in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n      return out;\n    }\n    SSF._split = split_fmt;\n    var abstime = /\\[[HhMmSs]*\\]/;\n    function eval_fmt(fmt, v, opts, flen) {\n      var out = [],\n        o = \"\",\n        i = 0,\n        c = \"\",\n        lst = 't',\n        q,\n        dt,\n        j,\n        cc;\n      var hr = 'H';\n      /* Tokenize */\n      while (i < fmt.length) {\n        switch (c = fmt[i]) {\n          case 'G':\n            /* General */\n            if (!isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n            out[out.length] = {\n              t: 'G',\n              v: 'General'\n            };\n            i += 7;\n            break;\n          case '\"':\n            /* Literal text */\n            for (o = \"\"; (cc = fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n            out[out.length] = {\n              t: 't',\n              v: o\n            };\n            ++i;\n            break;\n          case '\\\\':\n            var w = fmt[++i],\n              t = w === \"(\" || w === \")\" ? w : 't';\n            out[out.length] = {\n              t: t,\n              v: w\n            };\n            ++i;\n            break;\n          case '_':\n            out[out.length] = {\n              t: 't',\n              v: \" \"\n            };\n            i += 2;\n            break;\n          case '@':\n            /* Text Placeholder */\n            out[out.length] = {\n              t: 'T',\n              v: v\n            };\n            ++i;\n            break;\n          case 'B':\n          case 'b':\n            if (fmt[i + 1] === \"1\" || fmt[i + 1] === \"2\") {\n              if (dt == null) {\n                dt = parse_date_code(v, opts, fmt[i + 1] === \"2\");\n                if (dt == null) return \"\";\n              }\n              out[out.length] = {\n                t: 'X',\n                v: fmt.substr(i, 2)\n              };\n              lst = c;\n              i += 2;\n              break;\n            }\n          /* falls through */\n          case 'M':\n          case 'D':\n          case 'Y':\n          case 'H':\n          case 'S':\n          case 'E':\n            c = c.toLowerCase();\n          /* falls through */\n          case 'm':\n          case 'd':\n          case 'y':\n          case 'h':\n          case 's':\n          case 'e':\n          case 'g':\n            if (v < 0) return \"\";\n            if (dt == null) {\n              dt = parse_date_code(v, opts);\n              if (dt == null) return \"\";\n            }\n            o = c;\n            while (++i < fmt.length && fmt[i].toLowerCase() === c) o += c;\n            if (c === 'm' && lst.toLowerCase() === 'h') c = 'M'; /* m = minute */\n            if (c === 'h') c = hr;\n            out[out.length] = {\n              t: c,\n              v: o\n            };\n            lst = c;\n            break;\n          case 'A':\n            q = {\n              t: c,\n              v: \"A\"\n            };\n            if (dt == null) dt = parse_date_code(v, opts);\n            if (fmt.substr(i, 3) === \"A/P\") {\n              if (dt != null) q.v = dt.H >= 12 ? \"P\" : \"A\";\n              q.t = 'T';\n              hr = 'h';\n              i += 3;\n            } else if (fmt.substr(i, 5) === \"AM/PM\") {\n              if (dt != null) q.v = dt.H >= 12 ? \"PM\" : \"AM\";\n              q.t = 'T';\n              i += 5;\n              hr = 'h';\n            } else {\n              q.t = \"t\";\n              ++i;\n            }\n            if (dt == null && q.t === 'T') return \"\";\n            out[out.length] = q;\n            lst = c;\n            break;\n          case '[':\n            o = c;\n            while (fmt[i++] !== ']' && i < fmt.length) o += fmt[i];\n            if (o.substr(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n            if (o.match(abstime)) {\n              if (dt == null) {\n                dt = parse_date_code(v, opts);\n                if (dt == null) return \"\";\n              }\n              out[out.length] = {\n                t: 'Z',\n                v: o.toLowerCase()\n              };\n            } else {\n              o = \"\";\n            }\n            break;\n          /* Numbers */\n          case '.':\n            if (dt != null) {\n              o = c;\n              while ((c = fmt[++i]) === \"0\") o += c;\n              out[out.length] = {\n                t: 's',\n                v: o\n              };\n              break;\n            }\n          /* falls through */\n          case '0':\n          case '#':\n            o = c;\n            while (\"0#?.,E+-%\".indexOf(c = fmt[++i]) > -1 || c == '\\\\' && fmt[i + 1] == \"-\" && \"0#\".indexOf(fmt[i + 2]) > -1) o += c;\n            out[out.length] = {\n              t: 'n',\n              v: o\n            };\n            break;\n          case '?':\n            o = c;\n            while (fmt[++i] === c) o += c;\n            q = {\n              t: c,\n              v: o\n            };\n            out[out.length] = q;\n            lst = c;\n            break;\n          case '*':\n            ++i;\n            if (fmt[i] == ' ' || fmt[i] == '*') ++i;\n            break;\n          // **\n          case '(':\n          case ')':\n            out[out.length] = {\n              t: flen === 1 ? 't' : c,\n              v: c\n            };\n            ++i;\n            break;\n          case '1':\n          case '2':\n          case '3':\n          case '4':\n          case '5':\n          case '6':\n          case '7':\n          case '8':\n          case '9':\n            o = c;\n            while (\"0123456789\".indexOf(fmt[++i]) > -1) o += fmt[i];\n            out[out.length] = {\n              t: 'D',\n              v: o\n            };\n            break;\n          case ' ':\n            out[out.length] = {\n              t: c,\n              v: c\n            };\n            ++i;\n            break;\n          default:\n            if (\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxz\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n            out[out.length] = {\n              t: 't',\n              v: c\n            };\n            ++i;\n            break;\n        }\n      }\n      var bt = 0,\n        ss0 = 0,\n        ssm;\n      for (i = out.length - 1, lst = 't'; i >= 0; --i) {\n        switch (out[i].t) {\n          case 'h':\n          case 'H':\n            out[i].t = hr;\n            lst = 'h';\n            if (bt < 1) bt = 1;\n            break;\n          case 's':\n            if (ssm = out[i].v.match(/\\.0+$/)) ss0 = Math.max(ss0, ssm[0].length - 1);\n            if (bt < 3) bt = 3;\n          /* falls through */\n          case 'd':\n          case 'y':\n          case 'M':\n          case 'e':\n            lst = out[i].t;\n            break;\n          case 'm':\n            if (lst === 's') {\n              out[i].t = 'M';\n              if (bt < 2) bt = 2;\n            }\n            break;\n          case 'X':\n            if (out[i].v === \"B2\") ;\n            break;\n          case 'Z':\n            if (bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n            if (bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n            if (bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n        }\n      }\n      switch (bt) {\n        case 0:\n          break;\n        case 1:\n          if (dt.u >= 0.5) {\n            dt.u = 0;\n            ++dt.S;\n          }\n          if (dt.S >= 60) {\n            dt.S = 0;\n            ++dt.M;\n          }\n          if (dt.M >= 60) {\n            dt.M = 0;\n            ++dt.H;\n          }\n          break;\n        case 2:\n          if (dt.u >= 0.5) {\n            dt.u = 0;\n            ++dt.S;\n          }\n          if (dt.S >= 60) {\n            dt.S = 0;\n            ++dt.M;\n          }\n          break;\n      }\n      /* replace fields */\n      var nstr = \"\",\n        jj;\n      for (i = 0; i < out.length; ++i) {\n        switch (out[i].t) {\n          case 't':\n          case 'T':\n          case ' ':\n          case 'D':\n            break;\n          case 'X':\n            out[i] = undefined;\n            break;\n          case 'd':\n          case 'm':\n          case 'y':\n          case 'h':\n          case 'H':\n          case 'M':\n          case 's':\n          case 'e':\n          case 'b':\n          case 'Z':\n            out[i].v = write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n            out[i].t = 't';\n            break;\n          case 'n':\n          case '(':\n          case '?':\n            jj = i + 1;\n            while (out[jj] != null && ((c = out[jj].t) === \"?\" || c === \"D\" || (c === \" \" || c === \"t\") && out[jj + 1] != null && (out[jj + 1].t === '?' || out[jj + 1].t === \"t\" && out[jj + 1].v === '/') || out[i].t === '(' && (c === ' ' || c === 'n' || c === ')') || c === 't' && (out[jj].v === '/' || '$€'.indexOf(out[jj].v) > -1 || out[jj].v === ' ' && out[jj + 1] != null && out[jj + 1].t == '?'))) {\n              out[i].v += out[jj].v;\n              out[jj] = undefined;\n              ++jj;\n            }\n            nstr += out[i].v;\n            i = jj - 1;\n            break;\n          case 'G':\n            out[i].t = 't';\n            out[i].v = general_fmt(v, opts);\n            break;\n        }\n      }\n      var vv = \"\",\n        myv,\n        ostr;\n      if (nstr.length > 0) {\n        myv = v < 0 && nstr.charCodeAt(0) === 45 ? -v : v; /* '-' */\n        ostr = write_num(nstr.charCodeAt(0) === 40 ? '(' : 'n', nstr, myv); /* '(' */\n        jj = ostr.length - 1;\n        var decpt = out.length;\n        for (i = 0; i < out.length; ++i) if (out[i] != null && out[i].v.indexOf(\".\") > -1) {\n          decpt = i;\n          break;\n        }\n        var lasti = out.length;\n        if (decpt === out.length && ostr.indexOf(\"E\") === -1) {\n          for (i = out.length - 1; i >= 0; --i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n            if (jj >= out[i].v.length - 1) {\n              jj -= out[i].v.length;\n              out[i].v = ostr.substr(jj + 1, out[i].v.length);\n            } else if (jj < 0) out[i].v = \"\";else {\n              out[i].v = ostr.substr(0, jj + 1);\n              jj = -1;\n            }\n            out[i].t = 't';\n            lasti = i;\n          }\n          if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n        } else if (decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n          jj = ostr.indexOf(\".\") - 1;\n          for (i = decpt; i >= 0; --i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n            j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") - 1 : out[i].v.length - 1;\n            vv = out[i].v.substr(j + 1);\n            for (; j >= 0; --j) {\n              if (jj >= 0 && (out[i].v[j] === \"0\" || out[i].v[j] === \"#\")) vv = ostr[jj--] + vv;\n            }\n            out[i].v = vv;\n            out[i].t = 't';\n            lasti = i;\n          }\n          if (jj >= 0 && lasti < out.length) out[lasti].v = ostr.substr(0, jj + 1) + out[lasti].v;\n          jj = ostr.indexOf(\".\") + 1;\n          for (i = decpt; i < out.length; ++i) {\n            if (out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt) continue;\n            j = out[i].v.indexOf(\".\") > -1 && i === decpt ? out[i].v.indexOf(\".\") + 1 : 0;\n            vv = out[i].v.substr(0, j);\n            for (; j < out[i].v.length; ++j) {\n              if (jj < ostr.length) vv += ostr[jj++];\n            }\n            out[i].v = vv;\n            out[i].t = 't';\n            lasti = i;\n          }\n        }\n      }\n      for (i = 0; i < out.length; ++i) if (out[i] != null && 'n(?'.indexOf(out[i].t) > -1) {\n        myv = flen > 1 && v < 0 && i > 0 && out[i - 1].v === \"-\" ? -v : v;\n        out[i].v = write_num(out[i].t, out[i].v, myv);\n        out[i].t = 't';\n      }\n      var retval = \"\";\n      for (i = 0; i !== out.length; ++i) if (out[i] != null) retval += out[i].v;\n      return retval;\n    }\n    SSF._eval = eval_fmt;\n    var cfregex = /\\[[=<>]/;\n    var cfregex2 = /\\[([=<>]*)(-?\\d+\\.?\\d*)\\]/;\n    function chkcond(v, rr) {\n      if (rr == null) return false;\n      var thresh = parseFloat(rr[2]);\n      switch (rr[1]) {\n        case \"=\":\n          if (v == thresh) return true;\n          break;\n        case \">\":\n          if (v > thresh) return true;\n          break;\n        case \"<\":\n          if (v < thresh) return true;\n          break;\n        case \"<>\":\n          if (v != thresh) return true;\n          break;\n        case \">=\":\n          if (v >= thresh) return true;\n          break;\n        case \"<=\":\n          if (v <= thresh) return true;\n          break;\n      }\n      return false;\n    }\n    function choose_fmt(f, v) {\n      var fmt = split_fmt(f);\n      var l = fmt.length,\n        lat = fmt[l - 1].indexOf(\"@\");\n      if (l < 4 && lat > -1) --l;\n      if (fmt.length > 4) throw \"cannot find right format for |\" + fmt + \"|\";\n      if (typeof v !== \"number\") return [4, fmt.length === 4 || lat > -1 ? fmt[fmt.length - 1] : \"@\"];\n      switch (fmt.length) {\n        case 1:\n          fmt = lat > -1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"];\n          break;\n        case 2:\n          fmt = lat > -1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"];\n          break;\n        case 3:\n          fmt = lat > -1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"];\n          break;\n        case 4:\n          break;\n      }\n      var ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n      if (fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n      if (fmt[0].match(cfregex) != null || fmt[1].match(cfregex) != null) {\n        var m1 = fmt[0].match(cfregex2);\n        var m2 = fmt[1].match(cfregex2);\n        return chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n      }\n      return [l, ff];\n    }\n    function format(fmt, v, o) {\n      fixopts(o != null ? o : o = []);\n      var sfmt = \"\";\n      switch (typeof fmt) {\n        case \"string\":\n          sfmt = fmt;\n          break;\n        case \"number\":\n          sfmt = (o.table != null ? o.table : table_fmt)[fmt];\n          break;\n      }\n      if (isgeneral(sfmt, 0)) return general_fmt(v, o);\n      var f = choose_fmt(sfmt, v);\n      if (isgeneral(f[1])) return general_fmt(v, o);\n      if (v === true) v = \"TRUE\";else if (v === false) v = \"FALSE\";else if (v === \"\" || v == null) return \"\";\n      return eval_fmt(f[1], v, o, f[0]);\n    }\n    SSF._table = table_fmt;\n    SSF.load = function load_entry(fmt, idx) {\n      table_fmt[idx] = fmt;\n    };\n    SSF.format = format;\n    SSF.get_table = function get_table() {\n      return table_fmt;\n    };\n    SSF.load_table = function load_table(tbl) {\n      for (var i = 0; i != 0x0188; ++i) if (tbl[i] !== undefined) SSF.load(tbl[i], i);\n    };\n  };\n  make_ssf(SSF);\n  /* [MS-DTYP] 2.3.3 FILETIME */\n  /* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n  /* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\n  function parse_FILETIME(blob) {\n    var dwLowDateTime = blob.read_shift(4),\n      dwHighDateTime = blob.read_shift(4);\n    return new Date((dwHighDateTime / 1e7 * Math.pow(2, 32) + dwLowDateTime / 1e7 - 11644473600) * 1000).toISOString().replace(/\\.000/, \"\");\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.4 Lpstr */\n  function parse_lpstr(blob, type, pad) {\n    var str = blob.read_shift(0, 'lpstr');\n    if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n    return str;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\n  function parse_lpwstr(blob, type, pad) {\n    var str = blob.read_shift(0, 'lpwstr');\n    if (pad) blob.l += 4 - (str.length + 1 & 3) & 3;\n    return str;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.11 VtString */\n  /* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\n  function parse_VtStringBase(blob, stringType, pad) {\n    if (stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\n    return parse_lpstr(blob, stringType, pad);\n  }\n  function parse_VtString(blob, t, pad) {\n    return parse_VtStringBase(blob, t, pad === false ? 0 : 4);\n  }\n  function parse_VtUnalignedString(blob, t) {\n    if (!t) throw new Error(\"dafuq?\");\n    return parse_VtStringBase(blob, t, 0);\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\n  function parse_VtVecUnalignedLpstrValue(blob) {\n    var length = blob.read_shift(4);\n    var ret = [];\n    for (var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr');\n    return ret;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.10 VtVecUnalignedLpstr */\n  function parse_VtVecUnalignedLpstr(blob) {\n    return parse_VtVecUnalignedLpstrValue(blob);\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\n  function parse_VtHeadingPair(blob) {\n    var headingString = parse_TypedPropertyValue(blob, VT_USTR);\n    var headerParts = parse_TypedPropertyValue(blob, VT_I4);\n    return [headingString, headerParts];\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\n  function parse_VtVecHeadingPairValue(blob) {\n    var cElements = blob.read_shift(4);\n    var out = [];\n    for (var i = 0; i != cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n    return out;\n  }\n\n  /* [MS-OSHARED] 2.3.3.1.15 VtVecHeadingPair */\n  function parse_VtVecHeadingPair(blob) {\n    // NOTE: When invoked, wType & padding were already consumed\n    return parse_VtVecHeadingPairValue(blob);\n  }\n\n  /* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\n  function parse_dictionary(blob, CodePage) {\n    var cnt = blob.read_shift(4);\n    var dict = {};\n    for (var j = 0; j != cnt; ++j) {\n      var pid = blob.read_shift(4);\n      var len = blob.read_shift(4);\n      dict[pid] = blob.read_shift(len, CodePage === 0x4B0 ? 'utf16le' : 'utf8').replace(chr0, '').replace(chr1, '!');\n    }\n    if (blob.l & 3) blob.l = blob.l >> 2 + 1 << 2;\n    return dict;\n  }\n\n  /* [MS-OLEPS] 2.9 BLOB */\n  function parse_BLOB(blob) {\n    var size = blob.read_shift(4);\n    var bytes = blob.slice(blob.l, blob.l + size);\n    if ((size & 3) > 0) blob.l += 4 - (size & 3) & 3;\n    return bytes;\n  }\n\n  /* [MS-OLEPS] 2.11 ClipboardData */\n  function parse_ClipboardData(blob) {\n    // TODO\n    var o = {};\n    o.Size = blob.read_shift(4);\n    //o.Format = blob.read_shift(4);\n    blob.l += o.Size;\n    return o;\n  }\n\n  /* [MS-OLEPS] 2.14 Vector and Array Property Types */\n  function parse_VtVector(blob, cb) {\n    /* [MS-OLEPS] 2.14.2 VectorHeader */\n    /*\tvar Length = blob.read_shift(4);\n    \tvar o = [];\n    \tfor(var i = 0; i != Length; ++i) {\n    \t\to.push(cb(blob));\n    \t}\n    \treturn o;*/\n  }\n\n  /* [MS-OLEPS] 2.15 TypedPropertyValue */\n  function parse_TypedPropertyValue(blob, type, _opts) {\n    var t = blob.read_shift(2),\n      ret,\n      opts = _opts || {};\n    blob.l += 2;\n    if (type !== VT_VARIANT) if (t !== type && VT_CUSTOM.indexOf(type) === -1) throw new Error('Expected type ' + type + ' saw ' + t);\n    switch (type === VT_VARIANT ? t : type) {\n      case 0x02 /*VT_I2*/:\n        ret = blob.read_shift(2, 'i');\n        if (!opts.raw) blob.l += 2;\n        return ret;\n      case 0x03 /*VT_I4*/:\n        ret = blob.read_shift(4, 'i');\n        return ret;\n      case 0x0B /*VT_BOOL*/:\n        return blob.read_shift(4) !== 0x0;\n      case 0x13 /*VT_UI4*/:\n        ret = blob.read_shift(4);\n        return ret;\n      case 0x1E /*VT_LPSTR*/:\n        return parse_lpstr(blob, t, 4).replace(chr0, '');\n      case 0x1F /*VT_LPWSTR*/:\n        return parse_lpwstr(blob);\n      case 0x40 /*VT_FILETIME*/:\n        return parse_FILETIME(blob);\n      case 0x41 /*VT_BLOB*/:\n        return parse_BLOB(blob);\n      case 0x47 /*VT_CF*/:\n        return parse_ClipboardData(blob);\n      case 0x50 /*VT_STRING*/:\n        return parse_VtString(blob, t, !opts.raw && 4).replace(chr0, '');\n      case 0x51 /*VT_USTR*/:\n        return parse_VtUnalignedString(blob, t, 4).replace(chr0, '');\n      case 0x100C /*VT_VECTOR|VT_VARIANT*/:\n        return parse_VtVecHeadingPair(blob);\n      case 0x101E /*VT_LPSTR*/:\n        return parse_VtVecUnalignedLpstr(blob);\n      default:\n        throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n    }\n  }\n  /* [MS-OLEPS] 2.14.2 VectorHeader */\n  /*function parse_VTVectorVariant(blob) {\n  \tvar Length = blob.read_shift(4);\n  \n  \tif(Length & 1 !== 0) throw new Error(\"VectorHeader Length=\" + Length + \" must be even\");\n  \tvar o = [];\n  \tfor(var i = 0; i != Length; ++i) {\n  \t\to.push(parse_TypedPropertyValue(blob, VT_VARIANT));\n  \t}\n  \treturn o;\n  }*/\n\n  /* [MS-OLEPS] 2.20 PropertySet */\n  function parse_PropertySet(blob, PIDSI) {\n    var start_addr = blob.l;\n    var size = blob.read_shift(4);\n    var NumProps = blob.read_shift(4);\n    var Props = [],\n      i = 0;\n    var CodePage = 0;\n    var Dictionary = -1,\n      DictObj = {};\n    for (i = 0; i != NumProps; ++i) {\n      var PropID = blob.read_shift(4);\n      var Offset = blob.read_shift(4);\n      Props[i] = [PropID, Offset + start_addr];\n    }\n    var PropH = {};\n    for (i = 0; i != NumProps; ++i) {\n      if (blob.l !== Props[i][1]) {\n        var fail = true;\n        if (i > 0 && PIDSI) switch (PIDSI[Props[i - 1][0]].t) {\n          case 0x02 /*VT_I2*/:\n            if (blob.l + 2 === Props[i][1]) {\n              blob.l += 2;\n              fail = false;\n            }\n            break;\n          case 0x50 /*VT_STRING*/:\n            if (blob.l <= Props[i][1]) {\n              blob.l = Props[i][1];\n              fail = false;\n            }\n            break;\n          case 0x100C /*VT_VECTOR|VT_VARIANT*/:\n            if (blob.l <= Props[i][1]) {\n              blob.l = Props[i][1];\n              fail = false;\n            }\n            break;\n        }\n        if (!PIDSI && blob.l <= Props[i][1]) {\n          fail = false;\n          blob.l = Props[i][1];\n        }\n        if (fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n      }\n      if (PIDSI) {\n        var piddsi = PIDSI[Props[i][0]];\n        PropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {\n          raw: true\n        });\n        if (piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + String(PropH[piddsi.n] & 0xFFFF);\n        if (piddsi.n == \"CodePage\") switch (PropH[piddsi.n]) {\n          case 0:\n            PropH[piddsi.n] = 1252;\n          /* falls through */\n          case 10000: // OSX Roman\n          case 1252: // Windows Latin\n\n          case 874: // SB Windows Thai\n          case 1250: // SB Windows Central Europe\n          case 1251: // SB Windows Cyrillic\n          case 1253: // SB Windows Greek\n          case 1254: // SB Windows Turkish\n          case 1255: // SB Windows Hebrew\n          case 1256: // SB Windows Arabic\n          case 1257: // SB Windows Baltic\n          case 1258: // SB Windows Vietnam\n\n          case 932: // DB Windows Japanese Shift-JIS\n          case 936: // DB Windows Simplified Chinese GBK\n          case 949: // DB Windows Korean\n          case 950: // DB Windows Traditional Chinese Big5\n\n          case 1200: // UTF16LE\n          case 1201: // UTF16BE\n          case 65000:\n          case -536: // UTF-7\n          case 65001:\n          case -535:\n            // UTF-8\n            set_cp(CodePage = PropH[piddsi.n]);\n            break;\n          default:\n            throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n        }\n      } else {\n        if (Props[i][0] === 0x1) {\n          CodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2);\n          set_cp(CodePage);\n          if (Dictionary !== -1) {\n            var oldpos = blob.l;\n            blob.l = Props[Dictionary][1];\n            DictObj = parse_dictionary(blob, CodePage);\n            blob.l = oldpos;\n          }\n        } else if (Props[i][0] === 0) {\n          if (CodePage === 0) {\n            Dictionary = i;\n            blob.l = Props[i + 1][1];\n            continue;\n          }\n          DictObj = parse_dictionary(blob, CodePage);\n        } else {\n          var name = DictObj[Props[i][0]];\n          var val;\n          /* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n          switch (blob[blob.l]) {\n            case 0x41 /*VT_BLOB*/:\n              blob.l += 4;\n              val = parse_BLOB(blob);\n              break;\n            case 0x1E /*VT_LPSTR*/:\n              blob.l += 4;\n              val = parse_VtString(blob, blob[blob.l - 4]);\n              break;\n            case 0x1F /*VT_LPWSTR*/:\n              blob.l += 4;\n              val = parse_VtString(blob, blob[blob.l - 4]);\n              break;\n            case 0x03 /*VT_I4*/:\n              blob.l += 4;\n              val = blob.read_shift(4, 'i');\n              break;\n            case 0x13 /*VT_UI4*/:\n              blob.l += 4;\n              val = blob.read_shift(4);\n              break;\n            case 0x05 /*VT_R8*/:\n              blob.l += 4;\n              val = blob.read_shift(8, 'f');\n              break;\n            case 0x0B /*VT_BOOL*/:\n              blob.l += 4;\n              val = parsebool(blob, 4);\n              break;\n            case 0x40 /*VT_FILETIME*/:\n              blob.l += 4;\n              val = new Date(parse_FILETIME(blob));\n              break;\n            default:\n              throw new Error(\"unparsed value: \" + blob[blob.l]);\n          }\n          PropH[name] = val;\n        }\n      }\n    }\n    blob.l = start_addr + size; /* step ahead to skip padding */\n    return PropH;\n  }\n\n  /* [MS-OLEPS] 2.21 PropertySetStream */\n  function parse_PropertySetStream(file, PIDSI) {\n    var blob = file.content;\n    prep_blob(blob, 0);\n    var NumSets,\n      FMTID0,\n      FMTID1,\n      Offset0,\n      Offset1 = 0;\n    blob.chk('feff', 'Byte Order: ');\n    var vers = blob.read_shift(2); // TODO: check version\n    var SystemIdentifier = blob.read_shift(4);\n    blob.chk(CFB.utils.consts.HEADER_CLSID, 'CLSID: ');\n    NumSets = blob.read_shift(4);\n    if (NumSets !== 1 && NumSets !== 2) throw \"Unrecognized #Sets: \" + NumSets;\n    FMTID0 = blob.read_shift(16);\n    Offset0 = blob.read_shift(4);\n    if (NumSets === 1 && Offset0 !== blob.l) throw \"Length mismatch\";else if (NumSets === 2) {\n      FMTID1 = blob.read_shift(16);\n      Offset1 = blob.read_shift(4);\n    }\n    var PSet0 = parse_PropertySet(blob, PIDSI);\n    var rval = {\n      SystemIdentifier: SystemIdentifier\n    };\n    for (var y in PSet0) rval[y] = PSet0[y];\n    //rval.blob = blob;\n    rval.FMTID = FMTID0;\n    //rval.PSet0 = PSet0;\n    if (NumSets === 1) return rval;\n    if (blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n    var PSet1;\n    try {\n      PSet1 = parse_PropertySet(blob, null);\n    } catch (e) {}\n    for (y in PSet1) rval[y] = PSet1[y];\n    rval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n    return rval;\n  }\n  var DO_NOT_EXPORT_CFB = true;\n  /* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n  /* vim: set ts=2: */\n  /*jshint eqnull:true */\n\n  /* [MS-CFB] v20130118 */\n  var CFB = function _CFB() {\n    var exports = {};\n    exports.version = '0.11.0';\n    function parse(file) {\n      var mver = 3; // major version\n      var ssz = 512; // sector size\n      var nmfs = 0; // number of mini FAT sectors\n      var ndfs = 0; // number of DIFAT sectors\n      var dir_start = 0; // first directory sector location\n      var minifat_start = 0; // first mini FAT sector location\n      var difat_start = 0; // first mini FAT sector location\n\n      var fat_addrs = []; // locations of FAT sectors\n\n      /* [MS-CFB] 2.2 Compound File Header */\n      var blob = file.slice(0, 512);\n      prep_blob(blob, 0);\n\n      /* major version */\n      var mv = check_get_mver(blob);\n      mver = mv[0];\n      switch (mver) {\n        case 3:\n          ssz = 512;\n          break;\n        case 4:\n          ssz = 4096;\n          break;\n        default:\n          throw \"Major Version: Expected 3 or 4 saw \" + mver;\n      }\n\n      /* reprocess header */\n      if (ssz !== 512) {\n        blob = file.slice(0, ssz);\n        prep_blob(blob, 28 /* blob.l */);\n      }\n      /* Save header for final object */\n      var header = file.slice(0, ssz);\n      check_shifts(blob, mver);\n\n      // Number of Directory Sectors\n      var nds = blob.read_shift(4, 'i');\n      if (mver === 3 && nds !== 0) throw '# Directory Sectors: Expected 0 saw ' + nds;\n\n      // Number of FAT Sectors\n      //var nfs = blob.read_shift(4, 'i');\n      blob.l += 4;\n\n      // First Directory Sector Location\n      dir_start = blob.read_shift(4, 'i');\n\n      // Transaction Signature\n      blob.l += 4;\n\n      // Mini Stream Cutoff Size\n      blob.chk('00100000', 'Mini Stream Cutoff Size: ');\n\n      // First Mini FAT Sector Location\n      minifat_start = blob.read_shift(4, 'i');\n\n      // Number of Mini FAT Sectors\n      nmfs = blob.read_shift(4, 'i');\n\n      // First DIFAT sector location\n      difat_start = blob.read_shift(4, 'i');\n\n      // Number of DIFAT Sectors\n      ndfs = blob.read_shift(4, 'i');\n\n      // Grab FAT Sector Locations\n      for (var q, j = 0; j < 109; ++j) {\n        /* 109 = (512 - blob.l)>>>2; */\n        q = blob.read_shift(4, 'i');\n        if (q < 0) break;\n        fat_addrs[j] = q;\n      }\n\n      /** Break the file up into sectors */\n      var sectors = sectorify(file, ssz);\n      sleuth_fat(difat_start, ndfs, sectors, ssz, fat_addrs);\n\n      /** Chains */\n      var sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n      sector_list[dir_start].name = \"!Directory\";\n      if (nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\n      sector_list[fat_addrs[0]].name = \"!FAT\";\n      sector_list.fat_addrs = fat_addrs;\n      sector_list.ssz = ssz;\n\n      /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n      var files = {},\n        Paths = [],\n        FileIndex = [],\n        FullPaths = [],\n        FullPathDir = {};\n      read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex);\n      build_full_paths(FileIndex, FullPathDir, FullPaths, Paths);\n      var root_name = Paths.shift();\n      Paths.root = root_name;\n\n      /* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\n      var find_path = make_find_path(FullPaths, Paths, FileIndex, files, root_name);\n      return {\n        raw: {\n          header: header,\n          sectors: sectors\n        },\n        FileIndex: FileIndex,\n        FullPaths: FullPaths,\n        FullPathDir: FullPathDir,\n        find: find_path\n      };\n    } // parse\n\n    /* [MS-CFB] 2.2 Compound File Header -- read up to major version */\n    function check_get_mver(blob) {\n      // header signature 8\n      blob.chk(HEADER_SIGNATURE, 'Header Signature: ');\n\n      // clsid 16\n      blob.chk(HEADER_CLSID, 'CLSID: ');\n\n      // minor version 2\n      var mver = blob.read_shift(2, 'u');\n      return [blob.read_shift(2, 'u'), mver];\n    }\n    function check_shifts(blob, mver) {\n      var shift = 0x09;\n\n      // Byte Order\n      blob.chk('feff', 'Byte Order: ');\n\n      // Sector Shift\n      switch (shift = blob.read_shift(2)) {\n        case 0x09:\n          if (mver !== 3) throw 'MajorVersion/SectorShift Mismatch';\n          break;\n        case 0x0c:\n          if (mver !== 4) throw 'MajorVersion/SectorShift Mismatch';\n          break;\n        default:\n          throw 'Sector Shift: Expected 9 or 12 saw ' + shift;\n      }\n\n      // Mini Sector Shift\n      blob.chk('0600', 'Mini Sector Shift: ');\n\n      // Reserved\n      blob.chk('000000000000', 'Reserved: ');\n    }\n\n    /** Break the file up into sectors */\n    function sectorify(file, ssz) {\n      var nsectors = Math.ceil(file.length / ssz) - 1;\n      var sectors = new Array(nsectors);\n      for (var i = 1; i < nsectors; ++i) sectors[i - 1] = file.slice(i * ssz, (i + 1) * ssz);\n      sectors[nsectors - 1] = file.slice(nsectors * ssz);\n      return sectors;\n    }\n\n    /* [MS-CFB] 2.6.4 Red-Black Tree */\n    function build_full_paths(FI, FPD, FP, Paths) {\n      var i = 0,\n        L = 0,\n        R = 0,\n        C = 0,\n        j = 0,\n        pl = Paths.length;\n      var dad = new Array(pl),\n        q = new Array(pl);\n      for (; i < pl; ++i) {\n        dad[i] = q[i] = i;\n        FP[i] = Paths[i];\n      }\n      for (; j < q.length; ++j) {\n        i = q[j];\n        L = FI[i].L;\n        R = FI[i].R;\n        C = FI[i].C;\n        if (dad[i] === i) {\n          if (L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\n          if (R !== -1 && dad[R] !== R) dad[i] = dad[R];\n        }\n        if (C !== -1 /*NOSTREAM*/) dad[C] = i;\n        if (L !== -1) {\n          dad[L] = dad[i];\n          q.push(L);\n        }\n        if (R !== -1) {\n          dad[R] = dad[i];\n          q.push(R);\n        }\n      }\n      for (i = 1; i !== pl; ++i) if (dad[i] === i) {\n        if (R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];else if (L !== -1 && dad[L] !== L) dad[i] = dad[L];\n      }\n      for (i = 1; i < pl; ++i) {\n        if (FI[i].type === 0 /* unknown */) continue;\n        j = dad[i];\n        if (j === 0) FP[i] = FP[0] + \"/\" + FP[i];else while (j !== 0) {\n          FP[i] = FP[j] + \"/\" + FP[i];\n          j = dad[j];\n        }\n        dad[i] = 0;\n      }\n      FP[0] += \"/\";\n      for (i = 1; i < pl; ++i) {\n        if (FI[i].type !== 2 /* stream */) FP[i] += \"/\";\n        FPD[FP[i]] = FI[i];\n      }\n    }\n\n    /* [MS-CFB] 2.6.4 */\n    function make_find_path(FullPaths, Paths, FileIndex, files, root_name) {\n      var UCFullPaths = new Array(FullPaths.length);\n      var UCPaths = new Array(Paths.length),\n        i;\n      for (i = 0; i < FullPaths.length; ++i) UCFullPaths[i] = FullPaths[i].toUpperCase().replace(chr0, '').replace(chr1, '!');\n      for (i = 0; i < Paths.length; ++i) UCPaths[i] = Paths[i].toUpperCase().replace(chr0, '').replace(chr1, '!');\n      return function find_path(path) {\n        var k;\n        if (path.charCodeAt(0) === 47 /* \"/\" */) {\n          k = true;\n          path = root_name + path;\n        } else k = path.indexOf(\"/\") !== -1;\n        var UCPath = path.toUpperCase().replace(chr0, '').replace(chr1, '!');\n        var w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n        if (w === -1) return null;\n        return k === true ? FileIndex[w] : files[Paths[w]];\n      };\n    }\n\n    /** Chase down the rest of the DIFAT chain to build a comprehensive list\n        DIFAT chains by storing the next sector number as the last 32 bytes */\n    function sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\n      var q;\n      if (idx === ENDOFCHAIN) {\n        if (cnt !== 0) throw \"DIFAT chain shorter than expected\";\n      } else if (idx !== -1 /*FREESECT*/) {\n        var sector = sectors[idx],\n          m = (ssz >>> 2) - 1;\n        if (!sector) return;\n        for (var i = 0; i < m; ++i) {\n          if ((q = __readInt32LE(sector, i * 4)) === ENDOFCHAIN) break;\n          fat_addrs.push(q);\n        }\n        sleuth_fat(__readInt32LE(sector, ssz - 4), cnt - 1, sectors, ssz, fat_addrs);\n      }\n    }\n\n    /** Follow the linked list of sectors for a given starting point */\n    function get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\n      var sl = sectors.length;\n      var buf, buf_chain;\n      if (!chkd) chkd = new Array(sl);\n      var modulus = ssz - 1,\n        j,\n        jj;\n      buf = [];\n      buf_chain = [];\n      for (j = start; j >= 0;) {\n        chkd[j] = true;\n        buf[buf.length] = j;\n        buf_chain.push(sectors[j]);\n        var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n        jj = j * 4 & modulus;\n        if (ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \" + ssz;\n        if (!sectors[addr]) break;\n        j = __readInt32LE(sectors[addr], jj);\n      }\n      return {\n        nodes: buf,\n        data: __toBuffer([buf_chain])\n      };\n    }\n\n    /** Chase down the sector linked lists */\n    function make_sector_list(sectors, dir_start, fat_addrs, ssz) {\n      var sl = sectors.length,\n        sector_list = new Array(sl);\n      var chkd = new Array(sl),\n        buf,\n        buf_chain;\n      var modulus = ssz - 1,\n        i,\n        j,\n        k,\n        jj;\n      for (i = 0; i < sl; ++i) {\n        buf = [];\n        k = i + dir_start;\n        if (k >= sl) k -= sl;\n        if (chkd[k] === true) continue;\n        buf_chain = [];\n        for (j = k; j >= 0;) {\n          chkd[j] = true;\n          buf[buf.length] = j;\n          buf_chain.push(sectors[j]);\n          var addr = fat_addrs[Math.floor(j * 4 / ssz)];\n          jj = j * 4 & modulus;\n          if (ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \" + ssz;\n          if (!sectors[addr]) break;\n          j = __readInt32LE(sectors[addr], jj);\n        }\n        sector_list[k] = {\n          nodes: buf,\n          data: __toBuffer([buf_chain])\n        };\n      }\n      return sector_list;\n    }\n\n    /* [MS-CFB] 2.6.1 Compound File Directory Entry */\n    function read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex) {\n      var blob;\n      var minifat_store = 0,\n        pl = Paths.length ? 2 : 0;\n      var sector = sector_list[dir_start].data;\n      var i = 0,\n        namelen = 0,\n        name,\n        o,\n        ctime,\n        mtime;\n      for (; i < sector.length; i += 128) {\n        blob = sector.slice(i, i + 128);\n        prep_blob(blob, 64);\n        namelen = blob.read_shift(2);\n        if (namelen === 0) continue;\n        name = __utf16le(blob, 0, namelen - pl);\n        Paths.push(name);\n        o = {\n          name: name,\n          type: blob.read_shift(1),\n          color: blob.read_shift(1),\n          L: blob.read_shift(4, 'i'),\n          R: blob.read_shift(4, 'i'),\n          C: blob.read_shift(4, 'i'),\n          clsid: blob.read_shift(16),\n          state: blob.read_shift(4, 'i')\n        };\n        ctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n        if (ctime !== 0) {\n          o.ctime = ctime;\n          o.ct = read_date(blob, blob.l - 8);\n        }\n        mtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n        if (mtime !== 0) {\n          o.mtime = mtime;\n          o.mt = read_date(blob, blob.l - 8);\n        }\n        o.start = blob.read_shift(4, 'i');\n        o.size = blob.read_shift(4, 'i');\n        if (o.type === 5) {\n          /* root */\n          minifat_store = o.start;\n          if (nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n          /*minifat_size = o.size;*/\n        } else if (o.size >= 4096 /* MSCSZ */) {\n          o.storage = 'fat';\n          if (sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n          sector_list[o.start].name = o.name;\n          o.content = sector_list[o.start].data.slice(0, o.size);\n          prep_blob(o.content, 0);\n        } else {\n          o.storage = 'minifat';\n          if (minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN) {\n            o.content = sector_list[minifat_store].data.slice(o.start * MSSZ, o.start * MSSZ + o.size);\n            prep_blob(o.content, 0);\n          }\n        }\n        files[name] = o;\n        FileIndex.push(o);\n      }\n    }\n    function read_date(blob, offset) {\n      return new Date((__readUInt32LE(blob, offset + 4) / 1e7 * Math.pow(2, 32) + __readUInt32LE(blob, offset) / 1e7 - 11644473600) * 1000);\n    }\n    var fs;\n    function readFileSync(filename, options) {\n      if (fs === undefined) fs = require('fs');\n      return parse(fs.readFileSync(filename), options);\n    }\n    function readSync(blob, options) {\n      switch (options !== undefined && options.type !== undefined ? options.type : \"base64\") {\n        case \"file\":\n          return readFileSync(blob, options);\n        case \"base64\":\n          return parse(s2a(Base64.decode(blob)), options);\n        case \"binary\":\n          return parse(s2a(blob), options);\n      }\n      return parse(blob);\n    }\n\n    /** CFB Constants */\n    var MSSZ = 64; /* Mini Sector Size = 1<<6 */\n    //var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n    /* 2.1 Compound File Sector Numbers and Types */\n    var ENDOFCHAIN = -2;\n    /* 2.2 Compound File Header */\n    var HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\n    var HEADER_CLSID = '00000000000000000000000000000000';\n    var consts = {\n      /* 2.1 Compund File Sector Numbers and Types */\n      MAXREGSECT: -6,\n      DIFSECT: -4,\n      FATSECT: -3,\n      ENDOFCHAIN: ENDOFCHAIN,\n      FREESECT: -1,\n      /* 2.2 Compound File Header */\n      HEADER_SIGNATURE: HEADER_SIGNATURE,\n      HEADER_MINOR_VERSION: '3e00',\n      MAXREGSID: -6,\n      NOSTREAM: -1,\n      HEADER_CLSID: HEADER_CLSID,\n      /* 2.6.1 Compound File Directory Entry */\n      EntryTypes: ['unknown', 'storage', 'stream', 'lockbytes', 'property', 'root']\n    };\n    exports.read = readSync;\n    exports.parse = parse;\n    exports.utils = {\n      ReadShift: ReadShift,\n      CheckField: CheckField,\n      prep_blob: prep_blob,\n      bconcat: bconcat,\n      consts: consts\n    };\n    return exports;\n  }();\n  if (typeof require !== 'undefined' && typeof module !== 'undefined' && typeof DO_NOT_EXPORT_CFB === 'undefined') {\n    module.exports = CFB;\n  }\n  function dup(o) {\n    if (typeof JSON != 'undefined') return JSON.parse(JSON.stringify(o));\n    if (typeof o != 'object' || !o) return o;\n    var out = {};\n    for (var k in o) if (o.hasOwnProperty(k)) out[k] = dup(o[k]);\n    return out;\n  }\n  function fill(c, l) {\n    var o = \"\";\n    while (o.length < l) o += c;\n    return o;\n  }\n\n  /* sections refer to MS-XLS unless otherwise stated */\n\n  /* --- Simple Utilities --- */\n  function parsenoop(blob, length) {\n    blob.read_shift(length);\n    return;\n  }\n  function parsenoop2(blob, length) {\n    blob.read_shift(length);\n    return null;\n  }\n  function parslurp(blob, length, cb) {\n    var arr = [],\n      target = blob.l + length;\n    while (blob.l < target) arr.push(cb(blob, target - blob.l));\n    if (target !== blob.l) throw new Error(\"Slurp error\");\n    return arr;\n  }\n  function parslurp2(blob, length, cb) {\n    var arr = [],\n      target = blob.l + length,\n      len = blob.read_shift(2);\n    while (len-- !== 0) arr.push(cb(blob, target - blob.l));\n    if (target !== blob.l) throw new Error(\"Slurp error\");\n    return arr;\n  }\n  function parsebool(blob, length) {\n    return blob.read_shift(length) === 0x1;\n  }\n  function parseuint16(blob) {\n    return blob.read_shift(2, 'u');\n  }\n  function parseuint16a(blob, length) {\n    return parslurp(blob, length, parseuint16);\n  }\n\n  /* --- 2.5 Structures --- */\n\n  /* [MS-XLS] 2.5.14 Boolean */\n  var parse_Boolean = parsebool;\n\n  /* [MS-XLS] 2.5.10 Bes (boolean or error) */\n  function parse_Bes(blob) {\n    var v = blob.read_shift(1),\n      t = blob.read_shift(1);\n    return t === 0x01 ? v : v === 0x01;\n  }\n\n  /* [MS-XLS] 2.5.240 ShortXLUnicodeString */\n  function parse_ShortXLUnicodeString(blob, length, opts) {\n    var cch = blob.read_shift(1);\n    var width = 1,\n      encoding = 'sbcs-cont';\n    var cp = current_codepage;\n    if (opts && opts.biff >= 8) current_codepage = 1200;\n    if (!opts || opts.biff == 8) {\n      var fHighByte = blob.read_shift(1);\n      if (fHighByte) {\n        width = 2;\n        encoding = 'dbcs-cont';\n      }\n    }\n    var o = cch ? blob.read_shift(cch, encoding) : \"\";\n    current_codepage = cp;\n    return o;\n  }\n\n  /* 2.5.293 XLUnicodeRichExtendedString */\n  function parse_XLUnicodeRichExtendedString(blob) {\n    var cp = current_codepage;\n    current_codepage = 1200;\n    var cch = blob.read_shift(2),\n      flags = blob.read_shift(1);\n    var fHighByte = flags & 0x1,\n      fExtSt = flags & 0x4,\n      fRichSt = flags & 0x8;\n    var width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n    var cRun = 0,\n      cbExtRst;\n    var z = {};\n    if (fRichSt) cRun = blob.read_shift(2);\n    if (fExtSt) cbExtRst = blob.read_shift(4);\n    var encoding = flags & 0x1 ? 'dbcs-cont' : 'sbcs-cont';\n    var msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n    if (fRichSt) blob.l += 4 * cRun; //TODO: parse this\n    if (fExtSt) blob.l += cbExtRst; //TODO: parse this\n    z.t = msg;\n    if (!fRichSt) {\n      z.raw = \"<t>\" + z.t + \"</t>\";\n      z.r = z.t;\n    }\n    current_codepage = cp;\n    return z;\n  }\n\n  /* 2.5.296 XLUnicodeStringNoCch */\n  function parse_XLUnicodeStringNoCch(blob, cch, opts) {\n    var retval;\n    if (opts) {\n      if (opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'sbcs-cont');\n    }\n    var fHighByte = blob.read_shift(1);\n    if (fHighByte === 0) {\n      retval = blob.read_shift(cch, 'sbcs-cont');\n    } else {\n      retval = blob.read_shift(cch, 'dbcs-cont');\n    }\n    return retval;\n  }\n\n  /* 2.5.294 XLUnicodeString */\n  function parse_XLUnicodeString(blob, length, opts) {\n    var cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n    return parse_XLUnicodeStringNoCch(blob, cch, opts);\n  }\n  /* BIFF5 override */\n  function parse_XLUnicodeString2(blob, length, opts) {\n    if (opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n    var cch = blob.read_shift(1);\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n    return blob.read_shift(cch, 'sbcs-cont');\n  }\n\n  /* 2.5.342 Xnum */\n  function parse_Xnum(blob) {\n    return blob.read_shift(8, 'f');\n  }\n\n  /* 2.5.61 ControlInfo */\n  var parse_ControlInfo = parsenoop;\n\n  /* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\n  var parse_URLMoniker = function (blob, length) {\n    var len = blob.read_shift(4),\n      start = blob.l;\n    var extra = false;\n    if (len > 24) {\n      /* look ahead */\n      blob.l += len - 24;\n      if (blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n      blob.l = start;\n    }\n    var url = blob.read_shift((extra ? len - 24 : len) >> 1, 'utf16le').replace(chr0, \"\");\n    if (extra) blob.l += 24;\n    return url;\n  };\n\n  /* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\n  var parse_FileMoniker = function (blob, length) {\n    var cAnti = blob.read_shift(2);\n    var ansiLength = blob.read_shift(4);\n    var ansiPath = blob.read_shift(ansiLength, 'cstr');\n    var endServer = blob.read_shift(2);\n    var versionNumber = blob.read_shift(2);\n    var cbUnicodePathSize = blob.read_shift(4);\n    if (cbUnicodePathSize === 0) return ansiPath.replace(/\\\\/g, \"/\");\n    var cbUnicodePathBytes = blob.read_shift(4);\n    var usKeyValue = blob.read_shift(2);\n    var unicodePath = blob.read_shift(cbUnicodePathBytes >> 1, 'utf16le').replace(chr0, \"\");\n    return unicodePath;\n  };\n\n  /* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\n  var parse_HyperlinkMoniker = function (blob, length) {\n    var clsid = blob.read_shift(16);\n    length -= 16;\n    switch (clsid) {\n      case \"e0c9ea79f9bace118c8200aa004ba90b\":\n        return parse_URLMoniker(blob, length);\n      case \"0303000000000000c000000000000046\":\n        return parse_FileMoniker(blob, length);\n      default:\n        throw \"unsupported moniker \" + clsid;\n    }\n  };\n\n  /* [MS-OSHARED] 2.3.7.9 HyperlinkString */\n  var parse_HyperlinkString = function (blob, length) {\n    var len = blob.read_shift(4);\n    var o = blob.read_shift(len, 'utf16le').replace(chr0, \"\");\n    return o;\n  };\n\n  /* [MS-OSHARED] 2.3.7.1 Hyperlink Object TODO: unify params with XLSX */\n  var parse_Hyperlink = function (blob, length) {\n    var end = blob.l + length;\n    var sVer = blob.read_shift(4);\n    if (sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n    var flags = blob.read_shift(2);\n    blob.l += 2;\n    var displayName, targetFrameName, moniker, oleMoniker, location, guid, fileTime;\n    if (flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n    if (flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n    if ((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n    if ((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n    if (flags & 0x0008) location = parse_HyperlinkString(blob, end - blob.l);\n    if (flags & 0x0020) guid = blob.read_shift(16);\n    if (flags & 0x0040) fileTime = parse_FILETIME(blob, 8);\n    blob.l = end;\n    var target = targetFrameName || moniker || oleMoniker;\n    if (location) target += \"#\" + location;\n    return {\n      Target: target\n    };\n  };\n\n  /* 2.5.178 LongRGBA */\n  function parse_LongRGBA(blob, length) {\n    var r = blob.read_shift(1),\n      g = blob.read_shift(1),\n      b = blob.read_shift(1),\n      a = blob.read_shift(1);\n    return [r, g, b, a];\n  }\n\n  /* 2.5.177 LongRGB */\n  function parse_LongRGB(blob, length) {\n    var x = parse_LongRGBA(blob, length);\n    x[3] = 0;\n    return x;\n  }\n  function shift_cell(cell, tgt) {\n    var out = dup(cell);\n    if (tgt.s) {\n      if (out.cRel) out.c += tgt.s.c;\n      if (out.rRel) out.r += tgt.s.r;\n    } else {\n      out.c += tgt.c;\n      out.r += tgt.r;\n    }\n    while (out.c >= 0x100) out.c -= 0x100;\n    while (out.r >= 0x10000) out.r -= 0x10000;\n    return out;\n  }\n  function shift_range(cell, range) {\n    cell.s = shift_cell(cell.s, range.s);\n    cell.e = shift_cell(cell.e, range.s);\n    return cell;\n  }\n  function encode_cell_xls(c) {\n    var s = encode_cell(c);\n    if (c.cRel === 0) s = fix_col(s);\n    if (c.rRel === 0) s = fix_row(s);\n    return s;\n  }\n  function encode_range_xls(r) {\n    return encode_cell_xls(r.s) + \":\" + encode_cell_xls(r.e);\n  }\n  /* 2.5.217 */\n  function parse_RkNumber(data) {\n    var b = data.slice(data.l, data.l + 4);\n    var fX100 = b[0] & 1,\n      fInt = b[0] & 2;\n    data.l += 4;\n    b[0] &= 0xFC;\n    var RK = fInt === 0 ? __double([0, 0, 0, 0, b[0], b[1], b[2], b[3]], 0) : __readInt32LE(b, 0) >> 2;\n    return fX100 ? RK / 100 : RK;\n  }\n\n  /* 2.5.198.2 */\n  var BErr = {\n    0x00: \"#NULL!\",\n    0x07: \"#DIV/0!\",\n    0x0F: \"#VALUE!\",\n    0x17: \"#REF!\",\n    0x1D: \"#NAME?\",\n    0x24: \"#NUM!\",\n    0x2A: \"#N/A\",\n    0x2B: \"#GETTING_DATA\",\n    /* Noted in 2.5.10 but not in 2.5.198.2 */\n    0xFF: \"#WTF?\"\n  };\n  var RBErr = evert(BErr);\n\n  /* [MS-OLEPS] v20130118 */\n  /* [MS-OSHARED] v20130211 */\n\n  /* [MS-OLEPS] 2.2 PropertyType */\n  {\n    var VT_EMPTY = 0x0000;\n    var VT_NULL = 0x0001;\n    var VT_I2 = 0x0002;\n    var VT_I4 = 0x0003;\n    var VT_R4 = 0x0004;\n    var VT_R8 = 0x0005;\n    var VT_CY = 0x0006;\n    var VT_DATE = 0x0007;\n    var VT_BSTR = 0x0008;\n    var VT_ERROR = 0x000A;\n    var VT_BOOL = 0x000B;\n    var VT_VARIANT = 0x000C;\n    var VT_DECIMAL = 0x000E;\n    var VT_I1 = 0x0010;\n    var VT_UI1 = 0x0011;\n    var VT_UI2 = 0x0012;\n    var VT_UI4 = 0x0013;\n    var VT_I8 = 0x0014;\n    var VT_UI8 = 0x0015;\n    var VT_INT = 0x0016;\n    var VT_UINT = 0x0017;\n    var VT_LPSTR = 0x001E;\n    var VT_LPWSTR = 0x001F;\n    var VT_FILETIME = 0x0040;\n    var VT_BLOB = 0x0041;\n    var VT_STREAM = 0x0042;\n    var VT_STORAGE = 0x0043;\n    var VT_STREAMED_Object = 0x0044;\n    var VT_STORED_Object = 0x0045;\n    var VT_BLOB_Object = 0x0046;\n    var VT_CF = 0x0047;\n    var VT_CLSID = 0x0048;\n    var VT_VERSIONED_STREAM = 0x0049;\n    var VT_VECTOR = 0x1000;\n    var VT_ARRAY = 0x2000;\n    var VT_STRING = 0x0050; // 2.3.3.1.11 VtString\n    var VT_USTR = 0x0051; // 2.3.3.1.12 VtUnalignedString\n    var VT_CUSTOM = [VT_STRING, VT_USTR];\n  }\n\n  /* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\n  var DocSummaryPIDDSI = {\n    0x01: {\n      n: 'CodePage',\n      t: VT_I2\n    },\n    0x02: {\n      n: 'Category',\n      t: VT_STRING\n    },\n    0x03: {\n      n: 'PresentationFormat',\n      t: VT_STRING\n    },\n    0x04: {\n      n: 'ByteCount',\n      t: VT_I4\n    },\n    0x05: {\n      n: 'LineCount',\n      t: VT_I4\n    },\n    0x06: {\n      n: 'ParagraphCount',\n      t: VT_I4\n    },\n    0x07: {\n      n: 'SlideCount',\n      t: VT_I4\n    },\n    0x08: {\n      n: 'NoteCount',\n      t: VT_I4\n    },\n    0x09: {\n      n: 'HiddenCount',\n      t: VT_I4\n    },\n    0x0a: {\n      n: 'MultimediaClipCount',\n      t: VT_I4\n    },\n    0x0b: {\n      n: 'Scale',\n      t: VT_BOOL\n    },\n    0x0c: {\n      n: 'HeadingPair',\n      t: VT_VECTOR | VT_VARIANT\n    },\n    0x0d: {\n      n: 'DocParts',\n      t: VT_VECTOR | VT_LPSTR\n    },\n    0x0e: {\n      n: 'Manager',\n      t: VT_STRING\n    },\n    0x0f: {\n      n: 'Company',\n      t: VT_STRING\n    },\n    0x10: {\n      n: 'LinksDirty',\n      t: VT_BOOL\n    },\n    0x11: {\n      n: 'CharacterCount',\n      t: VT_I4\n    },\n    0x13: {\n      n: 'SharedDoc',\n      t: VT_BOOL\n    },\n    0x16: {\n      n: 'HLinksChanged',\n      t: VT_BOOL\n    },\n    0x17: {\n      n: 'AppVersion',\n      t: VT_I4,\n      p: 'version'\n    },\n    0x1A: {\n      n: 'ContentType',\n      t: VT_STRING\n    },\n    0x1B: {\n      n: 'ContentStatus',\n      t: VT_STRING\n    },\n    0x1C: {\n      n: 'Language',\n      t: VT_STRING\n    },\n    0x1D: {\n      n: 'Version',\n      t: VT_STRING\n    },\n    0xFF: {}\n  };\n\n  /* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\n  var SummaryPIDSI = {\n    0x01: {\n      n: 'CodePage',\n      t: VT_I2\n    },\n    0x02: {\n      n: 'Title',\n      t: VT_STRING\n    },\n    0x03: {\n      n: 'Subject',\n      t: VT_STRING\n    },\n    0x04: {\n      n: 'Author',\n      t: VT_STRING\n    },\n    0x05: {\n      n: 'Keywords',\n      t: VT_STRING\n    },\n    0x06: {\n      n: 'Comments',\n      t: VT_STRING\n    },\n    0x07: {\n      n: 'Template',\n      t: VT_STRING\n    },\n    0x08: {\n      n: 'LastAuthor',\n      t: VT_STRING\n    },\n    0x09: {\n      n: 'RevNumber',\n      t: VT_STRING\n    },\n    0x0A: {\n      n: 'EditTime',\n      t: VT_FILETIME\n    },\n    0x0B: {\n      n: 'LastPrinted',\n      t: VT_FILETIME\n    },\n    0x0C: {\n      n: 'CreatedDate',\n      t: VT_FILETIME\n    },\n    0x0D: {\n      n: 'ModifiedDate',\n      t: VT_FILETIME\n    },\n    0x0E: {\n      n: 'PageCount',\n      t: VT_I4\n    },\n    0x0F: {\n      n: 'WordCount',\n      t: VT_I4\n    },\n    0x10: {\n      n: 'CharCount',\n      t: VT_I4\n    },\n    0x11: {\n      n: 'Thumbnail',\n      t: VT_CF\n    },\n    0x12: {\n      n: 'ApplicationName',\n      t: VT_LPSTR\n    },\n    0x13: {\n      n: 'DocumentSecurity',\n      t: VT_I4\n    },\n    0xFF: {}\n  };\n\n  /* [MS-OLEPS] 2.18 */\n  var SpecialProperties = {\n    0x80000000: {\n      n: 'Locale',\n      t: VT_UI4\n    },\n    0x80000003: {\n      n: 'Behavior',\n      t: VT_UI4\n    },\n    0x69696969: {}\n  };\n  (function () {\n    for (var y in SpecialProperties) if (SpecialProperties.hasOwnProperty(y)) DocSummaryPIDDSI[y] = SummaryPIDSI[y] = SpecialProperties[y];\n  })();\n\n  /* 2.5.127 */\n  var FillPattern = [null, 'solid', 'mediumGray', 'darkGray', 'lightGray', 'darkHorizontal', 'darkVertical', 'darkDown', 'darkUp', 'darkGrid', 'darkTrellis', 'lightHorizontal', 'lightVertical', 'lightDown', 'lightUp', 'lightGrid', 'lightTrellis', 'gray125', 'gray0625'];\n  function rgbify(arr) {\n    return arr.map(function (x) {\n      return [x >> 16 & 255, x >> 8 & 255, x & 255];\n    });\n  }\n\n  /* 2.5.161 */\n  var Icv = rgbify([/* Color Constants */\n  0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF, /* Defaults */\n  0x000000, 0xFFFFFF, 0xFF0000, 0x00FF00, 0x0000FF, 0xFFFF00, 0xFF00FF, 0x00FFFF, 0x800000, 0x008000, 0x000080, 0x808000, 0x800080, 0x008080, 0xC0C0C0, 0x808080, 0x9999FF, 0x993366, 0xFFFFCC, 0xCCFFFF, 0x660066, 0xFF8080, 0x0066CC, 0xCCCCFF, 0x000080, 0xFF00FF, 0xFFFF00, 0x00FFFF, 0x800080, 0x800000, 0x008080, 0x0000FF, 0x00CCFF, 0xCCFFFF, 0xCCFFCC, 0xFFFF99, 0x99CCFF, 0xFF99CC, 0xCC99FF, 0xFFCC99, 0x3366FF, 0x33CCCC, 0x99CC00, 0xFFCC00, 0xFF9900, 0xFF6600, 0x666699, 0x969696, 0x003366, 0x339966, 0x003300, 0x333300, 0x993300, 0x993366, 0x333399, 0x333333, /* Sheet */\n  0xFFFFFF, 0x000000]);\n  function isval(x) {\n    return x !== undefined && x !== null;\n  }\n  function keys(o) {\n    return Object.keys(o);\n  }\n  function evert(obj, arr) {\n    var o = {};\n    var K = keys(obj);\n    for (var i = 0; i < K.length; ++i) {\n      var k = K[i];\n      if (!arr) o[obj[k]] = k;else (o[obj[k]] = o[obj[k]] || []).push(k);\n    }\n    return o;\n  }\n  function rgb2Hex(rgb) {\n    for (var i = 0, o = 1; i != 3; ++i) o = o * 256 + (rgb[i] > 255 ? 255 : rgb[i] < 0 ? 0 : rgb[i]);\n    return o.toString(16).toUpperCase().substr(1);\n  }\n\n  /* 2.5.19 */\n  function parse_Cell(blob, length) {\n    var rw = blob.read_shift(2); // 0-indexed\n    var col = blob.read_shift(2);\n    var ixfe = blob.read_shift(2);\n    return {\n      r: rw,\n      c: col,\n      ixfe: ixfe\n    };\n  }\n\n  /* 2.5.134 */\n  function parse_frtHeader(blob) {\n    var rt = blob.read_shift(2);\n    var flags = blob.read_shift(2); // TODO: parse these flags\n    blob.l += 8;\n    return {\n      type: rt,\n      flags: flags\n    };\n  }\n  function parse_OptXLUnicodeString(blob, length, opts) {\n    return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts);\n  }\n\n  /* 2.5.158 */\n  var HIDEOBJENUM = ['SHOWALL', 'SHOWPLACEHOLDER', 'HIDEALL'];\n  var parse_HideObjEnum = parseuint16;\n\n  /* 2.5.344 */\n  function parse_XTI(blob, length) {\n    var iSupBook = blob.read_shift(2),\n      itabFirst = blob.read_shift(2, 'i'),\n      itabLast = blob.read_shift(2, 'i');\n    return [iSupBook, itabFirst, itabLast];\n  }\n\n  /* 2.5.218 */\n  function parse_RkRec(blob, length) {\n    var ixfe = blob.read_shift(2);\n    var RK = parse_RkNumber(blob);\n    //console.log(\"::\", ixfe, RK,\";;\");\n    return [ixfe, RK];\n  }\n\n  /* 2.5.1 */\n  function parse_AddinUdf(blob, length, opts) {\n    blob.l += 4;\n    length -= 4;\n    var l = blob.l + length;\n    var udfName = parse_ShortXLUnicodeString(blob, length, opts);\n    var cb = blob.read_shift(2);\n    l -= blob.l;\n    if (cb !== l) throw \"Malformed AddinUdf: padding = \" + l + \" != \" + cb;\n    blob.l += cb;\n    return udfName;\n  }\n\n  /* 2.5.209 TODO: Check sizes */\n  function parse_Ref8U(blob, length) {\n    var rwFirst = blob.read_shift(2);\n    var rwLast = blob.read_shift(2);\n    var colFirst = blob.read_shift(2);\n    var colLast = blob.read_shift(2);\n    return {\n      s: {\n        c: colFirst,\n        r: rwFirst\n      },\n      e: {\n        c: colLast,\n        r: rwLast\n      }\n    };\n  }\n\n  /* 2.5.211 */\n  function parse_RefU(blob, length) {\n    var rwFirst = blob.read_shift(2);\n    var rwLast = blob.read_shift(2);\n    var colFirst = blob.read_shift(1);\n    var colLast = blob.read_shift(1);\n    return {\n      s: {\n        c: colFirst,\n        r: rwFirst\n      },\n      e: {\n        c: colLast,\n        r: rwLast\n      }\n    };\n  }\n\n  /* 2.5.207 */\n  var parse_Ref = parse_RefU;\n\n  /* 2.5.143 */\n  function parse_FtCmo(blob, length) {\n    blob.l += 4;\n    var ot = blob.read_shift(2);\n    var id = blob.read_shift(2);\n    var flags = blob.read_shift(2);\n    blob.l += 12;\n    return [id, ot, flags];\n  }\n\n  /* 2.5.149 */\n  function parse_FtNts(blob, length) {\n    var out = {};\n    blob.l += 4;\n    blob.l += 16; // GUID TODO\n    out.fSharedNote = blob.read_shift(2);\n    blob.l += 4;\n    return out;\n  }\n\n  /* 2.5.142 */\n  function parse_FtCf(blob, length) {\n    var out = {};\n    blob.l += 4;\n    blob.cf = blob.read_shift(2);\n    return out;\n  }\n\n  /* 2.5.140 - 2.5.154 and friends */\n  var FtTab = {\n    0x15: parse_FtCmo,\n    0x13: parsenoop,\n    /* FtLbsData */\n    0x12: function (blob, length) {\n      blob.l += 12;\n    },\n    /* FtCblsData */\n    0x11: function (blob, length) {\n      blob.l += 8;\n    },\n    /* FtRboData */\n    0x10: parsenoop,\n    /* FtEdoData */\n    0x0F: parsenoop,\n    /* FtGboData */\n    0x0D: parse_FtNts,\n    /* FtNts */\n    0x0C: function (blob, length) {\n      blob.l += 24;\n    },\n    /* FtSbs */\n    0x0B: function (blob, length) {\n      blob.l += 10;\n    },\n    /* FtRbo */\n    0x0A: function (blob, length) {\n      blob.l += 16;\n    },\n    /* FtCbls */\n    0x09: parsenoop,\n    /* FtPictFmla */\n    0x08: function (blob, length) {\n      blob.l += 6;\n    },\n    /* FtPioGrbit */\n    0x07: parse_FtCf,\n    /* FtCf */\n    0x06: function (blob, length) {\n      blob.l += 6;\n    },\n    /* FtGmo */\n    0x04: parsenoop,\n    /* FtMacro */\n    0x00: function (blob, length) {\n      blob.l += 4;\n    } /* FtEnding */\n  };\n\n  function parse_FtArray(blob, length, ot) {\n    var s = blob.l;\n    var fts = [];\n    while (blob.l < s + length) {\n      var ft = blob.read_shift(2);\n      blob.l -= 2;\n      try {\n        fts.push(FtTab[ft](blob, s + length - blob.l));\n      } catch (e) {\n        blob.l = s + length;\n        return fts;\n      }\n    }\n    if (blob.l != s + length) blob.l = s + length; //throw \"bad Object Ft-sequence\";\n    return fts;\n  }\n\n  /* 2.5.129 */\n  var parse_FontIndex = parseuint16;\n\n  /* --- 2.4 Records --- */\n\n  /* 2.4.21 */\n  function parse_BOF(blob, length) {\n    var o = {};\n    o.BIFFVer = blob.read_shift(2);\n    length -= 2;\n    switch (o.BIFFVer) {\n      case 0x0600: /* BIFF8 */\n      case 0x0500: /* BIFF5 */\n      case 0x0002:\n      case 0x0007:\n        /* BIFF2 */\n        break;\n      default:\n        if (length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n    }\n    blob.read_shift(length);\n    return o;\n  }\n\n  /* 2.4.146 */\n  function parse_InterfaceHdr(blob, length) {\n    if (length === 0) return 0x04b0;\n    var q;\n    if ((q = blob.read_shift(2)) !== 0x04b0) throw 'InterfaceHdr codePage ' + q;\n    return 0x04b0;\n  }\n\n  /* 2.4.349 */\n  function parse_WriteAccess(blob, length, opts) {\n    if (opts.enc) {\n      blob.l += length;\n      return \"\";\n    }\n    var l = blob.l;\n    // TODO: make sure XLUnicodeString doesnt overrun\n    var UserName = parse_XLUnicodeString(blob, 0, opts);\n    blob.read_shift(length + l - blob.l);\n    return UserName;\n  }\n\n  /* 2.4.28 */\n  function parse_BoundSheet8(blob, length, opts) {\n    var pos = blob.read_shift(4);\n    var hidden = blob.read_shift(1) & 0x03;\n    var dt = blob.read_shift(1);\n    switch (dt) {\n      case 0:\n        dt = 'Worksheet';\n        break;\n      case 1:\n        dt = 'Macrosheet';\n        break;\n      case 2:\n        dt = 'Chartsheet';\n        break;\n      case 6:\n        dt = 'VBAModule';\n        break;\n    }\n    var name = parse_ShortXLUnicodeString(blob, 0, opts);\n    if (name.length === 0) name = \"Sheet1\";\n    return {\n      pos: pos,\n      hs: hidden,\n      dt: dt,\n      name: name\n    };\n  }\n\n  /* 2.4.265 TODO */\n  function parse_SST(blob, length) {\n    var cnt = blob.read_shift(4);\n    var ucnt = blob.read_shift(4);\n    var strs = [];\n    for (var i = 0; i != ucnt; ++i) {\n      strs.push(parse_XLUnicodeRichExtendedString(blob));\n    }\n    strs.Count = cnt;\n    strs.Unique = ucnt;\n    return strs;\n  }\n\n  /* 2.4.107 */\n  function parse_ExtSST(blob, length) {\n    var extsst = {};\n    extsst.dsst = blob.read_shift(2);\n    blob.l += length - 2;\n    return extsst;\n  }\n\n  /* 2.4.221 TODO*/\n  function parse_Row(blob, length) {\n    var rw = blob.read_shift(2),\n      col = blob.read_shift(2),\n      Col = blob.read_shift(2),\n      rht = blob.read_shift(2);\n    blob.read_shift(4); // reserved(2), unused(2)\n    var flags = blob.read_shift(1); // various flags\n    blob.read_shift(1); // reserved\n    blob.read_shift(2); //ixfe, other flags\n    return {\n      r: rw,\n      c: col,\n      cnt: Col - col\n    };\n  }\n\n  /* 2.4.125 */\n  function parse_ForceFullCalculation(blob, length) {\n    var header = parse_frtHeader(blob);\n    if (header.type != 0x08A3) throw \"Invalid Future Record \" + header.type;\n    var fullcalc = blob.read_shift(4);\n    return fullcalc !== 0x0;\n  }\n  var parse_CompressPictures = parsenoop2; /* 2.4.55 Not interesting */\n\n  /* 2.4.215 rt */\n  function parse_RecalcId(blob, length) {\n    blob.read_shift(2);\n    return blob.read_shift(4);\n  }\n\n  /* 2.4.87 */\n  function parse_DefaultRowHeight(blob, length) {\n    var f = length == 4 ? blob.read_shift(2) : 0,\n      miyRw;\n    miyRw = blob.read_shift(2); // flags & 0x02 -> hidden, else empty\n    var fl = {\n      Unsynced: f & 1,\n      DyZero: (f & 2) >> 1,\n      ExAsc: (f & 4) >> 2,\n      ExDsc: (f & 8) >> 3\n    };\n    return [fl, miyRw];\n  }\n\n  /* 2.4.345 TODO */\n  function parse_Window1(blob, length) {\n    var xWn = blob.read_shift(2),\n      yWn = blob.read_shift(2),\n      dxWn = blob.read_shift(2),\n      dyWn = blob.read_shift(2);\n    var flags = blob.read_shift(2),\n      iTabCur = blob.read_shift(2),\n      iTabFirst = blob.read_shift(2);\n    var ctabSel = blob.read_shift(2),\n      wTabRatio = blob.read_shift(2);\n    return {\n      Pos: [xWn, yWn],\n      Dim: [dxWn, dyWn],\n      Flags: flags,\n      CurTab: iTabCur,\n      FirstTab: iTabFirst,\n      Selected: ctabSel,\n      TabRatio: wTabRatio\n    };\n  }\n\n  /* 2.4.122 TODO */\n  function parse_Font(blob, length, opts) {\n    blob.l += 14;\n    var name = parse_ShortXLUnicodeString(blob, 0, opts);\n    return name;\n  }\n\n  /* 2.4.149 */\n  function parse_LabelSst(blob, length) {\n    var cell = parse_Cell(blob);\n    cell.isst = blob.read_shift(4);\n    return cell;\n  }\n\n  /* 2.4.148 */\n  function parse_Label(blob, length, opts) {\n    var target = blob.l + length;\n    var cell = parse_Cell(blob, 6);\n    if (opts.biff == 2) blob.l++;\n    var str = parse_XLUnicodeString(blob, target - blob.l, opts);\n    cell.val = str;\n    return cell;\n  }\n\n  /* 2.4.126 Number Formats */\n  function parse_Format(blob, length, opts) {\n    var ifmt = blob.read_shift(2);\n    var fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n    return [ifmt, fmtstr];\n  }\n  var parse_BIFF2Format = parse_XLUnicodeString2;\n\n  /* 2.4.90 */\n  function parse_Dimensions(blob, length, opts) {\n    var end = blob.l + length;\n    var w = opts.biff == 8 || !opts.biff ? 4 : 2;\n    var r = blob.read_shift(w),\n      R = blob.read_shift(w),\n      c = blob.read_shift(2),\n      C = blob.read_shift(2);\n    blob.l = end;\n    return {\n      s: {\n        r: r,\n        c: c\n      },\n      e: {\n        r: R,\n        c: C\n      }\n    };\n  }\n\n  /* 2.4.220 */\n  function parse_RK(blob, length) {\n    var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n    var rkrec = parse_RkRec(blob);\n    return {\n      r: rw,\n      c: col,\n      ixfe: rkrec[0],\n      rknum: rkrec[1]\n    };\n  }\n\n  /* 2.4.175 */\n  function parse_MulRk(blob, length) {\n    var target = blob.l + length - 2;\n    var rw = blob.read_shift(2),\n      col = blob.read_shift(2);\n    var rkrecs = [];\n    while (blob.l < target) rkrecs.push(parse_RkRec(blob));\n    if (blob.l !== target) throw \"MulRK read error\";\n    var lastcol = blob.read_shift(2);\n    if (rkrecs.length != lastcol - col + 1) throw \"MulRK length mismatch\";\n    return {\n      r: rw,\n      c: col,\n      C: lastcol,\n      rkrec: rkrecs\n    };\n  }\n\n  /* 2.5.20 2.5.249 TODO */\n  function parse_CellStyleXF(blob, length, style) {\n    var o = {};\n    var a = blob.read_shift(4),\n      b = blob.read_shift(4);\n    var c = blob.read_shift(4),\n      d = blob.read_shift(2);\n    o.patternType = FillPattern[c >> 26];\n    o.icvFore = d & 0x7F;\n    o.icvBack = d >> 7 & 0x7F;\n    return o;\n  }\n  function parse_CellXF(blob, length) {\n    return parse_CellStyleXF(blob, length, 0);\n  }\n  function parse_StyleXF(blob, length) {\n    return parse_CellStyleXF(blob, length, 1);\n  }\n\n  /* 2.4.353 TODO: actually do this right */\n  function parse_XF(blob, length) {\n    var o = {};\n    o.ifnt = blob.read_shift(2);\n    o.ifmt = blob.read_shift(2);\n    o.flags = blob.read_shift(2);\n    o.fStyle = o.flags >> 2 & 0x01;\n    length -= 6;\n    o.data = parse_CellStyleXF(blob, length, o.fStyle);\n    return o;\n  }\n\n  /* 2.4.134 */\n  function parse_Guts(blob, length) {\n    blob.l += 4;\n    var out = [blob.read_shift(2), blob.read_shift(2)];\n    if (out[0] !== 0) out[0]--;\n    if (out[1] !== 0) out[1]--;\n    if (out[0] > 7 || out[1] > 7) throw \"Bad Gutters: \" + out.join(\"|\");\n    return out;\n  }\n\n  /* 2.4.24 */\n  function parse_BoolErr(blob, length, opts) {\n    var cell = parse_Cell(blob, 6);\n    if (opts.biff == 2) ++blob.l;\n    var val = parse_Bes(blob, 2);\n    cell.val = val;\n    cell.t = val === true || val === false ? 'b' : 'e';\n    return cell;\n  }\n\n  /* 2.4.180 Number */\n  function parse_Number(blob, length) {\n    var cell = parse_Cell(blob, 6);\n    var xnum = parse_Xnum(blob, 8);\n    cell.val = xnum;\n    return cell;\n  }\n  var parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n  /* 2.4.271 */\n  function parse_SupBook(blob, length, opts) {\n    var end = blob.l + length;\n    var ctab = blob.read_shift(2);\n    var cch = blob.read_shift(2);\n    var virtPath;\n    if (cch >= 0x01 && cch <= 0xff) virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n    var rgst = blob.read_shift(end - blob.l);\n    opts.sbcch = cch;\n    return [cch, ctab, virtPath, rgst];\n  }\n\n  /* 2.4.105 TODO */\n  function parse_ExternName(blob, length, opts) {\n    var flags = blob.read_shift(2);\n    var body;\n    var o = {\n      fBuiltIn: flags & 0x01,\n      fWantAdvise: flags >>> 1 & 0x01,\n      fWantPict: flags >>> 2 & 0x01,\n      fOle: flags >>> 3 & 0x01,\n      fOleLink: flags >>> 4 & 0x01,\n      cf: flags >>> 5 & 0x3FF,\n      fIcon: flags >>> 15 & 0x01\n    };\n    if (opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length - 2, opts);\n    //else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n    o.body = body || blob.read_shift(length - 2);\n    return o;\n  }\n\n  /* 2.4.150 TODO */\n  function parse_Lbl(blob, length, opts) {\n    var target = blob.l + length;\n    var flags = blob.read_shift(2);\n    var chKey = blob.read_shift(1);\n    var cch = blob.read_shift(1);\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    if (!opts || opts.biff >= 5) {\n      blob.l += 2;\n      var itab = blob.read_shift(2);\n      blob.l += 4;\n    }\n    var name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n    var npflen = target - blob.l;\n    if (opts && opts.biff == 2) --npflen;\n    var rgce = target == blob.l || cce == 0 ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n    return {\n      chKey: chKey,\n      Name: name,\n      rgce: rgce\n    };\n  }\n\n  /* 2.4.106 TODO: verify supbook manipulation */\n  function parse_ExternSheet(blob, length, opts) {\n    if (opts.biff < 8) return parse_ShortXLUnicodeString(blob, length, opts);\n    var o = parslurp2(blob, length, parse_XTI);\n    var oo = [];\n    if (opts.sbcch === 0x0401) {\n      for (var i = 0; i != o.length; ++i) oo.push(opts.snames[o[i][1]]);\n      return oo;\n    } else return o;\n  }\n\n  /* 2.4.260 */\n  function parse_ShrFmla(blob, length, opts) {\n    var ref = parse_RefU(blob, 6);\n    blob.l++;\n    var cUse = blob.read_shift(1);\n    length -= 8;\n    return [parse_SharedParsedFormula(blob, length, opts), cUse];\n  }\n\n  /* 2.4.4 TODO */\n  function parse_Array(blob, length, opts) {\n    var ref = parse_Ref(blob, 6);\n    /* TODO: fAlwaysCalc */\n    switch (opts.biff) {\n      case 2:\n        blob.l++;\n        length -= 7;\n        break;\n      case 3:\n      case 4:\n        blob.l += 2;\n        length -= 8;\n        break;\n      default:\n        blob.l += 6;\n        length -= 12;\n    }\n    return [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n  }\n\n  /* 2.4.173 */\n  function parse_MTRSettings(blob, length) {\n    var fMTREnabled = blob.read_shift(4) !== 0x00;\n    var fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n    var cUserThreadCount = blob.read_shift(4);\n    return [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n  }\n\n  /* 2.5.186 TODO: BIFF5 */\n  function parse_NoteSh(blob, length, opts) {\n    if (opts.biff < 8) return;\n    var row = blob.read_shift(2),\n      col = blob.read_shift(2);\n    var flags = blob.read_shift(2),\n      idObj = blob.read_shift(2);\n    var stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n    if (opts.biff < 8) blob.read_shift(1);\n    return [{\n      r: row,\n      c: col\n    }, stAuthor, idObj, flags];\n  }\n\n  /* 2.4.179 */\n  function parse_Note(blob, length, opts) {\n    /* TODO: Support revisions */\n    return parse_NoteSh(blob, length, opts);\n  }\n\n  /* 2.4.168 */\n  function parse_MergeCells(blob, length) {\n    var merges = [];\n    var cmcs = blob.read_shift(2);\n    while (cmcs--) merges.push(parse_Ref8U(blob, length));\n    return merges;\n  }\n\n  /* 2.4.181 TODO: parse all the things! */\n  function parse_Obj(blob, length) {\n    var cmo = parse_FtCmo(blob, 22); // id, ot, flags\n    var fts = parse_FtArray(blob, length - 22, cmo[1]);\n    return {\n      cmo: cmo,\n      ft: fts\n    };\n  }\n\n  /* 2.4.329 TODO: parse properly */\n  function parse_TxO(blob, length, opts) {\n    var s = blob.l;\n    var texts = \"\";\n    try {\n      blob.l += 4;\n      var ot = (opts.lastobj || {\n        cmo: [0, 0]\n      }).cmo[1];\n      var controlInfo;\n      if ([0, 5, 7, 11, 12, 14].indexOf(ot) == -1) blob.l += 6;else controlInfo = parse_ControlInfo(blob, 6, opts);\n      var cchText = blob.read_shift(2);\n      var cbRuns = blob.read_shift(2);\n      var ifntEmpty = parse_FontIndex(blob, 2);\n      var len = blob.read_shift(2);\n      blob.l += len;\n      //var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n      for (var i = 1; i < blob.lens.length - 1; ++i) {\n        if (blob.l - s != blob.lens[i]) throw \"TxO: bad continue record\";\n        var hdr = blob[blob.l];\n        var t = parse_XLUnicodeStringNoCch(blob, blob.lens[i + 1] - blob.lens[i] - 1);\n        texts += t;\n        if (texts.length >= (hdr ? cchText : 2 * cchText)) break;\n      }\n      if (texts.length !== cchText && texts.length !== cchText * 2) {\n        throw \"cchText: \" + cchText + \" != \" + texts.length;\n      }\n      blob.l = s + length;\n      /* 2.5.272 TxORuns */\n      //\tvar rgTxoRuns = [];\n      //\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n      //\tvar cchText2 = blob.read_shift(2);\n      //\tif(cchText2 !== cchText) throw \"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText;\n      //\tblob.l += 6;\n      //\tif(s + length != blob.l) throw \"TxO \" + (s + length) + \", at \" + blob.l;\n      return {\n        t: texts\n      };\n    } catch (e) {\n      blob.l = s + length;\n      return {\n        t: texts\n      };\n    }\n  }\n\n  /* 2.4.140 */\n  var parse_HLink = function (blob, length) {\n    var ref = parse_Ref8U(blob, 8);\n    blob.l += 16; /* CLSID */\n    var hlink = parse_Hyperlink(blob, length - 24);\n    return [ref, hlink];\n  };\n\n  /* 2.4.141 */\n  var parse_HLinkTooltip = function (blob, length) {\n    var end = blob.l + length;\n    blob.read_shift(2);\n    var ref = parse_Ref8U(blob, 8);\n    var wzTooltip = blob.read_shift((length - 10) / 2, 'dbcs-cont');\n    wzTooltip = wzTooltip.replace(chr0, \"\");\n    return [ref, wzTooltip];\n  };\n\n  /* 2.4.63 */\n  function parse_Country(blob, length) {\n    var o = [],\n      d;\n    d = blob.read_shift(2);\n    o[0] = CountryEnum[d] || d;\n    d = blob.read_shift(2);\n    o[1] = CountryEnum[d] || d;\n    return o;\n  }\n\n  /* 2.4.50 ClrtClient */\n  function parse_ClrtClient(blob, length) {\n    var ccv = blob.read_shift(2);\n    var o = [];\n    while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\n    return o;\n  }\n\n  /* 2.4.188 */\n  function parse_Palette(blob, length) {\n    var ccv = blob.read_shift(2);\n    var o = [];\n    while (ccv-- > 0) o.push(parse_LongRGB(blob, 8));\n    return o;\n  }\n\n  /* 2.4.354 */\n  function parse_XFCRC(blob, length) {\n    blob.l += 2;\n    var o = {\n      cxfs: 0,\n      crc: 0\n    };\n    o.cxfs = blob.read_shift(2);\n    o.crc = blob.read_shift(4);\n    return o;\n  }\n  var parse_Style = parsenoop;\n  var parse_StyleExt = parsenoop;\n  var parse_ColInfo = parsenoop;\n  var parse_Window2 = parsenoop;\n  var parse_Backup = parsebool; /* 2.4.14 */\n  var parse_Blank = parse_Cell; /* 2.4.20 Just the cell */\n  var parse_BottomMargin = parse_Xnum; /* 2.4.27 */\n  var parse_BuiltInFnGroupCount = parseuint16; /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */\n  var parse_CalcCount = parseuint16; /* 2.4.31 #Iterations */\n  var parse_CalcDelta = parse_Xnum; /* 2.4.32 */\n  var parse_CalcIter = parsebool; /* 2.4.33 1=iterative calc */\n  var parse_CalcMode = parseuint16; /* 2.4.34 0=manual, 1=auto (def), 2=table */\n  var parse_CalcPrecision = parsebool; /* 2.4.35 */\n  var parse_CalcRefMode = parsenoop2; /* 2.4.36 */\n  var parse_CalcSaveRecalc = parsebool; /* 2.4.37 */\n  var parse_CodePage = parseuint16; /* 2.4.52 */\n  var parse_Compat12 = parsebool; /* 2.4.54 true = no compatibility check */\n  var parse_Date1904 = parsebool; /* 2.4.77 - 1=1904,0=1900 */\n  var parse_DefColWidth = parseuint16; /* 2.4.89 */\n  var parse_DSF = parsenoop2; /* 2.4.94 -- MUST be ignored */\n  var parse_EntExU2 = parsenoop2; /* 2.4.102 -- Explicitly says to ignore */\n  var parse_EOF = parsenoop2; /* 2.4.103 */\n  var parse_Excel9File = parsenoop2; /* 2.4.104 -- Optional and unused */\n  var parse_FeatHdr = parsenoop2; /* 2.4.112 */\n  var parse_FontX = parseuint16; /* 2.4.123 */\n  var parse_Footer = parse_XLHeaderFooter; /* 2.4.124 */\n  var parse_GridSet = parseuint16; /* 2.4.132, =1 */\n  var parse_HCenter = parsebool; /* 2.4.135 sheet centered horizontal on print */\n  var parse_Header = parse_XLHeaderFooter; /* 2.4.136 */\n  var parse_HideObj = parse_HideObjEnum; /* 2.4.139 */\n  var parse_InterfaceEnd = parsenoop2; /* 2.4.145 -- noop */\n  var parse_LeftMargin = parse_Xnum; /* 2.4.151 */\n  var parse_Mms = parsenoop2; /* 2.4.169 -- Explicitly says to ignore */\n  var parse_ObjProtect = parsebool; /* 2.4.183 -- must be 1 if present */\n  var parse_Password = parseuint16; /* 2.4.191 */\n  var parse_PrintGrid = parsebool; /* 2.4.202 */\n  var parse_PrintRowCol = parsebool; /* 2.4.203 */\n  var parse_PrintSize = parseuint16; /* 2.4.204 0:3 */\n  var parse_Prot4Rev = parsebool; /* 2.4.205 */\n  var parse_Prot4RevPass = parseuint16; /* 2.4.206 */\n  var parse_Protect = parsebool; /* 2.4.207 */\n  var parse_RefreshAll = parsebool; /* 2.4.217 -- must be 0 if not template */\n  var parse_RightMargin = parse_Xnum; /* 2.4.219 */\n  var parse_RRTabId = parseuint16a; /* 2.4.241 */\n  var parse_ScenarioProtect = parsebool; /* 2.4.245 */\n  var parse_Scl = parseuint16a; /* 2.4.247 num, den */\n  var parse_String = parse_XLUnicodeString; /* 2.4.268 */\n  var parse_SxBool = parsebool; /* 2.4.274 */\n  var parse_TopMargin = parse_Xnum; /* 2.4.328 */\n  var parse_UsesELFs = parsebool; /* 2.4.337 -- should be 0 */\n  var parse_VCenter = parsebool; /* 2.4.342 */\n  var parse_WinProtect = parsebool; /* 2.4.347 */\n  var parse_WriteProtect = parsenoop; /* 2.4.350 empty record */\n\n  /* ---- */\n  var parse_VerticalPageBreaks = parsenoop;\n  var parse_HorizontalPageBreaks = parsenoop;\n  var parse_Selection = parsenoop;\n  var parse_Continue = parsenoop;\n  var parse_Pane = parsenoop;\n  var parse_Pls = parsenoop;\n  var parse_DCon = parsenoop;\n  var parse_DConRef = parsenoop;\n  var parse_DConName = parsenoop;\n  var parse_XCT = parsenoop;\n  var parse_CRN = parsenoop;\n  var parse_FileSharing = parsenoop;\n  var parse_Uncalced = parsenoop;\n  var parse_Template = parsenoop;\n  var parse_Intl = parsenoop;\n  var parse_WsBool = parsenoop;\n  var parse_Sort = parsenoop;\n  var parse_Sync = parsenoop;\n  var parse_LPr = parsenoop;\n  var parse_DxGCol = parsenoop;\n  var parse_FnGroupName = parsenoop;\n  var parse_FilterMode = parsenoop;\n  var parse_AutoFilterInfo = parsenoop;\n  var parse_AutoFilter = parsenoop;\n  var parse_Setup = parsenoop;\n  var parse_ScenMan = parsenoop;\n  var parse_SCENARIO = parsenoop;\n  var parse_SxView = parsenoop;\n  var parse_Sxvd = parsenoop;\n  var parse_SXVI = parsenoop;\n  var parse_SxIvd = parsenoop;\n  var parse_SXLI = parsenoop;\n  var parse_SXPI = parsenoop;\n  var parse_DocRoute = parsenoop;\n  var parse_RecipName = parsenoop;\n  var parse_MulBlank = parsenoop;\n  var parse_SXDI = parsenoop;\n  var parse_SXDB = parsenoop;\n  var parse_SXFDB = parsenoop;\n  var parse_SXDBB = parsenoop;\n  var parse_SXNum = parsenoop;\n  var parse_SxErr = parsenoop;\n  var parse_SXInt = parsenoop;\n  var parse_SXString = parsenoop;\n  var parse_SXDtr = parsenoop;\n  var parse_SxNil = parsenoop;\n  var parse_SXTbl = parsenoop;\n  var parse_SXTBRGIITM = parsenoop;\n  var parse_SxTbpg = parsenoop;\n  var parse_ObProj = parsenoop;\n  var parse_SXStreamID = parsenoop;\n  var parse_DBCell = parsenoop;\n  var parse_SXRng = parsenoop;\n  var parse_SxIsxoper = parsenoop;\n  var parse_BookBool = parsenoop;\n  var parse_DbOrParamQry = parsenoop;\n  var parse_OleObjectSize = parsenoop;\n  var parse_SXVS = parsenoop;\n  var parse_BkHim = parsenoop;\n  var parse_MsoDrawingGroup = parsenoop;\n  var parse_MsoDrawing = parsenoop;\n  var parse_MsoDrawingSelection = parsenoop;\n  var parse_PhoneticInfo = parsenoop;\n  var parse_SxRule = parsenoop;\n  var parse_SXEx = parsenoop;\n  var parse_SxFilt = parsenoop;\n  var parse_SxDXF = parsenoop;\n  var parse_SxItm = parsenoop;\n  var parse_SxName = parsenoop;\n  var parse_SxSelect = parsenoop;\n  var parse_SXPair = parsenoop;\n  var parse_SxFmla = parsenoop;\n  var parse_SxFormat = parsenoop;\n  var parse_SXVDEx = parsenoop;\n  var parse_SXFormula = parsenoop;\n  var parse_SXDBEx = parsenoop;\n  var parse_RRDInsDel = parsenoop;\n  var parse_RRDHead = parsenoop;\n  var parse_RRDChgCell = parsenoop;\n  var parse_RRDRenSheet = parsenoop;\n  var parse_RRSort = parsenoop;\n  var parse_RRDMove = parsenoop;\n  var parse_RRFormat = parsenoop;\n  var parse_RRAutoFmt = parsenoop;\n  var parse_RRInsertSh = parsenoop;\n  var parse_RRDMoveBegin = parsenoop;\n  var parse_RRDMoveEnd = parsenoop;\n  var parse_RRDInsDelBegin = parsenoop;\n  var parse_RRDInsDelEnd = parsenoop;\n  var parse_RRDConflict = parsenoop;\n  var parse_RRDDefName = parsenoop;\n  var parse_RRDRstEtxp = parsenoop;\n  var parse_LRng = parsenoop;\n  var parse_CUsr = parsenoop;\n  var parse_CbUsr = parsenoop;\n  var parse_UsrInfo = parsenoop;\n  var parse_UsrExcl = parsenoop;\n  var parse_FileLock = parsenoop;\n  var parse_RRDInfo = parsenoop;\n  var parse_BCUsrs = parsenoop;\n  var parse_UsrChk = parsenoop;\n  var parse_UserBView = parsenoop;\n  var parse_UserSViewBegin = parsenoop; // overloaded\n  var parse_UserSViewEnd = parsenoop;\n  var parse_RRDUserView = parsenoop;\n  var parse_Qsi = parsenoop;\n  var parse_CondFmt = parsenoop;\n  var parse_CF = parsenoop;\n  var parse_DVal = parsenoop;\n  var parse_DConBin = parsenoop;\n  var parse_Lel = parsenoop;\n  var parse_CodeName = parse_XLUnicodeString;\n  var parse_SXFDBType = parsenoop;\n  var parse_ObNoMacros = parsenoop;\n  var parse_Dv = parsenoop;\n  var parse_Index = parsenoop;\n  var parse_Table = parsenoop;\n  var parse_BigName = parsenoop;\n  var parse_ContinueBigName = parsenoop;\n  var parse_WebPub = parsenoop;\n  var parse_QsiSXTag = parsenoop;\n  var parse_DBQueryExt = parsenoop;\n  var parse_ExtString = parsenoop;\n  var parse_TxtQry = parsenoop;\n  var parse_Qsir = parsenoop;\n  var parse_Qsif = parsenoop;\n  var parse_RRDTQSIF = parsenoop;\n  var parse_OleDbConn = parsenoop;\n  var parse_WOpt = parsenoop;\n  var parse_SXViewEx = parsenoop;\n  var parse_SXTH = parsenoop;\n  var parse_SXPIEx = parsenoop;\n  var parse_SXVDTEx = parsenoop;\n  var parse_SXViewEx9 = parsenoop;\n  var parse_ContinueFrt = parsenoop;\n  var parse_RealTimeData = parsenoop;\n  var parse_ChartFrtInfo = parsenoop;\n  var parse_FrtWrapper = parsenoop;\n  var parse_StartBlock = parsenoop;\n  var parse_EndBlock = parsenoop;\n  var parse_StartObject = parsenoop;\n  var parse_EndObject = parsenoop;\n  var parse_CatLab = parsenoop;\n  var parse_YMult = parsenoop;\n  var parse_SXViewLink = parsenoop;\n  var parse_PivotChartBits = parsenoop;\n  var parse_FrtFontList = parsenoop;\n  var parse_SheetExt = parsenoop;\n  var parse_BookExt = parsenoop;\n  var parse_SXAddl = parsenoop;\n  var parse_CrErr = parsenoop;\n  var parse_HFPicture = parsenoop;\n  var parse_Feat = parsenoop;\n  var parse_DataLabExt = parsenoop;\n  var parse_DataLabExtContents = parsenoop;\n  var parse_CellWatch = parsenoop;\n  var parse_FeatHdr11 = parsenoop;\n  var parse_Feature11 = parsenoop;\n  var parse_DropDownObjIds = parsenoop;\n  var parse_ContinueFrt11 = parsenoop;\n  var parse_DConn = parsenoop;\n  var parse_List12 = parsenoop;\n  var parse_Feature12 = parsenoop;\n  var parse_CondFmt12 = parsenoop;\n  var parse_CF12 = parsenoop;\n  var parse_CFEx = parsenoop;\n  var parse_AutoFilter12 = parsenoop;\n  var parse_ContinueFrt12 = parsenoop;\n  var parse_MDTInfo = parsenoop;\n  var parse_MDXStr = parsenoop;\n  var parse_MDXTuple = parsenoop;\n  var parse_MDXSet = parsenoop;\n  var parse_MDXProp = parsenoop;\n  var parse_MDXKPI = parsenoop;\n  var parse_MDB = parsenoop;\n  var parse_PLV = parsenoop;\n  var parse_DXF = parsenoop;\n  var parse_TableStyles = parsenoop;\n  var parse_TableStyle = parsenoop;\n  var parse_TableStyleElement = parsenoop;\n  var parse_NamePublish = parsenoop;\n  var parse_NameCmt = parsenoop;\n  var parse_SortData = parsenoop;\n  var parse_GUIDTypeLib = parsenoop;\n  var parse_FnGrp12 = parsenoop;\n  var parse_NameFnGrp12 = parsenoop;\n  var parse_HeaderFooter = parsenoop;\n  var parse_CrtLayout12 = parsenoop;\n  var parse_CrtMlFrt = parsenoop;\n  var parse_CrtMlFrtContinue = parsenoop;\n  var parse_ShapePropsStream = parsenoop;\n  var parse_TextPropsStream = parsenoop;\n  var parse_RichTextStream = parsenoop;\n  var parse_CrtLayout12A = parsenoop;\n  var parse_Units = parsenoop;\n  var parse_Chart = parsenoop;\n  var parse_Series = parsenoop;\n  var parse_DataFormat = parsenoop;\n  var parse_LineFormat = parsenoop;\n  var parse_MarkerFormat = parsenoop;\n  var parse_AreaFormat = parsenoop;\n  var parse_PieFormat = parsenoop;\n  var parse_AttachedLabel = parsenoop;\n  var parse_SeriesText = parsenoop;\n  var parse_ChartFormat = parsenoop;\n  var parse_Legend = parsenoop;\n  var parse_SeriesList = parsenoop;\n  var parse_Bar = parsenoop;\n  var parse_Line = parsenoop;\n  var parse_Pie = parsenoop;\n  var parse_Area = parsenoop;\n  var parse_Scatter = parsenoop;\n  var parse_CrtLine = parsenoop;\n  var parse_Axis = parsenoop;\n  var parse_Tick = parsenoop;\n  var parse_ValueRange = parsenoop;\n  var parse_CatSerRange = parsenoop;\n  var parse_AxisLine = parsenoop;\n  var parse_CrtLink = parsenoop;\n  var parse_DefaultText = parsenoop;\n  var parse_Text = parsenoop;\n  var parse_ObjectLink = parsenoop;\n  var parse_Frame = parsenoop;\n  var parse_Begin = parsenoop;\n  var parse_End = parsenoop;\n  var parse_PlotArea = parsenoop;\n  var parse_Chart3d = parsenoop;\n  var parse_PicF = parsenoop;\n  var parse_DropBar = parsenoop;\n  var parse_Radar = parsenoop;\n  var parse_Surf = parsenoop;\n  var parse_RadarArea = parsenoop;\n  var parse_AxisParent = parsenoop;\n  var parse_LegendException = parsenoop;\n  var parse_ShtProps = parsenoop;\n  var parse_SerToCrt = parsenoop;\n  var parse_AxesUsed = parsenoop;\n  var parse_SBaseRef = parsenoop;\n  var parse_SerParent = parsenoop;\n  var parse_SerAuxTrend = parsenoop;\n  var parse_IFmtRecord = parsenoop;\n  var parse_Pos = parsenoop;\n  var parse_AlRuns = parsenoop;\n  var parse_BRAI = parsenoop;\n  var parse_SerAuxErrBar = parsenoop;\n  var parse_SerFmt = parsenoop;\n  var parse_Chart3DBarShape = parsenoop;\n  var parse_Fbi = parsenoop;\n  var parse_BopPop = parsenoop;\n  var parse_AxcExt = parsenoop;\n  var parse_Dat = parsenoop;\n  var parse_PlotGrowth = parsenoop;\n  var parse_SIIndex = parsenoop;\n  var parse_GelFrame = parsenoop;\n  var parse_BopPopCustom = parsenoop;\n  var parse_Fbi2 = parsenoop;\n\n  /* --- Specific to versions before BIFF8 --- */\n  function parse_BIFF5String(blob) {\n    var len = blob.read_shift(1);\n    return blob.read_shift(len, 'sbcs-cont');\n  }\n\n  /* BIFF2_??? where ??? is the name from [XLS] */\n  function parse_BIFF2STR(blob, length, opts) {\n    var cell = parse_Cell(blob, 6);\n    ++blob.l;\n    var str = parse_XLUnicodeString2(blob, length - 7, opts);\n    cell.t = 'str';\n    cell.val = str;\n    return cell;\n  }\n  function parse_BIFF2NUM(blob, length, opts) {\n    var cell = parse_Cell(blob, 6);\n    ++blob.l;\n    var num = parse_Xnum(blob, 8);\n    cell.t = 'n';\n    cell.val = num;\n    return cell;\n  }\n  function parse_BIFF2INT(blob, length) {\n    var cell = parse_Cell(blob, 6);\n    ++blob.l;\n    var num = blob.read_shift(2);\n    cell.t = 'n';\n    cell.val = num;\n    return cell;\n  }\n  function parse_BIFF2STRING(blob, length) {\n    var cch = blob.read_shift(1);\n    if (cch === 0) {\n      blob.l++;\n      return \"\";\n    }\n    return blob.read_shift(cch, 'sbcs-cont');\n  }\n\n  /* TODO: convert to BIFF8 font struct */\n  function parse_BIFF2FONTXTRA(blob, length) {\n    blob.l += 6; // unknown\n    blob.l += 2; // font weight \"bls\"\n    blob.l += 1; // charset\n    blob.l += 3; // unknown\n    blob.l += 1; // font family\n    blob.l += length - 9;\n  }\n\n  /* TODO: parse rich text runs */\n  function parse_RString(blob, length, opts) {\n    var end = blob.l + length;\n    var cell = parse_Cell(blob, 6);\n    var cch = blob.read_shift(2);\n    var str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n    blob.l = end;\n    cell.t = 'str';\n    cell.val = str;\n    return cell;\n  }\n  var _chr = function (c) {\n    return String.fromCharCode(c);\n  };\n  var attregexg = /([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\n  var attregex = /([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\n  function parsexmltag(tag, skip_root) {\n    var words = tag.split(/\\s+/);\n    var z = [];\n    if (!skip_root) z[0] = words[0];\n    if (words.length === 1) return z;\n    var m = tag.match(attregexg),\n      y,\n      j,\n      w,\n      i;\n    if (m) for (i = 0; i != m.length; ++i) {\n      y = m[i].match(attregex);\n      if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1, y[2].length - 2);else {\n        if (y[1].substr(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].substr(6);else w = y[1].substr(j + 1);\n        z[w] = y[2].substr(1, y[2].length - 2);\n      }\n    }\n    return z;\n  }\n  function parsexmltagobj(tag) {\n    var words = tag.split(/\\s+/);\n    var z = {};\n    if (words.length === 1) return z;\n    var m = tag.match(attregexg),\n      y,\n      j,\n      w,\n      i;\n    if (m) for (i = 0; i != m.length; ++i) {\n      y = m[i].match(attregex);\n      if ((j = y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1, y[2].length - 2);else {\n        if (y[1].substr(0, 6) === \"xmlns:\") w = \"xmlns\" + y[1].substr(6);else w = y[1].substr(j + 1);\n        z[w] = y[2].substr(1, y[2].length - 2);\n      }\n    }\n    return z;\n  }\n  var encodings = {\n    '&quot;': '\"',\n    '&apos;': \"'\",\n    '&gt;': '>',\n    '&lt;': '<',\n    '&amp;': '&'\n  };\n  var rencoding = evert(encodings);\n  var rencstr = \"&<>'\\\"\".split(\"\");\n  var XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\n  var OFFCRYPTO = {};\n  var make_offcrypto = function (O, _crypto) {\n    var crypto;\n    if (typeof _crypto !== 'undefined') crypto = _crypto;else if (typeof require !== 'undefined') {\n      try {\n        crypto = require('cry' + 'pto');\n      } catch (e) {\n        crypto = null;\n      }\n    }\n    O.rc4 = function (key, data) {\n      var S = new Array(256);\n      var c = 0,\n        i = 0,\n        j = 0,\n        t = 0;\n      for (i = 0; i != 256; ++i) S[i] = i;\n      for (i = 0; i != 256; ++i) {\n        j = j + S[i] + key[i % key.length].charCodeAt(0) & 255;\n        t = S[i];\n        S[i] = S[j];\n        S[j] = t;\n      }\n      i = j = 0;\n      out = Buffer(data.length);\n      for (c = 0; c != data.length; ++c) {\n        i = i + 1 & 255;\n        j = (j + S[i]) % 256;\n        t = S[i];\n        S[i] = S[j];\n        S[j] = t;\n        out[c] = data[c] ^ S[S[i] + S[j] & 255];\n      }\n      return out;\n    };\n    O.md5 = function (hex) {\n      if (!crypto) throw new Error(\"Unsupported crypto\");\n      return crypto.createHash('md5').update(hex).digest('hex');\n    };\n  };\n  make_offcrypto(OFFCRYPTO, typeof crypto !== \"undefined\" ? crypto : undefined);\n  function _JS2ANSI(str) {\n    if (typeof cptable !== 'undefined') return cptable.utils.encode(1252, str);\n    var o = [],\n      oo = str.split(\"\");\n    for (var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.1.4 Version */\n  function parse_Version(blob, length) {\n    var o = {};\n    o.Major = blob.read_shift(2);\n    o.Minor = blob.read_shift(2);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\n  function parse_EncryptionHeader(blob, length) {\n    var o = {};\n    o.Flags = blob.read_shift(4);\n\n    // Check if SizeExtra is 0x00000000\n    var tmp = blob.read_shift(4);\n    if (tmp !== 0) throw 'Unrecognized SizeExtra: ' + tmp;\n    o.AlgID = blob.read_shift(4);\n    switch (o.AlgID) {\n      case 0:\n      case 0x6801:\n      case 0x660E:\n      case 0x660F:\n      case 0x6610:\n        break;\n      default:\n        throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n    }\n    parsenoop(blob, length - 12);\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\n  function parse_EncryptionVerifier(blob, length) {\n    return parsenoop(blob, length);\n  }\n  /* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\n  function parse_RC4CryptoHeader(blob, length) {\n    var o = {};\n    var vers = o.EncryptionVersionInfo = parse_Version(blob, 4);\n    length -= 4;\n    if (vers.Minor != 2) throw 'unrecognized minor version code: ' + vers.Minor;\n    if (vers.Major > 4 || vers.Major < 2) throw 'unrecognized major version code: ' + vers.Major;\n    o.Flags = blob.read_shift(4);\n    length -= 4;\n    var sz = blob.read_shift(4);\n    length -= 4;\n    o.EncryptionHeader = parse_EncryptionHeader(blob, sz);\n    length -= sz;\n    o.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n    return o;\n  }\n  /* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\n  function parse_RC4Header(blob, length) {\n    var o = {};\n    var vers = o.EncryptionVersionInfo = parse_Version(blob, 4);\n    length -= 4;\n    if (vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n    o.Salt = blob.read_shift(16);\n    o.EncryptedVerifier = blob.read_shift(16);\n    o.EncryptedVerifierHash = blob.read_shift(16);\n    return o;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\n  function crypto_CreatePasswordVerifier_Method1(Password) {\n    var Verifier = 0x0000,\n      PasswordArray;\n    var PasswordDecoded = _JS2ANSI(Password);\n    var len = PasswordDecoded.length + 1,\n      i,\n      PasswordByte;\n    var Intermediate1, Intermediate2, Intermediate3;\n    PasswordArray = new_raw_buf(len);\n    PasswordArray[0] = PasswordDecoded.length;\n    for (i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i - 1];\n    for (i = len - 1; i >= 0; --i) {\n      PasswordByte = PasswordArray[i];\n      Intermediate1 = (Verifier & 0x4000) === 0x0000 ? 0 : 1;\n      Intermediate2 = Verifier << 1 & 0x7FFF;\n      Intermediate3 = Intermediate1 | Intermediate2;\n      Verifier = Intermediate3 ^ PasswordByte;\n    }\n    return Verifier ^ 0xCE4B;\n  }\n\n  /* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\n  var crypto_CreateXorArray_Method1 = function () {\n    var PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n    var InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n    var XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n    var Ror = function (Byte) {\n      return (Byte / 2 | Byte * 128) & 0xFF;\n    };\n    var XorRor = function (byte1, byte2) {\n      return Ror(byte1 ^ byte2);\n    };\n    var CreateXorKey_Method1 = function (Password) {\n      var XorKey = InitialCode[Password.length - 1];\n      var CurrentElement = 0x68;\n      for (var i = Password.length - 1; i >= 0; --i) {\n        var Char = Password[i];\n        for (var j = 0; j != 7; ++j) {\n          if (Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n          Char *= 2;\n          --CurrentElement;\n        }\n      }\n      return XorKey;\n    };\n    return function (password) {\n      var Password = _JS2ANSI(password);\n      var XorKey = CreateXorKey_Method1(Password);\n      var Index = Password.length;\n      var ObfuscationArray = new_raw_buf(16);\n      for (var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n      var Temp, PasswordLastChar, PadIndex;\n      if ((Index & 1) === 1) {\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n        --Index;\n        Temp = XorKey & 0xFF;\n        PasswordLastChar = Password[Password.length - 1];\n        ObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n      }\n      while (Index > 0) {\n        --Index;\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n        --Index;\n        Temp = XorKey & 0xFF;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n      }\n      Index = 15;\n      PadIndex = 15 - Password.length;\n      while (PadIndex > 0) {\n        Temp = XorKey >> 8;\n        ObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n        --Index;\n        --PadIndex;\n        Temp = XorKey & 0xFF;\n        ObfuscationArray[Index] = XorRor(Password[Index], Temp);\n        --Index;\n        --PadIndex;\n      }\n      return ObfuscationArray;\n    };\n  }();\n\n  /* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\n  var crypto_DecryptData_Method1 = function (password, Data, XorArrayIndex, XorArray, O) {\n    /* If XorArray is set, use it; if O is not set, make changes in-place */\n    if (!O) O = Data;\n    if (!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n    var Index, Value;\n    for (Index = 0; Index != Data.length; ++Index) {\n      Value = Data[Index];\n      Value ^= XorArray[XorArrayIndex];\n      Value = (Value >> 5 | Value << 3) & 0xFF;\n      O[Index] = Value;\n      ++XorArrayIndex;\n    }\n    return [O, XorArrayIndex, XorArray];\n  };\n  var crypto_MakeXorDecryptor = function (password) {\n    var XorArrayIndex = 0,\n      XorArray = crypto_CreateXorArray_Method1(password);\n    return function (Data) {\n      var O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n      XorArrayIndex = O[1];\n      return O[0];\n    };\n  };\n\n  /* 2.5.343 */\n  function parse_XORObfuscation(blob, length, opts, out) {\n    var o = {\n      key: parseuint16(blob),\n      verificationBytes: parseuint16(blob)\n    };\n    if (opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n    out.valid = o.verificationBytes === o.verifier;\n    if (out.valid) out.insitu_decrypt = crypto_MakeXorDecryptor(opts.password);\n    return o;\n  }\n\n  /* 2.4.117 */\n  function parse_FilePassHeader(blob, length, oo) {\n    var o = oo || {};\n    o.Info = blob.read_shift(2);\n    blob.l -= 2;\n    if (o.Info === 1) o.Data = parse_RC4Header(blob, length);else o.Data = parse_RC4CryptoHeader(blob, length);\n    return o;\n  }\n  function parse_FilePass(blob, length, opts) {\n    var o = {\n      Type: blob.read_shift(2)\n    }; /* wEncryptionType */\n    if (o.Type) parse_FilePassHeader(blob, length - 2, o);else parse_XORObfuscation(blob, length - 2, opts, o);\n    return o;\n  }\n\n  /* Small helpers */\n  function parseread(l) {\n    return function (blob, length) {\n      blob.l += l;\n      return;\n    };\n  }\n  function parseread1(blob, length) {\n    blob.l += 1;\n    return;\n  }\n\n  /* Rgce Helpers */\n\n  /* 2.5.51 */\n  function parse_ColRelU(blob, length) {\n    var c = blob.read_shift(length == 1 ? 1 : 2);\n    return [c & 0x3FFF, c >> 14 & 1, c >> 15 & 1];\n  }\n\n  /* 2.5.198.105 */\n  function parse_RgceArea(blob, length, opts) {\n    var w = 2;\n    if (opts) {\n      if (opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);\n    }\n    var r = blob.read_shift(w),\n      R = blob.read_shift(w);\n    var c = parse_ColRelU(blob, 2);\n    var C = parse_ColRelU(blob, 2);\n    return {\n      s: {\n        r: r,\n        c: c[0],\n        cRel: c[1],\n        rRel: c[2]\n      },\n      e: {\n        r: R,\n        c: C[0],\n        cRel: C[1],\n        rRel: C[2]\n      }\n    };\n  }\n  /* BIFF 2-5 encodes flags in the row field */\n  function parse_RgceArea_BIFF2(blob, length, opts) {\n    var r = parse_ColRelU(blob, 2),\n      R = parse_ColRelU(blob, 2);\n    var c = blob.read_shift(1);\n    var C = blob.read_shift(1);\n    return {\n      s: {\n        r: r[0],\n        c: c,\n        cRel: r[1],\n        rRel: r[2]\n      },\n      e: {\n        r: R[0],\n        c: C,\n        cRel: R[1],\n        rRel: R[2]\n      }\n    };\n  }\n\n  /* 2.5.198.105 TODO */\n  function parse_RgceAreaRel(blob, length) {\n    var r = blob.read_shift(2),\n      R = blob.read_shift(2);\n    var c = parse_ColRelU(blob, 2);\n    var C = parse_ColRelU(blob, 2);\n    return {\n      s: {\n        r: r,\n        c: c[0],\n        cRel: c[1],\n        rRel: c[2]\n      },\n      e: {\n        r: R,\n        c: C[0],\n        cRel: C[1],\n        rRel: C[2]\n      }\n    };\n  }\n\n  /* 2.5.198.109 */\n  function parse_RgceLoc(blob, length, opts) {\n    if (opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\n    var r = blob.read_shift(2);\n    var c = parse_ColRelU(blob, 2);\n    return {\n      r: r,\n      c: c[0],\n      cRel: c[1],\n      rRel: c[2]\n    };\n  }\n  function parse_RgceLoc_BIFF2(blob, length, opts) {\n    var r = parse_ColRelU(blob, 2);\n    var c = blob.read_shift(1);\n    return {\n      r: r[0],\n      c: c,\n      cRel: r[1],\n      rRel: r[2]\n    };\n  }\n\n  /* 2.5.198.111 */\n  function parse_RgceLocRel(blob, length, opts) {\n    var biff = opts && opts.biff ? opts.biff : 8;\n    if (biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\n    var r = blob.read_shift(2);\n    var cl = blob.read_shift(2);\n    var cRel = (cl & 0x8000) >> 15,\n      rRel = (cl & 0x4000) >> 14;\n    cl &= 0x3FFF;\n    if (rRel == 1) while (r > 0x7FFFF) r -= 0x100000;\n    if (cRel == 1) while (cl > 0x1FFF) cl = cl - 0x4000;\n    return {\n      r: r,\n      c: cl,\n      cRel: cRel,\n      rRel: rRel\n    };\n  }\n  function parse_RgceLocRel_BIFF2(blob, length) {\n    var rl = blob.read_shift(2);\n    var c = blob.read_shift(1);\n    var rRel = (rl & 0x8000) >> 15,\n      cRel = (rl & 0x4000) >> 14;\n    rl &= 0x3FFF;\n    if (rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n    if (cRel == 1 && c >= 0x80) c = c - 0x100;\n    return {\n      r: rl,\n      c: c,\n      cRel: cRel,\n      rRel: rRel\n    };\n  }\n\n  /* Ptg Tokens */\n\n  /* 2.5.198.27 */\n  function parse_PtgArea(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n    return [type, area];\n  }\n\n  /* 2.5.198.28 */\n  function parse_PtgArea3d(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2, 'i');\n    var w = 8;\n    if (opts) switch (opts.biff) {\n      case 5:\n        blob.l += 12;\n        w = 6;\n        break;\n    }\n    var area = parse_RgceArea(blob, w, opts);\n    return [type, ixti, area];\n  }\n\n  /* 2.5.198.29 */\n  function parse_PtgAreaErr(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    blob.l += 8;\n    return [type];\n  }\n  /* 2.5.198.30 */\n  function parse_PtgAreaErr3d(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var ixti = blob.read_shift(2);\n    var w = 8;\n    if (opts) switch (opts.biff) {\n      case 5:\n        blob.l += 12;\n        w = 6;\n        break;\n    }\n    blob.l += w;\n    return [type, ixti];\n  }\n\n  /* 2.5.198.31 */\n  function parse_PtgAreaN(blob, length) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    var area = parse_RgceAreaRel(blob, 8);\n    return [type, area];\n  }\n\n  /* 2.5.198.32 -- ignore this and look in PtgExtraArray for shape + values */\n  function parse_PtgArray(blob, length, opts) {\n    var type = (blob[blob.l++] & 0x60) >> 5;\n    blob.l += opts.biff == 2 ? 6 : 7;\n    return [type];\n  }\n\n  /* 2.5.198.33 */\n  function parse_PtgAttrBaxcel(blob, length) {\n    var bitSemi = blob[blob.l + 1] & 0x01; /* 1 = volatile */\n    var bitBaxcel = 1;\n    blob.l += 4;\n    return [bitSemi, bitBaxcel];\n  }\n\n  /* 2.5.198.34 */\n  function parse_PtgAttrChoose(blob, length, opts) {\n    blob.l += 2;\n    var offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    var o = [];\n    /* offset is 1 less than the number of elements */\n    for (var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n    return o;\n  }\n\n  /* 2.5.198.35 */\n  function parse_PtgAttrGoto(blob, length, opts) {\n    var bitGoto = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n  }\n\n  /* 2.5.198.36 */\n  function parse_PtgAttrIf(blob, length, opts) {\n    var bitIf = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += 2;\n    return [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n  }\n\n  /* 2.5.198.37 */\n  function parse_PtgAttrSemi(blob, length, opts) {\n    var bitSemi = blob[blob.l + 1] & 0xFF ? 1 : 0;\n    blob.l += opts && opts.biff == 2 ? 3 : 4;\n    return [bitSemi];\n  }\n\n  /* 2.5.198.40 (used by PtgAttrSpace and PtgAttrSpaceSemi) */\n  function parse_PtgAttrSpaceType(blob, length) {\n    var type = blob.read_shift(1),\n      cch = blob.read_shift(1);\n    return [type, cch];\n  }\n\n  /* 2.5.198.38 */\n  function parse_PtgAttrSpace(blob, length) {\n    blob.read_shift(2);\n    return parse_PtgAttrSpaceType(blob, 2);\n  }\n\n  /* 2.5.198.39 */\n  function parse_PtgAttrSpaceSemi(blob, length) {\n    blob.read_shift(2);\n    return parse_PtgAttrSpaceType(blob, 2);\n  }\n\n  /* 2.5.198.84 TODO */\n  function parse_PtgRef(blob, length, opts) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var loc = parse_RgceLoc(blob, 4, opts);\n    return [type, loc];\n  }\n\n  /* 2.5.198.88 TODO */\n  function parse_PtgRefN(blob, length, opts) {\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var loc = parse_RgceLocRel(blob, 4, opts);\n    return [type, loc];\n  }\n\n  /* 2.5.198.85 TODO */\n  function parse_PtgRef3d(blob, length, opts) {\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var ixti = blob.read_shift(2); // XtiIndex\n    var loc = parse_RgceLoc(blob, 0, opts);\n    return [type, ixti, loc];\n  }\n\n  /* 2.5.198.62 TODO */\n  function parse_PtgFunc(blob, length, opts) {\n    var ptg = blob[blob.l] & 0x1F;\n    var type = (blob[blob.l] & 0x60) >> 5;\n    blob.l += 1;\n    var iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n    return [FtabArgc[iftab], Ftab[iftab], type];\n  }\n  /* 2.5.198.63 TODO */\n  function parse_PtgFuncVar(blob, length, opts) {\n    blob.l++;\n    var cparams = blob.read_shift(1),\n      tab = opts && opts.biff <= 3 ? [0, blob.read_shift(1)] : parsetab(blob);\n    return [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n  }\n  function parsetab(blob, length) {\n    return [blob[blob.l + 1] >> 7, blob.read_shift(2) & 0x7FFF];\n  }\n\n  /* 2.5.198.41 */\n  function parse_PtgAttrSum(blob, length, opts) {\n    blob.l += opts && opts.biff == 2 ? 3 : 4;\n    return;\n  }\n\n  /* 2.5.198.43 */\n  var parse_PtgConcat = parseread1;\n\n  /* 2.5.198.58 */\n  function parse_PtgExp(blob, length, opts) {\n    blob.l++;\n    var row = blob.read_shift(2);\n    var col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    return [row, col];\n  }\n\n  /* 2.5.198.57 */\n  function parse_PtgErr(blob, length) {\n    blob.l++;\n    return BErr[blob.read_shift(1)];\n  }\n\n  /* 2.5.198.66 TODO */\n  function parse_PtgInt(blob, length) {\n    blob.l++;\n    return blob.read_shift(2);\n  }\n\n  /* 2.5.198.42 */\n  function parse_PtgBool(blob, length) {\n    blob.l++;\n    return blob.read_shift(1) !== 0;\n  }\n\n  /* 2.5.198.79 */\n  function parse_PtgNum(blob, length) {\n    blob.l++;\n    return parse_Xnum(blob, 8);\n  }\n\n  /* 2.5.198.89 */\n  function parse_PtgStr(blob, length, opts) {\n    blob.l++;\n    return parse_ShortXLUnicodeString(blob, length - 1, opts);\n  }\n\n  /* 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\n  function parse_SerAr(blob, biff) {\n    var val = [blob.read_shift(1)];\n    switch (val[0]) {\n      /* 2.5.192.113 */\n      case 0x04:\n        /* SerBool -- boolean */\n        val[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n        blob.l += 7;\n        break;\n      /* 2.5.192.114 */\n      case 0x10:\n        /* SerErr -- error */\n        val[1] = BErr[blob[blob.l]];\n        blob.l += 8;\n        break;\n      /* 2.5.192.115 */\n      case 0x00:\n        /* SerNil -- honestly, I'm not sure how to reproduce this */\n        blob.l += 8;\n        break;\n      /* 2.5.192.116 */\n      case 0x01:\n        /* SerNum -- Xnum */\n        val[1] = parse_Xnum(blob, 8);\n        break;\n      /* 2.5.192.117 */\n      case 0x02:\n        /* SerStr -- XLUnicodeString (<256 chars) */\n        val[1] = parse_XLUnicodeString2(blob, 0, {\n          biff: biff > 0 && biff < 8 ? 2 : biff\n        });\n        break;\n      // default: throw \"Bad SerAr: \" + val[0]; /* Unreachable */\n    }\n\n    return val;\n  }\n\n  /* 2.5.198.61 */\n  function parse_PtgExtraMem(blob, cce) {\n    var count = blob.read_shift(2);\n    var out = [];\n    for (var i = 0; i != count; ++i) out.push(parse_Ref8U(blob, 8));\n    return out;\n  }\n\n  /* 2.5.198.59 */\n  function parse_PtgExtraArray(blob, length, opts) {\n    var cols = 1 + blob.read_shift(1); //DColByteU\n    var rows = 1 + blob.read_shift(2); //DRw\n    if (opts.biff >= 2 && opts.biff < 8) {\n      --rows;\n      if (--cols == 0) cols = 0x100;\n    }\n    for (var i = 0, o = []; i != rows && (o[i] = []); ++i) for (var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\n    return o;\n  }\n\n  /* 2.5.198.76 */\n  function parse_PtgName(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var w = !opts || opts.biff >= 8 ? 4 : 2;\n    var nameindex = blob.read_shift(w);\n    switch (opts.biff) {\n      case 2:\n        blob.l += 5;\n        break;\n      case 3:\n      case 4:\n        blob.l += 8;\n        break;\n      case 5:\n        blob.l += 12;\n        break;\n    }\n    return [type, 0, nameindex];\n  }\n\n  /* 2.5.198.77 */\n  function parse_PtgNameX(blob, length, opts) {\n    if (opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var ixti = blob.read_shift(2); // XtiIndex\n    var nameindex = blob.read_shift(4);\n    return [type, ixti, nameindex];\n  }\n  function parse_PtgNameX_BIFF5(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var ixti = blob.read_shift(2, 'i'); // XtiIndex\n    blob.l += 8;\n    var nameindex = blob.read_shift(2);\n    blob.l += 12;\n    return [type, ixti, nameindex];\n  }\n\n  /* 2.5.198.70 */\n  function parse_PtgMemArea(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    blob.l += opts && opts.biff == 2 ? 3 : 4;\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    return [type, cce];\n  }\n\n  /* 2.5.198.72 */\n  function parse_PtgMemFunc(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    var cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n    return [type, cce];\n  }\n\n  /* 2.5.198.86 */\n  function parse_PtgRefErr(blob, length, opts) {\n    var type = blob.read_shift(1) >>> 5 & 0x03;\n    blob.l += 4;\n    return [type];\n  }\n\n  /* 2.5.198.26 */\n  var parse_PtgAdd = parseread1;\n  /* 2.5.198.45 */\n  var parse_PtgDiv = parseread1;\n  /* 2.5.198.56 */\n  var parse_PtgEq = parseread1;\n  /* 2.5.198.64 */\n  var parse_PtgGe = parseread1;\n  /* 2.5.198.65 */\n  var parse_PtgGt = parseread1;\n  /* 2.5.198.67 */\n  var parse_PtgIsect = parseread1;\n  /* 2.5.198.68 */\n  var parse_PtgLe = parseread1;\n  /* 2.5.198.69 */\n  var parse_PtgLt = parseread1;\n  /* 2.5.198.74 */\n  var parse_PtgMissArg = parseread1;\n  /* 2.5.198.75 */\n  var parse_PtgMul = parseread1;\n  /* 2.5.198.78 */\n  var parse_PtgNe = parseread1;\n  /* 2.5.198.80 */\n  var parse_PtgParen = parseread1;\n  /* 2.5.198.81 */\n  var parse_PtgPercent = parseread1;\n  /* 2.5.198.82 */\n  var parse_PtgPower = parseread1;\n  /* 2.5.198.83 */\n  var parse_PtgRange = parseread1;\n  /* 2.5.198.90 */\n  var parse_PtgSub = parseread1;\n  /* 2.5.198.93 */\n  var parse_PtgUminus = parseread1;\n  /* 2.5.198.94 */\n  var parse_PtgUnion = parseread1;\n  /* 2.5.198.95 */\n  var parse_PtgUplus = parseread1;\n\n  /* 2.5.198.71 */\n  var parse_PtgMemErr = parsenoop;\n  /* 2.5.198.73 */\n  var parse_PtgMemNoMem = parsenoop;\n  /* 2.5.198.87 */\n  var parse_PtgRefErr3d = parsenoop;\n  /* 2.5.198.92 */\n  var parse_PtgTbl = parsenoop;\n\n  /* 2.5.198.25 */\n  var PtgTypes = {\n    0x01: {\n      n: 'PtgExp',\n      f: parse_PtgExp\n    },\n    0x02: {\n      n: 'PtgTbl',\n      f: parse_PtgTbl\n    },\n    0x03: {\n      n: 'PtgAdd',\n      f: parse_PtgAdd\n    },\n    0x04: {\n      n: 'PtgSub',\n      f: parse_PtgSub\n    },\n    0x05: {\n      n: 'PtgMul',\n      f: parse_PtgMul\n    },\n    0x06: {\n      n: 'PtgDiv',\n      f: parse_PtgDiv\n    },\n    0x07: {\n      n: 'PtgPower',\n      f: parse_PtgPower\n    },\n    0x08: {\n      n: 'PtgConcat',\n      f: parse_PtgConcat\n    },\n    0x09: {\n      n: 'PtgLt',\n      f: parse_PtgLt\n    },\n    0x0A: {\n      n: 'PtgLe',\n      f: parse_PtgLe\n    },\n    0x0B: {\n      n: 'PtgEq',\n      f: parse_PtgEq\n    },\n    0x0C: {\n      n: 'PtgGe',\n      f: parse_PtgGe\n    },\n    0x0D: {\n      n: 'PtgGt',\n      f: parse_PtgGt\n    },\n    0x0E: {\n      n: 'PtgNe',\n      f: parse_PtgNe\n    },\n    0x0F: {\n      n: 'PtgIsect',\n      f: parse_PtgIsect\n    },\n    0x10: {\n      n: 'PtgUnion',\n      f: parse_PtgUnion\n    },\n    0x11: {\n      n: 'PtgRange',\n      f: parse_PtgRange\n    },\n    0x12: {\n      n: 'PtgUplus',\n      f: parse_PtgUplus\n    },\n    0x13: {\n      n: 'PtgUminus',\n      f: parse_PtgUminus\n    },\n    0x14: {\n      n: 'PtgPercent',\n      f: parse_PtgPercent\n    },\n    0x15: {\n      n: 'PtgParen',\n      f: parse_PtgParen\n    },\n    0x16: {\n      n: 'PtgMissArg',\n      f: parse_PtgMissArg\n    },\n    0x17: {\n      n: 'PtgStr',\n      f: parse_PtgStr\n    },\n    0x1C: {\n      n: 'PtgErr',\n      f: parse_PtgErr\n    },\n    0x1D: {\n      n: 'PtgBool',\n      f: parse_PtgBool\n    },\n    0x1E: {\n      n: 'PtgInt',\n      f: parse_PtgInt\n    },\n    0x1F: {\n      n: 'PtgNum',\n      f: parse_PtgNum\n    },\n    0x20: {\n      n: 'PtgArray',\n      f: parse_PtgArray\n    },\n    0x21: {\n      n: 'PtgFunc',\n      f: parse_PtgFunc\n    },\n    0x22: {\n      n: 'PtgFuncVar',\n      f: parse_PtgFuncVar\n    },\n    0x23: {\n      n: 'PtgName',\n      f: parse_PtgName\n    },\n    0x24: {\n      n: 'PtgRef',\n      f: parse_PtgRef\n    },\n    0x25: {\n      n: 'PtgArea',\n      f: parse_PtgArea\n    },\n    0x26: {\n      n: 'PtgMemArea',\n      f: parse_PtgMemArea\n    },\n    0x27: {\n      n: 'PtgMemErr',\n      f: parse_PtgMemErr\n    },\n    0x28: {\n      n: 'PtgMemNoMem',\n      f: parse_PtgMemNoMem\n    },\n    0x29: {\n      n: 'PtgMemFunc',\n      f: parse_PtgMemFunc\n    },\n    0x2A: {\n      n: 'PtgRefErr',\n      f: parse_PtgRefErr\n    },\n    0x2B: {\n      n: 'PtgAreaErr',\n      f: parse_PtgAreaErr\n    },\n    0x2C: {\n      n: 'PtgRefN',\n      f: parse_PtgRefN\n    },\n    0x2D: {\n      n: 'PtgAreaN',\n      f: parse_PtgAreaN\n    },\n    0x39: {\n      n: 'PtgNameX',\n      f: parse_PtgNameX\n    },\n    0x3A: {\n      n: 'PtgRef3d',\n      f: parse_PtgRef3d\n    },\n    0x3B: {\n      n: 'PtgArea3d',\n      f: parse_PtgArea3d\n    },\n    0x3C: {\n      n: 'PtgRefErr3d',\n      f: parse_PtgRefErr3d\n    },\n    0x3D: {\n      n: 'PtgAreaErr3d',\n      f: parse_PtgAreaErr3d\n    },\n    0xFF: {}\n  };\n  /* These are duplicated in the PtgTypes table */\n  var PtgDupes = {\n    0x40: 0x20,\n    0x60: 0x20,\n    0x41: 0x21,\n    0x61: 0x21,\n    0x42: 0x22,\n    0x62: 0x22,\n    0x43: 0x23,\n    0x63: 0x23,\n    0x44: 0x24,\n    0x64: 0x24,\n    0x45: 0x25,\n    0x65: 0x25,\n    0x46: 0x26,\n    0x66: 0x26,\n    0x47: 0x27,\n    0x67: 0x27,\n    0x48: 0x28,\n    0x68: 0x28,\n    0x49: 0x29,\n    0x69: 0x29,\n    0x4A: 0x2A,\n    0x6A: 0x2A,\n    0x4B: 0x2B,\n    0x6B: 0x2B,\n    0x4C: 0x2C,\n    0x6C: 0x2C,\n    0x4D: 0x2D,\n    0x6D: 0x2D,\n    0x59: 0x39,\n    0x79: 0x39,\n    0x5A: 0x3A,\n    0x7A: 0x3A,\n    0x5B: 0x3B,\n    0x7B: 0x3B,\n    0x5C: 0x3C,\n    0x7C: 0x3C,\n    0x5D: 0x3D,\n    0x7D: 0x3D\n  };\n  (function () {\n    for (var y in PtgDupes) PtgTypes[y] = PtgTypes[PtgDupes[y]];\n  })();\n  var Ptg18 = {};\n  var Ptg19 = {\n    0x01: {\n      n: 'PtgAttrSemi',\n      f: parse_PtgAttrSemi\n    },\n    0x02: {\n      n: 'PtgAttrIf',\n      f: parse_PtgAttrIf\n    },\n    0x04: {\n      n: 'PtgAttrChoose',\n      f: parse_PtgAttrChoose\n    },\n    0x08: {\n      n: 'PtgAttrGoto',\n      f: parse_PtgAttrGoto\n    },\n    0x10: {\n      n: 'PtgAttrSum',\n      f: parse_PtgAttrSum\n    },\n    0x20: {\n      n: 'PtgAttrBaxcel',\n      f: parse_PtgAttrBaxcel\n    },\n    0x40: {\n      n: 'PtgAttrSpace',\n      f: parse_PtgAttrSpace\n    },\n    0x41: {\n      n: 'PtgAttrSpaceSemi',\n      f: parse_PtgAttrSpaceSemi\n    },\n    0xFF: {}\n  };\n\n  /* TODO: it will be useful to parse the function str */\n  var rc_to_a1 = function () {\n    var rcregex = /(^|[^A-Za-z])R(\\[?)(-?\\d+|)\\]?C(\\[?)(-?\\d+|)\\]?/g;\n    var rcbase;\n    function rcfunc($$, $1, $2, $3, $4, $5) {\n      var R = $3.length > 0 ? parseInt($3, 10) | 0 : 0,\n        C = $5.length > 0 ? parseInt($5, 10) | 0 : 0;\n      if (C < 0 && $4.length === 0) C = 0;\n      var cRel = false,\n        rRel = false;\n      if ($4.length > 0 || $5.length == 0) cRel = true;\n      if (cRel) C += rcbase.c;else --C;\n      if ($2.length > 0 || $3.length == 0) rRel = true;\n      if (rRel) R += rcbase.r;else --R;\n      return $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n    }\n    return function rc_to_a1(fstr, base) {\n      rcbase = base;\n      return fstr.replace(rcregex, rcfunc);\n    };\n  }();\n  /* 2.4.127 TODO */\n  function parse_Formula(blob, length, opts) {\n    var end = blob.l + length;\n    var cell = parse_Cell(blob, 6);\n    if (opts.biff == 2) ++blob.l;\n    var val = parse_FormulaValue(blob, 8);\n    var flags = blob.read_shift(1);\n    if (opts.biff != 2) {\n      blob.read_shift(1);\n      if (opts.biff >= 5) {\n        var chn = blob.read_shift(4);\n      }\n    }\n    var cbf = parse_CellParsedFormula(blob, end - blob.l, opts);\n    return {\n      cell: cell,\n      val: val[0],\n      formula: cbf,\n      shared: flags >> 3 & 1,\n      tt: val[1]\n    };\n  }\n\n  /* 2.5.133 TODO: how to emit empty strings? */\n  function parse_FormulaValue(blob) {\n    var b;\n    if (__readUInt16LE(blob, blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob), 'n'];\n    switch (blob[blob.l]) {\n      case 0x00:\n        blob.l += 8;\n        return [\"String\", 's'];\n      case 0x01:\n        b = blob[blob.l + 2] === 0x1;\n        blob.l += 8;\n        return [b, 'b'];\n      case 0x02:\n        b = blob[blob.l + 2];\n        blob.l += 8;\n        return [b, 'e'];\n      case 0x03:\n        blob.l += 8;\n        return [\"\", 's'];\n    }\n    return [];\n  }\n\n  /* 2.5.198.103 */\n  function parse_RgbExtra(blob, length, rgce, opts) {\n    if (opts.biff < 8) return parsenoop(blob, length);\n    var target = blob.l + length;\n    var o = [];\n    for (var i = 0; i !== rgce.length; ++i) {\n      switch (rgce[i][0]) {\n        case 'PtgArray':\n          /* PtgArray -> PtgExtraArray */\n          rgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n          o.push(rgce[i][1]);\n          break;\n        case 'PtgMemArea':\n          /* PtgMemArea -> PtgExtraMem */\n          rgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1]);\n          o.push(rgce[i][2]);\n          break;\n        default:\n          break;\n      }\n    }\n    length = target - blob.l;\n    if (length !== 0) o.push(parsenoop(blob, length));\n    return o;\n  }\n\n  /* 2.5.198.21 */\n  function parse_NameParsedFormula(blob, length, opts, cce) {\n    var target = blob.l + length;\n    var rgce = parse_Rgce(blob, cce, opts);\n    var rgcb;\n    if (target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n    return [rgce, rgcb];\n  }\n\n  /* 2.5.198.3 TODO */\n  function parse_CellParsedFormula(blob, length, opts) {\n    var target = blob.l + length,\n      len = opts.biff == 2 ? 1 : 2;\n    var rgcb,\n      cce = blob.read_shift(len); // length of rgce\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    var rgce = parse_Rgce(blob, cce, opts);\n    if (length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n    return [rgce, rgcb];\n  }\n\n  /* 2.5.198.118 TODO */\n  function parse_SharedParsedFormula(blob, length, opts) {\n    var target = blob.l + length;\n    var rgcb,\n      cce = blob.read_shift(2); // length of rgce\n    var rgce = parse_Rgce(blob, cce, opts);\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    if (length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n    return [rgce, rgcb];\n  }\n\n  /* 2.5.198.1 TODO */\n  function parse_ArrayParsedFormula(blob, length, opts, ref) {\n    var target = blob.l + length,\n      len = opts.biff == 2 ? 1 : 2;\n    var rgcb,\n      cce = blob.read_shift(len); // length of rgce\n    if (cce == 0xFFFF) return [[], parsenoop(blob, length - 2)];\n    var rgce = parse_Rgce(blob, cce, opts);\n    if (length !== cce + len) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n    return [rgce, rgcb];\n  }\n\n  /* 2.5.198.104 */\n  function parse_Rgce(blob, length, opts) {\n    var target = blob.l + length;\n    var R,\n      id,\n      ptgs = [];\n    while (target != blob.l) {\n      length = target - blob.l;\n      id = blob[blob.l];\n      R = PtgTypes[id];\n      if (id === 0x18 || id === 0x19) {\n        id = blob[blob.l + 1];\n        R = (id === 0x18 ? Ptg18 : Ptg19)[id];\n      }\n      if (!R || !R.f) {\n        ptgs.push(parsenoop(blob, length));\n      } else {\n        ptgs.push([R.n, R.f(blob, length, opts)]);\n      }\n    }\n    return ptgs;\n  }\n  function stringify_array(f) {\n    var o = [];\n    for (var i = 0; i < f.length; ++i) {\n      var x = f[i],\n        r = [];\n      for (var j = 0; j < x.length; ++j) {\n        var y = x[j];\n        if (y) switch (y[0]) {\n          // TODO: handle embedded quotes\n          case 0x02:\n            r.push('\"' + y[1].replace(/\"/g, '\"\"') + '\"');\n            break;\n          default:\n            r.push(y[1]);\n        } else r.push(\"\");\n      }\n      o.push(r.join(\",\"));\n    }\n    return o.join(\";\");\n  }\n\n  /* 2.2.2 TODO */\n  var PtgBinOp = {\n    PtgAdd: \"+\",\n    PtgConcat: \"&\",\n    PtgDiv: \"/\",\n    PtgEq: \"=\",\n    PtgGe: \">=\",\n    PtgGt: \">\",\n    PtgLe: \"<=\",\n    PtgLt: \"<\",\n    PtgMul: \"*\",\n    PtgNe: \"<>\",\n    PtgPower: \"^\",\n    PtgSub: \"-\"\n  };\n  function stringify_formula(formula, range, cell, supbooks, opts) {\n    var _range = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n    var stack = [],\n      e1,\n      e2,\n      type,\n      c,\n      ixti,\n      nameidx,\n      r,\n      sname = \"\";\n    if (!formula[0] || !formula[0][0]) return \"\";\n    var last_sp = -1,\n      sp = \"\";\n    //console.log(\"--\",cell,formula[0])\n    for (var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n      var f = formula[0][ff];\n      //console.log(\"++\",f, stack)\n      switch (f[0]) {\n        /* 2.2.2.1 Unary Operator Tokens */\n        /* 2.5.198.93 */\n        case 'PtgUminus':\n          stack.push(\"-\" + stack.pop());\n          break;\n        /* 2.5.198.95 */\n        case 'PtgUplus':\n          stack.push(\"+\" + stack.pop());\n          break;\n        /* 2.5.198.81 */\n        case 'PtgPercent':\n          stack.push(stack.pop() + \"%\");\n          break;\n\n        /* 2.2.2.1 Binary Value Operator Token */\n        case 'PtgAdd': /* 2.5.198.26 */\n        case 'PtgConcat': /* 2.5.198.43 */\n        case 'PtgDiv': /* 2.5.198.45 */\n        case 'PtgEq': /* 2.5.198.56 */\n        case 'PtgGe': /* 2.5.198.64 */\n        case 'PtgGt': /* 2.5.198.65 */\n        case 'PtgLe': /* 2.5.198.68 */\n        case 'PtgLt': /* 2.5.198.69 */\n        case 'PtgMul': /* 2.5.198.75 */\n        case 'PtgNe': /* 2.5.198.78 */\n        case 'PtgPower': /* 2.5.198.82 */\n        case 'PtgSub':\n          /* 2.5.198.90 */\n          e1 = stack.pop();\n          e2 = stack.pop();\n          if (last_sp >= 0) {\n            switch (formula[0][last_sp][1][0]) {\n              case 0:\n                sp = fill(\" \", formula[0][last_sp][1][1]);\n                break;\n              case 1:\n                sp = fill(\"\\r\", formula[0][last_sp][1][1]);\n                break;\n              default:\n                sp = \"\";\n                if (opts.WTF) throw new Error(\"Unexpected PtgSpace type \" + formula[0][last_sp][1][0]);\n            }\n            e2 = e2 + sp;\n            last_sp = -1;\n          }\n          stack.push(e2 + PtgBinOp[f[0]] + e1);\n          break;\n\n        /* 2.2.2.1 Binary Reference Operator Token */\n        /* 2.5.198.67 */\n        case 'PtgIsect':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \" \" + e1);\n          break;\n        case 'PtgUnion':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \",\" + e1);\n          break;\n        case 'PtgRange':\n          e1 = stack.pop();\n          e2 = stack.pop();\n          stack.push(e2 + \":\" + e1);\n          break;\n\n        /* 2.2.2.3 Control Tokens \"can be ignored\" */\n        /* 2.5.198.34 */\n        case 'PtgAttrChoose':\n          break;\n        /* 2.5.198.35 */\n        case 'PtgAttrGoto':\n          break;\n        /* 2.5.198.36 */\n        case 'PtgAttrIf':\n          break;\n\n        /* 2.5.198.84 */\n        case 'PtgRef':\n          type = f[1][0];\n          c = shift_cell(f[1][1], _range, opts);\n          stack.push(encode_cell_xls(c));\n          break;\n        /* 2.5.198.88 */\n        case 'PtgRefN':\n          type = f[1][0];\n          c = shift_cell(f[1][1], cell, opts);\n          stack.push(encode_cell_xls(c));\n          break;\n        case 'PtgRef3d':\n          // TODO: lots of stuff\n          type = f[1][0];\n          ixti = f[1][1];\n          c = shift_cell(f[1][2], _range, opts);\n          sname = supbooks && supbooks[1] ? supbooks[1][ixti + 1] : \"**MISSING**\";\n          stack.push(sname + \"!\" + encode_cell(c));\n          break;\n\n        /* Function Call */\n        /* 2.5.198.62 */\n        case 'PtgFunc':\n        /* 2.5.198.63 */\n        case 'PtgFuncVar':\n          /* f[1] = [argc, func, type] */\n          var argc = f[1][0],\n            func = f[1][1];\n          if (!argc) argc = 0;\n          var args = argc == 0 ? [] : stack.slice(-argc);\n          stack.length -= argc;\n          if (func === 'User') func = args.shift();\n          stack.push(func + \"(\" + args.join(\",\") + \")\");\n          break;\n\n        /* 2.5.198.42 */\n        case 'PtgBool':\n          stack.push(f[1] ? \"TRUE\" : \"FALSE\");\n          break;\n        /* 2.5.198.66 */\n        case 'PtgInt':\n          stack.push(f[1]);\n          break;\n        /* 2.5.198.79 TODO: precision? */\n        case 'PtgNum':\n          stack.push(String(f[1]));\n          break;\n        /* 2.5.198.89 */\n        case 'PtgStr':\n          stack.push('\"' + f[1] + '\"');\n          break;\n        /* 2.5.198.57 */\n        case 'PtgErr':\n          stack.push(f[1]);\n          break;\n        /* 2.5.198.27 TODO: fixed points */\n        case 'PtgArea':\n          type = f[1][0];\n          r = shift_range(f[1][1], _range);\n          stack.push(encode_range_xls(r));\n          break;\n        /* 2.5.198.28 */\n        case 'PtgArea3d':\n          // TODO: lots of stuff\n          type = f[1][0];\n          ixti = f[1][1];\n          r = f[1][2];\n          sname = supbooks && supbooks[1] ? supbooks[1][ixti + 1] : \"**MISSING**\";\n          stack.push(sname + \"!\" + encode_range(r));\n          break;\n        /* 2.5.198.41 */\n        case 'PtgAttrSum':\n          stack.push(\"SUM(\" + stack.pop() + \")\");\n          break;\n\n        /* Expression Prefixes */\n        /* 2.5.198.37 */\n        case 'PtgAttrSemi':\n          break;\n\n        /* 2.5.97.60 TODO: do something different for revisions */\n        case 'PtgName':\n          /* f[1] = type, 0, nameindex */\n          nameidx = f[1][2];\n          var lbl = supbooks[0][nameidx];\n          var name = lbl ? lbl.Name : \"**MISSING**\" + nameidx;\n          if (name in XLSXFutureFunctions) name = XLSXFutureFunctions[name];\n          stack.push(name);\n          break;\n\n        /* 2.5.97.61 TODO: do something different for revisions */\n        case 'PtgNameX':\n          /* f[1] = type, ixti, nameindex */\n          var bookidx = f[1][1];\n          nameidx = f[1][2];\n          var externbook;\n          /* TODO: Properly handle missing values */\n          if (opts.biff == 5) {\n            if (bookidx < 0) bookidx = -bookidx;\n            if (supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n          } else {\n            if (supbooks[bookidx + 1]) externbook = supbooks[bookidx + 1][nameidx];else if (supbooks[bookidx - 1]) externbook = supbooks[bookidx - 1][nameidx];\n          }\n          if (!externbook) externbook = {\n            body: \"??NAMEX??\"\n          };\n          stack.push(externbook.body);\n          break;\n\n        /* 2.2.2.4 Display Tokens */\n        /* 2.5.198.80 */\n        case 'PtgParen':\n          var lp = '(',\n            rp = ')';\n          if (last_sp >= 0) {\n            sp = \"\";\n            switch (formula[0][last_sp][1][0]) {\n              case 2:\n                lp = fill(\" \", formula[0][last_sp][1][1]) + lp;\n                break;\n              case 3:\n                lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp;\n                break;\n              case 4:\n                rp = fill(\" \", formula[0][last_sp][1][1]) + lp;\n                break;\n              case 5:\n                rp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp;\n                break;\n              default:\n                if (opts.WTF) throw new Error(\"Unexpected PtgSpace type \" + formula[0][last_sp][1][0]);\n            }\n            last_sp = -1;\n          }\n          stack.push(lp + stack.pop() + rp);\n          break;\n\n        /* 2.5.198.86 */\n        case 'PtgRefErr':\n          stack.push('#REF!');\n          break;\n\n        /* */\n        /* 2.5.198.58 TODO */\n        case 'PtgExp':\n          c = {\n            c: f[1][1],\n            r: f[1][0]\n          };\n          var q = {\n            c: cell.c,\n            r: cell.r\n          };\n          if (supbooks.sharedf[encode_cell(c)]) {\n            var parsedf = supbooks.sharedf[encode_cell(c)];\n            stack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n          } else {\n            var fnd = false;\n            for (e1 = 0; e1 != supbooks.arrayf.length; ++e1) {\n              /* TODO: should be something like range_has */\n              e2 = supbooks.arrayf[e1];\n              if (c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n              if (c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n              stack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n              fnd = true;\n              break;\n            }\n            if (!fnd) stack.push(f[1]);\n          }\n          break;\n\n        /* 2.5.198.32 TODO */\n        case 'PtgArray':\n          stack.push(\"{\" + stringify_array(f[1]) + \"}\");\n          break;\n\n        /* 2.2.2.5 Mem Tokens */\n        /* 2.5.198.70 TODO: confirm this is a non-display */\n        case 'PtgMemArea':\n          //stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n          break;\n\n        /* 2.5.198.38 */\n        case 'PtgAttrSpace':\n        /* 2.5.198.39 */\n        case 'PtgAttrSpaceSemi':\n          last_sp = ff;\n          break;\n\n        /* 2.5.198.92 TODO */\n        case 'PtgTbl':\n          break;\n\n        /* 2.5.198.71 */\n        case 'PtgMemErr':\n          break;\n\n        /* 2.5.198.74 */\n        case 'PtgMissArg':\n          stack.push(\"\");\n          break;\n\n        /* 2.5.198.29 TODO */\n        case 'PtgAreaErr':\n          break;\n\n        /* 2.5.198.31 TODO */\n        case 'PtgAreaN':\n          stack.push(\"\");\n          break;\n\n        /* 2.5.198.87 TODO */\n        case 'PtgRefErr3d':\n          break;\n\n        /* 2.5.198.72 TODO */\n        case 'PtgMemFunc':\n          break;\n        default:\n          throw 'Unrecognized Formula Token: ' + f;\n      }\n      var PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n      if (last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n        f = formula[0][last_sp];\n        switch (f[1][0]) {\n          case 0:\n            sp = fill(\" \", f[1][1]);\n            break;\n          case 1:\n            sp = fill(\"\\r\", f[1][1]);\n            break;\n          default:\n            sp = \"\";\n            if (opts.WTF) throw new Error(\"Unexpected PtgSpace type \" + f[1][0]);\n        }\n        stack.push(sp + stack.pop());\n        last_sp = -1;\n      }\n      //console.log(\"::\",f, stack)\n    }\n    //console.log(\"--\",stack);\n    if (stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n    return stack[0];\n  }\n  /* [MS-XLS] 2.5.198.44 */\n  var PtgDataType = {\n    0x1: \"REFERENCE\",\n    // reference to range\n    0x2: \"VALUE\",\n    // single value\n    0x3: \"ARRAY\" // array of values\n  };\n\n  /* [MS-XLS] 2.5.198.4 */\n  var Cetab = {\n    0x0000: 'BEEP',\n    0x0001: 'OPEN',\n    0x0002: 'OPEN.LINKS',\n    0x0003: 'CLOSE.ALL',\n    0x0004: 'SAVE',\n    0x0005: 'SAVE.AS',\n    0x0006: 'FILE.DELETE',\n    0x0007: 'PAGE.SETUP',\n    0x0008: 'PRINT',\n    0x0009: 'PRINTER.SETUP',\n    0x000A: 'QUIT',\n    0x000B: 'NEW.WINDOW',\n    0x000C: 'ARRANGE.ALL',\n    0x000D: 'WINDOW.SIZE',\n    0x000E: 'WINDOW.MOVE',\n    0x000F: 'FULL',\n    0x0010: 'CLOSE',\n    0x0011: 'RUN',\n    0x0016: 'SET.PRINT.AREA',\n    0x0017: 'SET.PRINT.TITLES',\n    0x0018: 'SET.PAGE.BREAK',\n    0x0019: 'REMOVE.PAGE.BREAK',\n    0x001A: 'FONT',\n    0x001B: 'DISPLAY',\n    0x001C: 'PROTECT.DOCUMENT',\n    0x001D: 'PRECISION',\n    0x001E: 'A1.R1C1',\n    0x001F: 'CALCULATE.NOW',\n    0x0020: 'CALCULATION',\n    0x0022: 'DATA.FIND',\n    0x0023: 'EXTRACT',\n    0x0024: 'DATA.DELETE',\n    0x0025: 'SET.DATABASE',\n    0x0026: 'SET.CRITERIA',\n    0x0027: 'SORT',\n    0x0028: 'DATA.SERIES',\n    0x0029: 'TABLE',\n    0x002A: 'FORMAT.NUMBER',\n    0x002B: 'ALIGNMENT',\n    0x002C: 'STYLE',\n    0x002D: 'BORDER',\n    0x002E: 'CELL.PROTECTION',\n    0x002F: 'COLUMN.WIDTH',\n    0x0030: 'UNDO',\n    0x0031: 'CUT',\n    0x0032: 'COPY',\n    0x0033: 'PASTE',\n    0x0034: 'CLEAR',\n    0x0035: 'PASTE.SPECIAL',\n    0x0036: 'EDIT.DELETE',\n    0x0037: 'INSERT',\n    0x0038: 'FILL.RIGHT',\n    0x0039: 'FILL.DOWN',\n    0x003D: 'DEFINE.NAME',\n    0x003E: 'CREATE.NAMES',\n    0x003F: 'FORMULA.GOTO',\n    0x0040: 'FORMULA.FIND',\n    0x0041: 'SELECT.LAST.CELL',\n    0x0042: 'SHOW.ACTIVE.CELL',\n    0x0043: 'GALLERY.AREA',\n    0x0044: 'GALLERY.BAR',\n    0x0045: 'GALLERY.COLUMN',\n    0x0046: 'GALLERY.LINE',\n    0x0047: 'GALLERY.PIE',\n    0x0048: 'GALLERY.SCATTER',\n    0x0049: 'COMBINATION',\n    0x004A: 'PREFERRED',\n    0x004B: 'ADD.OVERLAY',\n    0x004C: 'GRIDLINES',\n    0x004D: 'SET.PREFERRED',\n    0x004E: 'AXES',\n    0x004F: 'LEGEND',\n    0x0050: 'ATTACH.TEXT',\n    0x0051: 'ADD.ARROW',\n    0x0052: 'SELECT.CHART',\n    0x0053: 'SELECT.PLOT.AREA',\n    0x0054: 'PATTERNS',\n    0x0055: 'MAIN.CHART',\n    0x0056: 'OVERLAY',\n    0x0057: 'SCALE',\n    0x0058: 'FORMAT.LEGEND',\n    0x0059: 'FORMAT.TEXT',\n    0x005A: 'EDIT.REPEAT',\n    0x005B: 'PARSE',\n    0x005C: 'JUSTIFY',\n    0x005D: 'HIDE',\n    0x005E: 'UNHIDE',\n    0x005F: 'WORKSPACE',\n    0x0060: 'FORMULA',\n    0x0061: 'FORMULA.FILL',\n    0x0062: 'FORMULA.ARRAY',\n    0x0063: 'DATA.FIND.NEXT',\n    0x0064: 'DATA.FIND.PREV',\n    0x0065: 'FORMULA.FIND.NEXT',\n    0x0066: 'FORMULA.FIND.PREV',\n    0x0067: 'ACTIVATE',\n    0x0068: 'ACTIVATE.NEXT',\n    0x0069: 'ACTIVATE.PREV',\n    0x006A: 'UNLOCKED.NEXT',\n    0x006B: 'UNLOCKED.PREV',\n    0x006C: 'COPY.PICTURE',\n    0x006D: 'SELECT',\n    0x006E: 'DELETE.NAME',\n    0x006F: 'DELETE.FORMAT',\n    0x0070: 'VLINE',\n    0x0071: 'HLINE',\n    0x0072: 'VPAGE',\n    0x0073: 'HPAGE',\n    0x0074: 'VSCROLL',\n    0x0075: 'HSCROLL',\n    0x0076: 'ALERT',\n    0x0077: 'NEW',\n    0x0078: 'CANCEL.COPY',\n    0x0079: 'SHOW.CLIPBOARD',\n    0x007A: 'MESSAGE',\n    0x007C: 'PASTE.LINK',\n    0x007D: 'APP.ACTIVATE',\n    0x007E: 'DELETE.ARROW',\n    0x007F: 'ROW.HEIGHT',\n    0x0080: 'FORMAT.MOVE',\n    0x0081: 'FORMAT.SIZE',\n    0x0082: 'FORMULA.REPLACE',\n    0x0083: 'SEND.KEYS',\n    0x0084: 'SELECT.SPECIAL',\n    0x0085: 'APPLY.NAMES',\n    0x0086: 'REPLACE.FONT',\n    0x0087: 'FREEZE.PANES',\n    0x0088: 'SHOW.INFO',\n    0x0089: 'SPLIT',\n    0x008A: 'ON.WINDOW',\n    0x008B: 'ON.DATA',\n    0x008C: 'DISABLE.INPUT',\n    0x008E: 'OUTLINE',\n    0x008F: 'LIST.NAMES',\n    0x0090: 'FILE.CLOSE',\n    0x0091: 'SAVE.WORKBOOK',\n    0x0092: 'DATA.FORM',\n    0x0093: 'COPY.CHART',\n    0x0094: 'ON.TIME',\n    0x0095: 'WAIT',\n    0x0096: 'FORMAT.FONT',\n    0x0097: 'FILL.UP',\n    0x0098: 'FILL.LEFT',\n    0x0099: 'DELETE.OVERLAY',\n    0x009B: 'SHORT.MENUS',\n    0x009F: 'SET.UPDATE.STATUS',\n    0x00A1: 'COLOR.PALETTE',\n    0x00A2: 'DELETE.STYLE',\n    0x00A3: 'WINDOW.RESTORE',\n    0x00A4: 'WINDOW.MAXIMIZE',\n    0x00A6: 'CHANGE.LINK',\n    0x00A7: 'CALCULATE.DOCUMENT',\n    0x00A8: 'ON.KEY',\n    0x00A9: 'APP.RESTORE',\n    0x00AA: 'APP.MOVE',\n    0x00AB: 'APP.SIZE',\n    0x00AC: 'APP.MINIMIZE',\n    0x00AD: 'APP.MAXIMIZE',\n    0x00AE: 'BRING.TO.FRONT',\n    0x00AF: 'SEND.TO.BACK',\n    0x00B9: 'MAIN.CHART.TYPE',\n    0x00BA: 'OVERLAY.CHART.TYPE',\n    0x00BB: 'SELECT.END',\n    0x00BC: 'OPEN.MAIL',\n    0x00BD: 'SEND.MAIL',\n    0x00BE: 'STANDARD.FONT',\n    0x00BF: 'CONSOLIDATE',\n    0x00C0: 'SORT.SPECIAL',\n    0x00C1: 'GALLERY.3D.AREA',\n    0x00C2: 'GALLERY.3D.COLUMN',\n    0x00C3: 'GALLERY.3D.LINE',\n    0x00C4: 'GALLERY.3D.PIE',\n    0x00C5: 'VIEW.3D',\n    0x00C6: 'GOAL.SEEK',\n    0x00C7: 'WORKGROUP',\n    0x00C8: 'FILL.GROUP',\n    0x00C9: 'UPDATE.LINK',\n    0x00CA: 'PROMOTE',\n    0x00CB: 'DEMOTE',\n    0x00CC: 'SHOW.DETAIL',\n    0x00CE: 'UNGROUP',\n    0x00CF: 'OBJECT.PROPERTIES',\n    0x00D0: 'SAVE.NEW.OBJECT',\n    0x00D1: 'SHARE',\n    0x00D2: 'SHARE.NAME',\n    0x00D3: 'DUPLICATE',\n    0x00D4: 'APPLY.STYLE',\n    0x00D5: 'ASSIGN.TO.OBJECT',\n    0x00D6: 'OBJECT.PROTECTION',\n    0x00D7: 'HIDE.OBJECT',\n    0x00D8: 'SET.EXTRACT',\n    0x00D9: 'CREATE.PUBLISHER',\n    0x00DA: 'SUBSCRIBE.TO',\n    0x00DB: 'ATTRIBUTES',\n    0x00DC: 'SHOW.TOOLBAR',\n    0x00DE: 'PRINT.PREVIEW',\n    0x00DF: 'EDIT.COLOR',\n    0x00E0: 'SHOW.LEVELS',\n    0x00E1: 'FORMAT.MAIN',\n    0x00E2: 'FORMAT.OVERLAY',\n    0x00E3: 'ON.RECALC',\n    0x00E4: 'EDIT.SERIES',\n    0x00E5: 'DEFINE.STYLE',\n    0x00F0: 'LINE.PRINT',\n    0x00F3: 'ENTER.DATA',\n    0x00F9: 'GALLERY.RADAR',\n    0x00FA: 'MERGE.STYLES',\n    0x00FB: 'EDITION.OPTIONS',\n    0x00FC: 'PASTE.PICTURE',\n    0x00FD: 'PASTE.PICTURE.LINK',\n    0x00FE: 'SPELLING',\n    0x0100: 'ZOOM',\n    0x0103: 'INSERT.OBJECT',\n    0x0104: 'WINDOW.MINIMIZE',\n    0x0109: 'SOUND.NOTE',\n    0x010A: 'SOUND.PLAY',\n    0x010B: 'FORMAT.SHAPE',\n    0x010C: 'EXTEND.POLYGON',\n    0x010D: 'FORMAT.AUTO',\n    0x0110: 'GALLERY.3D.BAR',\n    0x0111: 'GALLERY.3D.SURFACE',\n    0x0112: 'FILL.AUTO',\n    0x0114: 'CUSTOMIZE.TOOLBAR',\n    0x0115: 'ADD.TOOL',\n    0x0116: 'EDIT.OBJECT',\n    0x0117: 'ON.DOUBLECLICK',\n    0x0118: 'ON.ENTRY',\n    0x0119: 'WORKBOOK.ADD',\n    0x011A: 'WORKBOOK.MOVE',\n    0x011B: 'WORKBOOK.COPY',\n    0x011C: 'WORKBOOK.OPTIONS',\n    0x011D: 'SAVE.WORKSPACE',\n    0x0120: 'CHART.WIZARD',\n    0x0121: 'DELETE.TOOL',\n    0x0122: 'MOVE.TOOL',\n    0x0123: 'WORKBOOK.SELECT',\n    0x0124: 'WORKBOOK.ACTIVATE',\n    0x0125: 'ASSIGN.TO.TOOL',\n    0x0127: 'COPY.TOOL',\n    0x0128: 'RESET.TOOL',\n    0x0129: 'CONSTRAIN.NUMERIC',\n    0x012A: 'PASTE.TOOL',\n    0x012E: 'WORKBOOK.NEW',\n    0x0131: 'SCENARIO.CELLS',\n    0x0132: 'SCENARIO.DELETE',\n    0x0133: 'SCENARIO.ADD',\n    0x0134: 'SCENARIO.EDIT',\n    0x0135: 'SCENARIO.SHOW',\n    0x0136: 'SCENARIO.SHOW.NEXT',\n    0x0137: 'SCENARIO.SUMMARY',\n    0x0138: 'PIVOT.TABLE.WIZARD',\n    0x0139: 'PIVOT.FIELD.PROPERTIES',\n    0x013A: 'PIVOT.FIELD',\n    0x013B: 'PIVOT.ITEM',\n    0x013C: 'PIVOT.ADD.FIELDS',\n    0x013E: 'OPTIONS.CALCULATION',\n    0x013F: 'OPTIONS.EDIT',\n    0x0140: 'OPTIONS.VIEW',\n    0x0141: 'ADDIN.MANAGER',\n    0x0142: 'MENU.EDITOR',\n    0x0143: 'ATTACH.TOOLBARS',\n    0x0144: 'VBAActivate',\n    0x0145: 'OPTIONS.CHART',\n    0x0148: 'VBA.INSERT.FILE',\n    0x014A: 'VBA.PROCEDURE.DEFINITION',\n    0x0150: 'ROUTING.SLIP',\n    0x0152: 'ROUTE.DOCUMENT',\n    0x0153: 'MAIL.LOGON',\n    0x0156: 'INSERT.PICTURE',\n    0x0157: 'EDIT.TOOL',\n    0x0158: 'GALLERY.DOUGHNUT',\n    0x015E: 'CHART.TREND',\n    0x0160: 'PIVOT.ITEM.PROPERTIES',\n    0x0162: 'WORKBOOK.INSERT',\n    0x0163: 'OPTIONS.TRANSITION',\n    0x0164: 'OPTIONS.GENERAL',\n    0x0172: 'FILTER.ADVANCED',\n    0x0175: 'MAIL.ADD.MAILER',\n    0x0176: 'MAIL.DELETE.MAILER',\n    0x0177: 'MAIL.REPLY',\n    0x0178: 'MAIL.REPLY.ALL',\n    0x0179: 'MAIL.FORWARD',\n    0x017A: 'MAIL.NEXT.LETTER',\n    0x017B: 'DATA.LABEL',\n    0x017C: 'INSERT.TITLE',\n    0x017D: 'FONT.PROPERTIES',\n    0x017E: 'MACRO.OPTIONS',\n    0x017F: 'WORKBOOK.HIDE',\n    0x0180: 'WORKBOOK.UNHIDE',\n    0x0181: 'WORKBOOK.DELETE',\n    0x0182: 'WORKBOOK.NAME',\n    0x0184: 'GALLERY.CUSTOM',\n    0x0186: 'ADD.CHART.AUTOFORMAT',\n    0x0187: 'DELETE.CHART.AUTOFORMAT',\n    0x0188: 'CHART.ADD.DATA',\n    0x0189: 'AUTO.OUTLINE',\n    0x018A: 'TAB.ORDER',\n    0x018B: 'SHOW.DIALOG',\n    0x018C: 'SELECT.ALL',\n    0x018D: 'UNGROUP.SHEETS',\n    0x018E: 'SUBTOTAL.CREATE',\n    0x018F: 'SUBTOTAL.REMOVE',\n    0x0190: 'RENAME.OBJECT',\n    0x019C: 'WORKBOOK.SCROLL',\n    0x019D: 'WORKBOOK.NEXT',\n    0x019E: 'WORKBOOK.PREV',\n    0x019F: 'WORKBOOK.TAB.SPLIT',\n    0x01A0: 'FULL.SCREEN',\n    0x01A1: 'WORKBOOK.PROTECT',\n    0x01A4: 'SCROLLBAR.PROPERTIES',\n    0x01A5: 'PIVOT.SHOW.PAGES',\n    0x01A6: 'TEXT.TO.COLUMNS',\n    0x01A7: 'FORMAT.CHARTTYPE',\n    0x01A8: 'LINK.FORMAT',\n    0x01A9: 'TRACER.DISPLAY',\n    0x01AE: 'TRACER.NAVIGATE',\n    0x01AF: 'TRACER.CLEAR',\n    0x01B0: 'TRACER.ERROR',\n    0x01B1: 'PIVOT.FIELD.GROUP',\n    0x01B2: 'PIVOT.FIELD.UNGROUP',\n    0x01B3: 'CHECKBOX.PROPERTIES',\n    0x01B4: 'LABEL.PROPERTIES',\n    0x01B5: 'LISTBOX.PROPERTIES',\n    0x01B6: 'EDITBOX.PROPERTIES',\n    0x01B7: 'PIVOT.REFRESH',\n    0x01B8: 'LINK.COMBO',\n    0x01B9: 'OPEN.TEXT',\n    0x01BA: 'HIDE.DIALOG',\n    0x01BB: 'SET.DIALOG.FOCUS',\n    0x01BC: 'ENABLE.OBJECT',\n    0x01BD: 'PUSHBUTTON.PROPERTIES',\n    0x01BE: 'SET.DIALOG.DEFAULT',\n    0x01BF: 'FILTER',\n    0x01C0: 'FILTER.SHOW.ALL',\n    0x01C1: 'CLEAR.OUTLINE',\n    0x01C2: 'FUNCTION.WIZARD',\n    0x01C3: 'ADD.LIST.ITEM',\n    0x01C4: 'SET.LIST.ITEM',\n    0x01C5: 'REMOVE.LIST.ITEM',\n    0x01C6: 'SELECT.LIST.ITEM',\n    0x01C7: 'SET.CONTROL.VALUE',\n    0x01C8: 'SAVE.COPY.AS',\n    0x01CA: 'OPTIONS.LISTS.ADD',\n    0x01CB: 'OPTIONS.LISTS.DELETE',\n    0x01CC: 'SERIES.AXES',\n    0x01CD: 'SERIES.X',\n    0x01CE: 'SERIES.Y',\n    0x01CF: 'ERRORBAR.X',\n    0x01D0: 'ERRORBAR.Y',\n    0x01D1: 'FORMAT.CHART',\n    0x01D2: 'SERIES.ORDER',\n    0x01D3: 'MAIL.LOGOFF',\n    0x01D4: 'CLEAR.ROUTING.SLIP',\n    0x01D5: 'APP.ACTIVATE.MICROSOFT',\n    0x01D6: 'MAIL.EDIT.MAILER',\n    0x01D7: 'ON.SHEET',\n    0x01D8: 'STANDARD.WIDTH',\n    0x01D9: 'SCENARIO.MERGE',\n    0x01DA: 'SUMMARY.INFO',\n    0x01DB: 'FIND.FILE',\n    0x01DC: 'ACTIVE.CELL.FONT',\n    0x01DD: 'ENABLE.TIPWIZARD',\n    0x01DE: 'VBA.MAKE.ADDIN',\n    0x01E0: 'INSERTDATATABLE',\n    0x01E1: 'WORKGROUP.OPTIONS',\n    0x01E2: 'MAIL.SEND.MAILER',\n    0x01E5: 'AUTOCORRECT',\n    0x01E9: 'POST.DOCUMENT',\n    0x01EB: 'PICKLIST',\n    0x01ED: 'VIEW.SHOW',\n    0x01EE: 'VIEW.DEFINE',\n    0x01EF: 'VIEW.DELETE',\n    0x01FD: 'SHEET.BACKGROUND',\n    0x01FE: 'INSERT.MAP.OBJECT',\n    0x01FF: 'OPTIONS.MENONO',\n    0x0205: 'MSOCHECKS',\n    0x0206: 'NORMAL',\n    0x0207: 'LAYOUT',\n    0x0208: 'RM.PRINT.AREA',\n    0x0209: 'CLEAR.PRINT.AREA',\n    0x020A: 'ADD.PRINT.AREA',\n    0x020B: 'MOVE.BRK',\n    0x0221: 'HIDECURR.NOTE',\n    0x0222: 'HIDEALL.NOTES',\n    0x0223: 'DELETE.NOTE',\n    0x0224: 'TRAVERSE.NOTES',\n    0x0225: 'ACTIVATE.NOTES',\n    0x026C: 'PROTECT.REVISIONS',\n    0x026D: 'UNPROTECT.REVISIONS',\n    0x0287: 'OPTIONS.ME',\n    0x028D: 'WEB.PUBLISH',\n    0x029B: 'NEWWEBQUERY',\n    0x02A1: 'PIVOT.TABLE.CHART',\n    0x02F1: 'OPTIONS.SAVE',\n    0x02F3: 'OPTIONS.SPELL',\n    0x0328: 'HIDEALL.INKANNOTS'\n  };\n\n  /* [MS-XLS] 2.5.198.17 */\n  /* [MS-XLSB] 2.5.97.10 */\n  var Ftab = {\n    0x0000: 'COUNT',\n    0x0001: 'IF',\n    0x0002: 'ISNA',\n    0x0003: 'ISERROR',\n    0x0004: 'SUM',\n    0x0005: 'AVERAGE',\n    0x0006: 'MIN',\n    0x0007: 'MAX',\n    0x0008: 'ROW',\n    0x0009: 'COLUMN',\n    0x000A: 'NA',\n    0x000B: 'NPV',\n    0x000C: 'STDEV',\n    0x000D: 'DOLLAR',\n    0x000E: 'FIXED',\n    0x000F: 'SIN',\n    0x0010: 'COS',\n    0x0011: 'TAN',\n    0x0012: 'ATAN',\n    0x0013: 'PI',\n    0x0014: 'SQRT',\n    0x0015: 'EXP',\n    0x0016: 'LN',\n    0x0017: 'LOG10',\n    0x0018: 'ABS',\n    0x0019: 'INT',\n    0x001A: 'SIGN',\n    0x001B: 'ROUND',\n    0x001C: 'LOOKUP',\n    0x001D: 'INDEX',\n    0x001E: 'REPT',\n    0x001F: 'MID',\n    0x0020: 'LEN',\n    0x0021: 'VALUE',\n    0x0022: 'TRUE',\n    0x0023: 'FALSE',\n    0x0024: 'AND',\n    0x0025: 'OR',\n    0x0026: 'NOT',\n    0x0027: 'MOD',\n    0x0028: 'DCOUNT',\n    0x0029: 'DSUM',\n    0x002A: 'DAVERAGE',\n    0x002B: 'DMIN',\n    0x002C: 'DMAX',\n    0x002D: 'DSTDEV',\n    0x002E: 'VAR',\n    0x002F: 'DVAR',\n    0x0030: 'TEXT',\n    0x0031: 'LINEST',\n    0x0032: 'TREND',\n    0x0033: 'LOGEST',\n    0x0034: 'GROWTH',\n    0x0035: 'GOTO',\n    0x0036: 'HALT',\n    0x0037: 'RETURN',\n    0x0038: 'PV',\n    0x0039: 'FV',\n    0x003A: 'NPER',\n    0x003B: 'PMT',\n    0x003C: 'RATE',\n    0x003D: 'MIRR',\n    0x003E: 'IRR',\n    0x003F: 'RAND',\n    0x0040: 'MATCH',\n    0x0041: 'DATE',\n    0x0042: 'TIME',\n    0x0043: 'DAY',\n    0x0044: 'MONTH',\n    0x0045: 'YEAR',\n    0x0046: 'WEEKDAY',\n    0x0047: 'HOUR',\n    0x0048: 'MINUTE',\n    0x0049: 'SECOND',\n    0x004A: 'NOW',\n    0x004B: 'AREAS',\n    0x004C: 'ROWS',\n    0x004D: 'COLUMNS',\n    0x004E: 'OFFSET',\n    0x004F: 'ABSREF',\n    0x0050: 'RELREF',\n    0x0051: 'ARGUMENT',\n    0x0052: 'SEARCH',\n    0x0053: 'TRANSPOSE',\n    0x0054: 'ERROR',\n    0x0055: 'STEP',\n    0x0056: 'TYPE',\n    0x0057: 'ECHO',\n    0x0058: 'SET.NAME',\n    0x0059: 'CALLER',\n    0x005A: 'DEREF',\n    0x005B: 'WINDOWS',\n    0x005C: 'SERIES',\n    0x005D: 'DOCUMENTS',\n    0x005E: 'ACTIVE.CELL',\n    0x005F: 'SELECTION',\n    0x0060: 'RESULT',\n    0x0061: 'ATAN2',\n    0x0062: 'ASIN',\n    0x0063: 'ACOS',\n    0x0064: 'CHOOSE',\n    0x0065: 'HLOOKUP',\n    0x0066: 'VLOOKUP',\n    0x0067: 'LINKS',\n    0x0068: 'INPUT',\n    0x0069: 'ISREF',\n    0x006A: 'GET.FORMULA',\n    0x006B: 'GET.NAME',\n    0x006C: 'SET.VALUE',\n    0x006D: 'LOG',\n    0x006E: 'EXEC',\n    0x006F: 'CHAR',\n    0x0070: 'LOWER',\n    0x0071: 'UPPER',\n    0x0072: 'PROPER',\n    0x0073: 'LEFT',\n    0x0074: 'RIGHT',\n    0x0075: 'EXACT',\n    0x0076: 'TRIM',\n    0x0077: 'REPLACE',\n    0x0078: 'SUBSTITUTE',\n    0x0079: 'CODE',\n    0x007A: 'NAMES',\n    0x007B: 'DIRECTORY',\n    0x007C: 'FIND',\n    0x007D: 'CELL',\n    0x007E: 'ISERR',\n    0x007F: 'ISTEXT',\n    0x0080: 'ISNUMBER',\n    0x0081: 'ISBLANK',\n    0x0082: 'T',\n    0x0083: 'N',\n    0x0084: 'FOPEN',\n    0x0085: 'FCLOSE',\n    0x0086: 'FSIZE',\n    0x0087: 'FREADLN',\n    0x0088: 'FREAD',\n    0x0089: 'FWRITELN',\n    0x008A: 'FWRITE',\n    0x008B: 'FPOS',\n    0x008C: 'DATEVALUE',\n    0x008D: 'TIMEVALUE',\n    0x008E: 'SLN',\n    0x008F: 'SYD',\n    0x0090: 'DDB',\n    0x0091: 'GET.DEF',\n    0x0092: 'REFTEXT',\n    0x0093: 'TEXTREF',\n    0x0094: 'INDIRECT',\n    0x0095: 'REGISTER',\n    0x0096: 'CALL',\n    0x0097: 'ADD.BAR',\n    0x0098: 'ADD.MENU',\n    0x0099: 'ADD.COMMAND',\n    0x009A: 'ENABLE.COMMAND',\n    0x009B: 'CHECK.COMMAND',\n    0x009C: 'RENAME.COMMAND',\n    0x009D: 'SHOW.BAR',\n    0x009E: 'DELETE.MENU',\n    0x009F: 'DELETE.COMMAND',\n    0x00A0: 'GET.CHART.ITEM',\n    0x00A1: 'DIALOG.BOX',\n    0x00A2: 'CLEAN',\n    0x00A3: 'MDETERM',\n    0x00A4: 'MINVERSE',\n    0x00A5: 'MMULT',\n    0x00A6: 'FILES',\n    0x00A7: 'IPMT',\n    0x00A8: 'PPMT',\n    0x00A9: 'COUNTA',\n    0x00AA: 'CANCEL.KEY',\n    0x00AB: 'FOR',\n    0x00AC: 'WHILE',\n    0x00AD: 'BREAK',\n    0x00AE: 'NEXT',\n    0x00AF: 'INITIATE',\n    0x00B0: 'REQUEST',\n    0x00B1: 'POKE',\n    0x00B2: 'EXECUTE',\n    0x00B3: 'TERMINATE',\n    0x00B4: 'RESTART',\n    0x00B5: 'HELP',\n    0x00B6: 'GET.BAR',\n    0x00B7: 'PRODUCT',\n    0x00B8: 'FACT',\n    0x00B9: 'GET.CELL',\n    0x00BA: 'GET.WORKSPACE',\n    0x00BB: 'GET.WINDOW',\n    0x00BC: 'GET.DOCUMENT',\n    0x00BD: 'DPRODUCT',\n    0x00BE: 'ISNONTEXT',\n    0x00BF: 'GET.NOTE',\n    0x00C0: 'NOTE',\n    0x00C1: 'STDEVP',\n    0x00C2: 'VARP',\n    0x00C3: 'DSTDEVP',\n    0x00C4: 'DVARP',\n    0x00C5: 'TRUNC',\n    0x00C6: 'ISLOGICAL',\n    0x00C7: 'DCOUNTA',\n    0x00C8: 'DELETE.BAR',\n    0x00C9: 'UNREGISTER',\n    0x00CC: 'USDOLLAR',\n    0x00CD: 'FINDB',\n    0x00CE: 'SEARCHB',\n    0x00CF: 'REPLACEB',\n    0x00D0: 'LEFTB',\n    0x00D1: 'RIGHTB',\n    0x00D2: 'MIDB',\n    0x00D3: 'LENB',\n    0x00D4: 'ROUNDUP',\n    0x00D5: 'ROUNDDOWN',\n    0x00D6: 'ASC',\n    0x00D7: 'DBCS',\n    0x00D8: 'RANK',\n    0x00DB: 'ADDRESS',\n    0x00DC: 'DAYS360',\n    0x00DD: 'TODAY',\n    0x00DE: 'VDB',\n    0x00DF: 'ELSE',\n    0x00E0: 'ELSE.IF',\n    0x00E1: 'END.IF',\n    0x00E2: 'FOR.CELL',\n    0x00E3: 'MEDIAN',\n    0x00E4: 'SUMPRODUCT',\n    0x00E5: 'SINH',\n    0x00E6: 'COSH',\n    0x00E7: 'TANH',\n    0x00E8: 'ASINH',\n    0x00E9: 'ACOSH',\n    0x00EA: 'ATANH',\n    0x00EB: 'DGET',\n    0x00EC: 'CREATE.OBJECT',\n    0x00ED: 'VOLATILE',\n    0x00EE: 'LAST.ERROR',\n    0x00EF: 'CUSTOM.UNDO',\n    0x00F0: 'CUSTOM.REPEAT',\n    0x00F1: 'FORMULA.CONVERT',\n    0x00F2: 'GET.LINK.INFO',\n    0x00F3: 'TEXT.BOX',\n    0x00F4: 'INFO',\n    0x00F5: 'GROUP',\n    0x00F6: 'GET.OBJECT',\n    0x00F7: 'DB',\n    0x00F8: 'PAUSE',\n    0x00FB: 'RESUME',\n    0x00FC: 'FREQUENCY',\n    0x00FD: 'ADD.TOOLBAR',\n    0x00FE: 'DELETE.TOOLBAR',\n    0x00FF: 'User',\n    0x0100: 'RESET.TOOLBAR',\n    0x0101: 'EVALUATE',\n    0x0102: 'GET.TOOLBAR',\n    0x0103: 'GET.TOOL',\n    0x0104: 'SPELLING.CHECK',\n    0x0105: 'ERROR.TYPE',\n    0x0106: 'APP.TITLE',\n    0x0107: 'WINDOW.TITLE',\n    0x0108: 'SAVE.TOOLBAR',\n    0x0109: 'ENABLE.TOOL',\n    0x010A: 'PRESS.TOOL',\n    0x010B: 'REGISTER.ID',\n    0x010C: 'GET.WORKBOOK',\n    0x010D: 'AVEDEV',\n    0x010E: 'BETADIST',\n    0x010F: 'GAMMALN',\n    0x0110: 'BETAINV',\n    0x0111: 'BINOMDIST',\n    0x0112: 'CHIDIST',\n    0x0113: 'CHIINV',\n    0x0114: 'COMBIN',\n    0x0115: 'CONFIDENCE',\n    0x0116: 'CRITBINOM',\n    0x0117: 'EVEN',\n    0x0118: 'EXPONDIST',\n    0x0119: 'FDIST',\n    0x011A: 'FINV',\n    0x011B: 'FISHER',\n    0x011C: 'FISHERINV',\n    0x011D: 'FLOOR',\n    0x011E: 'GAMMADIST',\n    0x011F: 'GAMMAINV',\n    0x0120: 'CEILING',\n    0x0121: 'HYPGEOMDIST',\n    0x0122: 'LOGNORMDIST',\n    0x0123: 'LOGINV',\n    0x0124: 'NEGBINOMDIST',\n    0x0125: 'NORMDIST',\n    0x0126: 'NORMSDIST',\n    0x0127: 'NORMINV',\n    0x0128: 'NORMSINV',\n    0x0129: 'STANDARDIZE',\n    0x012A: 'ODD',\n    0x012B: 'PERMUT',\n    0x012C: 'POISSON',\n    0x012D: 'TDIST',\n    0x012E: 'WEIBULL',\n    0x012F: 'SUMXMY2',\n    0x0130: 'SUMX2MY2',\n    0x0131: 'SUMX2PY2',\n    0x0132: 'CHITEST',\n    0x0133: 'CORREL',\n    0x0134: 'COVAR',\n    0x0135: 'FORECAST',\n    0x0136: 'FTEST',\n    0x0137: 'INTERCEPT',\n    0x0138: 'PEARSON',\n    0x0139: 'RSQ',\n    0x013A: 'STEYX',\n    0x013B: 'SLOPE',\n    0x013C: 'TTEST',\n    0x013D: 'PROB',\n    0x013E: 'DEVSQ',\n    0x013F: 'GEOMEAN',\n    0x0140: 'HARMEAN',\n    0x0141: 'SUMSQ',\n    0x0142: 'KURT',\n    0x0143: 'SKEW',\n    0x0144: 'ZTEST',\n    0x0145: 'LARGE',\n    0x0146: 'SMALL',\n    0x0147: 'QUARTILE',\n    0x0148: 'PERCENTILE',\n    0x0149: 'PERCENTRANK',\n    0x014A: 'MODE',\n    0x014B: 'TRIMMEAN',\n    0x014C: 'TINV',\n    0x014E: 'MOVIE.COMMAND',\n    0x014F: 'GET.MOVIE',\n    0x0150: 'CONCATENATE',\n    0x0151: 'POWER',\n    0x0152: 'PIVOT.ADD.DATA',\n    0x0153: 'GET.PIVOT.TABLE',\n    0x0154: 'GET.PIVOT.FIELD',\n    0x0155: 'GET.PIVOT.ITEM',\n    0x0156: 'RADIANS',\n    0x0157: 'DEGREES',\n    0x0158: 'SUBTOTAL',\n    0x0159: 'SUMIF',\n    0x015A: 'COUNTIF',\n    0x015B: 'COUNTBLANK',\n    0x015C: 'SCENARIO.GET',\n    0x015D: 'OPTIONS.LISTS.GET',\n    0x015E: 'ISPMT',\n    0x015F: 'DATEDIF',\n    0x0160: 'DATESTRING',\n    0x0161: 'NUMBERSTRING',\n    0x0162: 'ROMAN',\n    0x0163: 'OPEN.DIALOG',\n    0x0164: 'SAVE.DIALOG',\n    0x0165: 'VIEW.GET',\n    0x0166: 'GETPIVOTDATA',\n    0x0167: 'HYPERLINK',\n    0x0168: 'PHONETIC',\n    0x0169: 'AVERAGEA',\n    0x016A: 'MAXA',\n    0x016B: 'MINA',\n    0x016C: 'STDEVPA',\n    0x016D: 'VARPA',\n    0x016E: 'STDEVA',\n    0x016F: 'VARA',\n    0x0170: 'BAHTTEXT',\n    0x0171: 'THAIDAYOFWEEK',\n    0x0172: 'THAIDIGIT',\n    0x0173: 'THAIMONTHOFYEAR',\n    0x0174: 'THAINUMSOUND',\n    0x0175: 'THAINUMSTRING',\n    0x0176: 'THAISTRINGLENGTH',\n    0x0177: 'ISTHAIDIGIT',\n    0x0178: 'ROUNDBAHTDOWN',\n    0x0179: 'ROUNDBAHTUP',\n    0x017A: 'THAIYEAR',\n    0x017B: 'RTD',\n    0x017C: 'CUBEVALUE',\n    0x017D: 'CUBEMEMBER',\n    0x017E: 'CUBEMEMBERPROPERTY',\n    0x017F: 'CUBERANKEDMEMBER',\n    0x0180: 'HEX2BIN',\n    0x0181: 'HEX2DEC',\n    0x0182: 'HEX2OCT',\n    0x0183: 'DEC2BIN',\n    0x0184: 'DEC2HEX',\n    0x0185: 'DEC2OCT',\n    0x0186: 'OCT2BIN',\n    0x0187: 'OCT2HEX',\n    0x0188: 'OCT2DEC',\n    0x0189: 'BIN2DEC',\n    0x018A: 'BIN2OCT',\n    0x018B: 'BIN2HEX',\n    0x018C: 'IMSUB',\n    0x018D: 'IMDIV',\n    0x018E: 'IMPOWER',\n    0x018F: 'IMABS',\n    0x0190: 'IMSQRT',\n    0x0191: 'IMLN',\n    0x0192: 'IMLOG2',\n    0x0193: 'IMLOG10',\n    0x0194: 'IMSIN',\n    0x0195: 'IMCOS',\n    0x0196: 'IMEXP',\n    0x0197: 'IMARGUMENT',\n    0x0198: 'IMCONJUGATE',\n    0x0199: 'IMAGINARY',\n    0x019A: 'IMREAL',\n    0x019B: 'COMPLEX',\n    0x019C: 'IMSUM',\n    0x019D: 'IMPRODUCT',\n    0x019E: 'SERIESSUM',\n    0x019F: 'FACTDOUBLE',\n    0x01A0: 'SQRTPI',\n    0x01A1: 'QUOTIENT',\n    0x01A2: 'DELTA',\n    0x01A3: 'GESTEP',\n    0x01A4: 'ISEVEN',\n    0x01A5: 'ISODD',\n    0x01A6: 'MROUND',\n    0x01A7: 'ERF',\n    0x01A8: 'ERFC',\n    0x01A9: 'BESSELJ',\n    0x01AA: 'BESSELK',\n    0x01AB: 'BESSELY',\n    0x01AC: 'BESSELI',\n    0x01AD: 'XIRR',\n    0x01AE: 'XNPV',\n    0x01AF: 'PRICEMAT',\n    0x01B0: 'YIELDMAT',\n    0x01B1: 'INTRATE',\n    0x01B2: 'RECEIVED',\n    0x01B3: 'DISC',\n    0x01B4: 'PRICEDISC',\n    0x01B5: 'YIELDDISC',\n    0x01B6: 'TBILLEQ',\n    0x01B7: 'TBILLPRICE',\n    0x01B8: 'TBILLYIELD',\n    0x01B9: 'PRICE',\n    0x01BA: 'YIELD',\n    0x01BB: 'DOLLARDE',\n    0x01BC: 'DOLLARFR',\n    0x01BD: 'NOMINAL',\n    0x01BE: 'EFFECT',\n    0x01BF: 'CUMPRINC',\n    0x01C0: 'CUMIPMT',\n    0x01C1: 'EDATE',\n    0x01C2: 'EOMONTH',\n    0x01C3: 'YEARFRAC',\n    0x01C4: 'COUPDAYBS',\n    0x01C5: 'COUPDAYS',\n    0x01C6: 'COUPDAYSNC',\n    0x01C7: 'COUPNCD',\n    0x01C8: 'COUPNUM',\n    0x01C9: 'COUPPCD',\n    0x01CA: 'DURATION',\n    0x01CB: 'MDURATION',\n    0x01CC: 'ODDLPRICE',\n    0x01CD: 'ODDLYIELD',\n    0x01CE: 'ODDFPRICE',\n    0x01CF: 'ODDFYIELD',\n    0x01D0: 'RANDBETWEEN',\n    0x01D1: 'WEEKNUM',\n    0x01D2: 'AMORDEGRC',\n    0x01D3: 'AMORLINC',\n    0x01D4: 'SHEETJS',\n    0x01D5: 'ACCRINT',\n    0x01D6: 'ACCRINTM',\n    0x01D7: 'WORKDAY',\n    0x01D8: 'NETWORKDAYS',\n    0x01D9: 'GCD',\n    0x01DA: 'MULTINOMIAL',\n    0x01DB: 'LCM',\n    0x01DC: 'FVSCHEDULE',\n    0x01DD: 'CUBEKPIMEMBER',\n    0x01DE: 'CUBESET',\n    0x01DF: 'CUBESETCOUNT',\n    0x01E0: 'IFERROR',\n    0x01E1: 'COUNTIFS',\n    0x01E2: 'SUMIFS',\n    0x01E3: 'AVERAGEIF',\n    0x01E4: 'AVERAGEIFS'\n  };\n  var FtabArgc = {\n    0x0002: 1,\n    /* ISNA */\n    0x0003: 1,\n    /* ISERROR */\n    0x000F: 1,\n    /* SIN */\n    0x0010: 1,\n    /* COS */\n    0x0011: 1,\n    /* TAN */\n    0x0012: 1,\n    /* ATAN */\n    0x0013: 0,\n    /* PI */\n    0x0014: 1,\n    /* SQRT */\n    0x0015: 1,\n    /* EXP */\n    0x0016: 1,\n    /* LN */\n    0x0017: 1,\n    /* LOG10 */\n    0x0018: 1,\n    /* ABS */\n    0x0019: 1,\n    /* INT */\n    0x001A: 1,\n    /* SIGN */\n    0x001B: 2,\n    /* ROUND */\n    0x001E: 2,\n    /* REPT */\n    0x001F: 3,\n    /* MID */\n    0x0020: 1,\n    /* LEN */\n    0x0021: 1,\n    /* VALUE */\n    0x0026: 1,\n    /* NOT */\n    0x0027: 2,\n    /* MOD */\n    0x0028: 3,\n    /* DCOUNT */\n    0x0029: 3,\n    /* DSUM */\n    0x002A: 3,\n    /* DAVERAGE */\n    0x002B: 3,\n    /* DMIN */\n    0x002C: 3,\n    /* DMAX */\n    0x002D: 3,\n    /* DSTDEV */\n    0x002F: 3,\n    /* DVAR */\n    0x0030: 2,\n    /* TEXT */\n    0x0035: 1,\n    /* GOTO */\n    0x003D: 3,\n    /* MIRR */\n    0x0041: 3,\n    /* DATE */\n    0x0042: 3,\n    /* TIME */\n    0x0043: 1,\n    /* DAY */\n    0x0044: 1,\n    /* MONTH */\n    0x0045: 1,\n    /* YEAR */\n    0x0046: 1,\n    /* WEEKDAY */\n    0x0047: 1,\n    /* HOUR */\n    0x0048: 1,\n    /* MINUTE */\n    0x0049: 1,\n    /* SECOND */\n    0x004B: 1,\n    /* AREAS */\n    0x004C: 1,\n    /* ROWS */\n    0x004D: 1,\n    /* COLUMNS */\n    0x004F: 2,\n    /* ABSREF */\n    0x0050: 2,\n    /* RELREF */\n    0x0053: 1,\n    /* TRANSPOSE */\n    0x0055: 0,\n    /* STEP */\n    0x0056: 1,\n    /* TYPE */\n    0x005A: 1,\n    /* DEREF */\n    0x0061: 2,\n    /* ATAN2 */\n    0x0062: 1,\n    /* ASIN */\n    0x0063: 1,\n    /* ACOS */\n    0x0065: 3,\n    /* HLOOKUP */\n    0x0066: 3,\n    /* VLOOKUP */\n    0x0069: 1,\n    /* ISREF */\n    0x006F: 1,\n    /* CHAR */\n    0x0070: 1,\n    /* LOWER */\n    0x0071: 1,\n    /* UPPER */\n    0x0072: 1,\n    /* PROPER */\n    0x0075: 2,\n    /* EXACT */\n    0x0076: 1,\n    /* TRIM */\n    0x0077: 4,\n    /* REPLACE */\n    0x0079: 1,\n    /* CODE */\n    0x007E: 1,\n    /* ISERR */\n    0x007F: 1,\n    /* ISTEXT */\n    0x0080: 1,\n    /* ISNUMBER */\n    0x0081: 1,\n    /* ISBLANK */\n    0x0082: 1,\n    /* T */\n    0x0083: 1,\n    /* N */\n    0x0085: 1,\n    /* FCLOSE */\n    0x0086: 1,\n    /* FSIZE */\n    0x0087: 1,\n    /* FREADLN */\n    0x0088: 2,\n    /* FREAD */\n    0x0089: 2,\n    /* FWRITELN */\n    0x008A: 2,\n    /* FWRITE */\n    0x008C: 1,\n    /* DATEVALUE */\n    0x008D: 1,\n    /* TIMEVALUE */\n    0x008E: 3,\n    /* SLN */\n    0x008F: 4,\n    /* SYD */\n    0x0090: 4,\n    /* DDB */\n    0x00A2: 1,\n    /* CLEAN */\n    0x00A3: 1,\n    /* MDETERM */\n    0x00A4: 1,\n    /* MINVERSE */\n    0x00A5: 2,\n    /* MMULT */\n    0x00AC: 1,\n    /* WHILE */\n    0x00AF: 2,\n    /* INITIATE */\n    0x00B0: 2,\n    /* REQUEST */\n    0x00B1: 3,\n    /* POKE */\n    0x00B2: 2,\n    /* EXECUTE */\n    0x00B3: 1,\n    /* TERMINATE */\n    0x00B8: 1,\n    /* FACT */\n    0x00BD: 3,\n    /* DPRODUCT */\n    0x00BE: 1,\n    /* ISNONTEXT */\n    0x00C3: 3,\n    /* DSTDEVP */\n    0x00C4: 3,\n    /* DVARP */\n    0x00C5: 1,\n    /* TRUNC */\n    0x00C6: 1,\n    /* ISLOGICAL */\n    0x00C7: 3,\n    /* DCOUNTA */\n    0x00C9: 1,\n    /* UNREGISTER */\n    0x00CF: 4,\n    /* REPLACEB */\n    0x00D2: 3,\n    /* MIDB */\n    0x00D3: 1,\n    /* LENB */\n    0x00D4: 2,\n    /* ROUNDUP */\n    0x00D5: 2,\n    /* ROUNDDOWN */\n    0x00D6: 1,\n    /* ASC */\n    0x00D7: 1,\n    /* DBCS */\n    0x00E5: 1,\n    /* SINH */\n    0x00E6: 1,\n    /* COSH */\n    0x00E7: 1,\n    /* TANH */\n    0x00E8: 1,\n    /* ASINH */\n    0x00E9: 1,\n    /* ACOSH */\n    0x00EA: 1,\n    /* ATANH */\n    0x00EB: 3,\n    /* DGET */\n    0x00F4: 1,\n    /* INFO */\n    0x00F7: 4,\n    /* DB */\n    0x00FC: 2,\n    /* FREQUENCY */\n    0x0101: 1,\n    /* EVALUATE */\n    0x0105: 1,\n    /* ERROR.TYPE */\n    0x010F: 1,\n    /* GAMMALN */\n    0x0111: 4,\n    /* BINOMDIST */\n    0x0112: 2,\n    /* CHIDIST */\n    0x0113: 2,\n    /* CHIINV */\n    0x0114: 2,\n    /* COMBIN */\n    0x0115: 3,\n    /* CONFIDENCE */\n    0x0116: 3,\n    /* CRITBINOM */\n    0x0117: 1,\n    /* EVEN */\n    0x0118: 3,\n    /* EXPONDIST */\n    0x0119: 3,\n    /* FDIST */\n    0x011A: 3,\n    /* FINV */\n    0x011B: 1,\n    /* FISHER */\n    0x011C: 1,\n    /* FISHERINV */\n    0x011D: 2,\n    /* FLOOR */\n    0x011E: 4,\n    /* GAMMADIST */\n    0x011F: 3,\n    /* GAMMAINV */\n    0x0120: 2,\n    /* CEILING */\n    0x0121: 4,\n    /* HYPGEOMDIST */\n    0x0122: 3,\n    /* LOGNORMDIST */\n    0x0123: 3,\n    /* LOGINV */\n    0x0124: 3,\n    /* NEGBINOMDIST */\n    0x0125: 4,\n    /* NORMDIST */\n    0x0126: 1,\n    /* NORMSDIST */\n    0x0127: 3,\n    /* NORMINV */\n    0x0128: 1,\n    /* NORMSINV */\n    0x0129: 3,\n    /* STANDARDIZE */\n    0x012A: 1,\n    /* ODD */\n    0x012B: 2,\n    /* PERMUT */\n    0x012C: 3,\n    /* POISSON */\n    0x012D: 3,\n    /* TDIST */\n    0x012E: 4,\n    /* WEIBULL */\n    0x012F: 2,\n    /* SUMXMY2 */\n    0x0130: 2,\n    /* SUMX2MY2 */\n    0x0131: 2,\n    /* SUMX2PY2 */\n    0x0132: 2,\n    /* CHITEST */\n    0x0133: 2,\n    /* CORREL */\n    0x0134: 2,\n    /* COVAR */\n    0x0135: 3,\n    /* FORECAST */\n    0x0136: 2,\n    /* FTEST */\n    0x0137: 2,\n    /* INTERCEPT */\n    0x0138: 2,\n    /* PEARSON */\n    0x0139: 2,\n    /* RSQ */\n    0x013A: 2,\n    /* STEYX */\n    0x013B: 2,\n    /* SLOPE */\n    0x013C: 4,\n    /* TTEST */\n    0x0145: 2,\n    /* LARGE */\n    0x0146: 2,\n    /* SMALL */\n    0x0147: 2,\n    /* QUARTILE */\n    0x0148: 2,\n    /* PERCENTILE */\n    0x014B: 2,\n    /* TRIMMEAN */\n    0x014C: 2,\n    /* TINV */\n    0x0151: 2,\n    /* POWER */\n    0x0156: 1,\n    /* RADIANS */\n    0x0157: 1,\n    /* DEGREES */\n    0x015A: 2,\n    /* COUNTIF */\n    0x015B: 1,\n    /* COUNTBLANK */\n    0x015E: 4,\n    /* ISPMT */\n    0x015F: 3,\n    /* DATEDIF */\n    0x0160: 1,\n    /* DATESTRING */\n    0x0161: 2,\n    /* NUMBERSTRING */\n    0x0168: 1,\n    /* PHONETIC */\n    0x0170: 1,\n    /* BAHTTEXT */\n    0x0171: 1,\n    /* THAIDAYOFWEEK */\n    0x0172: 1,\n    /* THAIDIGIT */\n    0x0173: 1,\n    /* THAIMONTHOFYEAR */\n    0x0174: 1,\n    /* THAINUMSOUND */\n    0x0175: 1,\n    /* THAINUMSTRING */\n    0x0176: 1,\n    /* THAISTRINGLENGTH */\n    0x0177: 1,\n    /* ISTHAIDIGIT */\n    0x0178: 1,\n    /* ROUNDBAHTDOWN */\n    0x0179: 1,\n    /* ROUNDBAHTUP */\n    0x017A: 1,\n    /* THAIYEAR */\n    0x01A0: 1,\n    /* SQRTPI */\n    0x01C1: 2,\n    /* EDATE */\n    0x01C2: 2,\n    /* EOMONTH */\n    0xFFFF: 0\n  };\n  /* [MS-XLSX] 2.2.3 Functions */\n  /* [MS-XLSB] 2.5.97.10 Ftab */\n  var XLSXFutureFunctions = {\n    \"_xlfn.ACOT\": \"ACOT\",\n    \"_xlfn.ACOTH\": \"ACOTH\",\n    \"_xlfn.AGGREGATE\": \"AGGREGATE\",\n    \"_xlfn.ARABIC\": \"ARABIC\",\n    \"_xlfn.AVERAGEIF\": \"AVERAGEIF\",\n    \"_xlfn.AVERAGEIFS\": \"AVERAGEIFS\",\n    \"_xlfn.BASE\": \"BASE\",\n    \"_xlfn.BETA.DIST\": \"BETA.DIST\",\n    \"_xlfn.BETA.INV\": \"BETA.INV\",\n    \"_xlfn.BINOM.DIST\": \"BINOM.DIST\",\n    \"_xlfn.BINOM.DIST.RANGE\": \"BINOM.DIST.RANGE\",\n    \"_xlfn.BINOM.INV\": \"BINOM.INV\",\n    \"_xlfn.BITAND\": \"BITAND\",\n    \"_xlfn.BITLSHIFT\": \"BITLSHIFT\",\n    \"_xlfn.BITOR\": \"BITOR\",\n    \"_xlfn.BITRSHIFT\": \"BITRSHIFT\",\n    \"_xlfn.BITXOR\": \"BITXOR\",\n    \"_xlfn.CEILING.MATH\": \"CEILING.MATH\",\n    \"_xlfn.CEILING.PRECISE\": \"CEILING.PRECISE\",\n    \"_xlfn.CHISQ.DIST\": \"CHISQ.DIST\",\n    \"_xlfn.CHISQ.DIST.RT\": \"CHISQ.DIST.RT\",\n    \"_xlfn.CHISQ.INV\": \"CHISQ.INV\",\n    \"_xlfn.CHISQ.INV.RT\": \"CHISQ.INV.RT\",\n    \"_xlfn.CHISQ.TEST\": \"CHISQ.TEST\",\n    \"_xlfn.COMBINA\": \"COMBINA\",\n    \"_xlfn.CONFIDENCE.NORM\": \"CONFIDENCE.NORM\",\n    \"_xlfn.CONFIDENCE.T\": \"CONFIDENCE.T\",\n    \"_xlfn.COT\": \"COT\",\n    \"_xlfn.COTH\": \"COTH\",\n    \"_xlfn.COUNTIFS\": \"COUNTIFS\",\n    \"_xlfn.COVARIANCE.P\": \"COVARIANCE.P\",\n    \"_xlfn.COVARIANCE.S\": \"COVARIANCE.S\",\n    \"_xlfn.CSC\": \"CSC\",\n    \"_xlfn.CSCH\": \"CSCH\",\n    \"_xlfn.DAYS\": \"DAYS\",\n    \"_xlfn.DECIMAL\": \"DECIMAL\",\n    \"_xlfn.ECMA.CEILING\": \"ECMA.CEILING\",\n    \"_xlfn.ERF.PRECISE\": \"ERF.PRECISE\",\n    \"_xlfn.ERFC.PRECISE\": \"ERFC.PRECISE\",\n    \"_xlfn.EXPON.DIST\": \"EXPON.DIST\",\n    \"_xlfn.F.DIST\": \"F.DIST\",\n    \"_xlfn.F.DIST.RT\": \"F.DIST.RT\",\n    \"_xlfn.F.INV\": \"F.INV\",\n    \"_xlfn.F.INV.RT\": \"F.INV.RT\",\n    \"_xlfn.F.TEST\": \"F.TEST\",\n    \"_xlfn.FILTERXML\": \"FILTERXML\",\n    \"_xlfn.FLOOR.MATH\": \"FLOOR.MATH\",\n    \"_xlfn.FLOOR.PRECISE\": \"FLOOR.PRECISE\",\n    \"_xlfn.FORMULATEXT\": \"FORMULATEXT\",\n    \"_xlfn.GAMMA\": \"GAMMA\",\n    \"_xlfn.GAMMA.DIST\": \"GAMMA.DIST\",\n    \"_xlfn.GAMMA.INV\": \"GAMMA.INV\",\n    \"_xlfn.GAMMALN.PRECISE\": \"GAMMALN.PRECISE\",\n    \"_xlfn.GAUSS\": \"GAUSS\",\n    \"_xlfn.HYPGEOM.DIST\": \"HYPGEOM.DIST\",\n    \"_xlfn.IFNA\": \"IFNA\",\n    \"_xlfn.IFERROR\": \"IFERROR\",\n    \"_xlfn.IMCOSH\": \"IMCOSH\",\n    \"_xlfn.IMCOT\": \"IMCOT\",\n    \"_xlfn.IMCSC\": \"IMCSC\",\n    \"_xlfn.IMCSCH\": \"IMCSCH\",\n    \"_xlfn.IMSEC\": \"IMSEC\",\n    \"_xlfn.IMSECH\": \"IMSECH\",\n    \"_xlfn.IMSINH\": \"IMSINH\",\n    \"_xlfn.IMTAN\": \"IMTAN\",\n    \"_xlfn.ISFORMULA\": \"ISFORMULA\",\n    \"_xlfn.ISO.CEILING\": \"ISO.CEILING\",\n    \"_xlfn.ISOWEEKNUM\": \"ISOWEEKNUM\",\n    \"_xlfn.LOGNORM.DIST\": \"LOGNORM.DIST\",\n    \"_xlfn.LOGNORM.INV\": \"LOGNORM.INV\",\n    \"_xlfn.MODE.MULT\": \"MODE.MULT\",\n    \"_xlfn.MODE.SNGL\": \"MODE.SNGL\",\n    \"_xlfn.MUNIT\": \"MUNIT\",\n    \"_xlfn.NEGBINOM.DIST\": \"NEGBINOM.DIST\",\n    \"_xlfn.NETWORKDAYS.INTL\": \"NETWORKDAYS.INTL\",\n    \"_xlfn.NIGBINOM\": \"NIGBINOM\",\n    \"_xlfn.NORM.DIST\": \"NORM.DIST\",\n    \"_xlfn.NORM.INV\": \"NORM.INV\",\n    \"_xlfn.NORM.S.DIST\": \"NORM.S.DIST\",\n    \"_xlfn.NORM.S.INV\": \"NORM.S.INV\",\n    \"_xlfn.NUMBERVALUE\": \"NUMBERVALUE\",\n    \"_xlfn.PDURATION\": \"PDURATION\",\n    \"_xlfn.PERCENTILE.EXC\": \"PERCENTILE.EXC\",\n    \"_xlfn.PERCENTILE.INC\": \"PERCENTILE.INC\",\n    \"_xlfn.PERCENTRANK.EXC\": \"PERCENTRANK.EXC\",\n    \"_xlfn.PERCENTRANK.INC\": \"PERCENTRANK.INC\",\n    \"_xlfn.PERMUTATIONA\": \"PERMUTATIONA\",\n    \"_xlfn.PHI\": \"PHI\",\n    \"_xlfn.POISSON.DIST\": \"POISSON.DIST\",\n    \"_xlfn.QUARTILE.EXC\": \"QUARTILE.EXC\",\n    \"_xlfn.QUARTILE.INC\": \"QUARTILE.INC\",\n    \"_xlfn.QUERYSTRING\": \"QUERYSTRING\",\n    \"_xlfn.RANK.AVG\": \"RANK.AVG\",\n    \"_xlfn.RANK.EQ\": \"RANK.EQ\",\n    \"_xlfn.RRI\": \"RRI\",\n    \"_xlfn.SEC\": \"SEC\",\n    \"_xlfn.SECH\": \"SECH\",\n    \"_xlfn.SHEET\": \"SHEET\",\n    \"_xlfn.SHEETS\": \"SHEETS\",\n    \"_xlfn.SKEW.P\": \"SKEW.P\",\n    \"_xlfn.STDEV.P\": \"STDEV.P\",\n    \"_xlfn.STDEV.S\": \"STDEV.S\",\n    \"_xlfn.SUMIFS\": \"SUMIFS\",\n    \"_xlfn.T.DIST\": \"T.DIST\",\n    \"_xlfn.T.DIST.2T\": \"T.DIST.2T\",\n    \"_xlfn.T.DIST.RT\": \"T.DIST.RT\",\n    \"_xlfn.T.INV\": \"T.INV\",\n    \"_xlfn.T.INV.2T\": \"T.INV.2T\",\n    \"_xlfn.T.TEST\": \"T.TEST\",\n    \"_xlfn.UNICHAR\": \"UNICHAR\",\n    \"_xlfn.UNICODE\": \"UNICODE\",\n    \"_xlfn.VAR.P\": \"VAR.P\",\n    \"_xlfn.VAR.S\": \"VAR.S\",\n    \"_xlfn.WEBSERVICE\": \"WEBSERVICE\",\n    \"_xlfn.WEIBULL.DIST\": \"WEIBULL.DIST\",\n    \"_xlfn.WORKDAY.INTL\": \"WORKDAY.INTL\",\n    \"_xlfn.XOR\": \"XOR\",\n    \"_xlfn.Z.TEST\": \"Z.TEST\"\n  };\n\n  /* 2.4.326 TODO: payload is a zip file */\n  function parse_Theme(blob, length) {\n    var dwThemeVersion = blob.read_shift(4);\n    if (dwThemeVersion === 124226) return;\n    blob.l += length - 4;\n  }\n\n  /* 2.5.49 */\n  function parse_ColorTheme(blob, length) {\n    return blob.read_shift(4);\n  }\n\n  /* 2.5.155 */\n  function parse_FullColorExt(blob, length) {\n    var o = {};\n    o.xclrType = blob.read_shift(2);\n    o.nTintShade = blob.read_shift(2);\n    switch (o.xclrType) {\n      case 0:\n        blob.l += 4;\n        break;\n      case 1:\n        o.xclrValue = parse_IcvXF(blob, 4);\n        break;\n      case 2:\n        o.xclrValue = parse_LongRGBA(blob, 4);\n        break;\n      case 3:\n        o.xclrValue = parse_ColorTheme(blob, 4);\n        break;\n      case 4:\n        blob.l += 4;\n        break;\n    }\n    blob.l += 8;\n    return o;\n  }\n\n  /* 2.5.164 TODO: read 7 bits*/\n  function parse_IcvXF(blob, length) {\n    return parsenoop(blob, length);\n  }\n\n  /* 2.5.280 */\n  function parse_XFExtGradient(blob, length) {\n    return parsenoop(blob, length);\n  }\n\n  /* 2.5.108 */\n  function parse_ExtProp(blob, length) {\n    var extType = blob.read_shift(2);\n    var cb = blob.read_shift(2);\n    var o = [extType];\n    switch (extType) {\n      case 0x04:\n      case 0x05:\n      case 0x07:\n      case 0x08:\n      case 0x09:\n      case 0x0A:\n      case 0x0B:\n      case 0x0D:\n        o[1] = parse_FullColorExt(blob, cb);\n        break;\n      case 0x06:\n        o[1] = parse_XFExtGradient(blob, cb);\n        break;\n      case 0x0E:\n      case 0x0F:\n        o[1] = blob.read_shift(cb === 5 ? 1 : 2);\n        break;\n      default:\n        throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n    }\n    return o;\n  }\n\n  /* 2.4.355 */\n  function parse_XFExt(blob, length) {\n    var end = blob.l + length;\n    blob.l += 2;\n    var ixfe = blob.read_shift(2);\n    blob.l += 2;\n    var cexts = blob.read_shift(2);\n    var ext = [];\n    while (cexts-- > 0) ext.push(parse_ExtProp(blob, end - blob.l));\n    return {\n      ixfe: ixfe,\n      ext: ext\n    };\n  }\n\n  /* xf is an XF, see parse_XFExt for xfext */\n  function update_xfext(xf, xfext) {\n    xfext.forEach(function (xfe) {\n      switch (xfe[0]) {\n        /* 2.5.108 extPropData */\n        case 0x04:\n          break;\n        /* foreground color */\n        case 0x05:\n          break;\n        /* background color */\n        case 0x07:\n        case 0x08:\n        case 0x09:\n        case 0x0a:\n          break;\n        case 0x0d:\n          break;\n        /* text color */\n        case 0x0e:\n          break;\n        /* font scheme */\n        default:\n          throw \"bafuq\" + xfe[0].toString(16);\n      }\n    });\n  }\n  /* [MS-XLS] 2.3 Record Enumeration */\n  var RecordEnum = {\n    0x0003: {\n      n: \"BIFF2NUM\",\n      f: parse_BIFF2NUM\n    },\n    0x0004: {\n      n: \"BIFF2STR\",\n      f: parse_BIFF2STR\n    },\n    0x0006: {\n      n: \"Formula\",\n      f: parse_Formula\n    },\n    0x0009: {\n      n: 'BOF',\n      f: parse_BOF\n    },\n    0x000a: {\n      n: 'EOF',\n      f: parse_EOF\n    },\n    0x000c: {\n      n: \"CalcCount\",\n      f: parse_CalcCount\n    },\n    0x000d: {\n      n: \"CalcMode\",\n      f: parse_CalcMode\n    },\n    0x000e: {\n      n: \"CalcPrecision\",\n      f: parse_CalcPrecision\n    },\n    0x000f: {\n      n: \"CalcRefMode\",\n      f: parse_CalcRefMode\n    },\n    0x0010: {\n      n: \"CalcDelta\",\n      f: parse_CalcDelta\n    },\n    0x0011: {\n      n: \"CalcIter\",\n      f: parse_CalcIter\n    },\n    0x0012: {\n      n: \"Protect\",\n      f: parse_Protect\n    },\n    0x0013: {\n      n: \"Password\",\n      f: parse_Password\n    },\n    0x0014: {\n      n: \"Header\",\n      f: parse_Header\n    },\n    0x0015: {\n      n: \"Footer\",\n      f: parse_Footer\n    },\n    0x0017: {\n      n: \"ExternSheet\",\n      f: parse_ExternSheet\n    },\n    0x0018: {\n      n: \"Lbl\",\n      f: parse_Lbl\n    },\n    0x0019: {\n      n: \"WinProtect\",\n      f: parse_WinProtect\n    },\n    0x001a: {\n      n: \"VerticalPageBreaks\",\n      f: parse_VerticalPageBreaks\n    },\n    0x001b: {\n      n: \"HorizontalPageBreaks\",\n      f: parse_HorizontalPageBreaks\n    },\n    0x001c: {\n      n: \"Note\",\n      f: parse_Note\n    },\n    0x001d: {\n      n: \"Selection\",\n      f: parse_Selection\n    },\n    0x0022: {\n      n: \"Date1904\",\n      f: parse_Date1904\n    },\n    0x0023: {\n      n: \"ExternName\",\n      f: parse_ExternName\n    },\n    0x0026: {\n      n: \"LeftMargin\",\n      f: parse_LeftMargin\n    },\n    0x0027: {\n      n: \"RightMargin\",\n      f: parse_RightMargin\n    },\n    0x0028: {\n      n: \"TopMargin\",\n      f: parse_TopMargin\n    },\n    0x0029: {\n      n: \"BottomMargin\",\n      f: parse_BottomMargin\n    },\n    0x002a: {\n      n: \"PrintRowCol\",\n      f: parse_PrintRowCol\n    },\n    0x002b: {\n      n: \"PrintGrid\",\n      f: parse_PrintGrid\n    },\n    0x002f: {\n      n: \"FilePass\",\n      f: parse_FilePass\n    },\n    0x0031: {\n      n: \"Font\",\n      f: parse_Font\n    },\n    0x0033: {\n      n: \"PrintSize\",\n      f: parse_PrintSize\n    },\n    0x003c: {\n      n: \"Continue\",\n      f: parse_Continue\n    },\n    0x003d: {\n      n: \"Window1\",\n      f: parse_Window1\n    },\n    0x0040: {\n      n: \"Backup\",\n      f: parse_Backup\n    },\n    0x0041: {\n      n: \"Pane\",\n      f: parse_Pane\n    },\n    0x0042: {\n      n: 'CodePage',\n      f: parse_CodePage\n    },\n    0x004d: {\n      n: \"Pls\",\n      f: parse_Pls\n    },\n    0x0050: {\n      n: \"DCon\",\n      f: parse_DCon\n    },\n    0x0051: {\n      n: \"DConRef\",\n      f: parse_DConRef\n    },\n    0x0052: {\n      n: \"DConName\",\n      f: parse_DConName\n    },\n    0x0055: {\n      n: \"DefColWidth\",\n      f: parse_DefColWidth\n    },\n    0x0059: {\n      n: \"XCT\",\n      f: parse_XCT\n    },\n    0x005a: {\n      n: \"CRN\",\n      f: parse_CRN\n    },\n    0x005b: {\n      n: \"FileSharing\",\n      f: parse_FileSharing\n    },\n    0x005c: {\n      n: 'WriteAccess',\n      f: parse_WriteAccess\n    },\n    0x005d: {\n      n: \"Obj\",\n      f: parse_Obj\n    },\n    0x005e: {\n      n: \"Uncalced\",\n      f: parse_Uncalced\n    },\n    0x005f: {\n      n: \"CalcSaveRecalc\",\n      f: parse_CalcSaveRecalc\n    },\n    0x0060: {\n      n: \"Template\",\n      f: parse_Template\n    },\n    0x0061: {\n      n: \"Intl\",\n      f: parse_Intl\n    },\n    0x0063: {\n      n: \"ObjProtect\",\n      f: parse_ObjProtect\n    },\n    0x007d: {\n      n: \"ColInfo\",\n      f: parse_ColInfo\n    },\n    0x0080: {\n      n: \"Guts\",\n      f: parse_Guts\n    },\n    0x0081: {\n      n: \"WsBool\",\n      f: parse_WsBool\n    },\n    0x0082: {\n      n: \"GridSet\",\n      f: parse_GridSet\n    },\n    0x0083: {\n      n: \"HCenter\",\n      f: parse_HCenter\n    },\n    0x0084: {\n      n: \"VCenter\",\n      f: parse_VCenter\n    },\n    0x0085: {\n      n: 'BoundSheet8',\n      f: parse_BoundSheet8\n    },\n    0x0086: {\n      n: \"WriteProtect\",\n      f: parse_WriteProtect\n    },\n    0x008c: {\n      n: \"Country\",\n      f: parse_Country\n    },\n    0x008d: {\n      n: \"HideObj\",\n      f: parse_HideObj\n    },\n    0x0090: {\n      n: \"Sort\",\n      f: parse_Sort\n    },\n    0x0092: {\n      n: \"Palette\",\n      f: parse_Palette\n    },\n    0x0097: {\n      n: \"Sync\",\n      f: parse_Sync\n    },\n    0x0098: {\n      n: \"LPr\",\n      f: parse_LPr\n    },\n    0x0099: {\n      n: \"DxGCol\",\n      f: parse_DxGCol\n    },\n    0x009a: {\n      n: \"FnGroupName\",\n      f: parse_FnGroupName\n    },\n    0x009b: {\n      n: \"FilterMode\",\n      f: parse_FilterMode\n    },\n    0x009c: {\n      n: \"BuiltInFnGroupCount\",\n      f: parse_BuiltInFnGroupCount\n    },\n    0x009d: {\n      n: \"AutoFilterInfo\",\n      f: parse_AutoFilterInfo\n    },\n    0x009e: {\n      n: \"AutoFilter\",\n      f: parse_AutoFilter\n    },\n    0x00a0: {\n      n: \"Scl\",\n      f: parse_Scl\n    },\n    0x00a1: {\n      n: \"Setup\",\n      f: parse_Setup\n    },\n    0x00ae: {\n      n: \"ScenMan\",\n      f: parse_ScenMan\n    },\n    0x00af: {\n      n: \"SCENARIO\",\n      f: parse_SCENARIO\n    },\n    0x00b0: {\n      n: \"SxView\",\n      f: parse_SxView\n    },\n    0x00b1: {\n      n: \"Sxvd\",\n      f: parse_Sxvd\n    },\n    0x00b2: {\n      n: \"SXVI\",\n      f: parse_SXVI\n    },\n    0x00b4: {\n      n: \"SxIvd\",\n      f: parse_SxIvd\n    },\n    0x00b5: {\n      n: \"SXLI\",\n      f: parse_SXLI\n    },\n    0x00b6: {\n      n: \"SXPI\",\n      f: parse_SXPI\n    },\n    0x00b8: {\n      n: \"DocRoute\",\n      f: parse_DocRoute\n    },\n    0x00b9: {\n      n: \"RecipName\",\n      f: parse_RecipName\n    },\n    0x00bd: {\n      n: \"MulRk\",\n      f: parse_MulRk\n    },\n    0x00be: {\n      n: \"MulBlank\",\n      f: parse_MulBlank\n    },\n    0x00c1: {\n      n: 'Mms',\n      f: parse_Mms\n    },\n    0x00c5: {\n      n: \"SXDI\",\n      f: parse_SXDI\n    },\n    0x00c6: {\n      n: \"SXDB\",\n      f: parse_SXDB\n    },\n    0x00c7: {\n      n: \"SXFDB\",\n      f: parse_SXFDB\n    },\n    0x00c8: {\n      n: \"SXDBB\",\n      f: parse_SXDBB\n    },\n    0x00c9: {\n      n: \"SXNum\",\n      f: parse_SXNum\n    },\n    0x00ca: {\n      n: \"SxBool\",\n      f: parse_SxBool\n    },\n    0x00cb: {\n      n: \"SxErr\",\n      f: parse_SxErr\n    },\n    0x00cc: {\n      n: \"SXInt\",\n      f: parse_SXInt\n    },\n    0x00cd: {\n      n: \"SXString\",\n      f: parse_SXString\n    },\n    0x00ce: {\n      n: \"SXDtr\",\n      f: parse_SXDtr\n    },\n    0x00cf: {\n      n: \"SxNil\",\n      f: parse_SxNil\n    },\n    0x00d0: {\n      n: \"SXTbl\",\n      f: parse_SXTbl\n    },\n    0x00d1: {\n      n: \"SXTBRGIITM\",\n      f: parse_SXTBRGIITM\n    },\n    0x00d2: {\n      n: \"SxTbpg\",\n      f: parse_SxTbpg\n    },\n    0x00d3: {\n      n: \"ObProj\",\n      f: parse_ObProj\n    },\n    0x00d5: {\n      n: \"SXStreamID\",\n      f: parse_SXStreamID\n    },\n    0x00d7: {\n      n: \"DBCell\",\n      f: parse_DBCell\n    },\n    0x00d8: {\n      n: \"SXRng\",\n      f: parse_SXRng\n    },\n    0x00d9: {\n      n: \"SxIsxoper\",\n      f: parse_SxIsxoper\n    },\n    0x00da: {\n      n: \"BookBool\",\n      f: parse_BookBool\n    },\n    0x00dc: {\n      n: \"DbOrParamQry\",\n      f: parse_DbOrParamQry\n    },\n    0x00dd: {\n      n: \"ScenarioProtect\",\n      f: parse_ScenarioProtect\n    },\n    0x00de: {\n      n: \"OleObjectSize\",\n      f: parse_OleObjectSize\n    },\n    0x00e0: {\n      n: \"XF\",\n      f: parse_XF\n    },\n    0x00e1: {\n      n: 'InterfaceHdr',\n      f: parse_InterfaceHdr\n    },\n    0x00e2: {\n      n: 'InterfaceEnd',\n      f: parse_InterfaceEnd\n    },\n    0x00e3: {\n      n: \"SXVS\",\n      f: parse_SXVS\n    },\n    0x00e5: {\n      n: \"MergeCells\",\n      f: parse_MergeCells\n    },\n    0x00e9: {\n      n: \"BkHim\",\n      f: parse_BkHim\n    },\n    0x00eb: {\n      n: \"MsoDrawingGroup\",\n      f: parse_MsoDrawingGroup\n    },\n    0x00ec: {\n      n: \"MsoDrawing\",\n      f: parse_MsoDrawing\n    },\n    0x00ed: {\n      n: \"MsoDrawingSelection\",\n      f: parse_MsoDrawingSelection\n    },\n    0x00ef: {\n      n: \"PhoneticInfo\",\n      f: parse_PhoneticInfo\n    },\n    0x00f0: {\n      n: \"SxRule\",\n      f: parse_SxRule\n    },\n    0x00f1: {\n      n: \"SXEx\",\n      f: parse_SXEx\n    },\n    0x00f2: {\n      n: \"SxFilt\",\n      f: parse_SxFilt\n    },\n    0x00f4: {\n      n: \"SxDXF\",\n      f: parse_SxDXF\n    },\n    0x00f5: {\n      n: \"SxItm\",\n      f: parse_SxItm\n    },\n    0x00f6: {\n      n: \"SxName\",\n      f: parse_SxName\n    },\n    0x00f7: {\n      n: \"SxSelect\",\n      f: parse_SxSelect\n    },\n    0x00f8: {\n      n: \"SXPair\",\n      f: parse_SXPair\n    },\n    0x00f9: {\n      n: \"SxFmla\",\n      f: parse_SxFmla\n    },\n    0x00fb: {\n      n: \"SxFormat\",\n      f: parse_SxFormat\n    },\n    0x00fc: {\n      n: \"SST\",\n      f: parse_SST\n    },\n    0x00fd: {\n      n: \"LabelSst\",\n      f: parse_LabelSst\n    },\n    0x00ff: {\n      n: \"ExtSST\",\n      f: parse_ExtSST\n    },\n    0x0100: {\n      n: \"SXVDEx\",\n      f: parse_SXVDEx\n    },\n    0x0103: {\n      n: \"SXFormula\",\n      f: parse_SXFormula\n    },\n    0x0122: {\n      n: \"SXDBEx\",\n      f: parse_SXDBEx\n    },\n    0x0137: {\n      n: \"RRDInsDel\",\n      f: parse_RRDInsDel\n    },\n    0x0138: {\n      n: \"RRDHead\",\n      f: parse_RRDHead\n    },\n    0x013b: {\n      n: \"RRDChgCell\",\n      f: parse_RRDChgCell\n    },\n    0x013d: {\n      n: \"RRTabId\",\n      f: parse_RRTabId\n    },\n    0x013e: {\n      n: \"RRDRenSheet\",\n      f: parse_RRDRenSheet\n    },\n    0x013f: {\n      n: \"RRSort\",\n      f: parse_RRSort\n    },\n    0x0140: {\n      n: \"RRDMove\",\n      f: parse_RRDMove\n    },\n    0x014a: {\n      n: \"RRFormat\",\n      f: parse_RRFormat\n    },\n    0x014b: {\n      n: \"RRAutoFmt\",\n      f: parse_RRAutoFmt\n    },\n    0x014d: {\n      n: \"RRInsertSh\",\n      f: parse_RRInsertSh\n    },\n    0x014e: {\n      n: \"RRDMoveBegin\",\n      f: parse_RRDMoveBegin\n    },\n    0x014f: {\n      n: \"RRDMoveEnd\",\n      f: parse_RRDMoveEnd\n    },\n    0x0150: {\n      n: \"RRDInsDelBegin\",\n      f: parse_RRDInsDelBegin\n    },\n    0x0151: {\n      n: \"RRDInsDelEnd\",\n      f: parse_RRDInsDelEnd\n    },\n    0x0152: {\n      n: \"RRDConflict\",\n      f: parse_RRDConflict\n    },\n    0x0153: {\n      n: \"RRDDefName\",\n      f: parse_RRDDefName\n    },\n    0x0154: {\n      n: \"RRDRstEtxp\",\n      f: parse_RRDRstEtxp\n    },\n    0x015f: {\n      n: \"LRng\",\n      f: parse_LRng\n    },\n    0x0160: {\n      n: \"UsesELFs\",\n      f: parse_UsesELFs\n    },\n    0x0161: {\n      n: \"DSF\",\n      f: parse_DSF\n    },\n    0x0191: {\n      n: \"CUsr\",\n      f: parse_CUsr\n    },\n    0x0192: {\n      n: \"CbUsr\",\n      f: parse_CbUsr\n    },\n    0x0193: {\n      n: \"UsrInfo\",\n      f: parse_UsrInfo\n    },\n    0x0194: {\n      n: \"UsrExcl\",\n      f: parse_UsrExcl\n    },\n    0x0195: {\n      n: \"FileLock\",\n      f: parse_FileLock\n    },\n    0x0196: {\n      n: \"RRDInfo\",\n      f: parse_RRDInfo\n    },\n    0x0197: {\n      n: \"BCUsrs\",\n      f: parse_BCUsrs\n    },\n    0x0198: {\n      n: \"UsrChk\",\n      f: parse_UsrChk\n    },\n    0x01a9: {\n      n: \"UserBView\",\n      f: parse_UserBView\n    },\n    0x01aa: {\n      n: \"UserSViewBegin\",\n      f: parse_UserSViewBegin\n    },\n    0x01ab: {\n      n: \"UserSViewEnd\",\n      f: parse_UserSViewEnd\n    },\n    0x01ac: {\n      n: \"RRDUserView\",\n      f: parse_RRDUserView\n    },\n    0x01ad: {\n      n: \"Qsi\",\n      f: parse_Qsi\n    },\n    0x01ae: {\n      n: \"SupBook\",\n      f: parse_SupBook\n    },\n    0x01af: {\n      n: \"Prot4Rev\",\n      f: parse_Prot4Rev\n    },\n    0x01b0: {\n      n: \"CondFmt\",\n      f: parse_CondFmt\n    },\n    0x01b1: {\n      n: \"CF\",\n      f: parse_CF\n    },\n    0x01b2: {\n      n: \"DVal\",\n      f: parse_DVal\n    },\n    0x01b5: {\n      n: \"DConBin\",\n      f: parse_DConBin\n    },\n    0x01b6: {\n      n: \"TxO\",\n      f: parse_TxO\n    },\n    0x01b7: {\n      n: \"RefreshAll\",\n      f: parse_RefreshAll\n    },\n    0x01b8: {\n      n: \"HLink\",\n      f: parse_HLink\n    },\n    0x01b9: {\n      n: \"Lel\",\n      f: parse_Lel\n    },\n    0x01ba: {\n      n: \"CodeName\",\n      f: parse_CodeName\n    },\n    0x01bb: {\n      n: \"SXFDBType\",\n      f: parse_SXFDBType\n    },\n    0x01bc: {\n      n: \"Prot4RevPass\",\n      f: parse_Prot4RevPass\n    },\n    0x01bd: {\n      n: \"ObNoMacros\",\n      f: parse_ObNoMacros\n    },\n    0x01be: {\n      n: \"Dv\",\n      f: parse_Dv\n    },\n    0x01c0: {\n      n: \"Excel9File\",\n      f: parse_Excel9File\n    },\n    0x01c1: {\n      n: \"RecalcId\",\n      f: parse_RecalcId,\n      r: 2\n    },\n    0x01c2: {\n      n: \"EntExU2\",\n      f: parse_EntExU2\n    },\n    0x0200: {\n      n: \"Dimensions\",\n      f: parse_Dimensions\n    },\n    0x0201: {\n      n: \"Blank\",\n      f: parse_Blank\n    },\n    0x0203: {\n      n: \"Number\",\n      f: parse_Number\n    },\n    0x0204: {\n      n: \"Label\",\n      f: parse_Label\n    },\n    0x0205: {\n      n: \"BoolErr\",\n      f: parse_BoolErr\n    },\n    0x0206: {\n      n: \"Formula\",\n      f: parse_Formula\n    },\n    0x0207: {\n      n: \"String\",\n      f: parse_String\n    },\n    0x0208: {\n      n: 'Row',\n      f: parse_Row\n    },\n    0x020b: {\n      n: \"Index\",\n      f: parse_Index\n    },\n    0x0221: {\n      n: \"Array\",\n      f: parse_Array\n    },\n    0x0225: {\n      n: \"DefaultRowHeight\",\n      f: parse_DefaultRowHeight\n    },\n    0x0236: {\n      n: \"Table\",\n      f: parse_Table\n    },\n    0x023e: {\n      n: \"Window2\",\n      f: parse_Window2\n    },\n    0x027e: {\n      n: \"RK\",\n      f: parse_RK\n    },\n    0x0293: {\n      n: \"Style\",\n      f: parse_Style\n    },\n    0x0406: {\n      n: \"Formula\",\n      f: parse_Formula\n    },\n    0x0418: {\n      n: \"BigName\",\n      f: parse_BigName\n    },\n    0x041e: {\n      n: \"Format\",\n      f: parse_Format\n    },\n    0x043c: {\n      n: \"ContinueBigName\",\n      f: parse_ContinueBigName\n    },\n    0x04bc: {\n      n: \"ShrFmla\",\n      f: parse_ShrFmla\n    },\n    0x0800: {\n      n: \"HLinkTooltip\",\n      f: parse_HLinkTooltip\n    },\n    0x0801: {\n      n: \"WebPub\",\n      f: parse_WebPub\n    },\n    0x0802: {\n      n: \"QsiSXTag\",\n      f: parse_QsiSXTag\n    },\n    0x0803: {\n      n: \"DBQueryExt\",\n      f: parse_DBQueryExt\n    },\n    0x0804: {\n      n: \"ExtString\",\n      f: parse_ExtString\n    },\n    0x0805: {\n      n: \"TxtQry\",\n      f: parse_TxtQry\n    },\n    0x0806: {\n      n: \"Qsir\",\n      f: parse_Qsir\n    },\n    0x0807: {\n      n: \"Qsif\",\n      f: parse_Qsif\n    },\n    0x0808: {\n      n: \"RRDTQSIF\",\n      f: parse_RRDTQSIF\n    },\n    0x0809: {\n      n: 'BOF',\n      f: parse_BOF\n    },\n    0x080a: {\n      n: \"OleDbConn\",\n      f: parse_OleDbConn\n    },\n    0x080b: {\n      n: \"WOpt\",\n      f: parse_WOpt\n    },\n    0x080c: {\n      n: \"SXViewEx\",\n      f: parse_SXViewEx\n    },\n    0x080d: {\n      n: \"SXTH\",\n      f: parse_SXTH\n    },\n    0x080e: {\n      n: \"SXPIEx\",\n      f: parse_SXPIEx\n    },\n    0x080f: {\n      n: \"SXVDTEx\",\n      f: parse_SXVDTEx\n    },\n    0x0810: {\n      n: \"SXViewEx9\",\n      f: parse_SXViewEx9\n    },\n    0x0812: {\n      n: \"ContinueFrt\",\n      f: parse_ContinueFrt\n    },\n    0x0813: {\n      n: \"RealTimeData\",\n      f: parse_RealTimeData\n    },\n    0x0850: {\n      n: \"ChartFrtInfo\",\n      f: parse_ChartFrtInfo\n    },\n    0x0851: {\n      n: \"FrtWrapper\",\n      f: parse_FrtWrapper\n    },\n    0x0852: {\n      n: \"StartBlock\",\n      f: parse_StartBlock\n    },\n    0x0853: {\n      n: \"EndBlock\",\n      f: parse_EndBlock\n    },\n    0x0854: {\n      n: \"StartObject\",\n      f: parse_StartObject\n    },\n    0x0855: {\n      n: \"EndObject\",\n      f: parse_EndObject\n    },\n    0x0856: {\n      n: \"CatLab\",\n      f: parse_CatLab\n    },\n    0x0857: {\n      n: \"YMult\",\n      f: parse_YMult\n    },\n    0x0858: {\n      n: \"SXViewLink\",\n      f: parse_SXViewLink\n    },\n    0x0859: {\n      n: \"PivotChartBits\",\n      f: parse_PivotChartBits\n    },\n    0x085a: {\n      n: \"FrtFontList\",\n      f: parse_FrtFontList\n    },\n    0x0862: {\n      n: \"SheetExt\",\n      f: parse_SheetExt\n    },\n    0x0863: {\n      n: \"BookExt\",\n      f: parse_BookExt,\n      r: 12\n    },\n    0x0864: {\n      n: \"SXAddl\",\n      f: parse_SXAddl\n    },\n    0x0865: {\n      n: \"CrErr\",\n      f: parse_CrErr\n    },\n    0x0866: {\n      n: \"HFPicture\",\n      f: parse_HFPicture\n    },\n    0x0867: {\n      n: 'FeatHdr',\n      f: parse_FeatHdr\n    },\n    0x0868: {\n      n: \"Feat\",\n      f: parse_Feat\n    },\n    0x086a: {\n      n: \"DataLabExt\",\n      f: parse_DataLabExt\n    },\n    0x086b: {\n      n: \"DataLabExtContents\",\n      f: parse_DataLabExtContents\n    },\n    0x086c: {\n      n: \"CellWatch\",\n      f: parse_CellWatch\n    },\n    0x0871: {\n      n: \"FeatHdr11\",\n      f: parse_FeatHdr11\n    },\n    0x0872: {\n      n: \"Feature11\",\n      f: parse_Feature11\n    },\n    0x0874: {\n      n: \"DropDownObjIds\",\n      f: parse_DropDownObjIds\n    },\n    0x0875: {\n      n: \"ContinueFrt11\",\n      f: parse_ContinueFrt11\n    },\n    0x0876: {\n      n: \"DConn\",\n      f: parse_DConn\n    },\n    0x0877: {\n      n: \"List12\",\n      f: parse_List12\n    },\n    0x0878: {\n      n: \"Feature12\",\n      f: parse_Feature12\n    },\n    0x0879: {\n      n: \"CondFmt12\",\n      f: parse_CondFmt12\n    },\n    0x087a: {\n      n: \"CF12\",\n      f: parse_CF12\n    },\n    0x087b: {\n      n: \"CFEx\",\n      f: parse_CFEx\n    },\n    0x087c: {\n      n: \"XFCRC\",\n      f: parse_XFCRC,\n      r: 12\n    },\n    0x087d: {\n      n: \"XFExt\",\n      f: parse_XFExt,\n      r: 12\n    },\n    0x087e: {\n      n: \"AutoFilter12\",\n      f: parse_AutoFilter12\n    },\n    0x087f: {\n      n: \"ContinueFrt12\",\n      f: parse_ContinueFrt12\n    },\n    0x0884: {\n      n: \"MDTInfo\",\n      f: parse_MDTInfo\n    },\n    0x0885: {\n      n: \"MDXStr\",\n      f: parse_MDXStr\n    },\n    0x0886: {\n      n: \"MDXTuple\",\n      f: parse_MDXTuple\n    },\n    0x0887: {\n      n: \"MDXSet\",\n      f: parse_MDXSet\n    },\n    0x0888: {\n      n: \"MDXProp\",\n      f: parse_MDXProp\n    },\n    0x0889: {\n      n: \"MDXKPI\",\n      f: parse_MDXKPI\n    },\n    0x088a: {\n      n: \"MDB\",\n      f: parse_MDB\n    },\n    0x088b: {\n      n: \"PLV\",\n      f: parse_PLV\n    },\n    0x088c: {\n      n: \"Compat12\",\n      f: parse_Compat12,\n      r: 12\n    },\n    0x088d: {\n      n: \"DXF\",\n      f: parse_DXF\n    },\n    0x088e: {\n      n: \"TableStyles\",\n      f: parse_TableStyles,\n      r: 12\n    },\n    0x088f: {\n      n: \"TableStyle\",\n      f: parse_TableStyle\n    },\n    0x0890: {\n      n: \"TableStyleElement\",\n      f: parse_TableStyleElement\n    },\n    0x0892: {\n      n: \"StyleExt\",\n      f: parse_StyleExt\n    },\n    0x0893: {\n      n: \"NamePublish\",\n      f: parse_NamePublish\n    },\n    0x0894: {\n      n: \"NameCmt\",\n      f: parse_NameCmt\n    },\n    0x0895: {\n      n: \"SortData\",\n      f: parse_SortData\n    },\n    0x0896: {\n      n: \"Theme\",\n      f: parse_Theme,\n      r: 12\n    },\n    0x0897: {\n      n: \"GUIDTypeLib\",\n      f: parse_GUIDTypeLib\n    },\n    0x0898: {\n      n: \"FnGrp12\",\n      f: parse_FnGrp12\n    },\n    0x0899: {\n      n: \"NameFnGrp12\",\n      f: parse_NameFnGrp12\n    },\n    0x089a: {\n      n: \"MTRSettings\",\n      f: parse_MTRSettings,\n      r: 12\n    },\n    0x089b: {\n      n: \"CompressPictures\",\n      f: parse_CompressPictures\n    },\n    0x089c: {\n      n: \"HeaderFooter\",\n      f: parse_HeaderFooter\n    },\n    0x089d: {\n      n: \"CrtLayout12\",\n      f: parse_CrtLayout12\n    },\n    0x089e: {\n      n: \"CrtMlFrt\",\n      f: parse_CrtMlFrt\n    },\n    0x089f: {\n      n: \"CrtMlFrtContinue\",\n      f: parse_CrtMlFrtContinue\n    },\n    0x08a3: {\n      n: \"ForceFullCalculation\",\n      f: parse_ForceFullCalculation\n    },\n    0x08a4: {\n      n: \"ShapePropsStream\",\n      f: parse_ShapePropsStream\n    },\n    0x08a5: {\n      n: \"TextPropsStream\",\n      f: parse_TextPropsStream\n    },\n    0x08a6: {\n      n: \"RichTextStream\",\n      f: parse_RichTextStream\n    },\n    0x08a7: {\n      n: \"CrtLayout12A\",\n      f: parse_CrtLayout12A\n    },\n    0x1001: {\n      n: \"Units\",\n      f: parse_Units\n    },\n    0x1002: {\n      n: \"Chart\",\n      f: parse_Chart\n    },\n    0x1003: {\n      n: \"Series\",\n      f: parse_Series\n    },\n    0x1006: {\n      n: \"DataFormat\",\n      f: parse_DataFormat\n    },\n    0x1007: {\n      n: \"LineFormat\",\n      f: parse_LineFormat\n    },\n    0x1009: {\n      n: \"MarkerFormat\",\n      f: parse_MarkerFormat\n    },\n    0x100a: {\n      n: \"AreaFormat\",\n      f: parse_AreaFormat\n    },\n    0x100b: {\n      n: \"PieFormat\",\n      f: parse_PieFormat\n    },\n    0x100c: {\n      n: \"AttachedLabel\",\n      f: parse_AttachedLabel\n    },\n    0x100d: {\n      n: \"SeriesText\",\n      f: parse_SeriesText\n    },\n    0x1014: {\n      n: \"ChartFormat\",\n      f: parse_ChartFormat\n    },\n    0x1015: {\n      n: \"Legend\",\n      f: parse_Legend\n    },\n    0x1016: {\n      n: \"SeriesList\",\n      f: parse_SeriesList\n    },\n    0x1017: {\n      n: \"Bar\",\n      f: parse_Bar\n    },\n    0x1018: {\n      n: \"Line\",\n      f: parse_Line\n    },\n    0x1019: {\n      n: \"Pie\",\n      f: parse_Pie\n    },\n    0x101a: {\n      n: \"Area\",\n      f: parse_Area\n    },\n    0x101b: {\n      n: \"Scatter\",\n      f: parse_Scatter\n    },\n    0x101c: {\n      n: \"CrtLine\",\n      f: parse_CrtLine\n    },\n    0x101d: {\n      n: \"Axis\",\n      f: parse_Axis\n    },\n    0x101e: {\n      n: \"Tick\",\n      f: parse_Tick\n    },\n    0x101f: {\n      n: \"ValueRange\",\n      f: parse_ValueRange\n    },\n    0x1020: {\n      n: \"CatSerRange\",\n      f: parse_CatSerRange\n    },\n    0x1021: {\n      n: \"AxisLine\",\n      f: parse_AxisLine\n    },\n    0x1022: {\n      n: \"CrtLink\",\n      f: parse_CrtLink\n    },\n    0x1024: {\n      n: \"DefaultText\",\n      f: parse_DefaultText\n    },\n    0x1025: {\n      n: \"Text\",\n      f: parse_Text\n    },\n    0x1026: {\n      n: \"FontX\",\n      f: parse_FontX\n    },\n    0x1027: {\n      n: \"ObjectLink\",\n      f: parse_ObjectLink\n    },\n    0x1032: {\n      n: \"Frame\",\n      f: parse_Frame\n    },\n    0x1033: {\n      n: \"Begin\",\n      f: parse_Begin\n    },\n    0x1034: {\n      n: \"End\",\n      f: parse_End\n    },\n    0x1035: {\n      n: \"PlotArea\",\n      f: parse_PlotArea\n    },\n    0x103a: {\n      n: \"Chart3d\",\n      f: parse_Chart3d\n    },\n    0x103c: {\n      n: \"PicF\",\n      f: parse_PicF\n    },\n    0x103d: {\n      n: \"DropBar\",\n      f: parse_DropBar\n    },\n    0x103e: {\n      n: \"Radar\",\n      f: parse_Radar\n    },\n    0x103f: {\n      n: \"Surf\",\n      f: parse_Surf\n    },\n    0x1040: {\n      n: \"RadarArea\",\n      f: parse_RadarArea\n    },\n    0x1041: {\n      n: \"AxisParent\",\n      f: parse_AxisParent\n    },\n    0x1043: {\n      n: \"LegendException\",\n      f: parse_LegendException\n    },\n    0x1044: {\n      n: \"ShtProps\",\n      f: parse_ShtProps\n    },\n    0x1045: {\n      n: \"SerToCrt\",\n      f: parse_SerToCrt\n    },\n    0x1046: {\n      n: \"AxesUsed\",\n      f: parse_AxesUsed\n    },\n    0x1048: {\n      n: \"SBaseRef\",\n      f: parse_SBaseRef\n    },\n    0x104a: {\n      n: \"SerParent\",\n      f: parse_SerParent\n    },\n    0x104b: {\n      n: \"SerAuxTrend\",\n      f: parse_SerAuxTrend\n    },\n    0x104e: {\n      n: \"IFmtRecord\",\n      f: parse_IFmtRecord\n    },\n    0x104f: {\n      n: \"Pos\",\n      f: parse_Pos\n    },\n    0x1050: {\n      n: \"AlRuns\",\n      f: parse_AlRuns\n    },\n    0x1051: {\n      n: \"BRAI\",\n      f: parse_BRAI\n    },\n    0x105b: {\n      n: \"SerAuxErrBar\",\n      f: parse_SerAuxErrBar\n    },\n    0x105c: {\n      n: \"ClrtClient\",\n      f: parse_ClrtClient\n    },\n    0x105d: {\n      n: \"SerFmt\",\n      f: parse_SerFmt\n    },\n    0x105f: {\n      n: \"Chart3DBarShape\",\n      f: parse_Chart3DBarShape\n    },\n    0x1060: {\n      n: \"Fbi\",\n      f: parse_Fbi\n    },\n    0x1061: {\n      n: \"BopPop\",\n      f: parse_BopPop\n    },\n    0x1062: {\n      n: \"AxcExt\",\n      f: parse_AxcExt\n    },\n    0x1063: {\n      n: \"Dat\",\n      f: parse_Dat\n    },\n    0x1064: {\n      n: \"PlotGrowth\",\n      f: parse_PlotGrowth\n    },\n    0x1065: {\n      n: \"SIIndex\",\n      f: parse_SIIndex\n    },\n    0x1066: {\n      n: \"GelFrame\",\n      f: parse_GelFrame\n    },\n    0x1067: {\n      n: \"BopPopCustom\",\n      f: parse_BopPopCustom\n    },\n    0x1068: {\n      n: \"Fbi2\",\n      f: parse_Fbi2\n    },\n    /* These are specified in an older version of the spec */\n    0x0000: {\n      n: \"Dimensions\",\n      f: parse_Dimensions\n    },\n    0x0002: {\n      n: \"BIFF2INT\",\n      f: parse_BIFF2INT\n    },\n    0x0005: {\n      n: \"BoolErr\",\n      f: parse_BoolErr\n    },\n    0x0007: {\n      n: \"String\",\n      f: parse_BIFF2STRING\n    },\n    0x0008: {\n      n: \"BIFF2ROW\",\n      f: parsenoop\n    },\n    0x000b: {\n      n: \"Index\",\n      f: parse_Index\n    },\n    0x001e: {\n      n: \"BIFF2FORMAT\",\n      f: parse_BIFF2Format\n    },\n    0x001f: {\n      n: \"BIFF2FMTCNT\",\n      f: parsenoop\n    },\n    /* 16-bit cnt of BIFF2FORMAT records */\n    0x0016: {\n      n: \"ExternCount\",\n      f: parsenoop\n    },\n    0x0021: {\n      n: \"Array\",\n      f: parse_Array\n    },\n    0x0025: {\n      n: \"DefaultRowHeight\",\n      f: parse_DefaultRowHeight\n    },\n    0x0032: {\n      n: \"BIFF2FONTXTRA\",\n      f: parse_BIFF2FONTXTRA\n    },\n    0x003e: {\n      n: \"BIFF2WINDOW2\",\n      f: parsenoop\n    },\n    0x0045: {\n      n: \"BIFF2FONTCLR\",\n      f: parsenoop\n    },\n    0x0056: {\n      n: \"BIFF4FMTCNT\",\n      f: parsenoop\n    },\n    /* 16-bit cnt, similar to BIFF2 */\n    0x007e: {\n      n: \"RK\",\n      f: parsenoop\n    },\n    /* Not necessarily same as 0x027e */\n    0x007f: {\n      n: \"ImData\",\n      f: parsenoop\n    },\n    0x0087: {\n      n: \"Addin\",\n      f: parsenoop\n    },\n    0x0088: {\n      n: \"Edg\",\n      f: parsenoop\n    },\n    0x0089: {\n      n: \"Pub\",\n      f: parsenoop\n    },\n    0x0091: {\n      n: \"Sub\",\n      f: parsenoop\n    },\n    0x0094: {\n      n: \"LHRecord\",\n      f: parsenoop\n    },\n    0x0095: {\n      n: \"LHNGraph\",\n      f: parsenoop\n    },\n    0x0096: {\n      n: \"Sound\",\n      f: parsenoop\n    },\n    0x00a9: {\n      n: \"CoordList\",\n      f: parsenoop\n    },\n    0x00ab: {\n      n: \"GCW\",\n      f: parsenoop\n    },\n    0x00bc: {\n      n: \"ShrFmla\",\n      f: parsenoop\n    },\n    /* Not necessarily same as 0x04bc */\n    0x00c2: {\n      n: \"AddMenu\",\n      f: parsenoop\n    },\n    0x00c3: {\n      n: \"DelMenu\",\n      f: parsenoop\n    },\n    0x00d6: {\n      n: \"RString\",\n      f: parse_RString\n    },\n    0x00df: {\n      n: \"UDDesc\",\n      f: parsenoop\n    },\n    0x00ea: {\n      n: \"TabIdConf\",\n      f: parsenoop\n    },\n    0x0162: {\n      n: \"XL5Modify\",\n      f: parsenoop\n    },\n    0x01a5: {\n      n: \"FileSharing2\",\n      f: parsenoop\n    },\n    0x0209: {\n      n: 'BOF',\n      f: parse_BOF\n    },\n    0x0218: {\n      n: \"Lbl\",\n      f: parse_Lbl\n    },\n    0x0223: {\n      n: \"ExternName\",\n      f: parse_ExternName\n    },\n    0x0231: {\n      n: \"Font\",\n      f: parsenoop\n    },\n    0x0409: {\n      n: 'BOF',\n      f: parse_BOF\n    },\n    0x086d: {\n      n: \"FeatInfo\",\n      f: parsenoop\n    },\n    0x0873: {\n      n: \"FeatInfo11\",\n      f: parsenoop\n    },\n    0x0881: {\n      n: \"SXAddl12\",\n      f: parsenoop\n    },\n    0x08c0: {\n      n: \"AutoWebPub\",\n      f: parsenoop\n    },\n    0x08c1: {\n      n: \"ListObj\",\n      f: parsenoop\n    },\n    0x08c2: {\n      n: \"ListField\",\n      f: parsenoop\n    },\n    0x08c3: {\n      n: \"ListDV\",\n      f: parsenoop\n    },\n    0x08c4: {\n      n: \"ListCondFmt\",\n      f: parsenoop\n    },\n    0x08c5: {\n      n: \"ListCF\",\n      f: parsenoop\n    },\n    0x08c6: {\n      n: \"FMQry\",\n      f: parsenoop\n    },\n    0x08c7: {\n      n: \"FMSQry\",\n      f: parsenoop\n    },\n    0x08c8: {\n      n: \"PLV\",\n      f: parsenoop\n    },\n    /* supposedly PLV for Excel 11 */\n    0x08c9: {\n      n: \"LnExt\",\n      f: parsenoop\n    },\n    0x08ca: {\n      n: \"MkrExt\",\n      f: parsenoop\n    },\n    0x08cb: {\n      n: \"CrtCoopt\",\n      f: parsenoop\n    },\n    0x0043: {\n      n: \"BIFF2XF\",\n      f: parsenoop\n    },\n    0x0243: {\n      n: \"BIFF3XF\",\n      f: parsenoop\n    },\n    0x0443: {\n      n: \"BIFF4XF\",\n      f: parsenoop\n    },\n    0x7262: {}\n  };\n\n  /* 2.4.63 Country/Region codes */\n  var CountryEnum = {\n    0x0001: \"US\",\n    // United States\n    0x0002: \"CA\",\n    // Canada\n    0x0003: \"\",\n    // Latin America (except Brazil)\n    0x0007: \"RU\",\n    // Russia\n    0x0014: \"EG\",\n    // Egypt\n    0x001E: \"GR\",\n    // Greece\n    0x001F: \"NL\",\n    // Netherlands\n    0x0020: \"BE\",\n    // Belgium\n    0x0021: \"FR\",\n    // France\n    0x0022: \"ES\",\n    // Spain\n    0x0024: \"HU\",\n    // Hungary\n    0x0027: \"IT\",\n    // Italy\n    0x0029: \"CH\",\n    // Switzerland\n    0x002B: \"AT\",\n    // Austria\n    0x002C: \"GB\",\n    // United Kingdom\n    0x002D: \"DK\",\n    // Denmark\n    0x002E: \"SE\",\n    // Sweden\n    0x002F: \"NO\",\n    // Norway\n    0x0030: \"PL\",\n    // Poland\n    0x0031: \"DE\",\n    // Germany\n    0x0034: \"MX\",\n    // Mexico\n    0x0037: \"BR\",\n    // Brazil\n    0x003d: \"AU\",\n    // Australia\n    0x0040: \"NZ\",\n    // New Zealand\n    0x0042: \"TH\",\n    // Thailand\n    0x0051: \"JP\",\n    // Japan\n    0x0052: \"KR\",\n    // Korea\n    0x0054: \"VN\",\n    // Viet Nam\n    0x0056: \"CN\",\n    // China\n    0x005A: \"TR\",\n    // Turkey\n    0x0069: \"JS\",\n    // Ramastan\n    0x00D5: \"DZ\",\n    // Algeria\n    0x00D8: \"MA\",\n    // Morocco\n    0x00DA: \"LY\",\n    // Libya\n    0x015F: \"PT\",\n    // Portugal\n    0x0162: \"IS\",\n    // Iceland\n    0x0166: \"FI\",\n    // Finland\n    0x01A4: \"CZ\",\n    // Czech Republic\n    0x0376: \"TW\",\n    // Taiwan\n    0x03C1: \"LB\",\n    // Lebanon\n    0x03C2: \"JO\",\n    // Jordan\n    0x03C3: \"SY\",\n    // Syria\n    0x03C4: \"IQ\",\n    // Iraq\n    0x03C5: \"KW\",\n    // Kuwait\n    0x03C6: \"SA\",\n    // Saudi Arabia\n    0x03CB: \"AE\",\n    // United Arab Emirates\n    0x03CC: \"IL\",\n    // Israel\n    0x03CE: \"QA\",\n    // Qatar\n    0x03D5: \"IR\",\n    // Iran\n    0xFFFF: \"US\" // United States\n  };\n\n  function fix_opts_func(defaults) {\n    return function fix_opts(opts) {\n      for (var i = 0; i != defaults.length; ++i) {\n        var d = defaults[i];\n        if (opts[d[0]] === undefined) opts[d[0]] = d[1];\n        if (d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n      }\n    };\n  }\n  var fix_read_opts = fix_opts_func([['cellNF', false], /* emit cell number format string as .z */\n  ['cellFormula', true], /* emit formulae as .f */\n  ['cellStyles', false], /* emits style/theme as .s */\n\n  ['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\n\n  ['bookSheets', false], /* only try to get sheet names (no Sheets) */\n  ['bookProps', false], /* only try to get properties (no Sheets) */\n  ['bookFiles', false], /* include raw file structure (cfb) */\n\n  ['password', ''], /* password */\n  ['WTF', false] /* WTF mode (throws errors) */]);\n  /* [MS-OLEDS] 2.3.8 CompObjStream */\n  function parse_compobj(obj) {\n    var v = {};\n    var o = obj.content;\n\n    /* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n    var l = 28,\n      m;\n    m = __lpstr(o, l);\n    l += 4 + __readUInt32LE(o, l);\n    v.UserType = m;\n\n    /* [MS-OLEDS] 2.3.1 ClipboardFormatOrAnsiString */\n    m = __readUInt32LE(o, l);\n    l += 4;\n    switch (m) {\n      case 0x00000000:\n        break;\n      case 0xffffffff:\n      case 0xfffffffe:\n        l += 4;\n        break;\n      default:\n        if (m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n        l += m;\n    }\n    m = __lpstr(o, l);\n    l += m.length === 0 ? 0 : 5 + m.length;\n    v.Reserved1 = m;\n    if ((m = __readUInt32LE(o, l)) !== 0x71b2e9f4) return v;\n    throw new Error(\"Unsupported Unicode Extension\");\n  }\n\n  /* 2.4.58 Continue logic */\n  function slurp(R, blob, length, opts) {\n    var l = length;\n    var bufs = [];\n    var d = blob.slice(blob.l, blob.l + l);\n    if (opts && opts.enc && opts.enc.insitu_decrypt) switch (R.n) {\n      case 'BOF':\n      case 'FilePass':\n      case 'FileLock':\n      case 'InterfaceHdr':\n      case 'RRDInfo':\n      case 'RRDHead':\n      case 'UsrExcl':\n        break;\n      default:\n        if (d.length === 0) break;\n        opts.enc.insitu_decrypt(d);\n    }\n    bufs.push(d);\n    blob.l += l;\n    var next = RecordEnum[__readUInt16LE(blob, blob.l)];\n    while (next != null && next.n === 'Continue') {\n      l = __readUInt16LE(blob, blob.l + 2);\n      bufs.push(blob.slice(blob.l + 4, blob.l + 4 + l));\n      blob.l += 4 + l;\n      next = RecordEnum[__readUInt16LE(blob, blob.l)];\n    }\n    var b = bconcat(bufs);\n    prep_blob(b, 0);\n    var ll = 0;\n    b.lens = [];\n    for (var j = 0; j < bufs.length; ++j) {\n      b.lens.push(ll);\n      ll += bufs[j].length;\n    }\n    return R.f(b, b.length, opts);\n  }\n  function safe_format_xf(p, opts, date1904) {\n    if (p.t === 'e') {\n      p.w = p.w || BErr[p.v];\n    }\n    if (!p.XF) return;\n    try {\n      var fmtid = p.XF.ifmt || 0;\n      if (p.t === 'e') ;else if (fmtid === 0) {\n        if (p.t === 'n') {\n          if ((p.v | 0) === p.v) p.w = SSF._general_int(p.v);else p.w = SSF._general_num(p.v);\n        } else p.w = SSF._general(p.v);\n      } else p.w = SSF.format(fmtid, p.v, {\n        date1904: date1904 || false\n      });\n      if (opts.cellNF) p.z = SSF._table[fmtid];\n    } catch (e) {\n      if (opts.WTF) throw e;\n    }\n  }\n  function make_cell(val, ixfe, t) {\n    return {\n      v: val,\n      ixfe: ixfe,\n      t: t\n    };\n  }\n\n  // 2.3.2\n  function parse_workbook(blob, options) {\n    var wb = {\n      opts: {}\n    };\n    var Sheets = {};\n    var out = {};\n    var Directory = {};\n    var found_sheet = false;\n    var range = {};\n    var last_formula = null;\n    var sst = [];\n    var cur_sheet = \"\";\n    var Preamble = {};\n    var lastcell, last_cell, cc, cmnt, rng, rngC, rngR;\n    var shared_formulae = {};\n    var array_formulae = []; /* TODO: something more clever */\n    var temp_val;\n    var country;\n    var cell_valid = true;\n    var XFs = []; /* XF records */\n    var palette = [];\n    var get_rgb = function getrgb(icv) {\n      if (icv < 8) return Icv[icv];\n      if (icv < 64) return palette[icv - 8] || Icv[icv];\n      return Icv[icv];\n    };\n    var process_cell_style = function pcs(cell, line) {\n      var xfd = line.XF.data;\n      if (!xfd || !xfd.patternType) return;\n      line.s = {};\n      line.s.patternType = xfd.patternType;\n      var t;\n      if (t = rgb2Hex(get_rgb(xfd.icvFore))) {\n        line.s.fgColor = {\n          rgb: t\n        };\n      }\n      if (t = rgb2Hex(get_rgb(xfd.icvBack))) {\n        line.s.bgColor = {\n          rgb: t\n        };\n      }\n    };\n    var addcell = function addcell(cell, line, options) {\n      if (!cell_valid) return;\n      if (options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line);\n      lastcell = cell;\n      last_cell = encode_cell(cell);\n      if (range.s) {\n        if (cell.r < range.s.r) range.s.r = cell.r;\n        if (cell.c < range.s.c) range.s.c = cell.c;\n      }\n      if (range.e) {\n        if (cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n        if (cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n      }\n      if (options.sheetRows && lastcell.r >= options.sheetRows) cell_valid = false;else out[last_cell] = line;\n    };\n    var opts = {\n      enc: false,\n      // encrypted\n      sbcch: 0,\n      // cch in the preceding SupBook\n      snames: [],\n      // sheetnames\n      sharedf: shared_formulae,\n      // shared formulae by address\n      arrayf: array_formulae,\n      // array formulae array\n      rrtabid: [],\n      // RRTabId\n      lastuser: \"\",\n      // Last User from WriteAccess\n      biff: 8,\n      // BIFF version\n      codepage: 0,\n      // CP from CodePage record\n      winlocked: 0,\n      // fLockWn from WinProtect\n      wtf: false\n    };\n    if (options.password) opts.password = options.password;\n    var mergecells = [];\n    var objects = [];\n    var supbooks = [[]]; // 1-indexed, will hold extern names\n    var sbc = 0,\n      sbci = 0,\n      sbcli = 0;\n    supbooks.SheetNames = opts.snames;\n    supbooks.sharedf = opts.sharedf;\n    supbooks.arrayf = opts.arrayf;\n    var last_Rn = '';\n    var file_depth = 0; /* TODO: make a real stack */\n    var BIFF2Fmt = 0;\n\n    /* explicit override for some broken writers */\n    opts.codepage = 1200;\n    set_cp(1200);\n    while (blob.l < blob.length - 1) {\n      var s = blob.l;\n      var RecordType = blob.read_shift(2);\n      if (RecordType === 0 && last_Rn === 'EOF') break;\n      var length = blob.l === blob.length ? 0 : blob.read_shift(2),\n        y;\n      var R = RecordEnum[RecordType];\n      if (R && R.f) {\n        if (options.bookSheets) {\n          if (last_Rn === 'BoundSheet8' && R.n !== 'BoundSheet8') break;\n        }\n        last_Rn = R.n;\n        if (R.r === 2 || R.r == 12) {\n          var rt = blob.read_shift(2);\n          length -= 2;\n          if (!opts.enc && rt !== RecordType) throw \"rt mismatch\";\n          if (R.r == 12) {\n            blob.l += 10;\n            length -= 10;\n          } // skip FRT\n        }\n        //console.error(R,blob.l,length,blob.length);\n        var val;\n        if (R.n === 'EOF') val = R.f(blob, length, opts);else val = slurp(R, blob, length, opts);\n        var Rn = R.n;\n        /* nested switch statements to workaround V8 128 limit */\n        switch (Rn) {\n          /* Workbook Options */\n          case 'Date1904':\n            wb.opts.Date1904 = val;\n            break;\n          case 'WriteProtect':\n            wb.opts.WriteProtect = true;\n            break;\n          case 'FilePass':\n            if (!opts.enc) blob.l = 0;\n            opts.enc = val;\n            if (opts.WTF) console.error(val);\n            if (!options.password) throw new Error(\"File is password-protected\");\n            if (val.Type !== 0) throw new Error(\"Encryption scheme unsupported\");\n            if (!val.valid) throw new Error(\"Password is incorrect\");\n            break;\n          case 'WriteAccess':\n            opts.lastuser = val;\n            break;\n          case 'FileSharing':\n            break;\n          //TODO\n          case 'CodePage':\n            /* overrides based on test cases */\n            if (val === 0x5212) val = 1200;else if (val === 0x8001) val = 1252;\n            opts.codepage = val;\n            set_cp(val);\n            break;\n          case 'RRTabId':\n            opts.rrtabid = val;\n            break;\n          case 'WinProtect':\n            opts.winlocked = val;\n            break;\n          case 'Template':\n            break;\n          // TODO\n          case 'RefreshAll':\n            wb.opts.RefreshAll = val;\n            break;\n          case 'BookBool':\n            break;\n          // TODO\n          case 'UsesELFs':\n            /* if(val) console.error(\"Unsupported ELFs\"); */break;\n          case 'MTRSettings':\n            {\n              if (val[0] && val[1]) throw \"Unsupported threads: \" + val;\n            }\n            break;\n          // TODO: actually support threads\n          case 'CalcCount':\n            wb.opts.CalcCount = val;\n            break;\n          case 'CalcDelta':\n            wb.opts.CalcDelta = val;\n            break;\n          case 'CalcIter':\n            wb.opts.CalcIter = val;\n            break;\n          case 'CalcMode':\n            wb.opts.CalcMode = val;\n            break;\n          case 'CalcPrecision':\n            wb.opts.CalcPrecision = val;\n            break;\n          case 'CalcSaveRecalc':\n            wb.opts.CalcSaveRecalc = val;\n            break;\n          case 'CalcRefMode':\n            opts.CalcRefMode = val;\n            break;\n          // TODO: implement R1C1\n          case 'Uncalced':\n            break;\n          case 'ForceFullCalculation':\n            wb.opts.FullCalc = val;\n            break;\n          case 'WsBool':\n            break;\n          // TODO\n          case 'XF':\n            XFs.push(val);\n            break;\n          case 'ExtSST':\n            break;\n          // TODO\n          case 'BookExt':\n            break;\n          // TODO\n          case 'RichTextStream':\n            break;\n          case 'BkHim':\n            break;\n          case 'SupBook':\n            supbooks[++sbc] = [val];\n            sbci = 0;\n            break;\n          case 'ExternName':\n            supbooks[sbc][++sbci] = val;\n            break;\n          case 'Index':\n            break;\n          // TODO\n          case 'Lbl':\n            supbooks[0][++sbcli] = val;\n            break;\n          case 'ExternSheet':\n            supbooks[sbc] = supbooks[sbc].concat(val);\n            sbci += val.length;\n            break;\n          case 'Protect':\n            out[\"!protect\"] = val;\n            break;\n          /* for sheet or book */\n          case 'Password':\n            if (val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val);\n            break;\n          case 'Prot4Rev':\n          case 'Prot4RevPass':\n            break;\n          /*TODO: Revision Control*/\n\n          case 'BoundSheet8':\n            {\n              Directory[val.pos] = val;\n              opts.snames.push(val.name);\n            }\n            break;\n          case 'EOF':\n            {\n              if (--file_depth) break;\n              if (range.e) {\n                out[\"!range\"] = range;\n                if (range.e.r > 0 && range.e.c > 0) {\n                  range.e.r--;\n                  range.e.c--;\n                  out[\"!ref\"] = encode_range(range);\n                  range.e.r++;\n                  range.e.c++;\n                }\n                if (mergecells.length > 0) out[\"!merges\"] = mergecells;\n                if (objects.length > 0) out[\"!objects\"] = objects;\n              }\n              if (cur_sheet === \"\") Preamble = out;else Sheets[cur_sheet] = out;\n              out = {};\n            }\n            break;\n          case 'BOF':\n            {\n              if (opts.biff !== 8) {} else if (val.BIFFVer === 0x0500) opts.biff = 5;else if (val.BIFFVer === 0x0002) opts.biff = 2;else if (val.BIFFVer === 0x0007) opts.biff = 2;else if (RecordType === 0x0009) opts.biff = 2;else if (RecordType === 0x0209) opts.biff = 3;else if (RecordType === 0x0409) opts.biff = 4;\n              if (file_depth++) break;\n              cell_valid = true;\n              out = {};\n              if (opts.biff < 5) {\n                if (cur_sheet === \"\") cur_sheet = \"Sheet1\";\n                range = {\n                  s: {\n                    r: 0,\n                    c: 0\n                  },\n                  e: {\n                    r: 0,\n                    c: 0\n                  }\n                };\n                /* fake BoundSheet8 */\n                var fakebs8 = {\n                  pos: blob.l - length,\n                  name: cur_sheet\n                };\n                Directory[fakebs8.pos] = fakebs8;\n                opts.snames.push(cur_sheet);\n              } else cur_sheet = (Directory[s] || {\n                name: \"\"\n              }).name;\n              mergecells = [];\n              objects = [];\n            }\n            break;\n          case 'Number':\n          case 'BIFF2NUM':\n          case 'BIFF2INT':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.val,\n                t: 'n'\n              };\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n          case 'BoolErr':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.val,\n                t: val.t\n              };\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n          case 'RK':\n            {\n              temp_val = {\n                ixfe: val.ixfe,\n                XF: XFs[val.ixfe],\n                v: val.rknum,\n                t: 'n'\n              };\n              safe_format_xf(temp_val, options, wb.opts.Date1904);\n              addcell({\n                c: val.c,\n                r: val.r\n              }, temp_val, options);\n            }\n            break;\n          case 'MulRk':\n            {\n              for (var j = val.c; j <= val.C; ++j) {\n                var ixfe = val.rkrec[j - val.c][0];\n                temp_val = {\n                  ixfe: ixfe,\n                  XF: XFs[ixfe],\n                  v: val.rkrec[j - val.c][1],\n                  t: 'n'\n                };\n                safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell({\n                  c: j,\n                  r: val.r\n                }, temp_val, options);\n              }\n            }\n            break;\n          case 'Formula':\n            {\n              switch (val.val) {\n                case 'String':\n                  last_formula = val;\n                  break;\n                case 'Array Formula':\n                  throw \"Array Formula unsupported\";\n                default:\n                  temp_val = {\n                    v: val.val,\n                    ixfe: val.cell.ixfe,\n                    t: val.tt\n                  };\n                  temp_val.XF = XFs[temp_val.ixfe];\n                  if (options.cellFormula) {\n                    var _f = val.formula;\n                    if (_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n                      var _fr = _f[0][0][1][0],\n                        _fc = _f[0][0][1][1];\n                      var _fe = encode_cell({\n                        r: _fr,\n                        c: _fc\n                      });\n                      if (shared_formulae[_fe]) temp_val.f = stringify_formula(val.formula, range, val.cell, supbooks, opts);else temp_val.F = (out[_fe] || {}).F;\n                    } else temp_val.f = stringify_formula(val.formula, range, val.cell, supbooks, opts);\n                  }\n                  safe_format_xf(temp_val, options, wb.opts.Date1904);\n                  addcell(val.cell, temp_val, options);\n                  last_formula = val;\n              }\n            }\n            break;\n          case 'String':\n            {\n              if (last_formula) {\n                last_formula.val = val;\n                temp_val = {\n                  v: last_formula.val,\n                  ixfe: last_formula.cell.ixfe,\n                  t: 's'\n                };\n                temp_val.XF = XFs[temp_val.ixfe];\n                if (options.cellFormula) temp_val.f = stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n                safe_format_xf(temp_val, options, wb.opts.Date1904);\n                addcell(last_formula.cell, temp_val, options);\n                last_formula = null;\n              }\n            }\n            break;\n          case 'Array':\n            {\n              array_formulae.push(val);\n              if (options.cellFormula && out[last_cell]) {\n                out[last_cell].f = stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n                out[last_cell].F = encode_range(val[0]);\n              }\n            }\n            break;\n          case 'ShrFmla':\n            {\n              if (!cell_valid) break;\n              if (!options.cellFormula) break;\n              if (last_cell) {\n                /* TODO: capture range */\n                shared_formulae[encode_cell(last_formula.cell)] = val[0];\n                (out[encode_cell(last_formula.cell)] || {}).f = stringify_formula(val[0], range, lastcell, supbooks, opts);\n              }\n            }\n            break;\n          case 'LabelSst':\n            temp_val = make_cell(sst[val.isst].t, val.ixfe, 's');\n            temp_val.XF = XFs[temp_val.ixfe];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n            break;\n          case 'RString':\n          case 'Label':\n          case 'BIFF2STR':\n            temp_val = make_cell(val.val, val.ixfe, 's');\n            temp_val.XF = XFs[temp_val.ixfe];\n            safe_format_xf(temp_val, options, wb.opts.Date1904);\n            addcell({\n              c: val.c,\n              r: val.r\n            }, temp_val, options);\n            break;\n          case 'Dimensions':\n            {\n              if (file_depth === 1) range = val; /* TODO: stack */\n            }\n            break;\n          case 'SST':\n            {\n              sst = val;\n            }\n            break;\n          case 'Format':\n            {\n              /* val = [id, fmt] */\n              SSF.load(val[1], val[0]);\n            }\n            break;\n          case 'BIFF2FORMAT':\n            {\n              SSF.load(val, BIFF2Fmt++);\n            }\n            break;\n          case 'MergeCells':\n            mergecells = mergecells.concat(val);\n            break;\n          case 'Obj':\n            objects[val.cmo[0]] = opts.lastobj = val;\n            break;\n          case 'TxO':\n            opts.lastobj.TxO = val;\n            break;\n          case 'HLink':\n            {\n              for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) if (out[encode_cell({\n                c: rngC,\n                r: rngR\n              })]) out[encode_cell({\n                c: rngC,\n                r: rngR\n              })].l = val[1];\n            }\n            break;\n          case 'HLinkTooltip':\n            {\n              for (rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR) for (rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC) if (out[encode_cell({\n                c: rngC,\n                r: rngR\n              })]) out[encode_cell({\n                c: rngC,\n                r: rngR\n              })].l.tooltip = val[1];\n            }\n            break;\n\n          /* Comments */\n          case 'Note':\n            {\n              if (opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\n              cc = out[encode_cell(val[0])];\n              var noteobj = objects[val[2]];\n              if (!cc) break;\n              if (!cc.c) cc.c = [];\n              cmnt = {\n                a: val[1],\n                t: noteobj.TxO.t\n              };\n              cc.c.push(cmnt);\n            }\n            break;\n          default:\n            switch (R.n) {\n              /* nested */\n              case 'ClrtClient':\n                break;\n              case 'XFExt':\n                update_xfext(XFs[val.ixfe], val.ext);\n                break;\n              case 'NameCmt':\n                break;\n              case 'Header':\n                break;\n              // TODO\n              case 'Footer':\n                break;\n              // TODO\n              case 'HCenter':\n                break;\n              // TODO\n              case 'VCenter':\n                break;\n              // TODO\n              case 'Pls':\n                break;\n              // TODO\n              case 'Setup':\n                break;\n              // TODO\n              case 'DefColWidth':\n                break;\n              // TODO\n              case 'GCW':\n                break;\n              case 'LHRecord':\n                break;\n              case 'ColInfo':\n                break;\n              // TODO\n              case 'Row':\n                break;\n              // TODO\n              case 'DBCell':\n                break;\n              // TODO\n              case 'MulBlank':\n                break;\n              // TODO\n              case 'EntExU2':\n                break;\n              // TODO\n              case 'SxView':\n                break;\n              // TODO\n              case 'Sxvd':\n                break;\n              // TODO\n              case 'SXVI':\n                break;\n              // TODO\n              case 'SXVDEx':\n                break;\n              // TODO\n              case 'SxIvd':\n                break;\n              // TODO\n              case 'SXDI':\n                break;\n              // TODO\n              case 'SXLI':\n                break;\n              // TODO\n              case 'SXEx':\n                break;\n              // TODO\n              case 'QsiSXTag':\n                break;\n              // TODO\n              case 'Selection':\n                break;\n              case 'Feat':\n                break;\n              case 'FeatHdr':\n              case 'FeatHdr11':\n                break;\n              case 'Feature11':\n              case 'Feature12':\n              case 'List12':\n                break;\n              case 'Blank':\n                break;\n              case 'Country':\n                country = val;\n                break;\n              case 'RecalcId':\n                break;\n              case 'DefaultRowHeight':\n              case 'DxGCol':\n                break;\n              // TODO: htmlify\n              case 'Fbi':\n              case 'Fbi2':\n              case 'GelFrame':\n                break;\n              case 'Font':\n                break;\n              // TODO\n              case 'XFCRC':\n                break;\n              // TODO\n              case 'Style':\n                break;\n              // TODO\n              case 'StyleExt':\n                break;\n              // TODO\n              case 'Palette':\n                palette = val;\n                break;\n              // TODO\n              case 'Theme':\n                break;\n              // TODO\n              /* Protection */\n              case 'ScenarioProtect':\n                break;\n              case 'ObjProtect':\n                break;\n\n              /* Conditional Formatting */\n              case 'CondFmt12':\n                break;\n\n              /* Table */\n              case 'Table':\n                break;\n              // TODO\n              case 'TableStyles':\n                break;\n              // TODO\n              case 'TableStyle':\n                break;\n              // TODO\n              case 'TableStyleElement':\n                break;\n              // TODO\n\n              /* PivotTable */\n              case 'SXStreamID':\n                break;\n              // TODO\n              case 'SXVS':\n                break;\n              // TODO\n              case 'DConRef':\n                break;\n              // TODO\n              case 'SXAddl':\n                break;\n              // TODO\n              case 'DConBin':\n                break;\n              // TODO\n              case 'DConName':\n                break;\n              // TODO\n              case 'SXPI':\n                break;\n              // TODO\n              case 'SxFormat':\n                break;\n              // TODO\n              case 'SxSelect':\n                break;\n              // TODO\n              case 'SxRule':\n                break;\n              // TODO\n              case 'SxFilt':\n                break;\n              // TODO\n              case 'SxItm':\n                break;\n              // TODO\n              case 'SxDXF':\n                break;\n              // TODO\n\n              /* Scenario Manager */\n              case 'ScenMan':\n                break;\n\n              /* Data Consolidation */\n              case 'DCon':\n                break;\n\n              /* Watched Cell */\n              case 'CellWatch':\n                break;\n\n              /* Print Settings */\n              case 'PrintRowCol':\n                break;\n              case 'PrintGrid':\n                break;\n              case 'PrintSize':\n                break;\n              case 'XCT':\n                break;\n              case 'CRN':\n                break;\n              case 'Scl':\n                {\n                  //console.log(\"Zoom Level:\", val[0]/val[1],val);\n                }\n                break;\n              case 'SheetExt':\n                {}\n                break;\n              case 'SheetExtOptional':\n                {}\n                break;\n\n              /* VBA */\n              case 'ObNoMacros':\n                {}\n                break;\n              case 'ObProj':\n                {}\n                break;\n              case 'CodeName':\n                {}\n                break;\n              case 'GUIDTypeLib':\n                {}\n                break;\n              case 'WOpt':\n                break;\n              // TODO: WTF?\n              case 'PhoneticInfo':\n                break;\n              case 'OleObjectSize':\n                break;\n\n              /* Differential Formatting */\n              case 'DXF':\n              case 'DXFN':\n              case 'DXFN12':\n              case 'DXFN12List':\n              case 'DXFN12NoCB':\n                break;\n\n              /* Data Validation */\n              case 'Dv':\n              case 'DVal':\n                break;\n\n              /* Data Series */\n              case 'BRAI':\n              case 'Series':\n              case 'SeriesText':\n                break;\n\n              /* Data Connection */\n              case 'DConn':\n                break;\n              case 'DbOrParamQry':\n                break;\n              case 'DBQueryExt':\n                break;\n\n              /* Formatting */\n              case 'IFmtRecord':\n                break;\n              case 'CondFmt':\n              case 'CF':\n              case 'CF12':\n              case 'CFEx':\n                break;\n\n              /* Explicitly Ignored */\n              case 'Excel9File':\n                break;\n              case 'Units':\n                break;\n              case 'InterfaceHdr':\n              case 'Mms':\n              case 'InterfaceEnd':\n              case 'DSF':\n              case 'BuiltInFnGroupCount':\n              /* View Stuff */\n              case 'Window1':\n              case 'Window2':\n              case 'HideObj':\n              case 'GridSet':\n              case 'Guts':\n              case 'UserBView':\n              case 'UserSViewBegin':\n              case 'UserSViewEnd':\n              case 'Pane':\n                break;\n              default:\n                switch (R.n) {\n                  /* nested */\n                  /* Chart */\n                  case 'Dat':\n                  case 'Begin':\n                  case 'End':\n                  case 'StartBlock':\n                  case 'EndBlock':\n                  case 'Frame':\n                  case 'Area':\n                  case 'Axis':\n                  case 'AxisLine':\n                  case 'Tick':\n                    break;\n                  case 'AxesUsed':\n                  case 'CrtLayout12':\n                  case 'CrtLayout12A':\n                  case 'CrtLink':\n                  case 'CrtLine':\n                  case 'CrtMlFrt':\n                  case 'CrtMlFrtContinue':\n                    break;\n                  case 'LineFormat':\n                  case 'AreaFormat':\n                  case 'Chart':\n                  case 'Chart3d':\n                  case 'Chart3DBarShape':\n                  case 'ChartFormat':\n                  case 'ChartFrtInfo':\n                    break;\n                  case 'PlotArea':\n                  case 'PlotGrowth':\n                    break;\n                  case 'SeriesList':\n                  case 'SerParent':\n                  case 'SerAuxTrend':\n                    break;\n                  case 'DataFormat':\n                  case 'SerToCrt':\n                  case 'FontX':\n                    break;\n                  case 'CatSerRange':\n                  case 'AxcExt':\n                  case 'SerFmt':\n                    break;\n                  case 'ShtProps':\n                    break;\n                  case 'DefaultText':\n                  case 'Text':\n                  case 'CatLab':\n                    break;\n                  case 'DataLabExtContents':\n                    break;\n                  case 'Legend':\n                  case 'LegendException':\n                    break;\n                  case 'Pie':\n                  case 'Scatter':\n                    break;\n                  case 'PieFormat':\n                  case 'MarkerFormat':\n                    break;\n                  case 'StartObject':\n                  case 'EndObject':\n                    break;\n                  case 'AlRuns':\n                  case 'ObjectLink':\n                    break;\n                  case 'SIIndex':\n                    break;\n                  case 'AttachedLabel':\n                  case 'YMult':\n                    break;\n\n                  /* Chart Group */\n                  case 'Line':\n                  case 'Bar':\n                    break;\n                  case 'Surf':\n                    break;\n\n                  /* Axis Group */\n                  case 'AxisParent':\n                    break;\n                  case 'Pos':\n                    break;\n                  case 'ValueRange':\n                    break;\n\n                  /* Pivot Chart */\n                  case 'SXViewEx9':\n                    break;\n                  // TODO\n                  case 'SXViewLink':\n                    break;\n                  case 'PivotChartBits':\n                    break;\n                  case 'SBaseRef':\n                    break;\n                  case 'TextPropsStream':\n                    break;\n\n                  /* Chart Misc */\n                  case 'LnExt':\n                    break;\n                  case 'MkrExt':\n                    break;\n                  case 'CrtCoopt':\n                    break;\n\n                  /* Query Table */\n                  case 'Qsi':\n                  case 'Qsif':\n                  case 'Qsir':\n                  case 'QsiSXTag':\n                    break;\n                  case 'TxtQry':\n                    break;\n\n                  /* Filter */\n                  case 'FilterMode':\n                    break;\n                  case 'AutoFilter':\n                  case 'AutoFilterInfo':\n                    break;\n                  case 'AutoFilter12':\n                    break;\n                  case 'DropDownObjIds':\n                    break;\n                  case 'Sort':\n                    break;\n                  case 'SortData':\n                    break;\n\n                  /* Drawing */\n                  case 'ShapePropsStream':\n                    break;\n                  case 'MsoDrawing':\n                  case 'MsoDrawingGroup':\n                  case 'MsoDrawingSelection':\n                    break;\n                  case 'ImData':\n                    break;\n                  /* Pub Stuff */\n                  case 'WebPub':\n                  case 'AutoWebPub':\n\n                  /* Print Stuff */\n                  case 'RightMargin':\n                  case 'LeftMargin':\n                  case 'TopMargin':\n                  case 'BottomMargin':\n                  case 'HeaderFooter':\n                  case 'HFPicture':\n                  case 'PLV':\n                  case 'HorizontalPageBreaks':\n                  case 'VerticalPageBreaks':\n                  /* Behavioral */\n                  case 'Backup':\n                  case 'CompressPictures':\n                  case 'Compat12':\n                    break;\n\n                  /* Should not Happen */\n                  case 'Continue':\n                  case 'ContinueFrt12':\n                    break;\n\n                  /* Future Records */\n                  case 'FrtFontList':\n                  case 'FrtWrapper':\n                    break;\n                  default:\n                    switch (R.n) {\n                      /* nested */\n                      /* BIFF5 records */\n                      case 'ExternCount':\n                        break;\n                      case 'TabIdConf':\n                      case 'Radar':\n                      case 'RadarArea':\n                      case 'DropBar':\n                      case 'Intl':\n                      case 'CoordList':\n                      case 'SerAuxErrBar':\n                        break;\n\n                      /* BIFF2-4 records */\n                      case 'BIFF2FONTCLR':\n                      case 'BIFF2FMTCNT':\n                      case 'BIFF2FONTXTRA':\n                        break;\n                      case 'BIFF2XF':\n                      case 'BIFF3XF':\n                      case 'BIFF4XF':\n                        break;\n                      case 'BIFF4FMTCNT':\n                      case 'BIFF2ROW':\n                      case 'BIFF2WINDOW2':\n                        break;\n\n                      /* Miscellaneous */\n                      case 'SCENARIO':\n                      case 'DConBin':\n                      case 'PicF':\n                      case 'DataLabExt':\n                      case 'Lel':\n                      case 'BopPop':\n                      case 'BopPopCustom':\n                      case 'RealTimeData':\n                      case 'Name':\n                        break;\n                      default:\n                        if (options.WTF) throw 'Unrecognized Record ' + R.n;\n                    }\n                }\n            }\n        }\n      } else blob.l += length;\n    }\n    var sheetnamesraw = Object.keys(Directory).sort(function (a, b) {\n      return Number(a) - Number(b);\n    }).map(function (x) {\n      return Directory[x].name;\n    });\n    var sheetnames = sheetnamesraw.slice();\n    wb.Directory = sheetnamesraw;\n    wb.SheetNames = sheetnamesraw;\n    if (!options.bookSheets) wb.Sheets = Sheets;\n    wb.Preamble = Preamble;\n    wb.Strings = sst;\n    wb.SSF = SSF.get_table();\n    if (opts.enc) wb.Encryption = opts.enc;\n    wb.Metadata = {};\n    if (country !== undefined) wb.Metadata.Country = country;\n    return wb;\n  }\n  function parse_xlscfb(cfb, options) {\n    if (!options) options = {};\n    fix_read_opts(options);\n    reset_cp();\n    var CompObj, Summary, Workbook;\n    if (cfb.FullPaths) {\n      CompObj = cfb.find('!CompObj');\n      Summary = cfb.find('!SummaryInformation');\n      Workbook = cfb.find('/Workbook');\n    } else {\n      prep_blob(cfb, 0);\n      Workbook = {\n        content: cfb\n      };\n    }\n    if (!Workbook) Workbook = cfb.find('/Book');\n    var CompObjP, SummaryP, WorkbookP;\n    if (CompObj) CompObjP = parse_compobj(CompObj);\n    if (options.bookProps && !options.bookSheets) WorkbookP = {};else {\n      if (Workbook) WorkbookP = parse_workbook(Workbook.content, options, !!Workbook.find);else throw new Error(\"Cannot find Workbook stream\");\n    }\n    if (cfb.FullPaths) parse_props(cfb);\n    var props = {};\n    for (var y in cfb.Summary) props[y] = cfb.Summary[y];\n    for (y in cfb.DocSummary) props[y] = cfb.DocSummary[y];\n    WorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\n    if (options.bookFiles) WorkbookP.cfb = cfb;\n    WorkbookP.CompObjP = CompObjP;\n    return WorkbookP;\n  }\n\n  /* TODO: WTF */\n  function parse_props(cfb) {\n    /* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n    var DSI = cfb.find('!DocumentSummaryInformation');\n    if (DSI) try {\n      cfb.DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI);\n    } catch (e) {}\n\n    /* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n    var SI = cfb.find('!SummaryInformation');\n    if (SI) try {\n      cfb.Summary = parse_PropertySetStream(SI, SummaryPIDSI);\n    } catch (e) {}\n  }\n  // TODO: CP remap (need to read file version to determine OS)\n  var encregex = /&[a-z]*;/g,\n    coderegex = /_x([0-9a-fA-F]+)_/g;\n  function coderepl(m, c) {\n    return _chr(parseInt(c, 16));\n  }\n  function encrepl($$) {\n    return encodings[$$];\n  }\n  function unescapexml(s) {\n    if (s.indexOf(\"&\") > -1) s = s.replace(encregex, encrepl);\n    return s.indexOf(\"_\") === -1 ? s : s.replace(coderegex, coderepl);\n  }\n  function parsexmlbool(value, tag) {\n    switch (value) {\n      case '1':\n      case 'true':\n      case 'TRUE':\n        return true;\n      /* case '0': case 'false': case 'FALSE':*/\n      default:\n        return false;\n    }\n  }\n\n  // matches <foo>...</foo> extracts content\n  function matchtag(f, g) {\n    return new RegExp('<' + f + '(?: xml:space=\"preserve\")?>([^\\u2603]*)</' + f + '>', (g || \"\") + \"m\");\n  }\n\n  /* TODO: handle codepages */\n  var entregex = /&#(\\d+);/g;\n  function entrepl($$, $1) {\n    return String.fromCharCode(parseInt($1, 10));\n  }\n  function fixstr(str) {\n    return str.replace(entregex, entrepl);\n  }\n  /* map from xlml named formats to SSF TODO: localize */\n  var XLMLFormatMap /*{[string]:string}*/ = {\n    \"General Number\": \"General\",\n    \"General Date\": SSF._table[22],\n    \"Long Date\": \"dddd, mmmm dd, yyyy\",\n    \"Medium Date\": SSF._table[15],\n    \"Short Date\": SSF._table[14],\n    \"Long Time\": SSF._table[19],\n    \"Medium Time\": SSF._table[18],\n    \"Short Time\": SSF._table[20],\n    \"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n    \"Fixed\": SSF._table[2],\n    \"Standard\": SSF._table[4],\n    \"Percent\": SSF._table[10],\n    \"Scientific\": SSF._table[11],\n    \"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n    \"True/False\": '\"True\";\"True\";\"False\";@',\n    \"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n  };\n\n  /* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\n  var PatternTypeMap = {\n    \"None\": \"none\",\n    \"Solid\": \"solid\",\n    \"Gray50\": \"mediumGray\",\n    \"Gray75\": \"darkGray\",\n    \"Gray25\": \"lightGray\",\n    \"HorzStripe\": \"darkHorizontal\",\n    \"VertStripe\": \"darkVertical\",\n    \"ReverseDiagStripe\": \"darkDown\",\n    \"DiagStripe\": \"darkUp\",\n    \"DiagCross\": \"darkGrid\",\n    \"ThickDiagCross\": \"darkTrellis\",\n    \"ThinHorzStripe\": \"lightHorizontal\",\n    \"ThinVertStripe\": \"lightVertical\",\n    \"ThinReverseDiagStripe\": \"lightDown\",\n    \"ThinHorzCross\": \"lightGrid\"\n  };\n\n  /* TODO: Normalize the properties */\n  function xlml_set_prop(Props, tag, val) {\n    switch (tag) {\n      case 'Description':\n        tag = 'Comments';\n        break;\n    }\n    Props[tag] = val;\n  }\n  function xlml_format(format, value) {\n    var fmt = XLMLFormatMap[format] || unescapexml(format);\n    if (fmt === \"General\") return SSF._general(value);\n    return SSF.format(fmt, value);\n  }\n  function xlml_set_custprop(Custprops, Rn, cp, val) {\n    switch ((cp[0].match(/dt:dt=\"([\\w.]+)\"/) || [\"\", \"\"])[1]) {\n      case \"boolean\":\n        val = parsexmlbool(val);\n        break;\n      case \"i2\":\n      case \"int\":\n        val = parseInt(val, 10);\n        break;\n      case \"r4\":\n      case \"float\":\n        val = parseFloat(val);\n        break;\n      case \"date\":\n      case \"dateTime.tz\":\n        val = new Date(val);\n        break;\n      case \"i8\":\n      case \"string\":\n      case \"fixed\":\n      case \"uuid\":\n      case \"bin.base64\":\n        break;\n      default:\n        throw \"bad custprop:\" + cp[0];\n    }\n    Custprops[unescapexml(Rn[3])] = val;\n  }\n  function safe_format_xlml(cell, nf, o) {\n    try {\n      if (cell.t === 'e') {\n        cell.w = cell.w || BErr[cell.v];\n      } else if (nf === \"General\") {\n        if (cell.t === 'n') {\n          if ((cell.v | 0) === cell.v) cell.w = SSF._general_int(cell.v);else cell.w = SSF._general_num(cell.v);\n        } else cell.w = SSF._general(cell.v);\n      } else cell.w = xlml_format(nf || \"General\", cell.v);\n      if (o.cellNF) cell.z = XLMLFormatMap[nf] || nf || \"General\";\n    } catch (e) {\n      if (o.WTF) throw e;\n    }\n  }\n  function process_style_xlml(styles, stag, opts) {\n    if (opts.cellStyles) {\n      if (stag.Interior) {\n        var I = stag.Interior;\n        if (I.Pattern) I.patternType = PatternTypeMap[I.Pattern] || I.Pattern;\n      }\n    }\n    styles[stag.ID] = stag;\n  }\n\n  /* TODO: there must exist some form of OSP-blessed spec */\n  function parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, arrayf, o) {\n    var nf = \"General\",\n      sid = cell.StyleID,\n      S = {};\n    o = o || {};\n    var interiors = [];\n    if (sid === undefined && row) sid = row.StyleID;\n    if (sid === undefined && csty) sid = csty.StyleID;\n    while (styles[sid] !== undefined) {\n      if (styles[sid].nf) nf = styles[sid].nf;\n      if (styles[sid].Interior) interiors.push(styles[sid].Interior);\n      if (!styles[sid].Parent) break;\n      sid = styles[sid].Parent;\n    }\n    switch (data.Type) {\n      case 'Boolean':\n        cell.t = 'b';\n        cell.v = parsexmlbool(xml);\n        break;\n      case 'String':\n        cell.t = 's';\n        cell.r = fixstr(unescapexml(xml));\n        cell.v = xml.indexOf(\"<\") > -1 ? unescapexml(ss) : cell.r;\n        break;\n      case 'DateTime':\n        cell.v = (Date.parse(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n        if (cell.v !== cell.v) cell.v = unescapexml(xml);else if (cell.v >= 1 && cell.v < 60) cell.v = cell.v - 1;\n        if (!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n      /* falls through */\n      case 'Number':\n        if (cell.v === undefined) cell.v = +xml;\n        if (!cell.t) cell.t = 'n';\n        break;\n      case 'Error':\n        cell.t = 'e';\n        cell.v = RBErr[xml];\n        cell.w = xml;\n        break;\n      default:\n        cell.t = 's';\n        cell.v = fixstr(ss);\n        break;\n    }\n    safe_format_xlml(cell, nf, o);\n    if (o.cellFormula != null) {\n      if (cell.Formula) {\n        var fstr = unescapexml(cell.Formula);\n        /* strictly speaking, the leading = is required but some writers omit */\n        if (fstr.charCodeAt(0) == 61 /* = */) fstr = fstr.substr(1);\n        cell.f = rc_to_a1(fstr, base);\n        cell.Formula = undefined;\n        if (cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);else if (cell.ArrayRange) {\n          cell.F = rc_to_a1(cell.ArrayRange, base);\n          arrayf.push([safe_decode_range(cell.F), cell.F]);\n        }\n      } else {\n        for (i = 0; i < arrayf.length; ++i) if (base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r) if (base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c) cell.F = arrayf[i][1];\n      }\n    }\n    if (o.cellStyles) {\n      interiors.forEach(function (x) {\n        if (!S.patternType && x.patternType) S.patternType = x.patternType;\n      });\n      cell.s = S;\n    }\n    cell.ixfe = cell.StyleID !== undefined ? cell.StyleID : 'Default';\n  }\n  function xlml_clean_comment(comment) {\n    comment.t = comment.v;\n    comment.v = comment.w = comment.ixfe = undefined;\n  }\n  function xlml_normalize(d) {\n    if (has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n    if (typeof d === 'string') return d;\n    throw new Error(\"Bad input format: expected Buffer or string\");\n  }\n\n  /* TODO: Everything */\n  var xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\n  function parse_xlml_xml(d, opts) {\n    var str = debom(xlml_normalize(d));\n    var Rn;\n    var state = [],\n      tmp;\n    var sheets = {},\n      sheetnames = [],\n      cursheet = {},\n      sheetname = \"\";\n    var table = {},\n      cell = {},\n      row = {};\n    var dtag = parsexmltag('<Data ss:Type=\"String\">'),\n      didx = 0;\n    var c = 0,\n      r = 0;\n    var refguess = {\n      s: {\n        r: 2000000,\n        c: 2000000\n      },\n      e: {\n        r: 0,\n        c: 0\n      }\n    };\n    var styles = {},\n      stag = {};\n    var ss = \"\",\n      fidx = 0;\n    var mergecells = [];\n    var Props = {},\n      Custprops = {},\n      pidx = 0,\n      cp = {};\n    var comments = [],\n      comment = {};\n    var cstys = [],\n      csty;\n    var arrayf = [];\n    xlmlregex.lastIndex = 0;\n    while (Rn = xlmlregex.exec(str)) switch (Rn[3]) {\n      case 'Data':\n        if (state[state.length - 1][1]) break;\n        if (Rn[1] === '/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length - 1][0] == \"Comment\" ? comment : cell, {\n          c: c,\n          r: r\n        }, styles, cstys[c], row, arrayf, opts);else {\n          ss = \"\";\n          dtag = parsexmltag(Rn[0]);\n          didx = Rn.index + Rn[0].length;\n        }\n        break;\n      case 'Cell':\n        if (Rn[1] === '/') {\n          if (comments.length > 0) cell.c = comments;\n          if ((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) cursheet[encode_col(c) + encode_row(r)] = cell;\n          if (cell.HRef) {\n            cell.l = {\n              Target: cell.HRef,\n              tooltip: cell.HRefScreenTip\n            };\n            cell.HRef = cell.HRefScreenTip = undefined;\n          }\n          if (cell.MergeAcross || cell.MergeDown) {\n            var cc = c + (parseInt(cell.MergeAcross, 10) | 0);\n            var rr = r + (parseInt(cell.MergeDown, 10) | 0);\n            mergecells.push({\n              s: {\n                c: c,\n                r: r\n              },\n              e: {\n                c: cc,\n                r: rr\n              }\n            });\n          }\n          ++c;\n          if (cell.MergeAcross) c += +cell.MergeAcross;\n        } else {\n          cell = parsexmltagobj(Rn[0]);\n          if (cell.Index) c = +cell.Index - 1;\n          if (c < refguess.s.c) refguess.s.c = c;\n          if (c > refguess.e.c) refguess.e.c = c;\n          if (Rn[0].slice(-2) === \"/>\") ++c;\n          comments = [];\n        }\n        break;\n      case 'Row':\n        if (Rn[1] === '/' || Rn[0].slice(-2) === \"/>\") {\n          if (r < refguess.s.r) refguess.s.r = r;\n          if (r > refguess.e.r) refguess.e.r = r;\n          if (Rn[0].slice(-2) === \"/>\") {\n            row = parsexmltag(Rn[0]);\n            if (row.Index) r = +row.Index - 1;\n          }\n          c = 0;\n          ++r;\n        } else {\n          row = parsexmltag(Rn[0]);\n          if (row.Index) r = +row.Index - 1;\n        }\n        break;\n      case 'Worksheet':\n        /* TODO: read range from FullRows/FullColumns */\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          sheetnames.push(sheetname);\n          if (refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) cursheet[\"!ref\"] = encode_range(refguess);\n          if (mergecells.length) cursheet[\"!merges\"] = mergecells;\n          sheets[sheetname] = cursheet;\n        } else {\n          refguess = {\n            s: {\n              r: 2000000,\n              c: 2000000\n            },\n            e: {\n              r: 0,\n              c: 0\n            }\n          };\n          r = c = 0;\n          state.push([Rn[3], false]);\n          tmp = parsexmltag(Rn[0]);\n          sheetname = tmp.Name;\n          cursheet = {};\n          mergecells = [];\n        }\n        break;\n      case 'Table':\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].slice(-2) == \"/>\") break;else {\n          table = parsexmltag(Rn[0]);\n          state.push([Rn[3], false]);\n          cstys = [];\n        }\n        break;\n      case 'Style':\n        if (Rn[1] === '/') process_style_xlml(styles, stag, opts);else stag = parsexmltag(Rn[0]);\n        break;\n      case 'NumberFormat':\n        stag.nf = parsexmltag(Rn[0]).Format || \"General\";\n        break;\n      case 'Column':\n        if (state[state.length - 1][0] !== 'Table') break;\n        csty = parsexmltag(Rn[0]);\n        cstys[csty.Index - 1 || cstys.length] = csty;\n        for (var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = csty;\n        break;\n      case 'NamedRange':\n        break;\n      case 'NamedCell':\n        break;\n      case 'B':\n        break;\n      case 'I':\n        break;\n      case 'U':\n        break;\n      case 'S':\n        break;\n      case 'Sub':\n        break;\n      case 'Sup':\n        break;\n      case 'Span':\n        break;\n      case 'Border':\n        break;\n      case 'Alignment':\n        break;\n      case 'Borders':\n        break;\n      case 'Font':\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") ss += str.slice(fidx, Rn.index);else fidx = Rn.index + Rn[0].length;\n        break;\n      case 'Interior':\n        if (!opts.cellStyles) break;\n        stag.Interior = parsexmltag(Rn[0]);\n        break;\n      case 'Protection':\n        break;\n      case 'Author':\n      case 'Title':\n      case 'Description':\n      case 'Created':\n      case 'Keywords':\n      case 'Subject':\n      case 'Category':\n      case 'Company':\n      case 'LastAuthor':\n      case 'LastSaved':\n      case 'LastPrinted':\n      case 'Version':\n      case 'Revision':\n      case 'TotalTime':\n      case 'HyperlinkBase':\n      case 'Manager':\n        if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_prop(Props, Rn[3], str.slice(pidx, Rn.index));else pidx = Rn.index + Rn[0].length;\n        break;\n      case 'Paragraphs':\n        break;\n      case 'Styles':\n      case 'Workbook':\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else state.push([Rn[3], false]);\n        break;\n      case 'Comment':\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n          xlml_clean_comment(comment);\n          comments.push(comment);\n        } else {\n          state.push([Rn[3], false]);\n          tmp = parsexmltag(Rn[0]);\n          comment = {\n            a: tmp.Author\n          };\n        }\n        break;\n      case 'Name':\n        break;\n      case 'ComponentOptions':\n      case 'DocumentProperties':\n      case 'CustomDocumentProperties':\n      case 'OfficeDocumentSettings':\n      case 'PivotTable':\n      case 'PivotCache':\n      case 'Names':\n      case 'MapInfo':\n      case 'PageBreaks':\n      case 'QueryTable':\n      case 'DataValidation':\n      case 'AutoFilter':\n      case 'Sorting':\n      case 'Schema':\n      case 'data':\n      case 'ConditionalFormatting':\n      case 'SmartTagType':\n      case 'SmartTags':\n      case 'ExcelWorkbook':\n      case 'WorkbookOptions':\n      case 'WorksheetOptions':\n        if (Rn[1] === '/') {\n          if ((tmp = state.pop())[0] !== Rn[3]) throw \"Bad state: \" + tmp;\n        } else if (Rn[0].charAt(Rn[0].length - 2) !== '/') state.push([Rn[3], true]);\n        break;\n      default:\n        /* FODS file root is <office:document> */\n        if (state.length == 0 && Rn[3] == \"document\") throw new Error(\"Unsupported FODS format\");\n        /* UOS file root is <uof:UOF> */\n        if (state.length == 0 && Rn[3] == \"UOF\") throw new Error(\"Unsupported UOS format\");\n        var seen = true;\n        switch (state[state.length - 1][0]) {\n          /* OfficeDocumentSettings */\n          case 'OfficeDocumentSettings':\n            switch (Rn[3]) {\n              case 'AllowPNG':\n                break;\n              case 'RemovePersonalInformation':\n                break;\n              case 'DownloadComponents':\n                break;\n              case 'LocationOfComponents':\n                break;\n              case 'Colors':\n                break;\n              case 'Color':\n                break;\n              case 'Index':\n                break;\n              case 'RGB':\n                break;\n              case 'PixelsPerInch':\n                break;\n              case 'TargetScreenSize':\n                break;\n              case 'ReadOnlyRecommended':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* ComponentOptions */\n          case 'ComponentOptions':\n            switch (Rn[3]) {\n              case 'Toolbar':\n                break;\n              case 'HideOfficeLogo':\n                break;\n              case 'SpreadsheetAutoFit':\n                break;\n              case 'Label':\n                break;\n              case 'Caption':\n                break;\n              case 'MaxHeight':\n                break;\n              case 'MaxWidth':\n                break;\n              case 'NextSheetNumber':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* ExcelWorkbook */\n          case 'ExcelWorkbook':\n            switch (Rn[3]) {\n              case 'WindowHeight':\n                break;\n              case 'WindowWidth':\n                break;\n              case 'WindowTopX':\n                break;\n              case 'WindowTopY':\n                break;\n              case 'TabRatio':\n                break;\n              case 'ProtectStructure':\n                break;\n              case 'ProtectWindows':\n                break;\n              case 'ActiveSheet':\n                break;\n              case 'DisplayInkNotes':\n                break;\n              case 'FirstVisibleSheet':\n                break;\n              case 'SupBook':\n                break;\n              case 'SheetName':\n                break;\n              case 'SheetIndex':\n                break;\n              case 'SheetIndexFirst':\n                break;\n              case 'SheetIndexLast':\n                break;\n              case 'Dll':\n                break;\n              case 'AcceptLabelsInFormulas':\n                break;\n              case 'DoNotSaveLinkValues':\n                break;\n              case 'Date1904':\n                break;\n              case 'Iteration':\n                break;\n              case 'MaxIterations':\n                break;\n              case 'MaxChange':\n                break;\n              case 'Path':\n                break;\n              case 'Xct':\n                break;\n              case 'Count':\n                break;\n              case 'SelectedSheets':\n                break;\n              case 'Calculation':\n                break;\n              case 'Uncalced':\n                break;\n              case 'StartupPrompt':\n                break;\n              case 'Crn':\n                break;\n              case 'ExternName':\n                break;\n              case 'Formula':\n                break;\n              case 'ColFirst':\n                break;\n              case 'ColLast':\n                break;\n              case 'WantAdvise':\n                break;\n              case 'Boolean':\n                break;\n              case 'Error':\n                break;\n              case 'Text':\n                break;\n              case 'OLE':\n                break;\n              case 'NoAutoRecover':\n                break;\n              case 'PublishObjects':\n                break;\n              case 'DoNotCalculateBeforeSave':\n                break;\n              case 'Number':\n                break;\n              case 'RefModeR1C1':\n                break;\n              case 'EmbedSaveSmartTags':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* WorkbookOptions */\n          case 'WorkbookOptions':\n            switch (Rn[3]) {\n              case 'OWCVersion':\n                break;\n              case 'Height':\n                break;\n              case 'Width':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* WorksheetOptions */\n          case 'WorksheetOptions':\n            switch (Rn[3]) {\n              case 'Unsynced':\n                break;\n              case 'Visible':\n                break;\n              case 'Print':\n                break;\n              case 'Panes':\n                break;\n              case 'Scale':\n                break;\n              case 'Pane':\n                break;\n              case 'Number':\n                break;\n              case 'Layout':\n                break;\n              case 'Header':\n                break;\n              case 'Footer':\n                break;\n              case 'PageSetup':\n                break;\n              case 'PageMargins':\n                break;\n              case 'Selected':\n                break;\n              case 'ProtectObjects':\n                break;\n              case 'EnableSelection':\n                break;\n              case 'ProtectScenarios':\n                break;\n              case 'ValidPrinterInfo':\n                break;\n              case 'HorizontalResolution':\n                break;\n              case 'VerticalResolution':\n                break;\n              case 'NumberofCopies':\n                break;\n              case 'ActiveRow':\n                break;\n              case 'ActiveCol':\n                break;\n              case 'ActivePane':\n                break;\n              case 'TopRowVisible':\n                break;\n              case 'TopRowBottomPane':\n                break;\n              case 'LeftColumnVisible':\n                break;\n              case 'LeftColumnRightPane':\n                break;\n              case 'FitToPage':\n                break;\n              case 'RangeSelection':\n                break;\n              case 'PaperSizeIndex':\n                break;\n              case 'PageLayoutZoom':\n                break;\n              case 'PageBreakZoom':\n                break;\n              case 'FilterOn':\n                break;\n              case 'DoNotDisplayGridlines':\n                break;\n              case 'SplitHorizontal':\n                break;\n              case 'SplitVertical':\n                break;\n              case 'FreezePanes':\n                break;\n              case 'FrozenNoSplit':\n                break;\n              case 'FitWidth':\n                break;\n              case 'FitHeight':\n                break;\n              case 'CommentsLayout':\n                break;\n              case 'Zoom':\n                break;\n              case 'LeftToRight':\n                break;\n              case 'Gridlines':\n                break;\n              case 'AllowSort':\n                break;\n              case 'AllowFilter':\n                break;\n              case 'AllowInsertRows':\n                break;\n              case 'AllowDeleteRows':\n                break;\n              case 'AllowInsertCols':\n                break;\n              case 'AllowDeleteCols':\n                break;\n              case 'AllowInsertHyperlinks':\n                break;\n              case 'AllowFormatCells':\n                break;\n              case 'AllowSizeCols':\n                break;\n              case 'AllowSizeRows':\n                break;\n              case 'NoSummaryRowsBelowDetail':\n                break;\n              case 'TabColorIndex':\n                break;\n              case 'DoNotDisplayHeadings':\n                break;\n              case 'ShowPageLayoutZoom':\n                break;\n              case 'NoSummaryColumnsRightDetail':\n                break;\n              case 'BlackAndWhite':\n                break;\n              case 'DoNotDisplayZeros':\n                break;\n              case 'DisplayPageBreak':\n                break;\n              case 'RowColHeadings':\n                break;\n              case 'DoNotDisplayOutline':\n                break;\n              case 'NoOrientation':\n                break;\n              case 'AllowUsePivotTables':\n                break;\n              case 'ZeroHeight':\n                break;\n              case 'ViewableRange':\n                break;\n              case 'Selection':\n                break;\n              case 'ProtectContents':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* PivotTable */\n          case 'PivotTable':\n          case 'PivotCache':\n            switch (Rn[3]) {\n              case 'ImmediateItemsOnDrop':\n                break;\n              case 'ShowPageMultipleItemLabel':\n                break;\n              case 'CompactRowIndent':\n                break;\n              case 'Location':\n                break;\n              case 'PivotField':\n                break;\n              case 'Orientation':\n                break;\n              case 'LayoutForm':\n                break;\n              case 'LayoutSubtotalLocation':\n                break;\n              case 'LayoutCompactRow':\n                break;\n              case 'Position':\n                break;\n              case 'PivotItem':\n                break;\n              case 'DataType':\n                break;\n              case 'DataField':\n                break;\n              case 'SourceName':\n                break;\n              case 'ParentField':\n                break;\n              case 'PTLineItems':\n                break;\n              case 'PTLineItem':\n                break;\n              case 'CountOfSameItems':\n                break;\n              case 'Item':\n                break;\n              case 'ItemType':\n                break;\n              case 'PTSource':\n                break;\n              case 'CacheIndex':\n                break;\n              case 'ConsolidationReference':\n                break;\n              case 'FileName':\n                break;\n              case 'Reference':\n                break;\n              case 'NoColumnGrand':\n                break;\n              case 'NoRowGrand':\n                break;\n              case 'BlankLineAfterItems':\n                break;\n              case 'Hidden':\n                break;\n              case 'Subtotal':\n                break;\n              case 'BaseField':\n                break;\n              case 'MapChildItems':\n                break;\n              case 'Function':\n                break;\n              case 'RefreshOnFileOpen':\n                break;\n              case 'PrintSetTitles':\n                break;\n              case 'MergeLabels':\n                break;\n              case 'DefaultVersion':\n                break;\n              case 'RefreshName':\n                break;\n              case 'RefreshDate':\n                break;\n              case 'RefreshDateCopy':\n                break;\n              case 'VersionLastRefresh':\n                break;\n              case 'VersionLastUpdate':\n                break;\n              case 'VersionUpdateableMin':\n                break;\n              case 'VersionRefreshableMin':\n                break;\n              case 'Calculation':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* PageBreaks */\n          case 'PageBreaks':\n            switch (Rn[3]) {\n              case 'ColBreaks':\n                break;\n              case 'ColBreak':\n                break;\n              case 'RowBreaks':\n                break;\n              case 'RowBreak':\n                break;\n              case 'ColStart':\n                break;\n              case 'ColEnd':\n                break;\n              case 'RowEnd':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* AutoFilter */\n          case 'AutoFilter':\n            switch (Rn[3]) {\n              case 'AutoFilterColumn':\n                break;\n              case 'AutoFilterCondition':\n                break;\n              case 'AutoFilterAnd':\n                break;\n              case 'AutoFilterOr':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* QueryTable */\n          case 'QueryTable':\n            switch (Rn[3]) {\n              case 'Id':\n                break;\n              case 'AutoFormatFont':\n                break;\n              case 'AutoFormatPattern':\n                break;\n              case 'QuerySource':\n                break;\n              case 'QueryType':\n                break;\n              case 'EnableRedirections':\n                break;\n              case 'RefreshedInXl9':\n                break;\n              case 'URLString':\n                break;\n              case 'HTMLTables':\n                break;\n              case 'Connection':\n                break;\n              case 'CommandText':\n                break;\n              case 'RefreshInfo':\n                break;\n              case 'NoTitles':\n                break;\n              case 'NextId':\n                break;\n              case 'ColumnInfo':\n                break;\n              case 'OverwriteCells':\n                break;\n              case 'DoNotPromptForFile':\n                break;\n              case 'TextWizardSettings':\n                break;\n              case 'Source':\n                break;\n              case 'Number':\n                break;\n              case 'Decimal':\n                break;\n              case 'ThousandSeparator':\n                break;\n              case 'TrailingMinusNumbers':\n                break;\n              case 'FormatSettings':\n                break;\n              case 'FieldType':\n                break;\n              case 'Delimiters':\n                break;\n              case 'Tab':\n                break;\n              case 'Comma':\n                break;\n              case 'AutoFormatName':\n                break;\n              case 'VersionLastEdit':\n                break;\n              case 'VersionLastRefresh':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* Sorting */\n          case 'Sorting':\n          /* ConditionalFormatting */\n          case 'ConditionalFormatting':\n          /* DataValidation */\n          case 'DataValidation':\n            switch (Rn[3]) {\n              case 'Range':\n                break;\n              case 'Type':\n                break;\n              case 'Min':\n                break;\n              case 'Max':\n                break;\n              case 'Sort':\n                break;\n              case 'Descending':\n                break;\n              case 'Order':\n                break;\n              case 'CaseSensitive':\n                break;\n              case 'Value':\n                break;\n              case 'ErrorStyle':\n                break;\n              case 'ErrorMessage':\n                break;\n              case 'ErrorTitle':\n                break;\n              case 'CellRangeList':\n                break;\n              case 'InputMessage':\n                break;\n              case 'InputTitle':\n                break;\n              case 'ComboHide':\n                break;\n              case 'InputHide':\n                break;\n              case 'Condition':\n                break;\n              case 'Qualifier':\n                break;\n              case 'UseBlank':\n                break;\n              case 'Value1':\n                break;\n              case 'Value2':\n                break;\n              case 'Format':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* MapInfo (schema) */\n          case 'MapInfo':\n          case 'Schema':\n          case 'data':\n            switch (Rn[3]) {\n              case 'Map':\n                break;\n              case 'Entry':\n                break;\n              case 'Range':\n                break;\n              case 'XPath':\n                break;\n              case 'Field':\n                break;\n              case 'XSDType':\n                break;\n              case 'FilterOn':\n                break;\n              case 'Aggregate':\n                break;\n              case 'ElementType':\n                break;\n              case 'AttributeType':\n                break;\n              /* These are from xsd (XML Schema Definition) */\n              case 'schema':\n              case 'element':\n              case 'complexType':\n              case 'datatype':\n              case 'all':\n              case 'attribute':\n              case 'extends':\n                break;\n              case 'row':\n                break;\n              default:\n                seen = false;\n            }\n            break;\n\n          /* SmartTags (can be anything) */\n          case 'SmartTags':\n            break;\n          default:\n            seen = false;\n            break;\n        }\n        if (seen) break;\n        /* CustomDocumentProperties */\n        if (!state[state.length - 1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n        if (state[state.length - 1][0] === 'CustomDocumentProperties') {\n          if (Rn[0].slice(-2) === \"/>\") break;else if (Rn[1] === \"/\") xlml_set_custprop(Custprops, Rn, cp, str.slice(pidx, Rn.index));else {\n            cp = Rn;\n            pidx = Rn.index + Rn[0].length;\n          }\n          break;\n        }\n        if (opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n    }\n    var out = {};\n    if (!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n    out.SheetNames = sheetnames;\n    out.SSF = SSF.get_table();\n    out.Props = Props;\n    out.Custprops = Custprops;\n    return out;\n  }\n  function parse_xlml(data, opts) {\n    fix_read_opts(opts = opts || {});\n    switch (opts.type || \"base64\") {\n      case \"base64\":\n        return parse_xlml_xml(Base64.decode(data), opts);\n      case \"binary\":\n      case \"buffer\":\n      case \"file\":\n        return parse_xlml_xml(data, opts);\n      case \"array\":\n        return parse_xlml_xml(data.map(_chr).join(\"\"), opts);\n    }\n  }\n\n  /* TODO */\n  function write_xlml(wb, opts) {\n    var o = [XML_HEADER];\n    return o.join(\"\");\n  }\n  var fs;\n  if (typeof exports !== 'undefined') {\n    if (typeof module !== 'undefined' && module.exports) {\n      fs = require('fs');\n    }\n  }\n  function firstbyte(f, o) {\n    switch ((o || {}).type || \"base64\") {\n      case 'buffer':\n        return f[0];\n      case 'base64':\n        return Base64.decode(f.substr(0, 12)).charCodeAt(0);\n      case 'binary':\n        return f.charCodeAt(0);\n      case 'array':\n        return f[0];\n      default:\n        throw new Error(\"Unrecognized type \" + o.type);\n    }\n  }\n  function xlsread(f, o) {\n    var n = 0;\n    if (!o) o = {};\n    if (!o.type) o.type = has_buf && Buffer.isBuffer(f) ? \"buffer\" : \"base64\";\n    switch (n = firstbyte(f, o)) {\n      case 0xD0:\n        return parse_xlscfb(CFB.read(f, o), o);\n      case 0x09:\n        return parse_xlscfb(s2a(o.type === 'base64' ? Base64.decode(f) : f), o);\n      case 0x3C:\n        return parse_xlml(f, o);\n      case 0xEF:\n        return parse_xlml(f, o);\n      default:\n        throw new Error(\"Unsupported file \" + n);\n    }\n  }\n  var readFile = function (f, o) {\n    var d = fs.readFileSync(f);\n    if (!o) o = {};\n    switch (firstbyte(d, {\n      type: 'buffer'\n    })) {\n      case 0xD0:\n        return parse_xlscfb(CFB.read(d, {\n          type: 'buffer'\n        }), o);\n      case 0x09:\n        return parse_xlscfb(d, o);\n      case 0x3C:\n        return parse_xlml(d, (o.type = \"buffer\", o));\n      case 0xEF:\n        return parse_xlml(d, (o.type = \"buffer\", o));\n      default:\n        throw \"Unsupported file\";\n    }\n  };\n  function writeSync(wb, opts) {\n    var o = opts || {};\n    switch (o.bookType) {\n      case 'xml':\n        return write_xlml(wb, o);\n      default:\n        throw 'unsupported output format ' + o.bookType;\n    }\n  }\n  function writeFileSync(wb, filename, opts) {\n    var o = opts | {};\n    o.type = 'file';\n    o.file = filename;\n    switch (o.file.substr(-4).toLowerCase()) {\n      case '.xls':\n        o.bookType = 'xls';\n        break;\n      case '.xml':\n        o.bookType = 'xml';\n        break;\n    }\n    return writeSync(wb, o);\n  }\n  function decode_row(rowstr) {\n    return parseInt(unfix_row(rowstr), 10) - 1;\n  }\n  function encode_row(row) {\n    return \"\" + (row + 1);\n  }\n  function fix_row(cstr) {\n    return cstr.replace(/([A-Z]|^)(\\d+)$/, \"$1$$$2\");\n  }\n  function unfix_row(cstr) {\n    return cstr.replace(/\\$(\\d+)$/, \"$1\");\n  }\n  function decode_col(colstr) {\n    var c = unfix_col(colstr),\n      d = 0,\n      i = 0;\n    for (; i !== c.length; ++i) d = 26 * d + c.charCodeAt(i) - 64;\n    return d - 1;\n  }\n  function encode_col(col) {\n    var s = \"\";\n    for (++col; col; col = Math.floor((col - 1) / 26)) s = String.fromCharCode((col - 1) % 26 + 65) + s;\n    return s;\n  }\n  function fix_col(cstr) {\n    return cstr.replace(/^([A-Z])/, \"$$$1\");\n  }\n  function unfix_col(cstr) {\n    return cstr.replace(/^\\$([A-Z])/, \"$1\");\n  }\n  function split_cell(cstr) {\n    return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/, \"$1,$2\").split(\",\");\n  }\n  function decode_cell(cstr) {\n    var splt = split_cell(cstr);\n    return {\n      c: decode_col(splt[0]),\n      r: decode_row(splt[1])\n    };\n  }\n  function encode_cell(cell) {\n    return encode_col(cell.c) + encode_row(cell.r);\n  }\n  function fix_cell(cstr) {\n    return fix_col(fix_row(cstr));\n  }\n  function unfix_cell(cstr) {\n    return unfix_col(unfix_row(cstr));\n  }\n  function decode_range(range) {\n    var x = range.split(\":\").map(decode_cell);\n    return {\n      s: x[0],\n      e: x[x.length - 1]\n    };\n  }\n  function encode_range(cs, ce) {\n    if (ce === undefined || typeof ce === 'number') return encode_range(cs.s, cs.e);\n    if (typeof cs !== 'string') cs = encode_cell(cs);\n    if (typeof ce !== 'string') ce = encode_cell(ce);\n    return cs == ce ? cs : cs + \":\" + ce;\n  }\n  function safe_decode_range(range) {\n    var o = {\n      s: {\n        c: 0,\n        r: 0\n      },\n      e: {\n        c: 0,\n        r: 0\n      }\n    };\n    var idx = 0,\n      i = 0,\n      cc = 0;\n    var len = range.length;\n    for (idx = 0; i < len; ++i) {\n      if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n      idx = 26 * idx + cc;\n    }\n    o.s.c = --idx;\n    for (idx = 0; i < len; ++i) {\n      if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n      idx = 10 * idx + cc;\n    }\n    o.s.r = --idx;\n    if (i === len || range.charCodeAt(++i) === 58) {\n      o.e.c = o.s.c;\n      o.e.r = o.s.r;\n      return o;\n    }\n    for (idx = 0; i != len; ++i) {\n      if ((cc = range.charCodeAt(i) - 64) < 1 || cc > 26) break;\n      idx = 26 * idx + cc;\n    }\n    o.e.c = --idx;\n    for (idx = 0; i != len; ++i) {\n      if ((cc = range.charCodeAt(i) - 48) < 0 || cc > 9) break;\n      idx = 10 * idx + cc;\n    }\n    o.e.r = --idx;\n    return o;\n  }\n  function safe_format_cell(cell, v) {\n    if (cell.z !== undefined) try {\n      return cell.w = SSF.format(cell.z, v);\n    } catch (e) {}\n    if (!cell.XF) return v;\n    try {\n      return cell.w = SSF.format(cell.XF.ifmt || 0, v);\n    } catch (e) {\n      return '' + v;\n    }\n  }\n  function format_cell(cell, v) {\n    if (cell == null || cell.t == null) return \"\";\n    if (cell.w !== undefined) return cell.w;\n    if (v === undefined) return safe_format_cell(cell, cell.v);\n    return safe_format_cell(cell, v);\n  }\n  function sheet_to_json(sheet, opts) {\n    var val,\n      row,\n      range,\n      header = 0,\n      offset = 1,\n      r,\n      hdr = [],\n      isempty,\n      R,\n      C,\n      v;\n    var o = opts != null ? opts : {};\n    var raw = o.raw;\n    if (sheet == null || sheet[\"!ref\"] == null) return [];\n    range = o.range !== undefined ? o.range : sheet[\"!ref\"];\n    if (o.header === 1) header = 1;else if (o.header === \"A\") header = 2;else if (Array.isArray(o.header)) header = 3;\n    switch (typeof range) {\n      case 'string':\n        r = safe_decode_range(range);\n        break;\n      case 'number':\n        r = safe_decode_range(sheet[\"!ref\"]);\n        r.s.r = range;\n        break;\n      default:\n        r = range;\n    }\n    if (header > 0) offset = 0;\n    var rr = encode_row(r.s.r);\n    var cols = new Array(r.e.c - r.s.c + 1);\n    var out = new Array(r.e.r - r.s.r - offset + 1);\n    var outi = 0;\n    for (C = r.s.c; C <= r.e.c; ++C) {\n      cols[C] = encode_col(C);\n      val = sheet[cols[C] + rr];\n      switch (header) {\n        case 1:\n          hdr[C] = C;\n          break;\n        case 2:\n          hdr[C] = cols[C];\n          break;\n        case 3:\n          hdr[C] = o.header[C - r.s.c];\n          break;\n        default:\n          if (val === undefined) continue;\n          hdr[C] = format_cell(val);\n      }\n    }\n    for (R = r.s.r + offset; R <= r.e.r; ++R) {\n      rr = encode_row(R);\n      isempty = true;\n      if (header === 1) row = [];else {\n        row = {};\n        if (Object.defineProperty) Object.defineProperty(row, '__rowNum__', {\n          value: R,\n          enumerable: false\n        });else row.__rowNum__ = R;\n      }\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        val = sheet[cols[C] + rr];\n        if (val === undefined || val.t === undefined) continue;\n        v = val.v;\n        switch (val.t) {\n          case 'e':\n            continue;\n          case 's':\n            break;\n          case 'b':\n          case 'n':\n            break;\n          default:\n            throw 'unrecognized type ' + val.t;\n        }\n        if (v !== undefined) {\n          row[hdr[C]] = raw ? v : format_cell(val, v);\n          isempty = false;\n        }\n      }\n      if (isempty === false || header === 1) out[outi++] = row;\n    }\n    out.length = outi;\n    return out;\n  }\n  function sheet_to_row_object_array(sheet, opts) {\n    return sheet_to_json(sheet, opts != null ? opts : {});\n  }\n  function sheet_to_csv(sheet, opts) {\n    var out = \"\",\n      txt = \"\",\n      qreg = /\"/g;\n    var o = opts == null ? {} : opts;\n    if (sheet == null || sheet[\"!ref\"] == null) return \"\";\n    var r = safe_decode_range(sheet[\"!ref\"]);\n    var FS = o.FS !== undefined ? o.FS : \",\",\n      fs = FS.charCodeAt(0);\n    var RS = o.RS !== undefined ? o.RS : \"\\n\",\n      rs = RS.charCodeAt(0);\n    var row = \"\",\n      rr = \"\",\n      cols = [];\n    var i = 0,\n      cc = 0,\n      val;\n    var R = 0,\n      C = 0;\n    for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n    for (R = r.s.r; R <= r.e.r; ++R) {\n      row = \"\";\n      rr = encode_row(R);\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        val = sheet[cols[C] + rr];\n        txt = val !== undefined ? '' + format_cell(val) : \"\";\n        for (i = 0, cc = 0; i !== txt.length; ++i) if ((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34) {\n          txt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\";\n          break;\n        }\n        row += (C === r.s.c ? \"\" : FS) + txt;\n      }\n      out += row + RS;\n    }\n    return out;\n  }\n  var make_csv = sheet_to_csv;\n  function sheet_to_formulae(sheet) {\n    var y = \"\",\n      x,\n      val = \"\";\n    if (sheet == null || sheet[\"!ref\"] == null) return [];\n    var r = safe_decode_range(sheet['!ref']),\n      rr = \"\",\n      cols = [],\n      C;\n    var cmds = new Array((r.e.r - r.s.r + 1) * (r.e.c - r.s.c + 1));\n    var i = 0;\n    for (C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n    for (var R = r.s.r; R <= r.e.r; ++R) {\n      rr = encode_row(R);\n      for (C = r.s.c; C <= r.e.c; ++C) {\n        y = cols[C] + rr;\n        x = sheet[y];\n        val = \"\";\n        if (x === undefined) continue;else if (x.F != null) {\n          y = x.F;\n          if (!x.f) continue;\n          val = x.f;\n          if (y.indexOf(\":\") == -1) y = y + \":\" + y;\n        }\n        if (x.f != null) val = x.f;else if (x.t == 'n' && x.v != null) val = \"\" + x.v;else if (x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";else if (x.w !== undefined) val = \"'\" + x.w;else if (x.v === undefined) continue;else if (x.t == 's') val = \"'\" + x.v;else val = \"\" + x.v;\n        cmds[i++] = y + \"=\" + val;\n      }\n    }\n    cmds.length = i;\n    return cmds;\n  }\n  var utils = {\n    encode_col: encode_col,\n    encode_row: encode_row,\n    encode_cell: encode_cell,\n    encode_range: encode_range,\n    decode_col: decode_col,\n    decode_row: decode_row,\n    split_cell: split_cell,\n    decode_cell: decode_cell,\n    decode_range: decode_range,\n    format_cell: format_cell,\n    get_formulae: sheet_to_formulae,\n    make_csv: sheet_to_csv,\n    make_json: sheet_to_json,\n    make_formulae: sheet_to_formulae,\n    sheet_to_csv: sheet_to_csv,\n    sheet_to_json: sheet_to_json,\n    sheet_to_formulae: sheet_to_formulae,\n    sheet_to_row_object_array: sheet_to_row_object_array\n  };\n  XLS.parse_xlscfb = parse_xlscfb;\n  XLS.read = xlsread;\n  XLS.readFile = readFile;\n  XLS.readSync = xlsread;\n  XLS.readFileSync = readFile;\n  XLS.utils = utils;\n  XLS.CFB = CFB;\n  XLS.SSF = SSF;\n})(typeof exports !== 'undefined' ? exports : XLS);","map":{"version":3,"names":["XLS","make_xls","version","current_codepage","current_cptable","module","require","cptable","reset_cp","set_cp","cp","char_codes","data","o","i","len","length","charCodeAt","debom","c1","c2","substr","_getchar","_gc1","x","String","fromCharCode","utils","decode","_gc2","Base64","make_b64","map","b64_decode","input","utf8","c3","e1","e2","e3","e4","replace","indexOf","charAt","has_buf","Buffer","new_raw_buf","Array","s2a","s","split","bconcat","bufs","concat","apply","chr0","chr1","read_double_le","b","idx","e","m","Infinity","NaN","Math","pow","__toBuffer","___toBuffer","toBuffer_","push","__utf16le","___utf16le","utf16le_","ss","__readUInt16LE","join","__hexlify","___hexlify","hexlify_","l","slice","toString","__utf8","___utf8","__readUInt8","__lpstr","___lpstr","lpstr_","__readUInt32LE","__lpwstr","___lpwstr","lpwstr_","__double","___double","utf16le_b","isBuffer","lpstr_b","readUInt32LE","lpwstr_b","utf8_b","double_","readDoubleLE","__readInt16LE","u","__readInt32LE","___unhexlify","match","parseInt","__unhexlify","ReadShift","size","t","oI","oR","oo","w","vv","loc","lens","call","CheckField","hexstr","fld","prep_blob","blob","pos","read_shift","chk","SSF","make_ssf","_strrev","fill","c","pad0","v","d","pad_","rpad_","pad0r1","round","pad0r2","p2_32","pad0r","isgeneral","opts_fmt","fixopts","y","undefined","opts","table_fmt","days","months","frac","D","mixed","sgn","B","P_2","P_1","P","Q_2","Q_1","Q","A","floor","q","general_fmt_int","_general_int","general_fmt_num","make_general_fmt_num","gnr1","gnr2","gnr4","gnr5","gnr6","gfn2","gfn5","toFixed","toPrecision","toExponential","gfn3","gfn4","V","log","abs","LOG10E","_general_num","general_fmt","Error","_general","fix_hijri","date","parse_date_code","b2","time","dow","dout","out","T","H","M","S","date1904","Date","setDate","getDate","getFullYear","getMonth","getDay","write_date","type","fmt","val","ss0","tt","outl","commaify","j","write_num","make_write_num","pct1","write_num_pct","sfmt","mul","write_num_cm","write_num_exp","period","ee","fakee","$$","$1","$2","$3","frac1","write_num_f1","r","aval","sign","den","rr","base","myn","myd","write_num_f2","dec1","closeparen","phone","hashq","str","cc","rnd","dd","dec","flr","write_num_flt","ffmt","ri","ff","oa","min","max","lres","rres","write_num_cm2","write_num_pct2","write_num_exp2","write_num_int","split_fmt","in_str","_split","abstime","eval_fmt","flen","lst","dt","hr","toLowerCase","bt","ssm","nstr","jj","myv","ostr","decpt","lasti","retval","_eval","cfregex","cfregex2","chkcond","thresh","parseFloat","choose_fmt","f","lat","m1","m2","format","table","_table","load","load_entry","get_table","load_table","tbl","parse_FILETIME","dwLowDateTime","dwHighDateTime","toISOString","parse_lpstr","pad","parse_lpwstr","parse_VtStringBase","stringType","parse_VtString","parse_VtUnalignedString","parse_VtVecUnalignedLpstrValue","ret","parse_VtVecUnalignedLpstr","parse_VtHeadingPair","headingString","parse_TypedPropertyValue","VT_USTR","headerParts","VT_I4","parse_VtVecHeadingPairValue","cElements","parse_VtVecHeadingPair","parse_dictionary","CodePage","cnt","dict","pid","parse_BLOB","bytes","parse_ClipboardData","Size","parse_VtVector","cb","_opts","VT_VARIANT","VT_CUSTOM","raw","parse_PropertySet","PIDSI","start_addr","NumProps","Props","Dictionary","DictObj","PropID","Offset","PropH","fail","piddsi","n","p","VT_I2","oldpos","name","parsebool","parse_PropertySetStream","file","content","NumSets","FMTID0","FMTID1","Offset0","Offset1","vers","SystemIdentifier","CFB","consts","HEADER_CLSID","PSet0","rval","FMTID","PSet1","DO_NOT_EXPORT_CFB","_CFB","exports","parse","mver","ssz","nmfs","ndfs","dir_start","minifat_start","difat_start","fat_addrs","mv","check_get_mver","header","check_shifts","nds","sectors","sectorify","sleuth_fat","sector_list","make_sector_list","ENDOFCHAIN","files","Paths","FileIndex","FullPaths","FullPathDir","read_directory","build_full_paths","root_name","shift","root","find_path","make_find_path","find","HEADER_SIGNATURE","nsectors","ceil","FI","FPD","FP","L","R","C","pl","dad","UCFullPaths","UCPaths","toUpperCase","path","k","UCPath","sector","get_sector_list","start","chkd","sl","buf","buf_chain","modulus","addr","nodes","minifat_store","namelen","ctime","mtime","color","clsid","state","ct","read_date","mt","storage","MSSZ","offset","fs","readFileSync","filename","options","readSync","MAXREGSECT","DIFSECT","FATSECT","FREESECT","HEADER_MINOR_VERSION","MAXREGSID","NOSTREAM","EntryTypes","read","dup","JSON","stringify","hasOwnProperty","parsenoop","parsenoop2","parslurp","arr","target","parslurp2","parseuint16","parseuint16a","parse_Boolean","parse_Bes","parse_ShortXLUnicodeString","cch","width","encoding","biff","fHighByte","parse_XLUnicodeRichExtendedString","flags","fExtSt","fRichSt","cRun","cbExtRst","z","msg","parse_XLUnicodeStringNoCch","parse_XLUnicodeString","parse_XLUnicodeString2","parse_Xnum","parse_ControlInfo","parse_URLMoniker","extra","url","parse_FileMoniker","cAnti","ansiLength","ansiPath","endServer","versionNumber","cbUnicodePathSize","cbUnicodePathBytes","usKeyValue","unicodePath","parse_HyperlinkMoniker","parse_HyperlinkString","parse_Hyperlink","end","sVer","displayName","targetFrameName","moniker","oleMoniker","location","guid","fileTime","Target","parse_LongRGBA","g","a","parse_LongRGB","shift_cell","cell","tgt","cRel","rRel","shift_range","range","encode_cell_xls","encode_cell","fix_col","fix_row","encode_range_xls","parse_RkNumber","fX100","fInt","RK","BErr","RBErr","evert","VT_EMPTY","VT_NULL","VT_R4","VT_R8","VT_CY","VT_DATE","VT_BSTR","VT_ERROR","VT_BOOL","VT_DECIMAL","VT_I1","VT_UI1","VT_UI2","VT_UI4","VT_I8","VT_UI8","VT_INT","VT_UINT","VT_LPSTR","VT_LPWSTR","VT_FILETIME","VT_BLOB","VT_STREAM","VT_STORAGE","VT_STREAMED_Object","VT_STORED_Object","VT_BLOB_Object","VT_CF","VT_CLSID","VT_VERSIONED_STREAM","VT_VECTOR","VT_ARRAY","VT_STRING","DocSummaryPIDDSI","SummaryPIDSI","SpecialProperties","FillPattern","rgbify","Icv","isval","keys","Object","obj","K","rgb2Hex","rgb","parse_Cell","rw","col","ixfe","parse_frtHeader","rt","parse_OptXLUnicodeString","HIDEOBJENUM","parse_HideObjEnum","parse_XTI","iSupBook","itabFirst","itabLast","parse_RkRec","parse_AddinUdf","udfName","parse_Ref8U","rwFirst","rwLast","colFirst","colLast","parse_RefU","parse_Ref","parse_FtCmo","ot","id","parse_FtNts","fSharedNote","parse_FtCf","cf","FtTab","parse_FtArray","fts","ft","parse_FontIndex","parse_BOF","BIFFVer","parse_InterfaceHdr","parse_WriteAccess","enc","UserName","parse_BoundSheet8","hidden","hs","parse_SST","ucnt","strs","Count","Unique","parse_ExtSST","extsst","dsst","parse_Row","Col","rht","parse_ForceFullCalculation","fullcalc","parse_CompressPictures","parse_RecalcId","parse_DefaultRowHeight","miyRw","fl","Unsynced","DyZero","ExAsc","ExDsc","parse_Window1","xWn","yWn","dxWn","dyWn","iTabCur","iTabFirst","ctabSel","wTabRatio","Pos","Dim","Flags","CurTab","FirstTab","Selected","TabRatio","parse_Font","parse_LabelSst","isst","parse_Label","parse_Format","ifmt","fmtstr","parse_BIFF2Format","parse_Dimensions","parse_RK","rkrec","rknum","parse_MulRk","rkrecs","lastcol","parse_CellStyleXF","style","patternType","icvFore","icvBack","parse_CellXF","parse_StyleXF","parse_XF","ifnt","fStyle","parse_Guts","parse_BoolErr","parse_Number","xnum","parse_XLHeaderFooter","parse_SupBook","ctab","virtPath","rgst","sbcch","parse_ExternName","body","fBuiltIn","fWantAdvise","fWantPict","fOle","fOleLink","fIcon","parse_Lbl","chKey","cce","itab","npflen","rgce","parse_NameParsedFormula","Name","parse_ExternSheet","snames","parse_ShrFmla","ref","cUse","parse_SharedParsedFormula","parse_Array","parse_ArrayParsedFormula","parse_MTRSettings","fMTREnabled","fUserSetThreadCount","cUserThreadCount","parse_NoteSh","row","idObj","stAuthor","parse_Note","parse_MergeCells","merges","cmcs","parse_Obj","cmo","parse_TxO","texts","lastobj","controlInfo","cchText","cbRuns","ifntEmpty","hdr","parse_HLink","hlink","parse_HLinkTooltip","wzTooltip","parse_Country","CountryEnum","parse_ClrtClient","ccv","parse_Palette","parse_XFCRC","cxfs","crc","parse_Style","parse_StyleExt","parse_ColInfo","parse_Window2","parse_Backup","parse_Blank","parse_BottomMargin","parse_BuiltInFnGroupCount","parse_CalcCount","parse_CalcDelta","parse_CalcIter","parse_CalcMode","parse_CalcPrecision","parse_CalcRefMode","parse_CalcSaveRecalc","parse_CodePage","parse_Compat12","parse_Date1904","parse_DefColWidth","parse_DSF","parse_EntExU2","parse_EOF","parse_Excel9File","parse_FeatHdr","parse_FontX","parse_Footer","parse_GridSet","parse_HCenter","parse_Header","parse_HideObj","parse_InterfaceEnd","parse_LeftMargin","parse_Mms","parse_ObjProtect","parse_Password","parse_PrintGrid","parse_PrintRowCol","parse_PrintSize","parse_Prot4Rev","parse_Prot4RevPass","parse_Protect","parse_RefreshAll","parse_RightMargin","parse_RRTabId","parse_ScenarioProtect","parse_Scl","parse_String","parse_SxBool","parse_TopMargin","parse_UsesELFs","parse_VCenter","parse_WinProtect","parse_WriteProtect","parse_VerticalPageBreaks","parse_HorizontalPageBreaks","parse_Selection","parse_Continue","parse_Pane","parse_Pls","parse_DCon","parse_DConRef","parse_DConName","parse_XCT","parse_CRN","parse_FileSharing","parse_Uncalced","parse_Template","parse_Intl","parse_WsBool","parse_Sort","parse_Sync","parse_LPr","parse_DxGCol","parse_FnGroupName","parse_FilterMode","parse_AutoFilterInfo","parse_AutoFilter","parse_Setup","parse_ScenMan","parse_SCENARIO","parse_SxView","parse_Sxvd","parse_SXVI","parse_SxIvd","parse_SXLI","parse_SXPI","parse_DocRoute","parse_RecipName","parse_MulBlank","parse_SXDI","parse_SXDB","parse_SXFDB","parse_SXDBB","parse_SXNum","parse_SxErr","parse_SXInt","parse_SXString","parse_SXDtr","parse_SxNil","parse_SXTbl","parse_SXTBRGIITM","parse_SxTbpg","parse_ObProj","parse_SXStreamID","parse_DBCell","parse_SXRng","parse_SxIsxoper","parse_BookBool","parse_DbOrParamQry","parse_OleObjectSize","parse_SXVS","parse_BkHim","parse_MsoDrawingGroup","parse_MsoDrawing","parse_MsoDrawingSelection","parse_PhoneticInfo","parse_SxRule","parse_SXEx","parse_SxFilt","parse_SxDXF","parse_SxItm","parse_SxName","parse_SxSelect","parse_SXPair","parse_SxFmla","parse_SxFormat","parse_SXVDEx","parse_SXFormula","parse_SXDBEx","parse_RRDInsDel","parse_RRDHead","parse_RRDChgCell","parse_RRDRenSheet","parse_RRSort","parse_RRDMove","parse_RRFormat","parse_RRAutoFmt","parse_RRInsertSh","parse_RRDMoveBegin","parse_RRDMoveEnd","parse_RRDInsDelBegin","parse_RRDInsDelEnd","parse_RRDConflict","parse_RRDDefName","parse_RRDRstEtxp","parse_LRng","parse_CUsr","parse_CbUsr","parse_UsrInfo","parse_UsrExcl","parse_FileLock","parse_RRDInfo","parse_BCUsrs","parse_UsrChk","parse_UserBView","parse_UserSViewBegin","parse_UserSViewEnd","parse_RRDUserView","parse_Qsi","parse_CondFmt","parse_CF","parse_DVal","parse_DConBin","parse_Lel","parse_CodeName","parse_SXFDBType","parse_ObNoMacros","parse_Dv","parse_Index","parse_Table","parse_BigName","parse_ContinueBigName","parse_WebPub","parse_QsiSXTag","parse_DBQueryExt","parse_ExtString","parse_TxtQry","parse_Qsir","parse_Qsif","parse_RRDTQSIF","parse_OleDbConn","parse_WOpt","parse_SXViewEx","parse_SXTH","parse_SXPIEx","parse_SXVDTEx","parse_SXViewEx9","parse_ContinueFrt","parse_RealTimeData","parse_ChartFrtInfo","parse_FrtWrapper","parse_StartBlock","parse_EndBlock","parse_StartObject","parse_EndObject","parse_CatLab","parse_YMult","parse_SXViewLink","parse_PivotChartBits","parse_FrtFontList","parse_SheetExt","parse_BookExt","parse_SXAddl","parse_CrErr","parse_HFPicture","parse_Feat","parse_DataLabExt","parse_DataLabExtContents","parse_CellWatch","parse_FeatHdr11","parse_Feature11","parse_DropDownObjIds","parse_ContinueFrt11","parse_DConn","parse_List12","parse_Feature12","parse_CondFmt12","parse_CF12","parse_CFEx","parse_AutoFilter12","parse_ContinueFrt12","parse_MDTInfo","parse_MDXStr","parse_MDXTuple","parse_MDXSet","parse_MDXProp","parse_MDXKPI","parse_MDB","parse_PLV","parse_DXF","parse_TableStyles","parse_TableStyle","parse_TableStyleElement","parse_NamePublish","parse_NameCmt","parse_SortData","parse_GUIDTypeLib","parse_FnGrp12","parse_NameFnGrp12","parse_HeaderFooter","parse_CrtLayout12","parse_CrtMlFrt","parse_CrtMlFrtContinue","parse_ShapePropsStream","parse_TextPropsStream","parse_RichTextStream","parse_CrtLayout12A","parse_Units","parse_Chart","parse_Series","parse_DataFormat","parse_LineFormat","parse_MarkerFormat","parse_AreaFormat","parse_PieFormat","parse_AttachedLabel","parse_SeriesText","parse_ChartFormat","parse_Legend","parse_SeriesList","parse_Bar","parse_Line","parse_Pie","parse_Area","parse_Scatter","parse_CrtLine","parse_Axis","parse_Tick","parse_ValueRange","parse_CatSerRange","parse_AxisLine","parse_CrtLink","parse_DefaultText","parse_Text","parse_ObjectLink","parse_Frame","parse_Begin","parse_End","parse_PlotArea","parse_Chart3d","parse_PicF","parse_DropBar","parse_Radar","parse_Surf","parse_RadarArea","parse_AxisParent","parse_LegendException","parse_ShtProps","parse_SerToCrt","parse_AxesUsed","parse_SBaseRef","parse_SerParent","parse_SerAuxTrend","parse_IFmtRecord","parse_Pos","parse_AlRuns","parse_BRAI","parse_SerAuxErrBar","parse_SerFmt","parse_Chart3DBarShape","parse_Fbi","parse_BopPop","parse_AxcExt","parse_Dat","parse_PlotGrowth","parse_SIIndex","parse_GelFrame","parse_BopPopCustom","parse_Fbi2","parse_BIFF5String","parse_BIFF2STR","parse_BIFF2NUM","num","parse_BIFF2INT","parse_BIFF2STRING","parse_BIFF2FONTXTRA","parse_RString","_chr","attregexg","attregex","parsexmltag","tag","skip_root","words","parsexmltagobj","encodings","rencoding","rencstr","XML_HEADER","OFFCRYPTO","make_offcrypto","O","_crypto","crypto","rc4","key","md5","hex","createHash","update","digest","_JS2ANSI","encode","parse_Version","Major","Minor","parse_EncryptionHeader","tmp","AlgID","parse_EncryptionVerifier","parse_RC4CryptoHeader","EncryptionVersionInfo","sz","EncryptionHeader","EncryptionVerifier","parse_RC4Header","Salt","EncryptedVerifier","EncryptedVerifierHash","crypto_CreatePasswordVerifier_Method1","Password","Verifier","PasswordArray","PasswordDecoded","PasswordByte","Intermediate1","Intermediate2","Intermediate3","crypto_CreateXorArray_Method1","PadArray","InitialCode","XorMatrix","Ror","Byte","XorRor","byte1","byte2","CreateXorKey_Method1","XorKey","CurrentElement","Char","password","Index","ObfuscationArray","Temp","PasswordLastChar","PadIndex","crypto_DecryptData_Method1","Data","XorArrayIndex","XorArray","Value","crypto_MakeXorDecryptor","parse_XORObfuscation","verificationBytes","verifier","valid","insitu_decrypt","parse_FilePassHeader","Info","parse_FilePass","Type","parseread","parseread1","parse_ColRelU","parse_RgceArea","parse_RgceArea_BIFF2","parse_RgceAreaRel","parse_RgceLoc","parse_RgceLoc_BIFF2","parse_RgceLocRel","parse_RgceLocRel_BIFF2","cl","rl","parse_PtgArea","area","parse_PtgArea3d","ixti","parse_PtgAreaErr","parse_PtgAreaErr3d","parse_PtgAreaN","parse_PtgArray","parse_PtgAttrBaxcel","bitSemi","bitBaxcel","parse_PtgAttrChoose","parse_PtgAttrGoto","bitGoto","parse_PtgAttrIf","bitIf","parse_PtgAttrSemi","parse_PtgAttrSpaceType","parse_PtgAttrSpace","parse_PtgAttrSpaceSemi","parse_PtgRef","ptg","parse_PtgRefN","parse_PtgRef3d","parse_PtgFunc","iftab","FtabArgc","Ftab","parse_PtgFuncVar","cparams","tab","parsetab","Cetab","parse_PtgAttrSum","parse_PtgConcat","parse_PtgExp","parse_PtgErr","parse_PtgInt","parse_PtgBool","parse_PtgNum","parse_PtgStr","parse_SerAr","parse_PtgExtraMem","count","parse_PtgExtraArray","cols","rows","parse_PtgName","nameindex","parse_PtgNameX","parse_PtgNameX_BIFF5","parse_PtgMemArea","parse_PtgMemFunc","parse_PtgRefErr","parse_PtgAdd","parse_PtgDiv","parse_PtgEq","parse_PtgGe","parse_PtgGt","parse_PtgIsect","parse_PtgLe","parse_PtgLt","parse_PtgMissArg","parse_PtgMul","parse_PtgNe","parse_PtgParen","parse_PtgPercent","parse_PtgPower","parse_PtgRange","parse_PtgSub","parse_PtgUminus","parse_PtgUnion","parse_PtgUplus","parse_PtgMemErr","parse_PtgMemNoMem","parse_PtgRefErr3d","parse_PtgTbl","PtgTypes","PtgDupes","Ptg18","Ptg19","rc_to_a1","rcregex","rcbase","rcfunc","$4","$5","encode_col","encode_row","fstr","parse_Formula","parse_FormulaValue","chn","cbf","parse_CellParsedFormula","formula","shared","parse_RgbExtra","parse_Rgce","rgcb","ptgs","stringify_array","PtgBinOp","PtgAdd","PtgConcat","PtgDiv","PtgEq","PtgGe","PtgGt","PtgLe","PtgLt","PtgMul","PtgNe","PtgPower","PtgSub","stringify_formula","supbooks","_range","stack","nameidx","sname","last_sp","sp","fflen","pop","WTF","argc","func","args","encode_range","lbl","XLSXFutureFunctions","bookidx","externbook","lp","rp","sharedf","parsedf","fnd","arrayf","PtgNonDisp","PtgDataType","parse_Theme","dwThemeVersion","parse_ColorTheme","parse_FullColorExt","xclrType","nTintShade","xclrValue","parse_IcvXF","parse_XFExtGradient","parse_ExtProp","extType","parse_XFExt","cexts","ext","update_xfext","xf","xfext","forEach","xfe","RecordEnum","fix_opts_func","defaults","fix_opts","Number","fix_read_opts","parse_compobj","UserType","Reserved1","slurp","next","ll","safe_format_xf","XF","fmtid","cellNF","make_cell","parse_workbook","wb","Sheets","Directory","found_sheet","last_formula","sst","cur_sheet","Preamble","lastcell","last_cell","cmnt","rng","rngC","rngR","shared_formulae","array_formulae","temp_val","country","cell_valid","XFs","palette","get_rgb","getrgb","icv","process_cell_style","pcs","line","xfd","fgColor","bgColor","addcell","cellStyles","sheetRows","rrtabid","lastuser","codepage","winlocked","wtf","mergecells","objects","sbc","sbci","sbcli","SheetNames","last_Rn","file_depth","BIFF2Fmt","RecordType","bookSheets","Rn","Date1904","WriteProtect","console","error","RefreshAll","CalcCount","CalcDelta","CalcIter","CalcMode","CalcPrecision","CalcSaveRecalc","CalcRefMode","FullCalc","fakebs8","cellFormula","_f","_fr","_fc","_fe","F","TxO","tooltip","noteobj","sheetnamesraw","sort","sheetnames","Strings","Encryption","Metadata","Country","parse_xlscfb","cfb","CompObj","Summary","Workbook","CompObjP","SummaryP","WorkbookP","bookProps","parse_props","props","DocSummary","Custprops","bookFiles","DSI","SI","encregex","coderegex","coderepl","encrepl","unescapexml","parsexmlbool","value","matchtag","RegExp","entregex","entrepl","fixstr","XLMLFormatMap","PatternTypeMap","xlml_set_prop","xlml_format","xlml_set_custprop","safe_format_xlml","nf","process_style_xlml","styles","stag","Interior","I","Pattern","ID","parse_xlml_data","xml","csty","sid","StyleID","interiors","Parent","UTC","Formula","ArrayRange","safe_decode_range","xlml_clean_comment","comment","xlml_normalize","xlmlregex","parse_xlml_xml","sheets","cursheet","sheetname","dtag","didx","refguess","fidx","pidx","comments","cstys","lastIndex","exec","index","HRef","HRefScreenTip","MergeAcross","MergeDown","Format","Span","Author","seen","parse_xlml","write_xlml","firstbyte","xlsread","readFile","writeSync","bookType","writeFileSync","decode_row","rowstr","unfix_row","cstr","decode_col","colstr","unfix_col","split_cell","decode_cell","splt","fix_cell","unfix_cell","decode_range","cs","ce","safe_format_cell","format_cell","sheet_to_json","sheet","isempty","isArray","outi","defineProperty","enumerable","__rowNum__","sheet_to_row_object_array","sheet_to_csv","txt","qreg","FS","RS","rs","make_csv","sheet_to_formulae","cmds","get_formulae","make_json","make_formulae"],"sources":["C:/Users/malvi/Angular/template/node_modules/xlsjs/xls.js"],"sourcesContent":["/* xls.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint -W041 */\n/*jshint funcscope:true, eqnull:true */\nvar XLS = {};\n(function make_xls(XLS){\nXLS.version = '0.7.6';\nvar current_codepage = 1200, current_cptable;\nif(typeof module !== \"undefined\" && typeof require !== 'undefined') {\n\tif(typeof cptable === 'undefined') cptable = require('./dist/cpexcel');\n\tcurrent_cptable = cptable[current_codepage];\n}\nfunction reset_cp() { set_cp(1200); }\nvar set_cp = function(cp) { current_codepage = cp; };\n\nfunction char_codes(data) { var o = []; for(var i = 0, len = data.length; i < len; ++i) o[i] = data.charCodeAt(i); return o; }\nvar debom = function(data) {\n\tvar c1 = data.charCodeAt(0), c2 = data.charCodeAt(1);\n\tif(c1 == 0xFF && c2 == 0xFE) return data.substr(2);\n\tif(c1 == 0xFE && c2 == 0xFF) return data.substr(2);\n\tif(c1 == 0xFEFF) return data.substr(1);\n\treturn data;\n};\n\nvar _getchar = function _gc1(x) { return String.fromCharCode(x); };\nif(typeof cptable !== 'undefined') {\n\tset_cp = function(cp) { current_codepage = cp; current_cptable = cptable[cp]; };\n\tdebom = function(data) {\n\t\tif(data.charCodeAt(0) === 0xFF && data.charCodeAt(1) === 0xFE) { return cptable.utils.decode(1200, char_codes(data.substr(2))); }\n\t\treturn data;\n\t};\n\t_getchar = function _gc2(x) {\n\t\tif(current_codepage === 1200) return String.fromCharCode(x);\n\t\treturn cptable.utils.decode(current_codepage, [x&255,x>>8])[0];\n\t};\n}\nvar Base64 = (function make_b64(){\n\tvar map = \"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=\";\n\treturn {\n\t\t/* (will need this for writing) encode: function(input, utf8) {\n\t\t\tvar o = \"\";\n\t\t\tvar c1, c2, c3, e1, e2, e3, e4;\n\t\t\tfor(var i = 0; i < input.length; ) {\n\t\t\t\tc1 = input.charCodeAt(i++);\n\t\t\t\tc2 = input.charCodeAt(i++);\n\t\t\t\tc3 = input.charCodeAt(i++);\n\t\t\t\te1 = c1 >> 2;\n\t\t\t\te2 = (c1 & 3) << 4 | c2 >> 4;\n\t\t\t\te3 = (c2 & 15) << 2 | c3 >> 6;\n\t\t\t\te4 = c3 & 63;\n\t\t\t\tif (isNaN(c2)) { e3 = e4 = 64; }\n\t\t\t\telse if (isNaN(c3)) { e4 = 64; }\n\t\t\t\to += map.charAt(e1) + map.charAt(e2) + map.charAt(e3) + map.charAt(e4);\n\t\t\t}\n\t\t\treturn o;\n\t\t},*/\n\t\tdecode: function b64_decode(input, utf8) {\n\t\t\tvar o = \"\";\n\t\t\tvar c1, c2, c3;\n\t\t\tvar e1, e2, e3, e4;\n\t\t\tinput = input.replace(/[^A-Za-z0-9\\+\\/\\=]/g, \"\");\n\t\t\tfor(var i = 0; i < input.length;) {\n\t\t\t\te1 = map.indexOf(input.charAt(i++));\n\t\t\t\te2 = map.indexOf(input.charAt(i++));\n\t\t\t\te3 = map.indexOf(input.charAt(i++));\n\t\t\t\te4 = map.indexOf(input.charAt(i++));\n\t\t\t\tc1 = e1 << 2 | e2 >> 4;\n\t\t\t\tc2 = (e2 & 15) << 4 | e3 >> 2;\n\t\t\t\tc3 = (e3 & 3) << 6 | e4;\n\t\t\t\to += String.fromCharCode(c1);\n\t\t\t\tif (e3 != 64) { o += String.fromCharCode(c2); }\n\t\t\t\tif (e4 != 64) { o += String.fromCharCode(c3); }\n\t\t\t}\n\t\t\treturn o;\n\t\t}\n\t};\n})();\nvar has_buf = (typeof Buffer !== 'undefined');\n\nfunction new_raw_buf(len) {\n\t/* jshint -W056 */\n\treturn new (has_buf ? Buffer : Array)(len);\n\t/* jshint +W056 */\n}\n\nfunction s2a(s) {\n\tif(has_buf) return new Buffer(s, \"binary\");\n\treturn s.split(\"\").map(function(x){ return x.charCodeAt(0) & 0xff; });\n}\n\nvar bconcat = function(bufs) { return [].concat.apply([], bufs); };\n\nvar chr0 = /\\u0000/g, chr1 = /[\\u0001-\\u0006]/;\nfunction read_double_le(b, idx) {\n\tvar s = 1 - 2 * (b[idx + 7] >>> 7);\n\tvar e = ((b[idx + 7] & 0x7f) << 4) + ((b[idx + 6] >>> 4) & 0x0f);\n\tvar m = (b[idx+6]&0x0f);\n\tfor(var i = 5; i >= 0; --i) m = m * 256 + b[idx + i];\n\tif(e == 0x7ff) return m == 0 ? s * Infinity : NaN;\n\tif(e == 0) e = -1022;\n\telse { e -= 1023; m += Math.pow(2,52); }\n\treturn s * Math.pow(2, e - 52) * m;\n}\n\nvar __toBuffer, ___toBuffer;\n__toBuffer = ___toBuffer = function toBuffer_(bufs) { var x = []; for(var i = 0; i < bufs[0].length; ++i) { x.push.apply(x, bufs[0][i]); } return x; };\nvar __utf16le, ___utf16le;\n__utf16le = ___utf16le = function utf16le_(b,s,e) { var ss=[]; for(var i=s; i<e; i+=2) ss.push(String.fromCharCode(__readUInt16LE(b,i))); return ss.join(\"\"); };\nvar __hexlify, ___hexlify;\n__hexlify = ___hexlify = function hexlify_(b,s,l) { return b.slice(s,(s+l)).map(function(x){return (x<16?\"0\":\"\") + x.toString(16);}).join(\"\"); };\nvar __utf8, ___utf8;\n__utf8 = ___utf8 = function(b,s,e) { var ss=[]; for(var i=s; i<e; i++) ss.push(String.fromCharCode(__readUInt8(b,i))); return ss.join(\"\"); };\nvar __lpstr, ___lpstr;\n__lpstr = ___lpstr = function lpstr_(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __lpwstr, ___lpwstr;\n__lpwstr = ___lpwstr = function lpwstr_(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? __utf8(b, i+4,i+4+len-1) : \"\";};\nvar __double, ___double;\n__double = ___double = function(b, idx) { return read_double_le(b, idx);};\n\n\nif(typeof Buffer !== \"undefined\") {\n\t__utf16le = function utf16le_b(b,s,e) { if(!Buffer.isBuffer(b)) return ___utf16le(b,s,e); return b.toString('utf16le',s,e); };\n\t__hexlify = function(b,s,l) { return Buffer.isBuffer(b) ? b.toString('hex',s,s+l) : ___hexlify(b,s,l); };\n\t__lpstr = function lpstr_b(b,i) { if(!Buffer.isBuffer(b)) return ___lpstr(b, i); var len = b.readUInt32LE(i); return len > 0 ? b.toString('utf8',i+4,i+4+len-1) : \"\";};\n\t__lpwstr = function lpwstr_b(b,i) { if(!Buffer.isBuffer(b)) return ___lpwstr(b, i); var len = 2*b.readUInt32LE(i); return b.toString('utf16le',i+4,i+4+len-1);};\n\t__utf8 = function utf8_b(b, s,e) { return b.toString('utf8',s,e); };\n\t__toBuffer = function(bufs) { return (bufs[0].length > 0 && Buffer.isBuffer(bufs[0][0])) ? Buffer.concat(bufs[0]) : ___toBuffer(bufs);};\n\tbconcat = function(bufs) { return Buffer.isBuffer(bufs[0]) ? Buffer.concat(bufs) : [].concat.apply([], bufs); };\n\t__double = function double_(b,i) { if(Buffer.isBuffer(b)) return b.readDoubleLE(i); return ___double(b,i); };\n}\n\nif(typeof cptable !== 'undefined') {\n\t__utf16le = function(b,s,e) { return cptable.utils.decode(1200, b.slice(s,e)); };\n\t__utf8 = function(b,s,e) { return cptable.utils.decode(65001, b.slice(s,e)); };\n\t__lpstr = function(b,i) { var len = __readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(current_codepage, b.slice(i+4, i+4+len-1)) : \"\";};\n\t__lpwstr = function(b,i) { var len = 2*__readUInt32LE(b,i); return len > 0 ? cptable.utils.decode(1200, b.slice(i+4,i+4+len-1)) : \"\";};\n}\n\nvar __readUInt8 = function(b, idx) { return b[idx]; };\nvar __readUInt16LE = function(b, idx) { return b[idx+1]*(1<<8)+b[idx]; };\nvar __readInt16LE = function(b, idx) { var u = b[idx+1]*(1<<8)+b[idx]; return (u < 0x8000) ? u : (0xffff - u + 1) * -1; };\nvar __readUInt32LE = function(b, idx) { return b[idx+3]*(1<<24)+(b[idx+2]<<16)+(b[idx+1]<<8)+b[idx]; };\nvar __readInt32LE = function(b, idx) { return (b[idx+3]<<24)|(b[idx+2]<<16)|(b[idx+1]<<8)|b[idx]; };\n\nvar ___unhexlify = function(s) { return s.match(/../g).map(function(x) { return parseInt(x,16);}); };\nvar __unhexlify = typeof Buffer !== \"undefined\" ? function(s) { return Buffer.isBuffer(s) ? new Buffer(s, 'hex') : ___unhexlify(s); } : ___unhexlify;\n\nfunction ReadShift(size, t) {\n\tvar o=\"\", oI, oR, oo=[], w, vv, i, loc;\n\tswitch(t) {\n\t\tcase 'utf8': o = __utf8(this, this.l, this.l + size); break;\n\t\tcase 'utf16le': size *= 2; o = __utf16le(this, this.l, this.l + size); break;\n\n\t\t/* [MS-OLEDS] 2.1.4 LengthPrefixedAnsiString */\n\t\tcase 'lpstr': o = __lpstr(this, this.l); size = 5 + o.length; break;\n\t\t/* [MS-OLEDS] 2.1.5 LengthPrefixedUnicodeString */\n\t\tcase 'lpwstr': o = __lpwstr(this, this.l); size = 5 + o.length; if(o[o.length-1] == '\\u0000') size += 2; break;\n\n\t\tcase 'cstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt8(this, this.l + size++))!==0) oo.push(_getchar(w));\n\t\t\to = oo.join(\"\"); break;\n\t\tcase 'wstr': size = 0; o = \"\";\n\t\t\twhile((w=__readUInt16LE(this,this.l +size))!==0){oo.push(_getchar(w));size+=2;}\n\t\t\tsize+=2; o = oo.join(\"\"); break;\n\n\t\t/* sbcs and dbcs support continue records in the SST way TODO codepages */\n\t\tcase 'dbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i != size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt16LE(this, loc)));\n\t\t\t\tloc+=2;\n\t\t\t} o = oo.join(\"\"); size *= 2; break;\n\n\t\tcase 'sbcs-cont': o = \"\"; loc = this.l;\n\t\t\tfor(i = 0; i != size; ++i) {\n\t\t\t\tif(this.lens && this.lens.indexOf(loc) !== -1) {\n\t\t\t\t\tw = __readUInt8(this, loc);\n\t\t\t\t\tthis.l = loc + 1;\n\t\t\t\t\tvv = ReadShift.call(this, size-i, w ? 'dbcs-cont' : 'sbcs-cont');\n\t\t\t\t\treturn oo.join(\"\") + vv;\n\t\t\t\t}\n\t\t\t\too.push(_getchar(__readUInt8(this, loc)));\n\t\t\t\tloc+=1;\n\t\t\t} o = oo.join(\"\"); break;\n\n\t\tdefault:\n\tswitch(size) {\n\t\tcase 1: oI = __readUInt8(this, this.l); this.l++; return oI;\n\t\tcase 2: oI = (t === 'i' ? __readInt16LE : __readUInt16LE)(this, this.l); this.l += 2; return oI;\n\t\tcase 4:\n\t\t\tif(t === 'i' || (this[this.l+3] & 0x80)===0) { oI = __readInt32LE(this, this.l); this.l += 4; return oI; }\n\t\t\telse { oR = __readUInt32LE(this, this.l); this.l += 4; return oR; } break;\n\t\tcase 8: if(t === 'f') { oR = __double(this, this.l); this.l += 8; return oR; }\n\t\t/* falls through */\n\t\tcase 16: o = __hexlify(this, this.l, size); break;\n\t}}\n\tthis.l+=size; return o;\n}\n\nfunction CheckField(hexstr, fld) {\n\tvar m = __hexlify(this,this.l,hexstr.length>>1);\n\tif(m !== hexstr) throw fld + 'Expected ' + hexstr + ' saw ' + m;\n\tthis.l += hexstr.length>>1;\n}\n\nfunction prep_blob(blob, pos) {\n\tblob.l = pos;\n\tblob.read_shift = ReadShift;\n\tblob.chk = CheckField;\n}\n\n/* ssf.js (C) 2013-2014 SheetJS -- http://sheetjs.com */\nvar SSF = {};\nvar make_ssf = function make_ssf(SSF){\nSSF.version = '0.8.1';\nfunction _strrev(x) { var o = \"\", i = x.length-1; while(i>=0) o += x.charAt(i--); return o; }\nfunction fill(c,l) { var o = \"\"; while(o.length < l) o+=c; return o; }\nfunction pad0(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad_(v,d){var t=\"\"+v;return t.length>=d?t:fill(' ',d-t.length)+t;}\nfunction rpad_(v,d){var t=\"\"+v; return t.length>=d?t:t+fill(' ',d-t.length);}\nfunction pad0r1(v,d){var t=\"\"+Math.round(v); return t.length>=d?t:fill('0',d-t.length)+t;}\nfunction pad0r2(v,d){var t=\"\"+v; return t.length>=d?t:fill('0',d-t.length)+t;}\nvar p2_32 = Math.pow(2,32);\nfunction pad0r(v,d){if(v>p2_32||v<-p2_32) return pad0r1(v,d); var i = Math.round(v); return pad0r2(i,d); }\nfunction isgeneral(s, i) { return s.length >= 7 + i && (s.charCodeAt(i)|32) === 103 && (s.charCodeAt(i+1)|32) === 101 && (s.charCodeAt(i+2)|32) === 110 && (s.charCodeAt(i+3)|32) === 101 && (s.charCodeAt(i+4)|32) === 114 && (s.charCodeAt(i+5)|32) === 97 && (s.charCodeAt(i+6)|32) === 108; }\n/* Options */\nvar opts_fmt = [\n\t[\"date1904\", 0],\n\t[\"output\", \"\"],\n\t[\"WTF\", false]\n];\nfunction fixopts(o){\n\tfor(var y = 0; y != opts_fmt.length; ++y) if(o[opts_fmt[y][0]]===undefined) o[opts_fmt[y][0]]=opts_fmt[y][1];\n}\nSSF.opts = opts_fmt;\nvar table_fmt = {\n\t0:  'General',\n\t1:  '0',\n\t2:  '0.00',\n\t3:  '#,##0',\n\t4:  '#,##0.00',\n\t9:  '0%',\n\t10: '0.00%',\n\t11: '0.00E+00',\n\t12: '# ?/?',\n\t13: '# ??/??',\n\t14: 'm/d/yy',\n\t15: 'd-mmm-yy',\n\t16: 'd-mmm',\n\t17: 'mmm-yy',\n\t18: 'h:mm AM/PM',\n\t19: 'h:mm:ss AM/PM',\n\t20: 'h:mm',\n\t21: 'h:mm:ss',\n\t22: 'm/d/yy h:mm',\n\t37: '#,##0 ;(#,##0)',\n\t38: '#,##0 ;[Red](#,##0)',\n\t39: '#,##0.00;(#,##0.00)',\n\t40: '#,##0.00;[Red](#,##0.00)',\n\t45: 'mm:ss',\n\t46: '[h]:mm:ss',\n\t47: 'mmss.0',\n\t48: '##0.0E+0',\n\t49: '@',\n\t56: '\"上午/下午 \"hh\"時\"mm\"分\"ss\"秒 \"',\n\t65535: 'General'\n};\nvar days = [\n\t['Sun', 'Sunday'],\n\t['Mon', 'Monday'],\n\t['Tue', 'Tuesday'],\n\t['Wed', 'Wednesday'],\n\t['Thu', 'Thursday'],\n\t['Fri', 'Friday'],\n\t['Sat', 'Saturday']\n];\nvar months = [\n\t['J', 'Jan', 'January'],\n\t['F', 'Feb', 'February'],\n\t['M', 'Mar', 'March'],\n\t['A', 'Apr', 'April'],\n\t['M', 'May', 'May'],\n\t['J', 'Jun', 'June'],\n\t['J', 'Jul', 'July'],\n\t['A', 'Aug', 'August'],\n\t['S', 'Sep', 'September'],\n\t['O', 'Oct', 'October'],\n\t['N', 'Nov', 'November'],\n\t['D', 'Dec', 'December']\n];\nfunction frac(x, D, mixed) {\n\tvar sgn = x < 0 ? -1 : 1;\n\tvar B = x * sgn;\n\tvar P_2 = 0, P_1 = 1, P = 0;\n\tvar Q_2 = 1, Q_1 = 0, Q = 0;\n\tvar A = Math.floor(B);\n\twhile(Q_1 < D) {\n\t\tA = Math.floor(B);\n\t\tP = A * P_1 + P_2;\n\t\tQ = A * Q_1 + Q_2;\n\t\tif((B - A) < 0.0000000005) break;\n\t\tB = 1 / (B - A);\n\t\tP_2 = P_1; P_1 = P;\n\t\tQ_2 = Q_1; Q_1 = Q;\n\t}\n\tif(Q > D) { Q = Q_1; P = P_1; }\n\tif(Q > D) { Q = Q_2; P = P_2; }\n\tif(!mixed) return [0, sgn * P, Q];\n\tif(Q===0) throw \"Unexpected state: \"+P+\" \"+P_1+\" \"+P_2+\" \"+Q+\" \"+Q_1+\" \"+Q_2;\n\tvar q = Math.floor(sgn * P/Q);\n\treturn [q, sgn*P - q*Q, Q];\n}\nfunction general_fmt_int(v, opts) { return \"\"+v; }\nSSF._general_int = general_fmt_int;\nvar general_fmt_num = (function make_general_fmt_num() {\nvar gnr1 = /\\.(\\d*[1-9])0+$/, gnr2 = /\\.0*$/, gnr4 = /\\.(\\d*[1-9])0+/, gnr5 = /\\.0*[Ee]/, gnr6 = /(E[+-])(\\d)$/;\nfunction gfn2(v) {\n\tvar w = (v<0?12:11);\n\tvar o = gfn5(v.toFixed(12)); if(o.length <= w) return o;\n\to = v.toPrecision(10); if(o.length <= w) return o;\n\treturn v.toExponential(5);\n}\nfunction gfn3(v) {\n\tvar o = v.toFixed(11).replace(gnr1,\".$1\");\n\tif(o.length > (v<0?12:11)) o = v.toPrecision(6);\n\treturn o;\n}\nfunction gfn4(o) {\n\tfor(var i = 0; i != o.length; ++i) if((o.charCodeAt(i) | 0x20) === 101) return o.replace(gnr4,\".$1\").replace(gnr5,\"E\").replace(\"e\",\"E\").replace(gnr6,\"$10$2\");\n\treturn o;\n}\nfunction gfn5(o) {\n\t//for(var i = 0; i != o.length; ++i) if(o.charCodeAt(i) === 46) return o.replace(gnr2,\"\").replace(gnr1,\".$1\");\n\t//return o;\n\treturn o.indexOf(\".\") > -1 ? o.replace(gnr2,\"\").replace(gnr1,\".$1\") : o;\n}\nreturn function general_fmt_num(v, opts) {\n\tvar V = Math.floor(Math.log(Math.abs(v))*Math.LOG10E), o;\n\tif(V >= -4 && V <= -1) o = v.toPrecision(10+V);\n\telse if(Math.abs(V) <= 9) o = gfn2(v);\n\telse if(V === 10) o = v.toFixed(10).substr(0,12);\n\telse o = gfn3(v);\n\treturn gfn5(gfn4(o));\n};})();\nSSF._general_num = general_fmt_num;\nfunction general_fmt(v, opts) {\n\tswitch(typeof v) {\n\t\tcase 'string': return v;\n\t\tcase 'boolean': return v ? \"TRUE\" : \"FALSE\";\n\t\tcase 'number': return (v|0) === v ? general_fmt_int(v, opts) : general_fmt_num(v, opts);\n\t}\n\tthrow new Error(\"unsupported value in General format: \" + v);\n}\nSSF._general = general_fmt;\nfunction fix_hijri(date, o) { return 0; }\nfunction parse_date_code(v,opts,b2) {\n\tif(v > 2958465 || v < 0) return null;\n\tvar date = (v|0), time = Math.floor(86400 * (v - date)), dow=0;\n\tvar dout=[];\n\tvar out={D:date, T:time, u:86400*(v-date)-time,y:0,m:0,d:0,H:0,M:0,S:0,q:0};\n\tif(Math.abs(out.u) < 1e-6) out.u = 0;\n\tfixopts(opts != null ? opts : (opts=[]));\n\tif(opts.date1904) date += 1462;\n\tif(out.u > 0.999) {\n\t\tout.u = 0;\n\t\tif(++time == 86400) { time = 0; ++date; }\n\t}\n\tif(date === 60) {dout = b2 ? [1317,10,29] : [1900,2,29]; dow=3;}\n\telse if(date === 0) {dout = b2 ? [1317,8,29] : [1900,1,0]; dow=6;}\n\telse {\n\t\tif(date > 60) --date;\n\t\t/* 1 = Jan 1 1900 */\n\t\tvar d = new Date(1900,0,1);\n\t\td.setDate(d.getDate() + date - 1);\n\t\tdout = [d.getFullYear(), d.getMonth()+1,d.getDate()];\n\t\tdow = d.getDay();\n\t\tif(date < 60) dow = (dow + 6) % 7;\n\t\tif(b2) dow = fix_hijri(d, dout);\n\t}\n\tout.y = dout[0]; out.m = dout[1]; out.d = dout[2];\n\tout.S = time % 60; time = Math.floor(time / 60);\n\tout.M = time % 60; time = Math.floor(time / 60);\n\tout.H = time;\n\tout.q = dow;\n\treturn out;\n}\nSSF.parse_date_code = parse_date_code;\n/*jshint -W086 */\nfunction write_date(type, fmt, val, ss0) {\n\tvar o=\"\", ss=0, tt=0, y = val.y, out, outl = 0;\n\tswitch(type) {\n\t\tcase 98: /* 'b' buddhist year */\n\t\t\ty = val.y + 543;\n\t\t\t/* falls through */\n\t\tcase 121: /* 'y' year */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = y % 100; outl = 2; break;\n\t\t\tdefault: out = y % 10000; outl = 4; break;\n\t\t} break;\n\t\tcase 109: /* 'm' month */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.m; outl = fmt.length; break;\n\t\t\tcase 3: return months[val.m-1][1];\n\t\t\tcase 5: return months[val.m-1][0];\n\t\t\tdefault: return months[val.m-1][2];\n\t\t} break;\n\t\tcase 100: /* 'd' day */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.d; outl = fmt.length; break;\n\t\t\tcase 3: return days[val.q][0];\n\t\t\tdefault: return days[val.q][1];\n\t\t} break;\n\t\tcase 104: /* 'h' 12-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = 1+(val.H+11)%12; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 72: /* 'H' 24-hour */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.H; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad hour format: ' + fmt;\n\t\t} break;\n\t\tcase 77: /* 'M' minutes */\n\t\tswitch(fmt.length) {\n\t\t\tcase 1: case 2: out = val.M; outl = fmt.length; break;\n\t\t\tdefault: throw 'bad minute format: ' + fmt;\n\t\t} break;\n\t\tcase 115: /* 's' seconds */\n\t\tif(val.u === 0) switch(fmt) {\n\t\t\tcase 's': case 'ss': return pad0(val.S, fmt.length);\n\t\t\tcase '.0': case '.00': case '.000':\n\t\t}\n\t\tswitch(fmt) {\n\t\t\tcase 's': case 'ss': case '.0': case '.00': case '.000':\n\t\t\t\tif(ss0 >= 2) tt = ss0 === 3 ? 1000 : 100;\n\t\t\t\telse tt = ss0 === 1 ? 10 : 1;\n\t\t\t\tss = Math.round((tt)*(val.S + val.u));\n\t\t\t\tif(ss >= 60*tt) ss = 0;\n\t\t\t\tif(fmt === 's') return ss === 0 ? \"0\" : \"\"+ss/tt;\n\t\t\t\to = pad0(ss,2 + ss0);\n\t\t\t\tif(fmt === 'ss') return o.substr(0,2);\n\t\t\t\treturn \".\" + o.substr(2,fmt.length-1);\n\t\t\tdefault: throw 'bad second format: ' + fmt;\n\t\t}\n\t\tcase 90: /* 'Z' absolute time */\n\t\tswitch(fmt) {\n\t\t\tcase '[h]': case '[hh]': out = val.D*24+val.H; break;\n\t\t\tcase '[m]': case '[mm]': out = (val.D*24+val.H)*60+val.M; break;\n\t\t\tcase '[s]': case '[ss]': out = ((val.D*24+val.H)*60+val.M)*60+Math.round(val.S+val.u); break;\n\t\t\tdefault: throw 'bad abstime format: ' + fmt;\n\t\t} outl = fmt.length === 3 ? 1 : 2; break;\n\t\tcase 101: /* 'e' era */\n\t\t\tout = y; outl = 1;\n\t}\n\tif(outl > 0) return pad0(out, outl); else return \"\";\n}\n/*jshint +W086 */\nfunction commaify(s) {\n\tif(s.length <= 3) return s;\n\tvar j = (s.length % 3), o = s.substr(0,j);\n\tfor(; j!=s.length; j+=3) o+=(o.length > 0 ? \",\" : \"\") + s.substr(j,3);\n\treturn o;\n}\nvar write_num = (function make_write_num(){\nvar pct1 = /%/g;\nfunction write_num_pct(type, fmt, val){\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\nfunction write_num_cm(type, fmt, val){\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\nfunction write_num_exp(fmt, val){\n\tvar o;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(o.indexOf(\"e\") === -1) {\n\t\t\tvar fakee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\twhile(o.substr(0,2) === \"0.\") {\n\t\t\t\to = o[0] + o.substr(2,period) + \".\" + o.substr(2+period);\n\t\t\t\to = o.replace(/^0+([1-9])/,\"$1\").replace(/^0+\\./,\"0.\");\n\t\t\t}\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o[o.length-1];\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nvar frac1 = /# (\\?+)( ?)\\/( ?)(\\d+)/;\nfunction write_num_f1(r, aval, sign) {\n\tvar den = parseInt(r[4]), rr = Math.round(aval * den), base = Math.floor(rr/den);\n\tvar myn = (rr - base*den), myd = den;\n\treturn sign + (base === 0 ? \"\" : \"\"+base) + \" \" + (myn === 0 ? fill(\" \", r[1].length + 1 + r[4].length) : pad_(myn,r[1].length) + r[2] + \"/\" + r[3] + pad0(myd,r[4].length));\n}\nfunction write_num_f2(r, aval, sign) {\n\treturn sign + (aval === 0 ? \"\" : \"\"+aval) + fill(\" \", r[1].length + 2 + r[4].length);\n}\nvar dec1 = /^#*0*\\.(0+)/;\nvar closeparen = /\\).*[0#]/;\nvar phone = /\\(###\\) ###\\\\?-####/;\nfunction hashq(str) {\n\tvar o = \"\", cc;\n\tfor(var i = 0; i != str.length; ++i) switch((cc=str.charCodeAt(i))) {\n\t\tcase 35: break;\n\t\tcase 63: o+= \" \"; break;\n\t\tcase 48: o+= \"0\"; break;\n\t\tdefault: o+= String.fromCharCode(cc);\n\t}\n\treturn o;\n}\nfunction rnd(val, d) { var dd = Math.pow(10,d); return \"\"+(Math.round(val * dd)/dd); }\nfunction dec(val, d) { return Math.round((val-Math.floor(val))*Math.pow(10,d)); }\nfunction flr(val) { if(val < 2147483647 && val > -2147483648) return \"\"+(val >= 0 ? (val|0) : (val-1|0)); return \"\"+Math.floor(val); }\nfunction write_num_flt(type, fmt, val) {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_flt('n', ffmt, val);\n\t\treturn '(' + write_num_flt('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_flt(type,fmt.substr(fmt[1]==' '?2:1),val);\n\tvar o, oo;\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0r(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = pad0r(val,0); if(o === \"0\") o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1)) !== null) return write_num_f1(r, aval, sign);\n\tif(fmt.match(/^#+0+$/) !== null) return sign + pad0r(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1)) !== null) {\n\t\to = rnd(val, r[1].length).replace(/^([^\\.]+)$/,\"$1.\"+r[1]).replace(/\\.$/,\".\"+r[1]).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", r[1].length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n\t\treturn sign + rnd(aval, r[2].length).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify(pad0r(aval,0));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(\"\"+(Math.floor(val))) + \".\" + pad0(dec(val, r[1].length),r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_flt(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n\t\to = _strrev(write_num_flt(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o[ri++]:x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone) !== null) {\n\t\to = write_num_flt(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n\t\tri = Math.min(r[4].length,7);\n\t\tff = frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif(oa[oa.length-1] == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/)) !== null) {\n\t\to = pad0r(val, 0);\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0?]+)\\.([#0]+)$/)) !== null) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n\t\tri = dec(val, r[1].length);\n\t\treturn val < 0 ? \"-\" + write_num_flt(type, fmt, -val) : commaify(flr(val)).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(ri,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"#,###\": var x = commaify(pad0r(aval,0)); return x !== \"0\" ? sign + x : \"\";\n\t\tdefault:\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nfunction write_num_cm2(type, fmt, val){\n\tvar idx = fmt.length - 1;\n\twhile(fmt.charCodeAt(idx-1) === 44) --idx;\n\treturn write_num(type, fmt.substr(0,idx), val / Math.pow(10,3*(fmt.length-idx)));\n}\nfunction write_num_pct2(type, fmt, val){\n\tvar sfmt = fmt.replace(pct1,\"\"), mul = fmt.length - sfmt.length;\n\treturn write_num(type, sfmt, val * Math.pow(10,2*mul)) + fill(\"%\",mul);\n}\nfunction write_num_exp2(fmt, val){\n\tvar o;\n\tvar idx = fmt.indexOf(\"E\") - fmt.indexOf(\".\") - 1;\n\tif(fmt.match(/^#+0.0E\\+0$/)) {\n\t\tvar period = fmt.indexOf(\".\"); if(period === -1) period=fmt.indexOf('E');\n\t\tvar ee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E)%period;\n\t\tif(ee < 0) ee += period;\n\t\to = (val/Math.pow(10,ee)).toPrecision(idx+1+(period+ee)%period);\n\t\tif(!o.match(/[Ee]/)) {\n\t\t\tvar fakee = Math.floor(Math.log(Math.abs(val))*Math.LOG10E);\n\t\t\tif(o.indexOf(\".\") === -1) o = o[0] + \".\" + o.substr(1) + \"E+\" + (fakee - o.length+ee);\n\t\t\telse o += \"E+\" + (fakee - ee);\n\t\t\to = o.replace(/\\+-/,\"-\");\n\t\t}\n\t\to = o.replace(/^([+-]?)(\\d*)\\.(\\d*)[Ee]/,function($$,$1,$2,$3) { return $1 + $2 + $3.substr(0,(period+ee)%period) + \".\" + $3.substr(ee) + \"E\"; });\n\t} else o = val.toExponential(idx);\n\tif(fmt.match(/E\\+00$/) && o.match(/e[+-]\\d$/)) o = o.substr(0,o.length-1) + \"0\" + o[o.length-1];\n\tif(fmt.match(/E\\-/) && o.match(/e\\+/)) o = o.replace(/e\\+/,\"e\");\n\treturn o.replace(\"e\",\"E\");\n}\nfunction write_num_int(type, fmt, val) {\n\tif(type.charCodeAt(0) === 40 && !fmt.match(closeparen)) {\n\t\tvar ffmt = fmt.replace(/\\( */,\"\").replace(/ \\)/,\"\").replace(/\\)/,\"\");\n\t\tif(val >= 0) return write_num_int('n', ffmt, val);\n\t\treturn '(' + write_num_int('n', ffmt, -val) + ')';\n\t}\n\tif(fmt.charCodeAt(fmt.length - 1) === 44) return write_num_cm2(type, fmt, val);\n\tif(fmt.indexOf('%') !== -1) return write_num_pct2(type, fmt, val);\n\tif(fmt.indexOf('E') !== -1) return write_num_exp2(fmt, val);\n\tif(fmt.charCodeAt(0) === 36) return \"$\"+write_num_int(type,fmt.substr(fmt[1]==' '?2:1),val);\n\tvar o;\n\tvar r, ri, ff, aval = Math.abs(val), sign = val < 0 ? \"-\" : \"\";\n\tif(fmt.match(/^00+$/)) return sign + pad0(aval,fmt.length);\n\tif(fmt.match(/^[#?]+$/)) {\n\t\to = (\"\"+val); if(val === 0) o = \"\";\n\t\treturn o.length > fmt.length ? o : hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(frac1)) !== null) return write_num_f2(r, aval, sign);\n\tif(fmt.match(/^#+0+$/) !== null) return sign + pad0(aval,fmt.length - fmt.indexOf(\"0\"));\n\tif((r = fmt.match(dec1)) !== null) {\n\t\to = (\"\"+val).replace(/^([^\\.]+)$/,\"$1.\"+r[1]).replace(/\\.$/,\".\"+r[1]).replace(/\\.(\\d*)$/,function($$, $1) { return \".\" + $1 + fill(\"0\", r[1].length-$1.length); });\n\t\treturn fmt.indexOf(\"0.\") !== -1 ? o : o.replace(/^0\\./,\".\");\n\t}\n\tfmt = fmt.replace(/^#+([0.])/, \"$1\");\n\tif((r = fmt.match(/^(0*)\\.(#*)$/)) !== null) {\n\t\treturn sign + (\"\"+aval).replace(/\\.(\\d*[1-9])0*$/,\".$1\").replace(/^(-?\\d*)$/,\"$1.\").replace(/^0\\./,r[1].length?\"0.\":\".\");\n\t}\n\tif((r = fmt.match(/^#,##0(\\.?)$/)) !== null) return sign + commaify((\"\"+aval));\n\tif((r = fmt.match(/^#,##0\\.([#0]*0)$/)) !== null) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify((\"\"+val)) + \".\" + fill('0',r[1].length);\n\t}\n\tif((r = fmt.match(/^#,#*,#0/)) !== null) return write_num_int(type,fmt.replace(/^#,#*,/,\"\"),val);\n\tif((r = fmt.match(/^([0#]+)(\\\\?-([0#]+))+$/)) !== null) {\n\t\to = _strrev(write_num_int(type, fmt.replace(/[\\\\-]/g,\"\"), val));\n\t\tri = 0;\n\t\treturn _strrev(_strrev(fmt.replace(/\\\\/g,\"\")).replace(/[0#]/g,function(x){return ri<o.length?o[ri++]:x==='0'?'0':\"\";}));\n\t}\n\tif(fmt.match(phone) !== null) {\n\t\to = write_num_int(type, \"##########\", val);\n\t\treturn \"(\" + o.substr(0,3) + \") \" + o.substr(3, 3) + \"-\" + o.substr(6);\n\t}\n\tvar oa = \"\";\n\tif((r = fmt.match(/^([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n\t\tri = Math.min(r[4].length,7);\n\t\tff = frac(aval, Math.pow(10,ri)-1, false);\n\t\to = \"\" + sign;\n\t\toa = write_num(\"n\", r[1], ff[1]);\n\t\tif(oa[oa.length-1] == \" \") oa = oa.substr(0,oa.length-1) + \"0\";\n\t\to += oa + r[2] + \"/\" + r[3];\n\t\toa = rpad_(ff[2],ri);\n\t\tif(oa.length < r[4].length) oa = hashq(r[4].substr(r[4].length-oa.length)) + oa;\n\t\to += oa;\n\t\treturn o;\n\t}\n\tif((r = fmt.match(/^# ([#0?]+)( ?)\\/( ?)([#0?]+)/)) !== null) {\n\t\tri = Math.min(Math.max(r[1].length, r[4].length),7);\n\t\tff = frac(aval, Math.pow(10,ri)-1, true);\n\t\treturn sign + (ff[0]||(ff[1] ? \"\" : \"0\")) + \" \" + (ff[1] ? pad_(ff[1],ri) + r[2] + \"/\" + r[3] + rpad_(ff[2],ri): fill(\" \", 2*ri+1 + r[2].length + r[3].length));\n\t}\n\tif((r = fmt.match(/^[#0?]+$/)) !== null) {\n\t\to = \"\" + val;\n\t\tif(fmt.length <= o.length) return o;\n\t\treturn hashq(fmt.substr(0,fmt.length-o.length)) + o;\n\t}\n\tif((r = fmt.match(/^([#0]+)\\.([#0]+)$/)) !== null) {\n\t\to = \"\" + val.toFixed(Math.min(r[2].length,10)).replace(/([^0])0+$/,\"$1\");\n\t\tri = o.indexOf(\".\");\n\t\tvar lres = fmt.indexOf(\".\") - ri, rres = fmt.length - o.length - lres;\n\t\treturn hashq(fmt.substr(0,lres) + o + fmt.substr(fmt.length-rres));\n\t}\n\tif((r = fmt.match(/^00,000\\.([#0]*0)$/)) !== null) {\n\t\treturn val < 0 ? \"-\" + write_num_int(type, fmt, -val) : commaify(\"\"+val).replace(/^\\d,\\d{3}$/,\"0$&\").replace(/^\\d*$/,function($$) { return \"00,\" + ($$.length < 3 ? pad0(0,3-$$.length) : \"\") + $$; }) + \".\" + pad0(0,r[1].length);\n\t}\n\tswitch(fmt) {\n\t\tcase \"#,###\": var x = commaify(\"\"+aval); return x !== \"0\" ? sign + x : \"\";\n\t\tdefault:\n\t}\n\tthrow new Error(\"unsupported format |\" + fmt + \"|\");\n}\nreturn function write_num(type, fmt, val) {\n\treturn (val|0) === val ? write_num_int(type, fmt, val) : write_num_flt(type, fmt, val);\n};})();\nfunction split_fmt(fmt) {\n\tvar out = [];\n\tvar in_str = false, cc;\n\tfor(var i = 0, j = 0; i < fmt.length; ++i) switch((cc=fmt.charCodeAt(i))) {\n\t\tcase 34: /* '\"' */\n\t\t\tin_str = !in_str; break;\n\t\tcase 95: case 42: case 92: /* '_' '*' '\\\\' */\n\t\t\t++i; break;\n\t\tcase 59: /* ';' */\n\t\t\tout[out.length] = fmt.substr(j,i-j);\n\t\t\tj = i+1;\n\t}\n\tout[out.length] = fmt.substr(j);\n\tif(in_str === true) throw new Error(\"Format |\" + fmt + \"| unterminated string \");\n\treturn out;\n}\nSSF._split = split_fmt;\nvar abstime = /\\[[HhMmSs]*\\]/;\nfunction eval_fmt(fmt, v, opts, flen) {\n\tvar out = [], o = \"\", i = 0, c = \"\", lst='t', q, dt, j, cc;\n\tvar hr='H';\n\t/* Tokenize */\n\twhile(i < fmt.length) {\n\t\tswitch((c = fmt[i])) {\n\t\t\tcase 'G': /* General */\n\t\t\t\tif(!isgeneral(fmt, i)) throw new Error('unrecognized character ' + c + ' in ' +fmt);\n\t\t\t\tout[out.length] = {t:'G', v:'General'}; i+=7; break;\n\t\t\tcase '\"': /* Literal text */\n\t\t\t\tfor(o=\"\";(cc=fmt.charCodeAt(++i)) !== 34 && i < fmt.length;) o += String.fromCharCode(cc);\n\t\t\t\tout[out.length] = {t:'t', v:o}; ++i; break;\n\t\t\tcase '\\\\': var w = fmt[++i], t = (w === \"(\" || w === \")\") ? w : 't';\n\t\t\t\tout[out.length] = {t:t, v:w}; ++i; break;\n\t\t\tcase '_': out[out.length] = {t:'t', v:\" \"}; i+=2; break;\n\t\t\tcase '@': /* Text Placeholder */\n\t\t\t\tout[out.length] = {t:'T', v:v}; ++i; break;\n\t\t\tcase 'B': case 'b':\n\t\t\t\tif(fmt[i+1] === \"1\" || fmt[i+1] === \"2\") {\n\t\t\t\t\tif(dt==null) { dt=parse_date_code(v, opts, fmt[i+1] === \"2\"); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'X', v:fmt.substr(i,2)}; lst = c; i+=2; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase 'M': case 'D': case 'Y': case 'H': case 'S': case 'E':\n\t\t\t\tc = c.toLowerCase();\n\t\t\t\t/* falls through */\n\t\t\tcase 'm': case 'd': case 'y': case 'h': case 's': case 'e': case 'g':\n\t\t\t\tif(v < 0) return \"\";\n\t\t\t\tif(dt==null) { dt=parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\to = c; while(++i<fmt.length && fmt[i].toLowerCase() === c) o+=c;\n\t\t\t\tif(c === 'm' && lst.toLowerCase() === 'h') c = 'M'; /* m = minute */\n\t\t\t\tif(c === 'h') c = hr;\n\t\t\t\tout[out.length] = {t:c, v:o}; lst = c; break;\n\t\t\tcase 'A':\n\t\t\t\tq={t:c, v:\"A\"};\n\t\t\t\tif(dt==null) dt=parse_date_code(v, opts);\n\t\t\t\tif(fmt.substr(i, 3) === \"A/P\") { if(dt!=null) q.v = dt.H >= 12 ? \"P\" : \"A\"; q.t = 'T'; hr='h';i+=3;}\n\t\t\t\telse if(fmt.substr(i,5) === \"AM/PM\") { if(dt!=null) q.v = dt.H >= 12 ? \"PM\" : \"AM\"; q.t = 'T'; i+=5; hr='h'; }\n\t\t\t\telse { q.t = \"t\"; ++i; }\n\t\t\t\tif(dt==null && q.t === 'T') return \"\";\n\t\t\t\tout[out.length] = q; lst = c; break;\n\t\t\tcase '[':\n\t\t\t\to = c;\n\t\t\t\twhile(fmt[i++] !== ']' && i < fmt.length) o += fmt[i];\n\t\t\t\tif(o.substr(-1) !== ']') throw 'unterminated \"[\" block: |' + o + '|';\n\t\t\t\tif(o.match(abstime)) {\n\t\t\t\t\tif(dt==null) { dt=parse_date_code(v, opts); if(dt==null) return \"\"; }\n\t\t\t\t\tout[out.length] = {t:'Z', v:o.toLowerCase()};\n\t\t\t\t} else { o=\"\"; }\n\t\t\t\tbreak;\n\t\t\t/* Numbers */\n\t\t\tcase '.':\n\t\t\t\tif(dt != null) {\n\t\t\t\t\to = c; while((c=fmt[++i]) === \"0\") o += c;\n\t\t\t\t\tout[out.length] = {t:'s', v:o}; break;\n\t\t\t\t}\n\t\t\t\t/* falls through */\n\t\t\tcase '0': case '#':\n\t\t\t\to = c; while(\"0#?.,E+-%\".indexOf(c=fmt[++i]) > -1 || c=='\\\\' && fmt[i+1] == \"-\" && \"0#\".indexOf(fmt[i+2])>-1) o += c;\n\t\t\t\tout[out.length] = {t:'n', v:o}; break;\n\t\t\tcase '?':\n\t\t\t\to = c; while(fmt[++i] === c) o+=c;\n\t\t\t\tq={t:c, v:o}; out[out.length] = q; lst = c; break;\n\t\t\tcase '*': ++i; if(fmt[i] == ' ' || fmt[i] == '*') ++i; break; // **\n\t\t\tcase '(': case ')': out[out.length] = {t:(flen===1?'t':c), v:c}; ++i; break;\n\t\t\tcase '1': case '2': case '3': case '4': case '5': case '6': case '7': case '8': case '9':\n\t\t\t\to = c; while(\"0123456789\".indexOf(fmt[++i]) > -1) o+=fmt[i];\n\t\t\t\tout[out.length] = {t:'D', v:o}; break;\n\t\t\tcase ' ': out[out.length] = {t:c, v:c}; ++i; break;\n\t\t\tdefault:\n\t\t\t\tif(\",$-+/():!^&'~{}<>=€acfijklopqrtuvwxz\".indexOf(c) === -1) throw new Error('unrecognized character ' + c + ' in ' + fmt);\n\t\t\t\tout[out.length] = {t:'t', v:c}; ++i; break;\n\t\t}\n\t}\n\tvar bt = 0, ss0 = 0, ssm;\n\tfor(i=out.length-1, lst='t'; i >= 0; --i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 'h': case 'H': out[i].t = hr; lst='h'; if(bt < 1) bt = 1; break;\n\t\t\tcase 's':\n\t\t\t\tif((ssm=out[i].v.match(/\\.0+$/))) ss0=Math.max(ss0,ssm[0].length-1);\n\t\t\t\tif(bt < 3) bt = 3;\n\t\t\t/* falls through */\n\t\t\tcase 'd': case 'y': case 'M': case 'e': lst=out[i].t; break;\n\t\t\tcase 'm': if(lst === 's') { out[i].t = 'M'; if(bt < 2) bt = 2; } break;\n\t\t\tcase 'X': if(out[i].v === \"B2\");\n\t\t\t\tbreak;\n\t\t\tcase 'Z':\n\t\t\t\tif(bt < 1 && out[i].v.match(/[Hh]/)) bt = 1;\n\t\t\t\tif(bt < 2 && out[i].v.match(/[Mm]/)) bt = 2;\n\t\t\t\tif(bt < 3 && out[i].v.match(/[Ss]/)) bt = 3;\n\t\t}\n\t}\n\tswitch(bt) {\n\t\tcase 0: break;\n\t\tcase 1:\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tif(dt.M >=  60) { dt.M = 0; ++dt.H; }\n\t\t\tbreak;\n\t\tcase 2:\n\t\t\tif(dt.u >= 0.5) { dt.u = 0; ++dt.S; }\n\t\t\tif(dt.S >=  60) { dt.S = 0; ++dt.M; }\n\t\t\tbreak;\n\t}\n\t/* replace fields */\n\tvar nstr = \"\", jj;\n\tfor(i=0; i < out.length; ++i) {\n\t\tswitch(out[i].t) {\n\t\t\tcase 't': case 'T': case ' ': case 'D': break;\n\t\t\tcase 'X': out[i] = undefined; break;\n\t\t\tcase 'd': case 'm': case 'y': case 'h': case 'H': case 'M': case 's': case 'e': case 'b': case 'Z':\n\t\t\t\tout[i].v = write_date(out[i].t.charCodeAt(0), out[i].v, dt, ss0);\n\t\t\t\tout[i].t = 't'; break;\n\t\t\tcase 'n': case '(': case '?':\n\t\t\t\tjj = i+1;\n\t\t\t\twhile(out[jj] != null && (\n\t\t\t\t\t(c=out[jj].t) === \"?\" || c === \"D\" ||\n\t\t\t\t\t(c === \" \" || c === \"t\") && out[jj+1] != null && (out[jj+1].t === '?' || out[jj+1].t === \"t\" && out[jj+1].v === '/') ||\n\t\t\t\t\tout[i].t === '(' && (c === ' ' || c === 'n' || c === ')') ||\n\t\t\t\t\tc === 't' && (out[jj].v === '/' || '$€'.indexOf(out[jj].v) > -1 || out[jj].v === ' ' && out[jj+1] != null && out[jj+1].t == '?')\n\t\t\t\t)) {\n\t\t\t\t\tout[i].v += out[jj].v;\n\t\t\t\t\tout[jj] = undefined; ++jj;\n\t\t\t\t}\n\t\t\t\tnstr += out[i].v;\n\t\t\t\ti = jj-1; break;\n\t\t\tcase 'G': out[i].t = 't'; out[i].v = general_fmt(v,opts); break;\n\t\t}\n\t}\n\tvar vv = \"\", myv, ostr;\n\tif(nstr.length > 0) {\n\t\tmyv = (v<0&&nstr.charCodeAt(0) === 45 ? -v : v); /* '-' */\n\t\tostr = write_num(nstr.charCodeAt(0) === 40 ? '(' : 'n', nstr, myv); /* '(' */\n\t\tjj=ostr.length-1;\n\t\tvar decpt = out.length;\n\t\tfor(i=0; i < out.length; ++i) if(out[i] != null && out[i].v.indexOf(\".\") > -1) { decpt = i; break; }\n\t\tvar lasti=out.length;\n\t\tif(decpt === out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tfor(i=out.length-1; i>= 0;--i) {\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n\t\t\t\tif(jj>=out[i].v.length-1) { jj -= out[i].v.length; out[i].v = ostr.substr(jj+1, out[i].v.length); }\n\t\t\t\telse if(jj < 0) out[i].v = \"\";\n\t\t\t\telse { out[i].v = ostr.substr(0, jj+1); jj = -1; }\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t}\n\t\telse if(decpt !== out.length && ostr.indexOf(\"E\") === -1) {\n\t\t\tjj = ostr.indexOf(\".\")-1;\n\t\t\tfor(i=decpt; i>= 0; --i) {\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")-1:out[i].v.length-1;\n\t\t\t\tvv = out[i].v.substr(j+1);\n\t\t\t\tfor(; j>=0; --j) {\n\t\t\t\t\tif(jj>=0 && (out[i].v[j] === \"0\" || out[i].v[j] === \"#\")) vv = ostr[jj--] + vv;\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t\tif(jj>=0 && lasti<out.length) out[lasti].v = ostr.substr(0,jj+1) + out[lasti].v;\n\t\t\tjj = ostr.indexOf(\".\")+1;\n\t\t\tfor(i=decpt; i<out.length; ++i) {\n\t\t\t\tif(out[i] == null || 'n?('.indexOf(out[i].t) === -1 && i !== decpt ) continue;\n\t\t\t\tj=out[i].v.indexOf(\".\")>-1&&i===decpt?out[i].v.indexOf(\".\")+1:0;\n\t\t\t\tvv = out[i].v.substr(0,j);\n\t\t\t\tfor(; j<out[i].v.length; ++j) {\n\t\t\t\t\tif(jj<ostr.length) vv += ostr[jj++];\n\t\t\t\t}\n\t\t\t\tout[i].v = vv;\n\t\t\t\tout[i].t = 't';\n\t\t\t\tlasti = i;\n\t\t\t}\n\t\t}\n\t}\n\tfor(i=0; i<out.length; ++i) if(out[i] != null && 'n(?'.indexOf(out[i].t)>-1) {\n\t\tmyv = (flen >1 && v < 0 && i>0 && out[i-1].v === \"-\" ? -v:v);\n\t\tout[i].v = write_num(out[i].t, out[i].v, myv);\n\t\tout[i].t = 't';\n\t}\n\tvar retval = \"\";\n\tfor(i=0; i !== out.length; ++i) if(out[i] != null) retval += out[i].v;\n\treturn retval;\n}\nSSF._eval = eval_fmt;\nvar cfregex = /\\[[=<>]/;\nvar cfregex2 = /\\[([=<>]*)(-?\\d+\\.?\\d*)\\]/;\nfunction chkcond(v, rr) {\n\tif(rr == null) return false;\n\tvar thresh = parseFloat(rr[2]);\n\tswitch(rr[1]) {\n\t\tcase \"=\":  if(v == thresh) return true; break;\n\t\tcase \">\":  if(v >  thresh) return true; break;\n\t\tcase \"<\":  if(v <  thresh) return true; break;\n\t\tcase \"<>\": if(v != thresh) return true; break;\n\t\tcase \">=\": if(v >= thresh) return true; break;\n\t\tcase \"<=\": if(v <= thresh) return true; break;\n\t}\n\treturn false;\n}\nfunction choose_fmt(f, v) {\n\tvar fmt = split_fmt(f);\n\tvar l = fmt.length, lat = fmt[l-1].indexOf(\"@\");\n\tif(l<4 && lat>-1) --l;\n\tif(fmt.length > 4) throw \"cannot find right format for |\" + fmt + \"|\";\n\tif(typeof v !== \"number\") return [4, fmt.length === 4 || lat>-1?fmt[fmt.length-1]:\"@\"];\n\tswitch(fmt.length) {\n\t\tcase 1: fmt = lat>-1 ? [\"General\", \"General\", \"General\", fmt[0]] : [fmt[0], fmt[0], fmt[0], \"@\"]; break;\n\t\tcase 2: fmt = lat>-1 ? [fmt[0], fmt[0], fmt[0], fmt[1]] : [fmt[0], fmt[1], fmt[0], \"@\"]; break;\n\t\tcase 3: fmt = lat>-1 ? [fmt[0], fmt[1], fmt[0], fmt[2]] : [fmt[0], fmt[1], fmt[2], \"@\"]; break;\n\t\tcase 4: break;\n\t}\n\tvar ff = v > 0 ? fmt[0] : v < 0 ? fmt[1] : fmt[2];\n\tif(fmt[0].indexOf(\"[\") === -1 && fmt[1].indexOf(\"[\") === -1) return [l, ff];\n\tif(fmt[0].match(cfregex) != null || fmt[1].match(cfregex) != null) {\n\t\tvar m1 = fmt[0].match(cfregex2);\n\t\tvar m2 = fmt[1].match(cfregex2);\n\t\treturn chkcond(v, m1) ? [l, fmt[0]] : chkcond(v, m2) ? [l, fmt[1]] : [l, fmt[m1 != null && m2 != null ? 2 : 1]];\n\t}\n\treturn [l, ff];\n}\nfunction format(fmt,v,o) {\n\tfixopts(o != null ? o : (o=[]));\n\tvar sfmt = \"\";\n\tswitch(typeof fmt) {\n\t\tcase \"string\": sfmt = fmt; break;\n\t\tcase \"number\": sfmt = (o.table != null ? o.table : table_fmt)[fmt]; break;\n\t}\n\tif(isgeneral(sfmt,0)) return general_fmt(v, o);\n\tvar f = choose_fmt(sfmt, v);\n\tif(isgeneral(f[1])) return general_fmt(v, o);\n\tif(v === true) v = \"TRUE\"; else if(v === false) v = \"FALSE\";\n\telse if(v === \"\" || v == null) return \"\";\n\treturn eval_fmt(f[1], v, o, f[0]);\n}\nSSF._table = table_fmt;\nSSF.load = function load_entry(fmt, idx) { table_fmt[idx] = fmt; };\nSSF.format = format;\nSSF.get_table = function get_table() { return table_fmt; };\nSSF.load_table = function load_table(tbl) { for(var i=0; i!=0x0188; ++i) if(tbl[i] !== undefined) SSF.load(tbl[i], i); };\n};\nmake_ssf(SSF);\n/* [MS-DTYP] 2.3.3 FILETIME */\n/* [MS-OLEDS] 2.1.3 FILETIME (Packet Version) */\n/* [MS-OLEPS] 2.8 FILETIME (Packet Version) */\nfunction parse_FILETIME(blob) {\n\tvar dwLowDateTime = blob.read_shift(4), dwHighDateTime = blob.read_shift(4);\n\treturn new Date(((dwHighDateTime/1e7*Math.pow(2,32) + dwLowDateTime/1e7) - 11644473600)*1000).toISOString().replace(/\\.000/,\"\");\n}\n\n/* [MS-OSHARED] 2.3.3.1.4 Lpstr */\nfunction parse_lpstr(blob, type, pad) {\n\tvar str = blob.read_shift(0, 'lpstr');\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\n\treturn str;\n}\n\n/* [MS-OSHARED] 2.3.3.1.6 Lpwstr */\nfunction parse_lpwstr(blob, type, pad) {\n\tvar str = blob.read_shift(0, 'lpwstr');\n\tif(pad) blob.l += (4 - ((str.length+1) & 3)) & 3;\n\treturn str;\n}\n\n\n/* [MS-OSHARED] 2.3.3.1.11 VtString */\n/* [MS-OSHARED] 2.3.3.1.12 VtUnalignedString */\nfunction parse_VtStringBase(blob, stringType, pad) {\n\tif(stringType === 0x1F /*VT_LPWSTR*/) return parse_lpwstr(blob);\n\treturn parse_lpstr(blob, stringType, pad);\n}\n\nfunction parse_VtString(blob, t, pad) { return parse_VtStringBase(blob, t, pad === false ? 0: 4); }\nfunction parse_VtUnalignedString(blob, t) { if(!t) throw new Error(\"dafuq?\"); return parse_VtStringBase(blob, t, 0); }\n\n/* [MS-OSHARED] 2.3.3.1.9 VtVecUnalignedLpstrValue */\nfunction parse_VtVecUnalignedLpstrValue(blob) {\n\tvar length = blob.read_shift(4);\n\tvar ret = [];\n\tfor(var i = 0; i != length; ++i) ret[i] = blob.read_shift(0, 'lpstr');\n\treturn ret;\n}\n\n/* [MS-OSHARED] 2.3.3.1.10 VtVecUnalignedLpstr */\nfunction parse_VtVecUnalignedLpstr(blob) {\n\treturn parse_VtVecUnalignedLpstrValue(blob);\n}\n\n/* [MS-OSHARED] 2.3.3.1.13 VtHeadingPair */\nfunction parse_VtHeadingPair(blob) {\n\tvar headingString = parse_TypedPropertyValue(blob, VT_USTR);\n\tvar headerParts = parse_TypedPropertyValue(blob, VT_I4);\n\treturn [headingString, headerParts];\n}\n\n/* [MS-OSHARED] 2.3.3.1.14 VtVecHeadingPairValue */\nfunction parse_VtVecHeadingPairValue(blob) {\n\tvar cElements = blob.read_shift(4);\n\tvar out = [];\n\tfor(var i = 0; i != cElements / 2; ++i) out.push(parse_VtHeadingPair(blob));\n\treturn out;\n}\n\n/* [MS-OSHARED] 2.3.3.1.15 VtVecHeadingPair */\nfunction parse_VtVecHeadingPair(blob) {\n\t// NOTE: When invoked, wType & padding were already consumed\n\treturn parse_VtVecHeadingPairValue(blob);\n}\n\n/* [MS-OLEPS] 2.18.1 Dictionary (uses 2.17, 2.16) */\nfunction parse_dictionary(blob,CodePage) {\n\tvar cnt = blob.read_shift(4);\n\tvar dict = ({});\n\tfor(var j = 0; j != cnt; ++j) {\n\t\tvar pid = blob.read_shift(4);\n\t\tvar len = blob.read_shift(4);\n\t\tdict[pid] = blob.read_shift(len, (CodePage === 0x4B0 ?'utf16le':'utf8')).replace(chr0,'').replace(chr1,'!');\n\t}\n\tif(blob.l & 3) blob.l = (blob.l>>2+1)<<2;\n\treturn dict;\n}\n\n/* [MS-OLEPS] 2.9 BLOB */\nfunction parse_BLOB(blob) {\n\tvar size = blob.read_shift(4);\n\tvar bytes = blob.slice(blob.l,blob.l+size);\n\tif((size & 3) > 0) blob.l += (4 - (size & 3)) & 3;\n\treturn bytes;\n}\n\n/* [MS-OLEPS] 2.11 ClipboardData */\nfunction parse_ClipboardData(blob) {\n\t// TODO\n\tvar o = {};\n\to.Size = blob.read_shift(4);\n\t//o.Format = blob.read_shift(4);\n\tblob.l += o.Size;\n\treturn o;\n}\n\n/* [MS-OLEPS] 2.14 Vector and Array Property Types */\nfunction parse_VtVector(blob, cb) {\n\t/* [MS-OLEPS] 2.14.2 VectorHeader */\n/*\tvar Length = blob.read_shift(4);\n\tvar o = [];\n\tfor(var i = 0; i != Length; ++i) {\n\t\to.push(cb(blob));\n\t}\n\treturn o;*/\n}\n\n/* [MS-OLEPS] 2.15 TypedPropertyValue */\nfunction parse_TypedPropertyValue(blob, type, _opts) {\n\tvar t = blob.read_shift(2), ret, opts = _opts||{};\n\tblob.l += 2;\n\tif(type !== VT_VARIANT)\n\tif(t !== type && VT_CUSTOM.indexOf(type)===-1) throw new Error('Expected type ' + type + ' saw ' + t);\n\tswitch(type === VT_VARIANT ? t : type) {\n\t\tcase 0x02 /*VT_I2*/: ret = blob.read_shift(2, 'i'); if(!opts.raw) blob.l += 2; return ret;\n\t\tcase 0x03 /*VT_I4*/: ret = blob.read_shift(4, 'i'); return ret;\n\t\tcase 0x0B /*VT_BOOL*/: return blob.read_shift(4) !== 0x0;\n\t\tcase 0x13 /*VT_UI4*/: ret = blob.read_shift(4); return ret;\n\t\tcase 0x1E /*VT_LPSTR*/: return parse_lpstr(blob, t, 4).replace(chr0,'');\n\t\tcase 0x1F /*VT_LPWSTR*/: return parse_lpwstr(blob);\n\t\tcase 0x40 /*VT_FILETIME*/: return parse_FILETIME(blob);\n\t\tcase 0x41 /*VT_BLOB*/: return parse_BLOB(blob);\n\t\tcase 0x47 /*VT_CF*/: return parse_ClipboardData(blob);\n\t\tcase 0x50 /*VT_STRING*/: return parse_VtString(blob, t, !opts.raw && 4).replace(chr0,'');\n\t\tcase 0x51 /*VT_USTR*/: return parse_VtUnalignedString(blob, t, 4).replace(chr0,'');\n\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: return parse_VtVecHeadingPair(blob);\n\t\tcase 0x101E /*VT_LPSTR*/: return parse_VtVecUnalignedLpstr(blob);\n\t\tdefault: throw new Error(\"TypedPropertyValue unrecognized type \" + type + \" \" + t);\n\t}\n}\n/* [MS-OLEPS] 2.14.2 VectorHeader */\n/*function parse_VTVectorVariant(blob) {\n\tvar Length = blob.read_shift(4);\n\n\tif(Length & 1 !== 0) throw new Error(\"VectorHeader Length=\" + Length + \" must be even\");\n\tvar o = [];\n\tfor(var i = 0; i != Length; ++i) {\n\t\to.push(parse_TypedPropertyValue(blob, VT_VARIANT));\n\t}\n\treturn o;\n}*/\n\n/* [MS-OLEPS] 2.20 PropertySet */\nfunction parse_PropertySet(blob, PIDSI) {\n\tvar start_addr = blob.l;\n\tvar size = blob.read_shift(4);\n\tvar NumProps = blob.read_shift(4);\n\tvar Props = [], i = 0;\n\tvar CodePage = 0;\n\tvar Dictionary = -1, DictObj = ({});\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tvar PropID = blob.read_shift(4);\n\t\tvar Offset = blob.read_shift(4);\n\t\tProps[i] = [PropID, Offset + start_addr];\n\t}\n\tvar PropH = {};\n\tfor(i = 0; i != NumProps; ++i) {\n\t\tif(blob.l !== Props[i][1]) {\n\t\t\tvar fail = true;\n\t\t\tif(i>0 && PIDSI) switch(PIDSI[Props[i-1][0]].t) {\n\t\t\t\tcase 0x02 /*VT_I2*/: if(blob.l +2 === Props[i][1]) { blob.l+=2; fail = false; } break;\n\t\t\t\tcase 0x50 /*VT_STRING*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t\tcase 0x100C /*VT_VECTOR|VT_VARIANT*/: if(blob.l <= Props[i][1]) { blob.l=Props[i][1]; fail = false; } break;\n\t\t\t}\n\t\t\tif(!PIDSI && blob.l <= Props[i][1]) { fail=false; blob.l = Props[i][1]; }\n\t\t\tif(fail) throw new Error(\"Read Error: Expected address \" + Props[i][1] + ' at ' + blob.l + ' :' + i);\n\t\t}\n\t\tif(PIDSI) {\n\t\t\tvar piddsi = PIDSI[Props[i][0]];\n\t\t\tPropH[piddsi.n] = parse_TypedPropertyValue(blob, piddsi.t, {raw:true});\n\t\t\tif(piddsi.p === 'version') PropH[piddsi.n] = String(PropH[piddsi.n] >> 16) + \".\" + String(PropH[piddsi.n] & 0xFFFF);\n\t\t\tif(piddsi.n == \"CodePage\") switch(PropH[piddsi.n]) {\n\t\t\t\tcase 0: PropH[piddsi.n] = 1252;\n\t\t\t\t\t/* falls through */\n\t\t\t\tcase 10000: // OSX Roman\n\t\t\t\tcase 1252: // Windows Latin\n\n\t\t\t\tcase 874: // SB Windows Thai\n\t\t\t\tcase 1250: // SB Windows Central Europe\n\t\t\t\tcase 1251: // SB Windows Cyrillic\n\t\t\t\tcase 1253: // SB Windows Greek\n\t\t\t\tcase 1254: // SB Windows Turkish\n\t\t\t\tcase 1255: // SB Windows Hebrew\n\t\t\t\tcase 1256: // SB Windows Arabic\n\t\t\t\tcase 1257: // SB Windows Baltic\n\t\t\t\tcase 1258: // SB Windows Vietnam\n\n\t\t\t\tcase 932: // DB Windows Japanese Shift-JIS\n\t\t\t\tcase 936: // DB Windows Simplified Chinese GBK\n\t\t\t\tcase 949: // DB Windows Korean\n\t\t\t\tcase 950: // DB Windows Traditional Chinese Big5\n\n\t\t\t\tcase 1200: // UTF16LE\n\t\t\t\tcase 1201: // UTF16BE\n\t\t\t\tcase 65000: case -536: // UTF-7\n\t\t\t\tcase 65001: case -535: // UTF-8\n\t\t\t\t\tset_cp(CodePage = PropH[piddsi.n]); break;\n\t\t\t\tdefault: throw new Error(\"Unsupported CodePage: \" + PropH[piddsi.n]);\n\t\t\t}\n\t\t} else {\n\t\t\tif(Props[i][0] === 0x1) {\n\t\t\t\tCodePage = PropH.CodePage = parse_TypedPropertyValue(blob, VT_I2);\n\t\t\t\tset_cp(CodePage);\n\t\t\t\tif(Dictionary !== -1) {\n\t\t\t\t\tvar oldpos = blob.l;\n\t\t\t\t\tblob.l = Props[Dictionary][1];\n\t\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t\t\tblob.l = oldpos;\n\t\t\t\t}\n\t\t\t} else if(Props[i][0] === 0) {\n\t\t\t\tif(CodePage === 0) { Dictionary = i; blob.l = Props[i+1][1]; continue; }\n\t\t\t\tDictObj = parse_dictionary(blob,CodePage);\n\t\t\t} else {\n\t\t\t\tvar name = DictObj[Props[i][0]];\n\t\t\t\tvar val;\n\t\t\t\t/* [MS-OSHARED] 2.3.3.2.3.1.2 + PROPVARIANT */\n\t\t\t\tswitch(blob[blob.l]) {\n\t\t\t\t\tcase 0x41 /*VT_BLOB*/: blob.l += 4; val = parse_BLOB(blob); break;\n\t\t\t\t\tcase 0x1E /*VT_LPSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]); break;\n\t\t\t\t\tcase 0x1F /*VT_LPWSTR*/: blob.l += 4; val = parse_VtString(blob, blob[blob.l-4]); break;\n\t\t\t\t\tcase 0x03 /*VT_I4*/: blob.l += 4; val = blob.read_shift(4, 'i'); break;\n\t\t\t\t\tcase 0x13 /*VT_UI4*/: blob.l += 4; val = blob.read_shift(4); break;\n\t\t\t\t\tcase 0x05 /*VT_R8*/: blob.l += 4; val = blob.read_shift(8, 'f'); break;\n\t\t\t\t\tcase 0x0B /*VT_BOOL*/: blob.l += 4; val = parsebool(blob, 4); break;\n\t\t\t\t\tcase 0x40 /*VT_FILETIME*/: blob.l += 4; val = new Date(parse_FILETIME(blob)); break;\n\t\t\t\t\tdefault: throw new Error(\"unparsed value: \" + blob[blob.l]);\n\t\t\t\t}\n\t\t\t\tPropH[name] = val;\n\t\t\t}\n\t\t}\n\t}\n\tblob.l = start_addr + size; /* step ahead to skip padding */\n\treturn PropH;\n}\n\n/* [MS-OLEPS] 2.21 PropertySetStream */\nfunction parse_PropertySetStream(file, PIDSI) {\n\tvar blob = file.content;\n\tprep_blob(blob, 0);\n\n\tvar NumSets, FMTID0, FMTID1, Offset0, Offset1 = 0;\n\tblob.chk('feff', 'Byte Order: ');\n\n\tvar vers = blob.read_shift(2); // TODO: check version\n\tvar SystemIdentifier = blob.read_shift(4);\n\tblob.chk(CFB.utils.consts.HEADER_CLSID, 'CLSID: ');\n\tNumSets = blob.read_shift(4);\n\tif(NumSets !== 1 && NumSets !== 2) throw \"Unrecognized #Sets: \" + NumSets;\n\tFMTID0 = blob.read_shift(16); Offset0 = blob.read_shift(4);\n\n\tif(NumSets === 1 && Offset0 !== blob.l) throw \"Length mismatch\";\n\telse if(NumSets === 2) { FMTID1 = blob.read_shift(16); Offset1 = blob.read_shift(4); }\n\tvar PSet0 = parse_PropertySet(blob, PIDSI);\n\n\tvar rval = ({ SystemIdentifier: SystemIdentifier });\n\tfor(var y in PSet0) rval[y] = PSet0[y];\n\t//rval.blob = blob;\n\trval.FMTID = FMTID0;\n\t//rval.PSet0 = PSet0;\n\tif(NumSets === 1) return rval;\n\tif(blob.l !== Offset1) throw new Error(\"Length mismatch 2: \" + blob.l + \" !== \" + Offset1);\n\tvar PSet1;\n\ttry { PSet1 = parse_PropertySet(blob, null); } catch(e) { }\n\tfor(y in PSet1) rval[y] = PSet1[y];\n\trval.FMTID = [FMTID0, FMTID1]; // TODO: verify FMTID0/1\n\treturn rval;\n}\nvar DO_NOT_EXPORT_CFB = true;\n/* cfb.js (C) 2013-present SheetJS -- http://sheetjs.com */\n/* vim: set ts=2: */\n/*jshint eqnull:true */\n\n/* [MS-CFB] v20130118 */\nvar CFB = (function _CFB(){\nvar exports = {};\nexports.version = '0.11.0';\nfunction parse(file) {\nvar mver = 3; // major version\nvar ssz = 512; // sector size\nvar nmfs = 0; // number of mini FAT sectors\nvar ndfs = 0; // number of DIFAT sectors\nvar dir_start = 0; // first directory sector location\nvar minifat_start = 0; // first mini FAT sector location\nvar difat_start = 0; // first mini FAT sector location\n\nvar fat_addrs = []; // locations of FAT sectors\n\n/* [MS-CFB] 2.2 Compound File Header */\nvar blob = file.slice(0,512);\nprep_blob(blob, 0);\n\n/* major version */\nvar mv = check_get_mver(blob);\nmver = mv[0];\nswitch(mver) {\n\tcase 3: ssz = 512; break; case 4: ssz = 4096; break;\n\tdefault: throw \"Major Version: Expected 3 or 4 saw \" + mver;\n}\n\n/* reprocess header */\nif(ssz !== 512) { blob = file.slice(0,ssz); prep_blob(blob, 28 /* blob.l */); }\n/* Save header for final object */\nvar header = file.slice(0,ssz);\n\ncheck_shifts(blob, mver);\n\n// Number of Directory Sectors\nvar nds = blob.read_shift(4, 'i');\nif(mver === 3 && nds !== 0) throw '# Directory Sectors: Expected 0 saw ' + nds;\n\n// Number of FAT Sectors\n//var nfs = blob.read_shift(4, 'i');\nblob.l += 4;\n\n// First Directory Sector Location\ndir_start = blob.read_shift(4, 'i');\n\n// Transaction Signature\nblob.l += 4;\n\n// Mini Stream Cutoff Size\nblob.chk('00100000', 'Mini Stream Cutoff Size: ');\n\n// First Mini FAT Sector Location\nminifat_start = blob.read_shift(4, 'i');\n\n// Number of Mini FAT Sectors\nnmfs = blob.read_shift(4, 'i');\n\n// First DIFAT sector location\ndifat_start = blob.read_shift(4, 'i');\n\n// Number of DIFAT Sectors\nndfs = blob.read_shift(4, 'i');\n\n// Grab FAT Sector Locations\nfor(var q, j = 0; j < 109; ++j) { /* 109 = (512 - blob.l)>>>2; */\n\tq = blob.read_shift(4, 'i');\n\tif(q<0) break;\n\tfat_addrs[j] = q;\n}\n\n/** Break the file up into sectors */\nvar sectors = sectorify(file, ssz);\n\nsleuth_fat(difat_start, ndfs, sectors, ssz, fat_addrs);\n\n/** Chains */\nvar sector_list = make_sector_list(sectors, dir_start, fat_addrs, ssz);\n\nsector_list[dir_start].name = \"!Directory\";\nif(nmfs > 0 && minifat_start !== ENDOFCHAIN) sector_list[minifat_start].name = \"!MiniFAT\";\nsector_list[fat_addrs[0]].name = \"!FAT\";\nsector_list.fat_addrs = fat_addrs;\nsector_list.ssz = ssz;\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nvar files = {}, Paths = [], FileIndex = [], FullPaths = [], FullPathDir = {};\nread_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex);\n\nbuild_full_paths(FileIndex, FullPathDir, FullPaths, Paths);\n\nvar root_name = Paths.shift();\nPaths.root = root_name;\n\n/* [MS-CFB] 2.6.4 (Unicode 3.0.1 case conversion) */\nvar find_path = make_find_path(FullPaths, Paths, FileIndex, files, root_name);\n\nreturn {\n\traw: {header: header, sectors: sectors},\n\tFileIndex: FileIndex,\n\tFullPaths: FullPaths,\n\tFullPathDir: FullPathDir,\n\tfind: find_path\n};\n} // parse\n\n/* [MS-CFB] 2.2 Compound File Header -- read up to major version */\nfunction check_get_mver(blob) {\n\t// header signature 8\n\tblob.chk(HEADER_SIGNATURE, 'Header Signature: ');\n\n\t// clsid 16\n\tblob.chk(HEADER_CLSID, 'CLSID: ');\n\n\t// minor version 2\n\tvar mver = blob.read_shift(2, 'u');\n\n\treturn [blob.read_shift(2,'u'), mver];\n}\nfunction check_shifts(blob, mver) {\n\tvar shift = 0x09;\n\n\t// Byte Order\n\tblob.chk('feff', 'Byte Order: ');\n\n\t// Sector Shift\n\tswitch((shift = blob.read_shift(2))) {\n\t\tcase 0x09: if(mver !== 3) throw 'MajorVersion/SectorShift Mismatch'; break;\n\t\tcase 0x0c: if(mver !== 4) throw 'MajorVersion/SectorShift Mismatch'; break;\n\t\tdefault: throw 'Sector Shift: Expected 9 or 12 saw ' + shift;\n\t}\n\n\t// Mini Sector Shift\n\tblob.chk('0600', 'Mini Sector Shift: ');\n\n\t// Reserved\n\tblob.chk('000000000000', 'Reserved: ');\n}\n\n/** Break the file up into sectors */\nfunction sectorify(file, ssz) {\n\tvar nsectors = Math.ceil(file.length/ssz)-1;\n\tvar sectors = new Array(nsectors);\n\tfor(var i=1; i < nsectors; ++i) sectors[i-1] = file.slice(i*ssz,(i+1)*ssz);\n\tsectors[nsectors-1] = file.slice(nsectors*ssz);\n\treturn sectors;\n}\n\n/* [MS-CFB] 2.6.4 Red-Black Tree */\nfunction build_full_paths(FI, FPD, FP, Paths) {\n\tvar i = 0, L = 0, R = 0, C = 0, j = 0, pl = Paths.length;\n\tvar dad = new Array(pl), q = new Array(pl);\n\n\tfor(; i < pl; ++i) { dad[i]=q[i]=i; FP[i]=Paths[i]; }\n\n\tfor(; j < q.length; ++j) {\n\t\ti = q[j];\n\t\tL = FI[i].L; R = FI[i].R; C = FI[i].C;\n\t\tif(dad[i] === i) {\n\t\t\tif(L !== -1 /*NOSTREAM*/ && dad[L] !== L) dad[i] = dad[L];\n\t\t\tif(R !== -1 && dad[R] !== R) dad[i] = dad[R];\n\t\t}\n\t\tif(C !== -1 /*NOSTREAM*/) dad[C] = i;\n\t\tif(L !== -1) { dad[L] = dad[i]; q.push(L); }\n\t\tif(R !== -1) { dad[R] = dad[i]; q.push(R); }\n\t}\n\tfor(i=1; i !== pl; ++i) if(dad[i] === i) {\n\t\tif(R !== -1 /*NOSTREAM*/ && dad[R] !== R) dad[i] = dad[R];\n\t\telse if(L !== -1 && dad[L] !== L) dad[i] = dad[L];\n\t}\n\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type === 0 /* unknown */) continue;\n\t\tj = dad[i];\n\t\tif(j === 0) FP[i] = FP[0] + \"/\" + FP[i];\n\t\telse while(j !== 0) {\n\t\t\tFP[i] = FP[j] + \"/\" + FP[i];\n\t\t\tj = dad[j];\n\t\t}\n\t\tdad[i] = 0;\n\t}\n\n\tFP[0] += \"/\";\n\tfor(i=1; i < pl; ++i) {\n\t\tif(FI[i].type !== 2 /* stream */) FP[i] += \"/\";\n\t\tFPD[FP[i]] = FI[i];\n\t}\n}\n\n/* [MS-CFB] 2.6.4 */\nfunction make_find_path(FullPaths, Paths, FileIndex, files, root_name) {\n\tvar UCFullPaths = new Array(FullPaths.length);\n\tvar UCPaths = new Array(Paths.length), i;\n\tfor(i = 0; i < FullPaths.length; ++i) UCFullPaths[i] = FullPaths[i].toUpperCase().replace(chr0,'').replace(chr1,'!');\n\tfor(i = 0; i < Paths.length; ++i) UCPaths[i] = Paths[i].toUpperCase().replace(chr0,'').replace(chr1,'!');\n\treturn function find_path(path) {\n\t\tvar k;\n\t\tif(path.charCodeAt(0) === 47 /* \"/\" */) { k=true; path = root_name + path; }\n\t\telse k = path.indexOf(\"/\") !== -1;\n\t\tvar UCPath = path.toUpperCase().replace(chr0,'').replace(chr1,'!');\n\t\tvar w = k === true ? UCFullPaths.indexOf(UCPath) : UCPaths.indexOf(UCPath);\n\t\tif(w === -1) return null;\n\t\treturn k === true ? FileIndex[w] : files[Paths[w]];\n\t};\n}\n\n/** Chase down the rest of the DIFAT chain to build a comprehensive list\n    DIFAT chains by storing the next sector number as the last 32 bytes */\nfunction sleuth_fat(idx, cnt, sectors, ssz, fat_addrs) {\n\tvar q;\n\tif(idx === ENDOFCHAIN) {\n\t\tif(cnt !== 0) throw \"DIFAT chain shorter than expected\";\n\t} else if(idx !== -1 /*FREESECT*/) {\n\t\tvar sector = sectors[idx], m = (ssz>>>2)-1;\n\t\tif(!sector) return;\n\t\tfor(var i = 0; i < m; ++i) {\n\t\t\tif((q = __readInt32LE(sector,i*4)) === ENDOFCHAIN) break;\n\t\t\tfat_addrs.push(q);\n\t\t}\n\t\tsleuth_fat(__readInt32LE(sector,ssz-4),cnt - 1, sectors, ssz, fat_addrs);\n\t}\n}\n\n/** Follow the linked list of sectors for a given starting point */\nfunction get_sector_list(sectors, start, fat_addrs, ssz, chkd) {\n\tvar sl = sectors.length;\n\tvar buf, buf_chain;\n\tif(!chkd) chkd = new Array(sl);\n\tvar modulus = ssz - 1, j, jj;\n\tbuf = [];\n\tbuf_chain = [];\n\tfor(j=start; j>=0;) {\n\t\tchkd[j] = true;\n\t\tbuf[buf.length] = j;\n\t\tbuf_chain.push(sectors[j]);\n\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\tjj = ((j*4) & modulus);\n\t\tif(ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \"+ssz;\n\t\tif(!sectors[addr]) break;\n\t\tj = __readInt32LE(sectors[addr], jj);\n\t}\n\treturn {nodes: buf, data:__toBuffer([buf_chain])};\n}\n\n/** Chase down the sector linked lists */\nfunction make_sector_list(sectors, dir_start, fat_addrs, ssz) {\n\tvar sl = sectors.length, sector_list = new Array(sl);\n\tvar chkd = new Array(sl), buf, buf_chain;\n\tvar modulus = ssz - 1, i, j, k, jj;\n\tfor(i=0; i < sl; ++i) {\n\t\tbuf = [];\n\t\tk = (i + dir_start); if(k >= sl) k-=sl;\n\t\tif(chkd[k] === true) continue;\n\t\tbuf_chain = [];\n\t\tfor(j=k; j>=0;) {\n\t\t\tchkd[j] = true;\n\t\t\tbuf[buf.length] = j;\n\t\t\tbuf_chain.push(sectors[j]);\n\t\t\tvar addr = fat_addrs[Math.floor(j*4/ssz)];\n\t\t\tjj = ((j*4) & modulus);\n\t\t\tif(ssz < 4 + jj) throw \"FAT boundary crossed: \" + j + \" 4 \"+ssz;\n\t\t\tif(!sectors[addr]) break;\n\t\t\tj = __readInt32LE(sectors[addr], jj);\n\t\t}\n\t\tsector_list[k] = {nodes: buf, data:__toBuffer([buf_chain])};\n\t}\n\treturn sector_list;\n}\n\n/* [MS-CFB] 2.6.1 Compound File Directory Entry */\nfunction read_directory(dir_start, sector_list, sectors, Paths, nmfs, files, FileIndex) {\n\tvar blob;\n\tvar minifat_store = 0, pl = (Paths.length?2:0);\n\tvar sector = sector_list[dir_start].data;\n\tvar i = 0, namelen = 0, name, o, ctime, mtime;\n\tfor(; i < sector.length; i+= 128) {\n\t\tblob = sector.slice(i, i+128);\n\t\tprep_blob(blob, 64);\n\t\tnamelen = blob.read_shift(2);\n\t\tif(namelen === 0) continue;\n\t\tname = __utf16le(blob,0,namelen-pl);\n\t\tPaths.push(name);\n\t\to = ({\n\t\t\tname:  name,\n\t\t\ttype:  blob.read_shift(1),\n\t\t\tcolor: blob.read_shift(1),\n\t\t\tL:     blob.read_shift(4, 'i'),\n\t\t\tR:     blob.read_shift(4, 'i'),\n\t\t\tC:     blob.read_shift(4, 'i'),\n\t\t\tclsid: blob.read_shift(16),\n\t\t\tstate: blob.read_shift(4, 'i')\n\t\t});\n\t\tctime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(ctime !== 0) {\n\t\t\to.ctime = ctime; o.ct = read_date(blob, blob.l-8);\n\t\t}\n\t\tmtime = blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2) + blob.read_shift(2);\n\t\tif(mtime !== 0) {\n\t\t\to.mtime = mtime; o.mt = read_date(blob, blob.l-8);\n\t\t}\n\t\to.start = blob.read_shift(4, 'i');\n\t\to.size = blob.read_shift(4, 'i');\n\t\tif(o.type === 5) { /* root */\n\t\t\tminifat_store = o.start;\n\t\t\tif(nmfs > 0 && minifat_store !== ENDOFCHAIN) sector_list[minifat_store].name = \"!StreamData\";\n\t\t\t/*minifat_size = o.size;*/\n\t\t} else if(o.size >= 4096 /* MSCSZ */) {\n\t\t\to.storage = 'fat';\n\t\t\tif(sector_list[o.start] === undefined) sector_list[o.start] = get_sector_list(sectors, o.start, sector_list.fat_addrs, sector_list.ssz);\n\t\t\tsector_list[o.start].name = o.name;\n\t\t\to.content = sector_list[o.start].data.slice(0,o.size);\n\t\t\tprep_blob(o.content, 0);\n\t\t} else {\n\t\t\to.storage = 'minifat';\n\t\t\tif(minifat_store !== ENDOFCHAIN && o.start !== ENDOFCHAIN) {\n\t\t\t\to.content = sector_list[minifat_store].data.slice(o.start*MSSZ,o.start*MSSZ+o.size);\n\t\t\t\tprep_blob(o.content, 0);\n\t\t\t}\n\t\t}\n\t\tfiles[name] = o;\n\t\tFileIndex.push(o);\n\t}\n}\n\nfunction read_date(blob, offset) {\n\treturn new Date(( ( (__readUInt32LE(blob,offset+4)/1e7)*Math.pow(2,32)+__readUInt32LE(blob,offset)/1e7 ) - 11644473600)*1000);\n}\n\nvar fs;\nfunction readFileSync(filename, options) {\n\tif(fs === undefined) fs = require('fs');\n\treturn parse(fs.readFileSync(filename), options);\n}\n\nfunction readSync(blob, options) {\n\tswitch(options !== undefined && options.type !== undefined ? options.type : \"base64\") {\n\t\tcase \"file\": return readFileSync(blob, options);\n\t\tcase \"base64\": return parse(s2a(Base64.decode(blob)), options);\n\t\tcase \"binary\": return parse(s2a(blob), options);\n\t}\n\treturn parse(blob);\n}\n\n/** CFB Constants */\nvar MSSZ = 64; /* Mini Sector Size = 1<<6 */\n//var MSCSZ = 4096; /* Mini Stream Cutoff Size */\n/* 2.1 Compound File Sector Numbers and Types */\nvar ENDOFCHAIN = -2;\n/* 2.2 Compound File Header */\nvar HEADER_SIGNATURE = 'd0cf11e0a1b11ae1';\nvar HEADER_CLSID = '00000000000000000000000000000000';\nvar consts = {\n\t/* 2.1 Compund File Sector Numbers and Types */\n\tMAXREGSECT: -6,\n\tDIFSECT: -4,\n\tFATSECT: -3,\n\tENDOFCHAIN: ENDOFCHAIN,\n\tFREESECT: -1,\n\t/* 2.2 Compound File Header */\n\tHEADER_SIGNATURE: HEADER_SIGNATURE,\n\tHEADER_MINOR_VERSION: '3e00',\n\tMAXREGSID: -6,\n\tNOSTREAM: -1,\n\tHEADER_CLSID: HEADER_CLSID,\n\t/* 2.6.1 Compound File Directory Entry */\n\tEntryTypes: ['unknown','storage','stream','lockbytes','property','root']\n};\n\nexports.read = readSync;\nexports.parse = parse;\nexports.utils = {\n\tReadShift: ReadShift,\n\tCheckField: CheckField,\n\tprep_blob: prep_blob,\n\tbconcat: bconcat,\n\tconsts: consts\n};\n\nreturn exports;\n})();\n\nif(typeof require !== 'undefined' && typeof module !== 'undefined' && typeof DO_NOT_EXPORT_CFB === 'undefined') { module.exports = CFB; }\nfunction dup(o) {\n\tif(typeof JSON != 'undefined') return JSON.parse(JSON.stringify(o));\n\tif(typeof o != 'object' || !o) return o;\n\tvar out = {};\n\tfor(var k in o) if(o.hasOwnProperty(k)) out[k] = dup(o[k]);\n\treturn out;\n}\n\nfunction fill(c,l) { var o = \"\"; while(o.length < l) o+=c; return o; }\n\n/* sections refer to MS-XLS unless otherwise stated */\n\n/* --- Simple Utilities --- */\nfunction parsenoop(blob, length) { blob.read_shift(length); return; }\nfunction parsenoop2(blob, length) { blob.read_shift(length); return null; }\n\nfunction parslurp(blob, length, cb) {\n\tvar arr = [], target = blob.l + length;\n\twhile(blob.l < target) arr.push(cb(blob, target - blob.l));\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\n\treturn arr;\n}\n\nfunction parslurp2(blob, length, cb) {\n\tvar arr = [], target = blob.l + length, len = blob.read_shift(2);\n\twhile(len-- !== 0) arr.push(cb(blob, target - blob.l));\n\tif(target !== blob.l) throw new Error(\"Slurp error\");\n\treturn arr;\n}\n\nfunction parsebool(blob, length) { return blob.read_shift(length) === 0x1; }\n\nfunction parseuint16(blob) { return blob.read_shift(2, 'u'); }\nfunction parseuint16a(blob, length) { return parslurp(blob,length,parseuint16);}\n\n/* --- 2.5 Structures --- */\n\n/* [MS-XLS] 2.5.14 Boolean */\nvar parse_Boolean = parsebool;\n\n/* [MS-XLS] 2.5.10 Bes (boolean or error) */\nfunction parse_Bes(blob) {\n\tvar v = blob.read_shift(1), t = blob.read_shift(1);\n\treturn t === 0x01 ? v : v === 0x01;\n}\n\n/* [MS-XLS] 2.5.240 ShortXLUnicodeString */\nfunction parse_ShortXLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(1);\n\tvar width = 1, encoding = 'sbcs-cont';\n\tvar cp = current_codepage;\n\tif(opts && opts.biff >= 8) current_codepage = 1200;\n\tif(!opts || opts.biff == 8 ) {\n\t\tvar fHighByte = blob.read_shift(1);\n\t\tif(fHighByte) { width = 2; encoding = 'dbcs-cont'; }\n\t}\n\tvar o = cch ? blob.read_shift(cch, encoding) : \"\";\n\tcurrent_codepage = cp;\n\treturn o;\n}\n\n/* 2.5.293 XLUnicodeRichExtendedString */\nfunction parse_XLUnicodeRichExtendedString(blob) {\n\tvar cp = current_codepage;\n\tcurrent_codepage = 1200;\n\tvar cch = blob.read_shift(2), flags = blob.read_shift(1);\n\tvar fHighByte = flags & 0x1, fExtSt = flags & 0x4, fRichSt = flags & 0x8;\n\tvar width = 1 + (flags & 0x1); // 0x0 -> utf8, 0x1 -> dbcs\n\tvar cRun = 0, cbExtRst;\n\tvar z = {};\n\tif(fRichSt) cRun = blob.read_shift(2);\n\tif(fExtSt) cbExtRst = blob.read_shift(4);\n\tvar encoding = (flags & 0x1) ? 'dbcs-cont' : 'sbcs-cont';\n\tvar msg = cch === 0 ? \"\" : blob.read_shift(cch, encoding);\n\tif(fRichSt) blob.l += 4 * cRun; //TODO: parse this\n\tif(fExtSt) blob.l += cbExtRst; //TODO: parse this\n\tz.t = msg;\n\tif(!fRichSt) { z.raw = \"<t>\" + z.t + \"</t>\"; z.r = z.t; }\n\tcurrent_codepage = cp;\n\treturn z;\n}\n\n/* 2.5.296 XLUnicodeStringNoCch */\nfunction parse_XLUnicodeStringNoCch(blob, cch, opts) {\n\tvar retval;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return blob.read_shift(cch, 'sbcs-cont');\n\t}\n\tvar fHighByte = blob.read_shift(1);\n\tif(fHighByte===0) { retval = blob.read_shift(cch, 'sbcs-cont'); }\n\telse { retval = blob.read_shift(cch, 'dbcs-cont'); }\n\treturn retval;\n}\n\n/* 2.5.294 XLUnicodeString */\nfunction parse_XLUnicodeString(blob, length, opts) {\n\tvar cch = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn parse_XLUnicodeStringNoCch(blob, cch, opts);\n}\n/* BIFF5 override */\nfunction parse_XLUnicodeString2(blob, length, opts) {\n\tif(opts.biff > 5) return parse_XLUnicodeString(blob, length, opts);\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, 'sbcs-cont');\n}\n\n/* 2.5.342 Xnum */\nfunction parse_Xnum(blob) { return blob.read_shift(8, 'f'); }\n\n/* 2.5.61 ControlInfo */\nvar parse_ControlInfo = parsenoop;\n\n/* [MS-OSHARED] 2.3.7.6 URLMoniker TODO: flags */\nvar parse_URLMoniker = function(blob, length) {\n\tvar len = blob.read_shift(4), start = blob.l;\n\tvar extra = false;\n\tif(len > 24) {\n\t\t/* look ahead */\n\t\tblob.l += len - 24;\n\t\tif(blob.read_shift(16) === \"795881f43b1d7f48af2c825dc4852763\") extra = true;\n\t\tblob.l = start;\n\t}\n\tvar url = blob.read_shift((extra?len-24:len)>>1, 'utf16le').replace(chr0,\"\");\n\tif(extra) blob.l += 24;\n\treturn url;\n};\n\n/* [MS-OSHARED] 2.3.7.8 FileMoniker TODO: all fields */\nvar parse_FileMoniker = function(blob, length) {\n\tvar cAnti = blob.read_shift(2);\n\tvar ansiLength = blob.read_shift(4);\n\tvar ansiPath = blob.read_shift(ansiLength, 'cstr');\n\tvar endServer = blob.read_shift(2);\n\tvar versionNumber = blob.read_shift(2);\n\tvar cbUnicodePathSize = blob.read_shift(4);\n\tif(cbUnicodePathSize === 0) return ansiPath.replace(/\\\\/g,\"/\");\n\tvar cbUnicodePathBytes = blob.read_shift(4);\n\tvar usKeyValue = blob.read_shift(2);\n\tvar unicodePath = blob.read_shift(cbUnicodePathBytes>>1, 'utf16le').replace(chr0,\"\");\n\treturn unicodePath;\n};\n\n/* [MS-OSHARED] 2.3.7.2 HyperlinkMoniker TODO: all the monikers */\nvar parse_HyperlinkMoniker = function(blob, length) {\n\tvar clsid = blob.read_shift(16); length -= 16;\n\tswitch(clsid) {\n\t\tcase \"e0c9ea79f9bace118c8200aa004ba90b\": return parse_URLMoniker(blob, length);\n\t\tcase \"0303000000000000c000000000000046\": return parse_FileMoniker(blob, length);\n\t\tdefault: throw \"unsupported moniker \" + clsid;\n\t}\n};\n\n/* [MS-OSHARED] 2.3.7.9 HyperlinkString */\nvar parse_HyperlinkString = function(blob, length) {\n\tvar len = blob.read_shift(4);\n\tvar o = blob.read_shift(len, 'utf16le').replace(chr0, \"\");\n\treturn o;\n};\n\n/* [MS-OSHARED] 2.3.7.1 Hyperlink Object TODO: unify params with XLSX */\nvar parse_Hyperlink = function(blob, length) {\n\tvar end = blob.l + length;\n\tvar sVer = blob.read_shift(4);\n\tif(sVer !== 2) throw new Error(\"Unrecognized streamVersion: \" + sVer);\n\tvar flags = blob.read_shift(2);\n\tblob.l += 2;\n\tvar displayName, targetFrameName, moniker, oleMoniker, location, guid, fileTime;\n\tif(flags & 0x0010) displayName = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0080) targetFrameName = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0101) moniker = parse_HyperlinkString(blob, end - blob.l);\n\tif((flags & 0x0101) === 0x0001) oleMoniker = parse_HyperlinkMoniker(blob, end - blob.l);\n\tif(flags & 0x0008) location = parse_HyperlinkString(blob, end - blob.l);\n\tif(flags & 0x0020) guid = blob.read_shift(16);\n\tif(flags & 0x0040) fileTime = parse_FILETIME(blob, 8);\n\tblob.l = end;\n\tvar target = (targetFrameName||moniker||oleMoniker);\n\tif(location) target+=\"#\"+location;\n\treturn {Target: target};\n};\n\n/* 2.5.178 LongRGBA */\nfunction parse_LongRGBA(blob, length) { var r = blob.read_shift(1), g = blob.read_shift(1), b = blob.read_shift(1), a = blob.read_shift(1); return [r,g,b,a]; }\n\n/* 2.5.177 LongRGB */\nfunction parse_LongRGB(blob, length) { var x = parse_LongRGBA(blob, length); x[3] = 0; return x; }\nfunction shift_cell(cell, tgt) {\n\tvar out = dup(cell);\n\tif(tgt.s) {\n\t\tif(out.cRel) out.c += tgt.s.c;\n\t\tif(out.rRel) out.r += tgt.s.r;\n\t} else {\n\t\tout.c += tgt.c;\n\t\tout.r += tgt.r;\n\t}\n\twhile(out.c >= 0x100) out.c -= 0x100;\n\twhile(out.r >= 0x10000) out.r -= 0x10000;\n\treturn out;\n}\n\nfunction shift_range(cell, range) {\n\tcell.s = shift_cell(cell.s, range.s);\n\tcell.e = shift_cell(cell.e, range.s);\n\treturn cell;\n}\n\nfunction encode_cell_xls(c) {\n\tvar s = encode_cell(c);\n\tif(c.cRel === 0) s = fix_col(s);\n\tif(c.rRel === 0) s = fix_row(s);\n\treturn s;\n}\n\nfunction encode_range_xls(r) {\n\treturn encode_cell_xls(r.s) + \":\" + encode_cell_xls(r.e);\n}\n/* 2.5.217 */\nfunction parse_RkNumber(data) {\n\tvar b = data.slice(data.l, data.l+4);\n\tvar fX100 = b[0] & 1, fInt = b[0] & 2;\n\tdata.l+=4;\n\tb[0] &= 0xFC;\n\tvar RK = fInt === 0 ? __double([0,0,0,0,b[0],b[1],b[2],b[3]],0) : __readInt32LE(b,0)>>2;\n\treturn fX100 ? RK/100 : RK;\n}\n\n/* 2.5.198.2 */\nvar BErr = {\n\t0x00: \"#NULL!\",\n\t0x07: \"#DIV/0!\",\n\t0x0F: \"#VALUE!\",\n\t0x17: \"#REF!\",\n\t0x1D: \"#NAME?\",\n\t0x24: \"#NUM!\",\n\t0x2A: \"#N/A\",\n\t0x2B: \"#GETTING_DATA\", /* Noted in 2.5.10 but not in 2.5.198.2 */\n\t0xFF: \"#WTF?\"\n};\nvar RBErr = evert(BErr);\n\n/* [MS-OLEPS] v20130118 */\n/* [MS-OSHARED] v20130211 */\n\n/* [MS-OLEPS] 2.2 PropertyType */\n{\n\tvar VT_EMPTY    = 0x0000;\n\tvar VT_NULL     = 0x0001;\n\tvar VT_I2       = 0x0002;\n\tvar VT_I4       = 0x0003;\n\tvar VT_R4       = 0x0004;\n\tvar VT_R8       = 0x0005;\n\tvar VT_CY       = 0x0006;\n\tvar VT_DATE     = 0x0007;\n\tvar VT_BSTR     = 0x0008;\n\tvar VT_ERROR    = 0x000A;\n\tvar VT_BOOL     = 0x000B;\n\tvar VT_VARIANT  = 0x000C;\n\tvar VT_DECIMAL  = 0x000E;\n\tvar VT_I1       = 0x0010;\n\tvar VT_UI1      = 0x0011;\n\tvar VT_UI2      = 0x0012;\n\tvar VT_UI4      = 0x0013;\n\tvar VT_I8       = 0x0014;\n\tvar VT_UI8      = 0x0015;\n\tvar VT_INT      = 0x0016;\n\tvar VT_UINT     = 0x0017;\n\tvar VT_LPSTR    = 0x001E;\n\tvar VT_LPWSTR   = 0x001F;\n\tvar VT_FILETIME = 0x0040;\n\tvar VT_BLOB     = 0x0041;\n\tvar VT_STREAM   = 0x0042;\n\tvar VT_STORAGE  = 0x0043;\n\tvar VT_STREAMED_Object  = 0x0044;\n\tvar VT_STORED_Object    = 0x0045;\n\tvar VT_BLOB_Object      = 0x0046;\n\tvar VT_CF       = 0x0047;\n\tvar VT_CLSID    = 0x0048;\n\tvar VT_VERSIONED_STREAM = 0x0049;\n\tvar VT_VECTOR   = 0x1000;\n\tvar VT_ARRAY    = 0x2000;\n\n\tvar VT_STRING   = 0x0050; // 2.3.3.1.11 VtString\n\tvar VT_USTR     = 0x0051; // 2.3.3.1.12 VtUnalignedString\n\tvar VT_CUSTOM   = [VT_STRING, VT_USTR];\n}\n\n/* [MS-OSHARED] 2.3.3.2.2.1 Document Summary Information PIDDSI */\nvar DocSummaryPIDDSI = {\n\t0x01: { n: 'CodePage', t: VT_I2 },\n\t0x02: { n: 'Category', t: VT_STRING },\n\t0x03: { n: 'PresentationFormat', t: VT_STRING },\n\t0x04: { n: 'ByteCount', t: VT_I4 },\n\t0x05: { n: 'LineCount', t: VT_I4 },\n\t0x06: { n: 'ParagraphCount', t: VT_I4 },\n\t0x07: { n: 'SlideCount', t: VT_I4 },\n\t0x08: { n: 'NoteCount', t: VT_I4 },\n\t0x09: { n: 'HiddenCount', t: VT_I4 },\n\t0x0a: { n: 'MultimediaClipCount', t: VT_I4 },\n\t0x0b: { n: 'Scale', t: VT_BOOL },\n\t0x0c: { n: 'HeadingPair', t: VT_VECTOR | VT_VARIANT },\n\t0x0d: { n: 'DocParts', t: VT_VECTOR | VT_LPSTR },\n\t0x0e: { n: 'Manager', t: VT_STRING },\n\t0x0f: { n: 'Company', t: VT_STRING },\n\t0x10: { n: 'LinksDirty', t: VT_BOOL },\n\t0x11: { n: 'CharacterCount', t: VT_I4 },\n\t0x13: { n: 'SharedDoc', t: VT_BOOL },\n\t0x16: { n: 'HLinksChanged', t: VT_BOOL },\n\t0x17: { n: 'AppVersion', t: VT_I4, p: 'version' },\n\t0x1A: { n: 'ContentType', t: VT_STRING },\n\t0x1B: { n: 'ContentStatus', t: VT_STRING },\n\t0x1C: { n: 'Language', t: VT_STRING },\n\t0x1D: { n: 'Version', t: VT_STRING },\n\t0xFF: {}\n};\n\n/* [MS-OSHARED] 2.3.3.2.1.1 Summary Information Property Set PIDSI */\nvar SummaryPIDSI = {\n\t0x01: { n: 'CodePage', t: VT_I2 },\n\t0x02: { n: 'Title', t: VT_STRING },\n\t0x03: { n: 'Subject', t: VT_STRING },\n\t0x04: { n: 'Author', t: VT_STRING },\n\t0x05: { n: 'Keywords', t: VT_STRING },\n\t0x06: { n: 'Comments', t: VT_STRING },\n\t0x07: { n: 'Template', t: VT_STRING },\n\t0x08: { n: 'LastAuthor', t: VT_STRING },\n\t0x09: { n: 'RevNumber', t: VT_STRING },\n\t0x0A: { n: 'EditTime', t: VT_FILETIME },\n\t0x0B: { n: 'LastPrinted', t: VT_FILETIME },\n\t0x0C: { n: 'CreatedDate', t: VT_FILETIME },\n\t0x0D: { n: 'ModifiedDate', t: VT_FILETIME },\n\t0x0E: { n: 'PageCount', t: VT_I4 },\n\t0x0F: { n: 'WordCount', t: VT_I4 },\n\t0x10: { n: 'CharCount', t: VT_I4 },\n\t0x11: { n: 'Thumbnail', t: VT_CF },\n\t0x12: { n: 'ApplicationName', t: VT_LPSTR },\n\t0x13: { n: 'DocumentSecurity', t: VT_I4 },\n\t0xFF: {}\n};\n\n/* [MS-OLEPS] 2.18 */\nvar SpecialProperties = {\n\t0x80000000: { n: 'Locale', t: VT_UI4 },\n\t0x80000003: { n: 'Behavior', t: VT_UI4 },\n\t0x69696969: {}\n};\n\n(function() {\n\tfor(var y in SpecialProperties) if(SpecialProperties.hasOwnProperty(y))\n\tDocSummaryPIDDSI[y] = SummaryPIDSI[y] = SpecialProperties[y];\n})();\n\n/* 2.5.127 */\nvar FillPattern = [\n\tnull,\n\t'solid',\n\t'mediumGray',\n\t'darkGray',\n\t'lightGray',\n\t'darkHorizontal',\n\t'darkVertical',\n\t'darkDown',\n\t'darkUp',\n\t'darkGrid',\n\t'darkTrellis',\n\t'lightHorizontal',\n\t'lightVertical',\n\t'lightDown',\n\t'lightUp',\n\t'lightGrid',\n\t'lightTrellis',\n\t'gray125',\n\t'gray0625'\n];\n\nfunction rgbify(arr) { return arr.map(function(x) { return [(x>>16)&255,(x>>8)&255,x&255]; }); }\n\n/* 2.5.161 */\nvar Icv = rgbify([\n\t/* Color Constants */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t/* Defaults */\n\t0x000000,\n\t0xFFFFFF,\n\t0xFF0000,\n\t0x00FF00,\n\t0x0000FF,\n\t0xFFFF00,\n\t0xFF00FF,\n\t0x00FFFF,\n\n\t0x800000,\n\t0x008000,\n\t0x000080,\n\t0x808000,\n\t0x800080,\n\t0x008080,\n\t0xC0C0C0,\n\t0x808080,\n\t0x9999FF,\n\t0x993366,\n\t0xFFFFCC,\n\t0xCCFFFF,\n\t0x660066,\n\t0xFF8080,\n\t0x0066CC,\n\t0xCCCCFF,\n\n\t0x000080,\n\t0xFF00FF,\n\t0xFFFF00,\n\t0x00FFFF,\n\t0x800080,\n\t0x800000,\n\t0x008080,\n\t0x0000FF,\n\t0x00CCFF,\n\t0xCCFFFF,\n\t0xCCFFCC,\n\t0xFFFF99,\n\t0x99CCFF,\n\t0xFF99CC,\n\t0xCC99FF,\n\t0xFFCC99,\n\n\t0x3366FF,\n\t0x33CCCC,\n\t0x99CC00,\n\t0xFFCC00,\n\t0xFF9900,\n\t0xFF6600,\n\t0x666699,\n\t0x969696,\n\t0x003366,\n\t0x339966,\n\t0x003300,\n\t0x333300,\n\t0x993300,\n\t0x993366,\n\t0x333399,\n\t0x333333,\n\n\t/* Sheet */\n\t0xFFFFFF,\n\t0x000000\n]);\nfunction isval(x) { return x !== undefined && x !== null; }\n\nfunction keys(o) { return Object.keys(o); }\n\nfunction evert(obj, arr) {\n\tvar o = {};\n\tvar K = keys(obj);\n\tfor(var i = 0; i < K.length; ++i) {\n\t\tvar k = K[i];\n\t\tif(!arr) o[obj[k]] = k;\n\t\telse (o[obj[k]]=o[obj[k]]||[]).push(k);\n\t}\n\treturn o;\n}\n\nfunction rgb2Hex(rgb) {\n\tfor(var i=0,o=1; i!=3; ++i) o = o*256 + (rgb[i]>255?255:rgb[i]<0?0:rgb[i]);\n\treturn o.toString(16).toUpperCase().substr(1);\n}\n\n\n/* 2.5.19 */\nfunction parse_Cell(blob, length) {\n\tvar rw = blob.read_shift(2); // 0-indexed\n\tvar col = blob.read_shift(2);\n\tvar ixfe = blob.read_shift(2);\n\treturn ({r:rw, c:col, ixfe:ixfe});\n}\n\n/* 2.5.134 */\nfunction parse_frtHeader(blob) {\n\tvar rt = blob.read_shift(2);\n\tvar flags = blob.read_shift(2); // TODO: parse these flags\n\tblob.l += 8;\n\treturn {type: rt, flags: flags};\n}\n\n\n\nfunction parse_OptXLUnicodeString(blob, length, opts) { return length === 0 ? \"\" : parse_XLUnicodeString2(blob, length, opts); }\n\n/* 2.5.158 */\nvar HIDEOBJENUM = ['SHOWALL', 'SHOWPLACEHOLDER', 'HIDEALL'];\nvar parse_HideObjEnum = parseuint16;\n\n/* 2.5.344 */\nfunction parse_XTI(blob, length) {\n\tvar iSupBook = blob.read_shift(2), itabFirst = blob.read_shift(2,'i'), itabLast = blob.read_shift(2,'i');\n\treturn [iSupBook, itabFirst, itabLast];\n}\n\n/* 2.5.218 */\nfunction parse_RkRec(blob, length) {\n\tvar ixfe = blob.read_shift(2);\n\tvar RK = parse_RkNumber(blob);\n\t//console.log(\"::\", ixfe, RK,\";;\");\n\treturn [ixfe, RK];\n}\n\n/* 2.5.1 */\nfunction parse_AddinUdf(blob, length, opts) {\n\tblob.l += 4; length -= 4;\n\tvar l = blob.l + length;\n\tvar udfName = parse_ShortXLUnicodeString(blob, length, opts);\n\tvar cb = blob.read_shift(2);\n\tl -= blob.l;\n\tif(cb !== l) throw \"Malformed AddinUdf: padding = \" + l + \" != \" + cb;\n\tblob.l += cb;\n\treturn udfName;\n}\n\n/* 2.5.209 TODO: Check sizes */\nfunction parse_Ref8U(blob, length) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(2);\n\tvar colLast = blob.read_shift(2);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\n\n/* 2.5.211 */\nfunction parse_RefU(blob, length) {\n\tvar rwFirst = blob.read_shift(2);\n\tvar rwLast = blob.read_shift(2);\n\tvar colFirst = blob.read_shift(1);\n\tvar colLast = blob.read_shift(1);\n\treturn {s:{c:colFirst, r:rwFirst}, e:{c:colLast,r:rwLast}};\n}\n\n/* 2.5.207 */\nvar parse_Ref = parse_RefU;\n\n/* 2.5.143 */\nfunction parse_FtCmo(blob, length) {\n\tblob.l += 4;\n\tvar ot = blob.read_shift(2);\n\tvar id = blob.read_shift(2);\n\tvar flags = blob.read_shift(2);\n\tblob.l+=12;\n\treturn [id, ot, flags];\n}\n\n/* 2.5.149 */\nfunction parse_FtNts(blob, length) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.l += 16; // GUID TODO\n\tout.fSharedNote = blob.read_shift(2);\n\tblob.l += 4;\n\treturn out;\n}\n\n/* 2.5.142 */\nfunction parse_FtCf(blob, length) {\n\tvar out = {};\n\tblob.l += 4;\n\tblob.cf = blob.read_shift(2);\n\treturn out;\n}\n\n/* 2.5.140 - 2.5.154 and friends */\nvar FtTab = {\n\t0x15: parse_FtCmo,\n\t0x13: parsenoop,                                /* FtLbsData */\n\t0x12: function(blob, length) { blob.l += 12; }, /* FtCblsData */\n\t0x11: function(blob, length) { blob.l += 8; },  /* FtRboData */\n\t0x10: parsenoop,                                /* FtEdoData */\n\t0x0F: parsenoop,                                /* FtGboData */\n\t0x0D: parse_FtNts,                              /* FtNts */\n\t0x0C: function(blob, length) { blob.l += 24; }, /* FtSbs */\n\t0x0B: function(blob, length) { blob.l += 10; }, /* FtRbo */\n\t0x0A: function(blob, length) { blob.l += 16; }, /* FtCbls */\n\t0x09: parsenoop,                                /* FtPictFmla */\n\t0x08: function(blob, length) { blob.l += 6; },  /* FtPioGrbit */\n\t0x07: parse_FtCf,                               /* FtCf */\n\t0x06: function(blob, length) { blob.l += 6; },  /* FtGmo */\n\t0x04: parsenoop,                                /* FtMacro */\n\t0x00: function(blob, length) { blob.l += 4; }   /* FtEnding */\n};\nfunction parse_FtArray(blob, length, ot) {\n\tvar s = blob.l;\n\tvar fts = [];\n\twhile(blob.l < s + length) {\n\t\tvar ft = blob.read_shift(2);\n\t\tblob.l-=2;\n\t\ttry {\n\t\t\tfts.push(FtTab[ft](blob, s + length - blob.l));\n\t\t} catch(e) { blob.l = s + length; return fts; }\n\t}\n\tif(blob.l != s + length) blob.l = s + length; //throw \"bad Object Ft-sequence\";\n\treturn fts;\n}\n\n/* 2.5.129 */\nvar parse_FontIndex = parseuint16;\n\n/* --- 2.4 Records --- */\n\n/* 2.4.21 */\nfunction parse_BOF(blob, length) {\n\tvar o = {};\n\to.BIFFVer = blob.read_shift(2); length -= 2;\n\tswitch(o.BIFFVer) {\n\t\tcase 0x0600: /* BIFF8 */\n\t\tcase 0x0500: /* BIFF5 */\n\t\tcase 0x0002: case 0x0007: /* BIFF2 */\n\t\t\tbreak;\n\t\tdefault: if(length > 6) throw new Error(\"Unexpected BIFF Ver \" + o.BIFFVer);\n\t}\n\tblob.read_shift(length);\n\treturn o;\n}\n\n\n/* 2.4.146 */\nfunction parse_InterfaceHdr(blob, length) {\n\tif(length === 0) return 0x04b0;\n\tvar q;\n\tif((q=blob.read_shift(2))!==0x04b0) throw 'InterfaceHdr codePage ' + q;\n\treturn 0x04b0;\n}\n\n\n/* 2.4.349 */\nfunction parse_WriteAccess(blob, length, opts) {\n\tif(opts.enc) { blob.l += length; return \"\"; }\n\tvar l = blob.l;\n\t// TODO: make sure XLUnicodeString doesnt overrun\n\tvar UserName = parse_XLUnicodeString(blob, 0, opts);\n\tblob.read_shift(length + l - blob.l);\n\treturn UserName;\n}\n\n/* 2.4.28 */\nfunction parse_BoundSheet8(blob, length, opts) {\n\tvar pos = blob.read_shift(4);\n\tvar hidden = blob.read_shift(1) & 0x03;\n\tvar dt = blob.read_shift(1);\n\tswitch(dt) {\n\t\tcase 0: dt = 'Worksheet'; break;\n\t\tcase 1: dt = 'Macrosheet'; break;\n\t\tcase 2: dt = 'Chartsheet'; break;\n\t\tcase 6: dt = 'VBAModule'; break;\n\t}\n\tvar name = parse_ShortXLUnicodeString(blob, 0, opts);\n\tif(name.length === 0) name = \"Sheet1\";\n\treturn { pos:pos, hs:hidden, dt:dt, name:name };\n}\n\n/* 2.4.265 TODO */\nfunction parse_SST(blob, length) {\n\tvar cnt = blob.read_shift(4);\n\tvar ucnt = blob.read_shift(4);\n\tvar strs = [];\n\tfor(var i = 0; i != ucnt; ++i) {\n\t\tstrs.push(parse_XLUnicodeRichExtendedString(blob));\n\t}\n\tstrs.Count = cnt; strs.Unique = ucnt;\n\treturn strs;\n}\n\n/* 2.4.107 */\nfunction parse_ExtSST(blob, length) {\n\tvar extsst = {};\n\textsst.dsst = blob.read_shift(2);\n\tblob.l += length-2;\n\treturn extsst;\n}\n\n\n/* 2.4.221 TODO*/\nfunction parse_Row(blob, length) {\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2), Col = blob.read_shift(2), rht = blob.read_shift(2);\n\tblob.read_shift(4); // reserved(2), unused(2)\n\tvar flags = blob.read_shift(1); // various flags\n\tblob.read_shift(1); // reserved\n\tblob.read_shift(2); //ixfe, other flags\n\treturn {r:rw, c:col, cnt:Col-col};\n}\n\n\n/* 2.4.125 */\nfunction parse_ForceFullCalculation(blob, length) {\n\tvar header = parse_frtHeader(blob);\n\tif(header.type != 0x08A3) throw \"Invalid Future Record \" + header.type;\n\tvar fullcalc = blob.read_shift(4);\n\treturn fullcalc !== 0x0;\n}\n\n\nvar parse_CompressPictures = parsenoop2; /* 2.4.55 Not interesting */\n\n\n\n/* 2.4.215 rt */\nfunction parse_RecalcId(blob, length) {\n\tblob.read_shift(2);\n\treturn blob.read_shift(4);\n}\n\n/* 2.4.87 */\nfunction parse_DefaultRowHeight (blob, length) {\n\tvar f = length == 4 ? blob.read_shift(2) : 0, miyRw;\n\tmiyRw = blob.read_shift(2); // flags & 0x02 -> hidden, else empty\n\tvar fl = {Unsynced:f&1,DyZero:(f&2)>>1,ExAsc:(f&4)>>2,ExDsc:(f&8)>>3};\n\treturn [fl, miyRw];\n}\n\n/* 2.4.345 TODO */\nfunction parse_Window1(blob, length) {\n\tvar xWn = blob.read_shift(2), yWn = blob.read_shift(2), dxWn = blob.read_shift(2), dyWn = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), iTabCur = blob.read_shift(2), iTabFirst = blob.read_shift(2);\n\tvar ctabSel = blob.read_shift(2), wTabRatio = blob.read_shift(2);\n\treturn { Pos: [xWn, yWn], Dim: [dxWn, dyWn], Flags: flags, CurTab: iTabCur,\n\t\tFirstTab: iTabFirst, Selected: ctabSel, TabRatio: wTabRatio };\n}\n\n/* 2.4.122 TODO */\nfunction parse_Font(blob, length, opts) {\n\tblob.l += 14;\n\tvar name = parse_ShortXLUnicodeString(blob, 0, opts);\n\treturn name;\n}\n\n/* 2.4.149 */\nfunction parse_LabelSst(blob, length) {\n\tvar cell = parse_Cell(blob);\n\tcell.isst = blob.read_shift(4);\n\treturn cell;\n}\n\n/* 2.4.148 */\nfunction parse_Label(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar cell = parse_Cell(blob, 6);\n\tif(opts.biff == 2) blob.l++;\n\tvar str = parse_XLUnicodeString(blob, target - blob.l, opts);\n\tcell.val = str;\n\treturn cell;\n}\n\n/* 2.4.126 Number Formats */\nfunction parse_Format(blob, length, opts) {\n\tvar ifmt = blob.read_shift(2);\n\tvar fmtstr = parse_XLUnicodeString2(blob, 0, opts);\n\treturn [ifmt, fmtstr];\n}\nvar parse_BIFF2Format = parse_XLUnicodeString2;\n\n/* 2.4.90 */\nfunction parse_Dimensions(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar w = opts.biff == 8 || !opts.biff ? 4 : 2;\n\tvar r = blob.read_shift(w), R = blob.read_shift(w),\n\t    c = blob.read_shift(2), C = blob.read_shift(2);\n\tblob.l = end;\n\treturn {s: {r:r, c:c}, e: {r:R, c:C}};\n}\n\n/* 2.4.220 */\nfunction parse_RK(blob, length) {\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrec = parse_RkRec(blob);\n\treturn {r:rw, c:col, ixfe:rkrec[0], rknum:rkrec[1]};\n}\n\n/* 2.4.175 */\nfunction parse_MulRk(blob, length) {\n\tvar target = blob.l + length - 2;\n\tvar rw = blob.read_shift(2), col = blob.read_shift(2);\n\tvar rkrecs = [];\n\twhile(blob.l < target) rkrecs.push(parse_RkRec(blob));\n\tif(blob.l !== target) throw \"MulRK read error\";\n\tvar lastcol = blob.read_shift(2);\n\tif(rkrecs.length != lastcol - col + 1) throw \"MulRK length mismatch\";\n\treturn {r:rw, c:col, C:lastcol, rkrec:rkrecs};\n}\n\n/* 2.5.20 2.5.249 TODO */\nfunction parse_CellStyleXF(blob, length, style) {\n\tvar o = {};\n\tvar a = blob.read_shift(4), b = blob.read_shift(4);\n\tvar c = blob.read_shift(4), d = blob.read_shift(2);\n\to.patternType = FillPattern[c >> 26];\n\to.icvFore = d & 0x7F;\n\to.icvBack = (d >> 7) & 0x7F;\n\treturn o;\n}\nfunction parse_CellXF(blob, length) {return parse_CellStyleXF(blob,length,0);}\nfunction parse_StyleXF(blob, length) {return parse_CellStyleXF(blob,length,1);}\n\n/* 2.4.353 TODO: actually do this right */\nfunction parse_XF(blob, length) {\n\tvar o = {};\n\to.ifnt = blob.read_shift(2); o.ifmt = blob.read_shift(2); o.flags = blob.read_shift(2);\n\to.fStyle = (o.flags >> 2) & 0x01;\n\tlength -= 6;\n\to.data = parse_CellStyleXF(blob, length, o.fStyle);\n\treturn o;\n}\n\n/* 2.4.134 */\nfunction parse_Guts(blob, length) {\n\tblob.l += 4;\n\tvar out = [blob.read_shift(2), blob.read_shift(2)];\n\tif(out[0] !== 0) out[0]--;\n\tif(out[1] !== 0) out[1]--;\n\tif(out[0] > 7 || out[1] > 7) throw \"Bad Gutters: \" + out.join(\"|\");\n\treturn out;\n}\n\n/* 2.4.24 */\nfunction parse_BoolErr(blob, length, opts) {\n\tvar cell = parse_Cell(blob, 6);\n\tif(opts.biff == 2) ++blob.l;\n\tvar val = parse_Bes(blob, 2);\n\tcell.val = val;\n\tcell.t = (val === true || val === false) ? 'b' : 'e';\n\treturn cell;\n}\n\n/* 2.4.180 Number */\nfunction parse_Number(blob, length) {\n\tvar cell = parse_Cell(blob, 6);\n\tvar xnum = parse_Xnum(blob, 8);\n\tcell.val = xnum;\n\treturn cell;\n}\n\nvar parse_XLHeaderFooter = parse_OptXLUnicodeString; // TODO: parse 2.4.136\n\n/* 2.4.271 */\nfunction parse_SupBook(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar ctab = blob.read_shift(2);\n\tvar cch = blob.read_shift(2);\n\tvar virtPath;\n\tif(cch >=0x01 && cch <=0xff) virtPath = parse_XLUnicodeStringNoCch(blob, cch);\n\tvar rgst = blob.read_shift(end - blob.l);\n\topts.sbcch = cch;\n\treturn [cch, ctab, virtPath, rgst];\n}\n\n/* 2.4.105 TODO */\nfunction parse_ExternName(blob, length, opts) {\n\tvar flags = blob.read_shift(2);\n\tvar body;\n\tvar o = ({\n\t\tfBuiltIn: flags & 0x01,\n\t\tfWantAdvise: (flags >>> 1) & 0x01,\n\t\tfWantPict: (flags >>> 2) & 0x01,\n\t\tfOle: (flags >>> 3) & 0x01,\n\t\tfOleLink: (flags >>> 4) & 0x01,\n\t\tcf: (flags >>> 5) & 0x3FF,\n\t\tfIcon: flags >>> 15 & 0x01\n\t});\n\tif(opts.sbcch === 0x3A01) body = parse_AddinUdf(blob, length-2, opts);\n\t//else throw new Error(\"unsupported SupBook cch: \" + opts.sbcch);\n\to.body = body || blob.read_shift(length-2);\n\treturn o;\n}\n\n/* 2.4.150 TODO */\nfunction parse_Lbl(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar flags = blob.read_shift(2);\n\tvar chKey = blob.read_shift(1);\n\tvar cch = blob.read_shift(1);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tif(!opts || opts.biff >= 5) {\n\t\tblob.l += 2;\n\t\tvar itab = blob.read_shift(2);\n\t\tblob.l += 4;\n\t}\n\tvar name = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tvar npflen = target - blob.l; if(opts && opts.biff == 2) --npflen;\n\tvar rgce = target == blob.l || cce == 0 ? [] : parse_NameParsedFormula(blob, npflen, opts, cce);\n\treturn {\n\t\tchKey: chKey,\n\t\tName: name,\n\t\trgce: rgce\n\t};\n}\n\n/* 2.4.106 TODO: verify supbook manipulation */\nfunction parse_ExternSheet(blob, length, opts) {\n\tif(opts.biff < 8) return parse_ShortXLUnicodeString(blob, length, opts);\n\tvar o = parslurp2(blob,length,parse_XTI);\n\tvar oo = [];\n\tif(opts.sbcch === 0x0401) {\n\t\tfor(var i = 0; i != o.length; ++i) oo.push(opts.snames[o[i][1]]);\n\t\treturn oo;\n\t}\n\telse return o;\n}\n\n/* 2.4.260 */\nfunction parse_ShrFmla(blob, length, opts) {\n\tvar ref = parse_RefU(blob, 6);\n\tblob.l++;\n\tvar cUse = blob.read_shift(1);\n\tlength -= 8;\n\treturn [parse_SharedParsedFormula(blob, length, opts), cUse];\n}\n\n/* 2.4.4 TODO */\nfunction parse_Array(blob, length, opts) {\n\tvar ref = parse_Ref(blob, 6);\n\t/* TODO: fAlwaysCalc */\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l ++; length -= 7; break;\n\t\tcase 3: case 4: blob.l += 2; length -= 8; break;\n\t\tdefault: blob.l += 6; length -= 12;\n\t}\n\treturn [ref, parse_ArrayParsedFormula(blob, length, opts, ref)];\n}\n\n/* 2.4.173 */\nfunction parse_MTRSettings(blob, length) {\n\tvar fMTREnabled = blob.read_shift(4) !== 0x00;\n\tvar fUserSetThreadCount = blob.read_shift(4) !== 0x00;\n\tvar cUserThreadCount = blob.read_shift(4);\n\treturn [fMTREnabled, fUserSetThreadCount, cUserThreadCount];\n}\n\n/* 2.5.186 TODO: BIFF5 */\nfunction parse_NoteSh(blob, length, opts) {\n\tif(opts.biff < 8) return;\n\tvar row = blob.read_shift(2), col = blob.read_shift(2);\n\tvar flags = blob.read_shift(2), idObj = blob.read_shift(2);\n\tvar stAuthor = parse_XLUnicodeString2(blob, 0, opts);\n\tif(opts.biff < 8) blob.read_shift(1);\n\treturn [{r:row,c:col}, stAuthor, idObj, flags];\n}\n\n/* 2.4.179 */\nfunction parse_Note(blob, length, opts) {\n\t/* TODO: Support revisions */\n\treturn parse_NoteSh(blob, length, opts);\n}\n\n/* 2.4.168 */\nfunction parse_MergeCells(blob, length) {\n\tvar merges = [];\n\tvar cmcs = blob.read_shift(2);\n\twhile (cmcs--) merges.push(parse_Ref8U(blob,length));\n\treturn merges;\n}\n\n/* 2.4.181 TODO: parse all the things! */\nfunction parse_Obj(blob, length) {\n\tvar cmo = parse_FtCmo(blob, 22); // id, ot, flags\n\tvar fts = parse_FtArray(blob, length-22, cmo[1]);\n\treturn { cmo: cmo, ft:fts };\n}\n\n/* 2.4.329 TODO: parse properly */\nfunction parse_TxO(blob, length, opts) {\n\tvar s = blob.l;\n\tvar texts = \"\";\ntry {\n\tblob.l += 4;\n\tvar ot = (opts.lastobj||{cmo:[0,0]}).cmo[1];\n\tvar controlInfo;\n\tif([0,5,7,11,12,14].indexOf(ot) == -1) blob.l += 6;\n\telse controlInfo = parse_ControlInfo(blob, 6, opts);\n\tvar cchText = blob.read_shift(2);\n\tvar cbRuns = blob.read_shift(2);\n\tvar ifntEmpty = parse_FontIndex(blob, 2);\n\tvar len = blob.read_shift(2);\n\tblob.l += len;\n\t//var fmla = parse_ObjFmla(blob, s + length - blob.l);\n\n\tfor(var i = 1; i < blob.lens.length-1; ++i) {\n\t\tif(blob.l-s != blob.lens[i]) throw \"TxO: bad continue record\";\n\t\tvar hdr = blob[blob.l];\n\t\tvar t = parse_XLUnicodeStringNoCch(blob, blob.lens[i+1]-blob.lens[i]-1);\n\t\ttexts += t;\n\t\tif(texts.length >= (hdr ? cchText : 2*cchText)) break;\n\t}\n\tif(texts.length !== cchText && texts.length !== cchText*2) {\n\t\tthrow \"cchText: \" + cchText + \" != \" + texts.length;\n\t}\n\n\tblob.l = s + length;\n\t/* 2.5.272 TxORuns */\n//\tvar rgTxoRuns = [];\n//\tfor(var j = 0; j != cbRuns/8-1; ++j) blob.l += 8;\n//\tvar cchText2 = blob.read_shift(2);\n//\tif(cchText2 !== cchText) throw \"TxOLastRun mismatch: \" + cchText2 + \" \" + cchText;\n//\tblob.l += 6;\n//\tif(s + length != blob.l) throw \"TxO \" + (s + length) + \", at \" + blob.l;\n\treturn { t: texts };\n} catch(e) { blob.l = s + length; return { t: texts }; }\n}\n\n/* 2.4.140 */\nvar parse_HLink = function(blob, length) {\n\tvar ref = parse_Ref8U(blob, 8);\n\tblob.l += 16; /* CLSID */\n\tvar hlink = parse_Hyperlink(blob, length-24);\n\treturn [ref, hlink];\n};\n\n/* 2.4.141 */\nvar parse_HLinkTooltip = function(blob, length) {\n\tvar end = blob.l + length;\n\tblob.read_shift(2);\n\tvar ref = parse_Ref8U(blob, 8);\n\tvar wzTooltip = blob.read_shift((length-10)/2, 'dbcs-cont');\n\twzTooltip = wzTooltip.replace(chr0,\"\");\n\treturn [ref, wzTooltip];\n};\n\n/* 2.4.63 */\nfunction parse_Country(blob, length) {\n\tvar o = [], d;\n\td = blob.read_shift(2); o[0] = CountryEnum[d] || d;\n\td = blob.read_shift(2); o[1] = CountryEnum[d] || d;\n\treturn o;\n}\n\n/* 2.4.50 ClrtClient */\nfunction parse_ClrtClient(blob, length) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* 2.4.188 */\nfunction parse_Palette(blob, length) {\n\tvar ccv = blob.read_shift(2);\n\tvar o = [];\n\twhile(ccv-->0) o.push(parse_LongRGB(blob, 8));\n\treturn o;\n}\n\n/* 2.4.354 */\nfunction parse_XFCRC(blob, length) {\n\tblob.l += 2;\n\tvar o = {cxfs:0, crc:0};\n\to.cxfs = blob.read_shift(2);\n\to.crc = blob.read_shift(4);\n\treturn o;\n}\n\n\nvar parse_Style = parsenoop;\nvar parse_StyleExt = parsenoop;\n\nvar parse_ColInfo = parsenoop;\n\nvar parse_Window2 = parsenoop;\n\n\nvar parse_Backup = parsebool; /* 2.4.14 */\nvar parse_Blank = parse_Cell; /* 2.4.20 Just the cell */\nvar parse_BottomMargin = parse_Xnum; /* 2.4.27 */\nvar parse_BuiltInFnGroupCount = parseuint16; /* 2.4.30 0x0E or 0x10 but excel 2011 generates 0x11? */\nvar parse_CalcCount = parseuint16; /* 2.4.31 #Iterations */\nvar parse_CalcDelta = parse_Xnum; /* 2.4.32 */\nvar parse_CalcIter = parsebool;  /* 2.4.33 1=iterative calc */\nvar parse_CalcMode = parseuint16; /* 2.4.34 0=manual, 1=auto (def), 2=table */\nvar parse_CalcPrecision = parsebool; /* 2.4.35 */\nvar parse_CalcRefMode = parsenoop2; /* 2.4.36 */\nvar parse_CalcSaveRecalc = parsebool; /* 2.4.37 */\nvar parse_CodePage = parseuint16; /* 2.4.52 */\nvar parse_Compat12 = parsebool; /* 2.4.54 true = no compatibility check */\nvar parse_Date1904 = parsebool; /* 2.4.77 - 1=1904,0=1900 */\nvar parse_DefColWidth = parseuint16; /* 2.4.89 */\nvar parse_DSF = parsenoop2; /* 2.4.94 -- MUST be ignored */\nvar parse_EntExU2 = parsenoop2; /* 2.4.102 -- Explicitly says to ignore */\nvar parse_EOF = parsenoop2; /* 2.4.103 */\nvar parse_Excel9File = parsenoop2; /* 2.4.104 -- Optional and unused */\nvar parse_FeatHdr = parsenoop2; /* 2.4.112 */\nvar parse_FontX = parseuint16; /* 2.4.123 */\nvar parse_Footer = parse_XLHeaderFooter; /* 2.4.124 */\nvar parse_GridSet = parseuint16; /* 2.4.132, =1 */\nvar parse_HCenter = parsebool; /* 2.4.135 sheet centered horizontal on print */\nvar parse_Header = parse_XLHeaderFooter; /* 2.4.136 */\nvar parse_HideObj = parse_HideObjEnum; /* 2.4.139 */\nvar parse_InterfaceEnd = parsenoop2; /* 2.4.145 -- noop */\nvar parse_LeftMargin = parse_Xnum; /* 2.4.151 */\nvar parse_Mms = parsenoop2; /* 2.4.169 -- Explicitly says to ignore */\nvar parse_ObjProtect = parsebool; /* 2.4.183 -- must be 1 if present */\nvar parse_Password = parseuint16; /* 2.4.191 */\nvar parse_PrintGrid = parsebool; /* 2.4.202 */\nvar parse_PrintRowCol = parsebool; /* 2.4.203 */\nvar parse_PrintSize = parseuint16; /* 2.4.204 0:3 */\nvar parse_Prot4Rev = parsebool; /* 2.4.205 */\nvar parse_Prot4RevPass = parseuint16; /* 2.4.206 */\nvar parse_Protect = parsebool; /* 2.4.207 */\nvar parse_RefreshAll = parsebool; /* 2.4.217 -- must be 0 if not template */\nvar parse_RightMargin = parse_Xnum; /* 2.4.219 */\nvar parse_RRTabId = parseuint16a; /* 2.4.241 */\nvar parse_ScenarioProtect = parsebool; /* 2.4.245 */\nvar parse_Scl = parseuint16a; /* 2.4.247 num, den */\nvar parse_String = parse_XLUnicodeString; /* 2.4.268 */\nvar parse_SxBool = parsebool; /* 2.4.274 */\nvar parse_TopMargin = parse_Xnum; /* 2.4.328 */\nvar parse_UsesELFs = parsebool; /* 2.4.337 -- should be 0 */\nvar parse_VCenter = parsebool; /* 2.4.342 */\nvar parse_WinProtect = parsebool; /* 2.4.347 */\nvar parse_WriteProtect = parsenoop; /* 2.4.350 empty record */\n\n\n/* ---- */\nvar parse_VerticalPageBreaks = parsenoop;\nvar parse_HorizontalPageBreaks = parsenoop;\nvar parse_Selection = parsenoop;\nvar parse_Continue = parsenoop;\nvar parse_Pane = parsenoop;\nvar parse_Pls = parsenoop;\nvar parse_DCon = parsenoop;\nvar parse_DConRef = parsenoop;\nvar parse_DConName = parsenoop;\nvar parse_XCT = parsenoop;\nvar parse_CRN = parsenoop;\nvar parse_FileSharing = parsenoop;\nvar parse_Uncalced = parsenoop;\nvar parse_Template = parsenoop;\nvar parse_Intl = parsenoop;\nvar parse_WsBool = parsenoop;\nvar parse_Sort = parsenoop;\nvar parse_Sync = parsenoop;\nvar parse_LPr = parsenoop;\nvar parse_DxGCol = parsenoop;\nvar parse_FnGroupName = parsenoop;\nvar parse_FilterMode = parsenoop;\nvar parse_AutoFilterInfo = parsenoop;\nvar parse_AutoFilter = parsenoop;\nvar parse_Setup = parsenoop;\nvar parse_ScenMan = parsenoop;\nvar parse_SCENARIO = parsenoop;\nvar parse_SxView = parsenoop;\nvar parse_Sxvd = parsenoop;\nvar parse_SXVI = parsenoop;\nvar parse_SxIvd = parsenoop;\nvar parse_SXLI = parsenoop;\nvar parse_SXPI = parsenoop;\nvar parse_DocRoute = parsenoop;\nvar parse_RecipName = parsenoop;\nvar parse_MulBlank = parsenoop;\nvar parse_SXDI = parsenoop;\nvar parse_SXDB = parsenoop;\nvar parse_SXFDB = parsenoop;\nvar parse_SXDBB = parsenoop;\nvar parse_SXNum = parsenoop;\nvar parse_SxErr = parsenoop;\nvar parse_SXInt = parsenoop;\nvar parse_SXString = parsenoop;\nvar parse_SXDtr = parsenoop;\nvar parse_SxNil = parsenoop;\nvar parse_SXTbl = parsenoop;\nvar parse_SXTBRGIITM = parsenoop;\nvar parse_SxTbpg = parsenoop;\nvar parse_ObProj = parsenoop;\nvar parse_SXStreamID = parsenoop;\nvar parse_DBCell = parsenoop;\nvar parse_SXRng = parsenoop;\nvar parse_SxIsxoper = parsenoop;\nvar parse_BookBool = parsenoop;\nvar parse_DbOrParamQry = parsenoop;\nvar parse_OleObjectSize = parsenoop;\nvar parse_SXVS = parsenoop;\nvar parse_BkHim = parsenoop;\nvar parse_MsoDrawingGroup = parsenoop;\nvar parse_MsoDrawing = parsenoop;\nvar parse_MsoDrawingSelection = parsenoop;\nvar parse_PhoneticInfo = parsenoop;\nvar parse_SxRule = parsenoop;\nvar parse_SXEx = parsenoop;\nvar parse_SxFilt = parsenoop;\nvar parse_SxDXF = parsenoop;\nvar parse_SxItm = parsenoop;\nvar parse_SxName = parsenoop;\nvar parse_SxSelect = parsenoop;\nvar parse_SXPair = parsenoop;\nvar parse_SxFmla = parsenoop;\nvar parse_SxFormat = parsenoop;\nvar parse_SXVDEx = parsenoop;\nvar parse_SXFormula = parsenoop;\nvar parse_SXDBEx = parsenoop;\nvar parse_RRDInsDel = parsenoop;\nvar parse_RRDHead = parsenoop;\nvar parse_RRDChgCell = parsenoop;\nvar parse_RRDRenSheet = parsenoop;\nvar parse_RRSort = parsenoop;\nvar parse_RRDMove = parsenoop;\nvar parse_RRFormat = parsenoop;\nvar parse_RRAutoFmt = parsenoop;\nvar parse_RRInsertSh = parsenoop;\nvar parse_RRDMoveBegin = parsenoop;\nvar parse_RRDMoveEnd = parsenoop;\nvar parse_RRDInsDelBegin = parsenoop;\nvar parse_RRDInsDelEnd = parsenoop;\nvar parse_RRDConflict = parsenoop;\nvar parse_RRDDefName = parsenoop;\nvar parse_RRDRstEtxp = parsenoop;\nvar parse_LRng = parsenoop;\nvar parse_CUsr = parsenoop;\nvar parse_CbUsr = parsenoop;\nvar parse_UsrInfo = parsenoop;\nvar parse_UsrExcl = parsenoop;\nvar parse_FileLock = parsenoop;\nvar parse_RRDInfo = parsenoop;\nvar parse_BCUsrs = parsenoop;\nvar parse_UsrChk = parsenoop;\nvar parse_UserBView = parsenoop;\nvar parse_UserSViewBegin = parsenoop; // overloaded\nvar parse_UserSViewEnd = parsenoop;\nvar parse_RRDUserView = parsenoop;\nvar parse_Qsi = parsenoop;\nvar parse_CondFmt = parsenoop;\nvar parse_CF = parsenoop;\nvar parse_DVal = parsenoop;\nvar parse_DConBin = parsenoop;\nvar parse_Lel = parsenoop;\nvar parse_CodeName = parse_XLUnicodeString;\nvar parse_SXFDBType = parsenoop;\nvar parse_ObNoMacros = parsenoop;\nvar parse_Dv = parsenoop;\nvar parse_Index = parsenoop;\nvar parse_Table = parsenoop;\nvar parse_BigName = parsenoop;\nvar parse_ContinueBigName = parsenoop;\nvar parse_WebPub = parsenoop;\nvar parse_QsiSXTag = parsenoop;\nvar parse_DBQueryExt = parsenoop;\nvar parse_ExtString = parsenoop;\nvar parse_TxtQry = parsenoop;\nvar parse_Qsir = parsenoop;\nvar parse_Qsif = parsenoop;\nvar parse_RRDTQSIF = parsenoop;\nvar parse_OleDbConn = parsenoop;\nvar parse_WOpt = parsenoop;\nvar parse_SXViewEx = parsenoop;\nvar parse_SXTH = parsenoop;\nvar parse_SXPIEx = parsenoop;\nvar parse_SXVDTEx = parsenoop;\nvar parse_SXViewEx9 = parsenoop;\nvar parse_ContinueFrt = parsenoop;\nvar parse_RealTimeData = parsenoop;\nvar parse_ChartFrtInfo = parsenoop;\nvar parse_FrtWrapper = parsenoop;\nvar parse_StartBlock = parsenoop;\nvar parse_EndBlock = parsenoop;\nvar parse_StartObject = parsenoop;\nvar parse_EndObject = parsenoop;\nvar parse_CatLab = parsenoop;\nvar parse_YMult = parsenoop;\nvar parse_SXViewLink = parsenoop;\nvar parse_PivotChartBits = parsenoop;\nvar parse_FrtFontList = parsenoop;\nvar parse_SheetExt = parsenoop;\nvar parse_BookExt = parsenoop;\nvar parse_SXAddl = parsenoop;\nvar parse_CrErr = parsenoop;\nvar parse_HFPicture = parsenoop;\nvar parse_Feat = parsenoop;\nvar parse_DataLabExt = parsenoop;\nvar parse_DataLabExtContents = parsenoop;\nvar parse_CellWatch = parsenoop;\nvar parse_FeatHdr11 = parsenoop;\nvar parse_Feature11 = parsenoop;\nvar parse_DropDownObjIds = parsenoop;\nvar parse_ContinueFrt11 = parsenoop;\nvar parse_DConn = parsenoop;\nvar parse_List12 = parsenoop;\nvar parse_Feature12 = parsenoop;\nvar parse_CondFmt12 = parsenoop;\nvar parse_CF12 = parsenoop;\nvar parse_CFEx = parsenoop;\nvar parse_AutoFilter12 = parsenoop;\nvar parse_ContinueFrt12 = parsenoop;\nvar parse_MDTInfo = parsenoop;\nvar parse_MDXStr = parsenoop;\nvar parse_MDXTuple = parsenoop;\nvar parse_MDXSet = parsenoop;\nvar parse_MDXProp = parsenoop;\nvar parse_MDXKPI = parsenoop;\nvar parse_MDB = parsenoop;\nvar parse_PLV = parsenoop;\nvar parse_DXF = parsenoop;\nvar parse_TableStyles = parsenoop;\nvar parse_TableStyle = parsenoop;\nvar parse_TableStyleElement = parsenoop;\nvar parse_NamePublish = parsenoop;\nvar parse_NameCmt = parsenoop;\nvar parse_SortData = parsenoop;\nvar parse_GUIDTypeLib = parsenoop;\nvar parse_FnGrp12 = parsenoop;\nvar parse_NameFnGrp12 = parsenoop;\nvar parse_HeaderFooter = parsenoop;\nvar parse_CrtLayout12 = parsenoop;\nvar parse_CrtMlFrt = parsenoop;\nvar parse_CrtMlFrtContinue = parsenoop;\nvar parse_ShapePropsStream = parsenoop;\nvar parse_TextPropsStream = parsenoop;\nvar parse_RichTextStream = parsenoop;\nvar parse_CrtLayout12A = parsenoop;\nvar parse_Units = parsenoop;\nvar parse_Chart = parsenoop;\nvar parse_Series = parsenoop;\nvar parse_DataFormat = parsenoop;\nvar parse_LineFormat = parsenoop;\nvar parse_MarkerFormat = parsenoop;\nvar parse_AreaFormat = parsenoop;\nvar parse_PieFormat = parsenoop;\nvar parse_AttachedLabel = parsenoop;\nvar parse_SeriesText = parsenoop;\nvar parse_ChartFormat = parsenoop;\nvar parse_Legend = parsenoop;\nvar parse_SeriesList = parsenoop;\nvar parse_Bar = parsenoop;\nvar parse_Line = parsenoop;\nvar parse_Pie = parsenoop;\nvar parse_Area = parsenoop;\nvar parse_Scatter = parsenoop;\nvar parse_CrtLine = parsenoop;\nvar parse_Axis = parsenoop;\nvar parse_Tick = parsenoop;\nvar parse_ValueRange = parsenoop;\nvar parse_CatSerRange = parsenoop;\nvar parse_AxisLine = parsenoop;\nvar parse_CrtLink = parsenoop;\nvar parse_DefaultText = parsenoop;\nvar parse_Text = parsenoop;\nvar parse_ObjectLink = parsenoop;\nvar parse_Frame = parsenoop;\nvar parse_Begin = parsenoop;\nvar parse_End = parsenoop;\nvar parse_PlotArea = parsenoop;\nvar parse_Chart3d = parsenoop;\nvar parse_PicF = parsenoop;\nvar parse_DropBar = parsenoop;\nvar parse_Radar = parsenoop;\nvar parse_Surf = parsenoop;\nvar parse_RadarArea = parsenoop;\nvar parse_AxisParent = parsenoop;\nvar parse_LegendException = parsenoop;\nvar parse_ShtProps = parsenoop;\nvar parse_SerToCrt = parsenoop;\nvar parse_AxesUsed = parsenoop;\nvar parse_SBaseRef = parsenoop;\nvar parse_SerParent = parsenoop;\nvar parse_SerAuxTrend = parsenoop;\nvar parse_IFmtRecord = parsenoop;\nvar parse_Pos = parsenoop;\nvar parse_AlRuns = parsenoop;\nvar parse_BRAI = parsenoop;\nvar parse_SerAuxErrBar = parsenoop;\nvar parse_SerFmt = parsenoop;\nvar parse_Chart3DBarShape = parsenoop;\nvar parse_Fbi = parsenoop;\nvar parse_BopPop = parsenoop;\nvar parse_AxcExt = parsenoop;\nvar parse_Dat = parsenoop;\nvar parse_PlotGrowth = parsenoop;\nvar parse_SIIndex = parsenoop;\nvar parse_GelFrame = parsenoop;\nvar parse_BopPopCustom = parsenoop;\nvar parse_Fbi2 = parsenoop;\n\n/* --- Specific to versions before BIFF8 --- */\nfunction parse_BIFF5String(blob) {\n\tvar len = blob.read_shift(1);\n\treturn blob.read_shift(len, 'sbcs-cont');\n}\n\n/* BIFF2_??? where ??? is the name from [XLS] */\nfunction parse_BIFF2STR(blob, length, opts) {\n\tvar cell = parse_Cell(blob, 6);\n\t++blob.l;\n\tvar str = parse_XLUnicodeString2(blob, length-7, opts);\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\n\nfunction parse_BIFF2NUM(blob, length, opts) {\n\tvar cell = parse_Cell(blob, 6);\n\t++blob.l;\n\tvar num = parse_Xnum(blob, 8);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\n\nfunction parse_BIFF2INT(blob, length) {\n\tvar cell = parse_Cell(blob, 6);\n\t++blob.l;\n\tvar num = blob.read_shift(2);\n\tcell.t = 'n';\n\tcell.val = num;\n\treturn cell;\n}\n\nfunction parse_BIFF2STRING(blob, length) {\n\tvar cch = blob.read_shift(1);\n\tif(cch === 0) { blob.l++; return \"\"; }\n\treturn blob.read_shift(cch, 'sbcs-cont');\n}\n\n/* TODO: convert to BIFF8 font struct */\nfunction parse_BIFF2FONTXTRA(blob, length) {\n\tblob.l += 6; // unknown\n\tblob.l += 2; // font weight \"bls\"\n\tblob.l += 1; // charset\n\tblob.l += 3; // unknown\n\tblob.l += 1; // font family\n\tblob.l += length - 9;\n}\n\n/* TODO: parse rich text runs */\nfunction parse_RString(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_Cell(blob, 6);\n\tvar cch = blob.read_shift(2);\n\tvar str = parse_XLUnicodeStringNoCch(blob, cch, opts);\n\tblob.l = end;\n\tcell.t = 'str';\n\tcell.val = str;\n\treturn cell;\n}\nvar _chr = function(c) { return String.fromCharCode(c); };\nvar attregexg=/([\\w:]+)=((?:\")([^\"]*)(?:\")|(?:')([^']*)(?:'))/g;\nvar attregex=/([\\w:]+)=((?:\")(?:[^\"]*)(?:\")|(?:')(?:[^']*)(?:'))/;\nfunction parsexmltag(tag, skip_root) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = []; if(!skip_root) z[0] = words[0];\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex);\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1,y[2].length-2);\n\t\telse {\n\t\t\tif(y[1].substr(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].substr(6);\n\t\t\telse w = y[1].substr(j+1);\n\t\t\tz[w] = y[2].substr(1,y[2].length-2);\n\t\t}\n\t}\n\treturn z;\n}\nfunction parsexmltagobj(tag) {\n\tvar words = tag.split(/\\s+/);\n\tvar z = {};\n\tif(words.length === 1) return z;\n\tvar m = tag.match(attregexg), y, j, w, i;\n\tif(m) for(i = 0; i != m.length; ++i) {\n\t\ty = m[i].match(attregex);\n\t\tif((j=y[1].indexOf(\":\")) === -1) z[y[1]] = y[2].substr(1,y[2].length-2);\n\t\telse {\n\t\t\tif(y[1].substr(0,6) === \"xmlns:\") w = \"xmlns\"+y[1].substr(6);\n\t\t\telse w = y[1].substr(j+1);\n\t\t\tz[w] = y[2].substr(1,y[2].length-2);\n\t\t}\n\t}\n\treturn z;\n}\n\nvar encodings = {\n\t'&quot;': '\"',\n\t'&apos;': \"'\",\n\t'&gt;': '>',\n\t'&lt;': '<',\n\t'&amp;': '&'\n};\nvar rencoding = evert(encodings);\nvar rencstr = \"&<>'\\\"\".split(\"\");\n\nvar XML_HEADER = '<?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?>\\r\\n';\nvar OFFCRYPTO = {};\nvar make_offcrypto = function(O, _crypto) {\n\tvar crypto;\n\tif(typeof _crypto !== 'undefined') crypto = _crypto;\n\telse if(typeof require !== 'undefined') {\n\t\ttry { crypto = require('cry'+'pto'); }\n\t\tcatch(e) { crypto = null; }\n\t}\n\n\tO.rc4 = function(key, data) {\n\t\tvar S = new Array(256);\n\t\tvar c = 0, i = 0, j = 0, t = 0;\n\t\tfor(i = 0; i != 256; ++i) S[i] = i;\n\t\tfor(i = 0; i != 256; ++i) {\n\t\t\tj = (j + S[i] + (key[i%key.length]).charCodeAt(0))&255;\n\t\t\tt = S[i]; S[i] = S[j]; S[j] = t;\n\t\t}\n\t\ti = j = 0; out = Buffer(data.length);\n\t\tfor(c = 0; c != data.length; ++c) {\n\t\t\ti = (i + 1)&255;\n\t\t\tj = (j + S[i])%256;\n\t\t\tt = S[i]; S[i] = S[j]; S[j] = t;\n\t\t\tout[c] = (data[c] ^ S[(S[i]+S[j])&255]);\n\t\t}\n\t\treturn out;\n\t};\n\n\tO.md5 = function(hex) {\n\t\tif(!crypto) throw new Error(\"Unsupported crypto\");\n\t\treturn crypto.createHash('md5').update(hex).digest('hex');\n\t};\n};\nmake_offcrypto(OFFCRYPTO, typeof crypto !== \"undefined\" ? crypto : undefined);\nfunction _JS2ANSI(str) {\n\tif(typeof cptable !== 'undefined') return cptable.utils.encode(1252, str);\n\tvar o = [], oo = str.split(\"\");\n\tfor(var i = 0; i < oo.length; ++i) o[i] = oo[i].charCodeAt(0);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.1.4 Version */\nfunction parse_Version(blob, length) {\n\tvar o = {};\n\to.Major = blob.read_shift(2);\n\to.Minor = blob.read_shift(2);\n\treturn o;\n}\n/* [MS-OFFCRYPTO] 2.3.2 Encryption Header */\nfunction parse_EncryptionHeader(blob, length) {\n\tvar o = {};\n\to.Flags = blob.read_shift(4);\n\n\t// Check if SizeExtra is 0x00000000\n\tvar tmp = blob.read_shift(4);\n\tif(tmp !== 0) throw 'Unrecognized SizeExtra: ' + tmp;\n\n\to.AlgID = blob.read_shift(4);\n\tswitch(o.AlgID) {\n\t\tcase 0: case 0x6801: case 0x660E: case 0x660F: case 0x6610: break;\n\t\tdefault: throw 'Unrecognized encryption algorithm: ' + o.AlgID;\n\t}\n\tparsenoop(blob, length-12);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.3 Encryption Verifier */\nfunction parse_EncryptionVerifier(blob, length) {\n\treturn parsenoop(blob, length);\n}\n/* [MS-OFFCRYPTO] 2.3.5.1 RC4 CryptoAPI Encryption Header */\nfunction parse_RC4CryptoHeader(blob, length) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_Version(blob, 4); length -= 4;\n\tif(vers.Minor != 2) throw 'unrecognized minor version code: ' + vers.Minor;\n\tif(vers.Major > 4 || vers.Major < 2) throw 'unrecognized major version code: ' + vers.Major;\n\to.Flags = blob.read_shift(4); length -= 4;\n\tvar sz = blob.read_shift(4); length -= 4;\n\to.EncryptionHeader = parse_EncryptionHeader(blob, sz); length -= sz;\n\to.EncryptionVerifier = parse_EncryptionVerifier(blob, length);\n\treturn o;\n}\n/* [MS-OFFCRYPTO] 2.3.6.1 RC4 Encryption Header */\nfunction parse_RC4Header(blob, length) {\n\tvar o = {};\n\tvar vers = o.EncryptionVersionInfo = parse_Version(blob, 4); length -= 4;\n\tif(vers.Major != 1 || vers.Minor != 1) throw 'unrecognized version code ' + vers.Major + ' : ' + vers.Minor;\n\to.Salt = blob.read_shift(16);\n\to.EncryptedVerifier = blob.read_shift(16);\n\to.EncryptedVerifierHash = blob.read_shift(16);\n\treturn o;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.1 Binary Document Password Verifier Derivation */\nfunction crypto_CreatePasswordVerifier_Method1(Password) {\n\tvar Verifier = 0x0000, PasswordArray;\n\tvar PasswordDecoded = _JS2ANSI(Password);\n\tvar len = PasswordDecoded.length + 1, i, PasswordByte;\n\tvar Intermediate1, Intermediate2, Intermediate3;\n\tPasswordArray = new_raw_buf(len);\n\tPasswordArray[0] = PasswordDecoded.length;\n\tfor(i = 1; i != len; ++i) PasswordArray[i] = PasswordDecoded[i-1];\n\tfor(i = len-1; i >= 0; --i) {\n\t\tPasswordByte = PasswordArray[i];\n\t\tIntermediate1 = ((Verifier & 0x4000) === 0x0000) ? 0 : 1;\n\t\tIntermediate2 = (Verifier << 1) & 0x7FFF;\n\t\tIntermediate3 = Intermediate1 | Intermediate2;\n\t\tVerifier = Intermediate3 ^ PasswordByte;\n\t}\n\treturn Verifier ^ 0xCE4B;\n}\n\n/* [MS-OFFCRYPTO] 2.3.7.2 Binary Document XOR Array Initialization */\nvar crypto_CreateXorArray_Method1 = (function() {\n\tvar PadArray = [0xBB, 0xFF, 0xFF, 0xBA, 0xFF, 0xFF, 0xB9, 0x80, 0x00, 0xBE, 0x0F, 0x00, 0xBF, 0x0F, 0x00];\n\tvar InitialCode = [0xE1F0, 0x1D0F, 0xCC9C, 0x84C0, 0x110C, 0x0E10, 0xF1CE, 0x313E, 0x1872, 0xE139, 0xD40F, 0x84F9, 0x280C, 0xA96A, 0x4EC3];\n\tvar XorMatrix = [0xAEFC, 0x4DD9, 0x9BB2, 0x2745, 0x4E8A, 0x9D14, 0x2A09, 0x7B61, 0xF6C2, 0xFDA5, 0xEB6B, 0xC6F7, 0x9DCF, 0x2BBF, 0x4563, 0x8AC6, 0x05AD, 0x0B5A, 0x16B4, 0x2D68, 0x5AD0, 0x0375, 0x06EA, 0x0DD4, 0x1BA8, 0x3750, 0x6EA0, 0xDD40, 0xD849, 0xA0B3, 0x5147, 0xA28E, 0x553D, 0xAA7A, 0x44D5, 0x6F45, 0xDE8A, 0xAD35, 0x4A4B, 0x9496, 0x390D, 0x721A, 0xEB23, 0xC667, 0x9CEF, 0x29FF, 0x53FE, 0xA7FC, 0x5FD9, 0x47D3, 0x8FA6, 0x0F6D, 0x1EDA, 0x3DB4, 0x7B68, 0xF6D0, 0xB861, 0x60E3, 0xC1C6, 0x93AD, 0x377B, 0x6EF6, 0xDDEC, 0x45A0, 0x8B40, 0x06A1, 0x0D42, 0x1A84, 0x3508, 0x6A10, 0xAA51, 0x4483, 0x8906, 0x022D, 0x045A, 0x08B4, 0x1168, 0x76B4, 0xED68, 0xCAF1, 0x85C3, 0x1BA7, 0x374E, 0x6E9C, 0x3730, 0x6E60, 0xDCC0, 0xA9A1, 0x4363, 0x86C6, 0x1DAD, 0x3331, 0x6662, 0xCCC4, 0x89A9, 0x0373, 0x06E6, 0x0DCC, 0x1021, 0x2042, 0x4084, 0x8108, 0x1231, 0x2462, 0x48C4];\n\tvar Ror = function(Byte) { return ((Byte/2) | (Byte*128)) & 0xFF; };\n\tvar XorRor = function(byte1, byte2) { return Ror(byte1 ^ byte2); };\n\tvar CreateXorKey_Method1 = function(Password) {\n\t\tvar XorKey = InitialCode[Password.length - 1];\n\t\tvar CurrentElement = 0x68;\n\t\tfor(var i = Password.length-1; i >= 0; --i) {\n\t\t\tvar Char = Password[i];\n\t\t\tfor(var j = 0; j != 7; ++j) {\n\t\t\t\tif(Char & 0x40) XorKey ^= XorMatrix[CurrentElement];\n\t\t\t\tChar *= 2; --CurrentElement;\n\t\t\t}\n\t\t}\n\t\treturn XorKey;\n\t};\n\treturn function(password) {\n\t\tvar Password = _JS2ANSI(password);\n\t\tvar XorKey = CreateXorKey_Method1(Password);\n\t\tvar Index = Password.length;\n\t\tvar ObfuscationArray = new_raw_buf(16);\n\t\tfor(var i = 0; i != 16; ++i) ObfuscationArray[i] = 0x00;\n\t\tvar Temp, PasswordLastChar, PadIndex;\n\t\tif((Index & 1) === 1) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[0], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tPasswordLastChar = Password[Password.length - 1];\n\t\t\tObfuscationArray[Index] = XorRor(PasswordLastChar, Temp);\n\t\t}\n\t\twhile(Index > 0) {\n\t\t\t--Index;\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t}\n\t\tIndex = 15;\n\t\tPadIndex = 15 - Password.length;\n\t\twhile(PadIndex > 0) {\n\t\t\tTemp = XorKey >> 8;\n\t\t\tObfuscationArray[Index] = XorRor(PadArray[PadIndex], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t\tTemp = XorKey & 0xFF;\n\t\t\tObfuscationArray[Index] = XorRor(Password[Index], Temp);\n\t\t\t--Index;\n\t\t\t--PadIndex;\n\t\t}\n\t\treturn ObfuscationArray;\n\t};\n})();\n\n/* [MS-OFFCRYPTO] 2.3.7.3 Binary Document XOR Data Transformation Method 1 */\nvar crypto_DecryptData_Method1 = function(password, Data, XorArrayIndex, XorArray, O) {\n\t/* If XorArray is set, use it; if O is not set, make changes in-place */\n\tif(!O) O = Data;\n\tif(!XorArray) XorArray = crypto_CreateXorArray_Method1(password);\n\tvar Index, Value;\n\tfor(Index = 0; Index != Data.length; ++Index) {\n\t\tValue = Data[Index];\n\t\tValue ^= XorArray[XorArrayIndex];\n\t\tValue = ((Value>>5) | (Value<<3)) & 0xFF;\n\t\tO[Index] = Value;\n\t\t++XorArrayIndex;\n\t}\n\treturn [O, XorArrayIndex, XorArray];\n};\n\nvar crypto_MakeXorDecryptor = function(password) {\n\tvar XorArrayIndex = 0, XorArray = crypto_CreateXorArray_Method1(password);\n\treturn function(Data) {\n\t\tvar O = crypto_DecryptData_Method1(\"\", Data, XorArrayIndex, XorArray);\n\t\tXorArrayIndex = O[1];\n\t\treturn O[0];\n\t};\n};\n\n/* 2.5.343 */\nfunction parse_XORObfuscation(blob, length, opts, out) {\n\tvar o = ({ key: parseuint16(blob), verificationBytes: parseuint16(blob) });\n\tif(opts.password) o.verifier = crypto_CreatePasswordVerifier_Method1(opts.password);\n\tout.valid = o.verificationBytes === o.verifier;\n\tif(out.valid) out.insitu_decrypt = crypto_MakeXorDecryptor(opts.password);\n\treturn o;\n}\n\n/* 2.4.117 */\nfunction parse_FilePassHeader(blob, length, oo) {\n\tvar o = oo || {}; o.Info = blob.read_shift(2); blob.l -= 2;\n\tif(o.Info === 1) o.Data = parse_RC4Header(blob, length);\n\telse o.Data = parse_RC4CryptoHeader(blob, length);\n\treturn o;\n}\nfunction parse_FilePass(blob, length, opts) {\n\tvar o = { Type: blob.read_shift(2) }; /* wEncryptionType */\n\tif(o.Type) parse_FilePassHeader(blob, length-2, o);\n\telse parse_XORObfuscation(blob, length-2, opts, o);\n\treturn o;\n}\n\n\n/* Small helpers */\nfunction parseread(l) { return function(blob, length) { blob.l+=l; return; }; }\nfunction parseread1(blob, length) { blob.l+=1; return; }\n\n/* Rgce Helpers */\n\n/* 2.5.51 */\nfunction parse_ColRelU(blob, length) {\n\tvar c = blob.read_shift(length == 1 ? 1 : 2);\n\treturn [c & 0x3FFF, (c >> 14) & 1, (c >> 15) & 1];\n}\n\n/* 2.5.198.105 */\nfunction parse_RgceArea(blob, length, opts) {\n\tvar w = 2;\n\tif(opts) {\n\t\tif(opts.biff >= 2 && opts.biff <= 5) return parse_RgceArea_BIFF2(blob, length, opts);\n\t}\n\tvar r=blob.read_shift(w), R=blob.read_shift(w);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n/* BIFF 2-5 encodes flags in the row field */\nfunction parse_RgceArea_BIFF2(blob, length, opts) {\n\tvar r=parse_ColRelU(blob, 2), R=parse_ColRelU(blob, 2);\n\tvar c=blob.read_shift(1);\n\tvar C=blob.read_shift(1);\n\treturn { s:{r:r[0], c:c, cRel:r[1], rRel:r[2]}, e:{r:R[0], c:C, cRel:R[1], rRel:R[2]} };\n}\n\n/* 2.5.198.105 TODO */\nfunction parse_RgceAreaRel(blob, length) {\n\tvar r=blob.read_shift(2), R=blob.read_shift(2);\n\tvar c=parse_ColRelU(blob, 2);\n\tvar C=parse_ColRelU(blob, 2);\n\treturn { s:{r:r, c:c[0], cRel:c[1], rRel:c[2]}, e:{r:R, c:C[0], cRel:C[1], rRel:C[2]} };\n}\n\n/* 2.5.198.109 */\nfunction parse_RgceLoc(blob, length, opts) {\n\tif(opts && opts.biff >= 2 && opts.biff <= 5) return parse_RgceLoc_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(2);\n\tvar c = parse_ColRelU(blob, 2);\n\treturn {r:r, c:c[0], cRel:c[1], rRel:c[2]};\n}\nfunction parse_RgceLoc_BIFF2(blob, length, opts) {\n\tvar r = parse_ColRelU(blob, 2);\n\tvar c = blob.read_shift(1);\n\treturn {r:r[0], c:c, cRel:r[1], rRel:r[2]};\n}\n\n/* 2.5.198.111 */\nfunction parse_RgceLocRel(blob, length, opts) {\n\tvar biff = opts && opts.biff ? opts.biff : 8;\n\tif(biff >= 2 && biff <= 5) return parse_RgceLocRel_BIFF2(blob, length, opts);\n\tvar r = blob.read_shift(2);\n\tvar cl = blob.read_shift(2);\n\tvar cRel = (cl & 0x8000) >> 15, rRel = (cl & 0x4000) >> 14;\n\tcl &= 0x3FFF;\n\tif(rRel == 1) while(r > 0x7FFFF) r -= 0x100000;\n\tif(cRel == 1) while(cl > 0x1FFF) cl = cl - 0x4000;\n\treturn {r:r,c:cl,cRel:cRel,rRel:rRel};\n}\nfunction parse_RgceLocRel_BIFF2(blob, length) {\n\tvar rl = blob.read_shift(2);\n\tvar c = blob.read_shift(1);\n\tvar rRel = (rl & 0x8000) >> 15, cRel = (rl & 0x4000) >> 14;\n\trl &= 0x3FFF;\n\tif(rRel == 1 && rl >= 0x2000) rl = rl - 0x4000;\n\tif(cRel == 1 && c >= 0x80) c = c - 0x100;\n\treturn {r:rl,c:c,cRel:cRel,rRel:rRel};\n}\n\n/* Ptg Tokens */\n\n/* 2.5.198.27 */\nfunction parse_PtgArea(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceArea(blob, opts.biff >= 2 && opts.biff <= 5 ? 6 : 8, opts);\n\treturn [type, area];\n}\n\n/* 2.5.198.28 */\nfunction parse_PtgArea3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2, 'i');\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t}\n\tvar area = parse_RgceArea(blob, w, opts);\n\treturn [type, ixti, area];\n}\n\n/* 2.5.198.29 */\nfunction parse_PtgAreaErr(blob, length) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += 8;\n\treturn [type];\n}\n/* 2.5.198.30 */\nfunction parse_PtgAreaErr3d(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar ixti = blob.read_shift(2);\n\tvar w = 8;\n\tif(opts) switch(opts.biff) {\n\t\tcase 5: blob.l += 12; w = 6; break;\n\t}\n\tblob.l += w;\n\treturn [type, ixti];\n}\n\n/* 2.5.198.31 */\nfunction parse_PtgAreaN(blob, length) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tvar area = parse_RgceAreaRel(blob, 8);\n\treturn [type, area];\n}\n\n/* 2.5.198.32 -- ignore this and look in PtgExtraArray for shape + values */\nfunction parse_PtgArray(blob, length, opts) {\n\tvar type = (blob[blob.l++] & 0x60) >> 5;\n\tblob.l += opts.biff == 2 ? 6 : 7;\n\treturn [type];\n}\n\n/* 2.5.198.33 */\nfunction parse_PtgAttrBaxcel(blob, length) {\n\tvar bitSemi = blob[blob.l+1] & 0x01; /* 1 = volatile */\n\tvar bitBaxcel = 1;\n\tblob.l += 4;\n\treturn [bitSemi, bitBaxcel];\n}\n\n/* 2.5.198.34 */\nfunction parse_PtgAttrChoose(blob, length, opts) {\n\tblob.l +=2;\n\tvar offset = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\tvar o = [];\n\t/* offset is 1 less than the number of elements */\n\tfor(var i = 0; i <= offset; ++i) o.push(blob.read_shift(opts && opts.biff == 2 ? 1 : 2));\n\treturn o;\n}\n\n/* 2.5.198.35 */\nfunction parse_PtgAttrGoto(blob, length, opts) {\n\tvar bitGoto = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitGoto, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* 2.5.198.36 */\nfunction parse_PtgAttrIf(blob, length, opts) {\n\tvar bitIf = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += 2;\n\treturn [bitIf, blob.read_shift(opts && opts.biff == 2 ? 1 : 2)];\n}\n\n/* 2.5.198.37 */\nfunction parse_PtgAttrSemi(blob, length, opts) {\n\tvar bitSemi = (blob[blob.l+1] & 0xFF) ? 1 : 0;\n\tblob.l += opts && opts.biff == 2 ? 3 : 4;\n\treturn [bitSemi];\n}\n\n/* 2.5.198.40 (used by PtgAttrSpace and PtgAttrSpaceSemi) */\nfunction parse_PtgAttrSpaceType(blob, length) {\n\tvar type = blob.read_shift(1), cch = blob.read_shift(1);\n\treturn [type, cch];\n}\n\n/* 2.5.198.38 */\nfunction parse_PtgAttrSpace(blob, length) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* 2.5.198.39 */\nfunction parse_PtgAttrSpaceSemi(blob, length) {\n\tblob.read_shift(2);\n\treturn parse_PtgAttrSpaceType(blob, 2);\n}\n\n/* 2.5.198.84 TODO */\nfunction parse_PtgRef(blob, length, opts) {\n\tvar ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLoc(blob, 4, opts);\n\treturn [type, loc];\n}\n\n/* 2.5.198.88 TODO */\nfunction parse_PtgRefN(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar loc = parse_RgceLocRel(blob, 4, opts);\n\treturn [type, loc];\n}\n\n/* 2.5.198.85 TODO */\nfunction parse_PtgRef3d(blob, length, opts) {\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tvar loc = parse_RgceLoc(blob, 0, opts);\n\treturn [type, ixti, loc];\n}\n\n\n/* 2.5.198.62 TODO */\nfunction parse_PtgFunc(blob, length, opts) {\n\tvar ptg = blob[blob.l] & 0x1F;\n\tvar type = (blob[blob.l] & 0x60)>>5;\n\tblob.l += 1;\n\tvar iftab = blob.read_shift(opts && opts.biff <= 3 ? 1 : 2);\n\treturn [FtabArgc[iftab], Ftab[iftab], type];\n}\n/* 2.5.198.63 TODO */\nfunction parse_PtgFuncVar(blob, length, opts) {\n\tblob.l++;\n\tvar cparams = blob.read_shift(1), tab = opts && opts.biff <= 3 ? [0, blob.read_shift(1)]: parsetab(blob);\n\treturn [cparams, (tab[0] === 0 ? Ftab : Cetab)[tab[1]]];\n}\n\nfunction parsetab(blob, length) {\n\treturn [blob[blob.l+1]>>7, blob.read_shift(2) & 0x7FFF];\n}\n\n/* 2.5.198.41 */\nfunction parse_PtgAttrSum(blob, length, opts) {\n\tblob.l += opts && opts.biff == 2 ? 3 : 4; return;\n}\n\n/* 2.5.198.43 */\nvar parse_PtgConcat = parseread1;\n\n/* 2.5.198.58 */\nfunction parse_PtgExp(blob, length, opts) {\n\tblob.l++;\n\tvar row = blob.read_shift(2);\n\tvar col = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [row, col];\n}\n\n/* 2.5.198.57 */\nfunction parse_PtgErr(blob, length) { blob.l++; return BErr[blob.read_shift(1)]; }\n\n/* 2.5.198.66 TODO */\nfunction parse_PtgInt(blob, length) { blob.l++; return blob.read_shift(2); }\n\n/* 2.5.198.42 */\nfunction parse_PtgBool(blob, length) { blob.l++; return blob.read_shift(1)!==0;}\n\n/* 2.5.198.79 */\nfunction parse_PtgNum(blob, length) { blob.l++; return parse_Xnum(blob, 8); }\n\n/* 2.5.198.89 */\nfunction parse_PtgStr(blob, length, opts) { blob.l++; return parse_ShortXLUnicodeString(blob, length-1, opts); }\n\n/* 2.5.192.112 + 2.5.192.11{3,4,5,6,7} */\nfunction parse_SerAr(blob, biff) {\n\tvar val = [blob.read_shift(1)];\n\tswitch(val[0]) {\n\t\t/* 2.5.192.113 */\n\t\tcase 0x04: /* SerBool -- boolean */\n\t\t\tval[1] = parsebool(blob, 1) ? 'TRUE' : 'FALSE';\n\t\t\tblob.l += 7; break;\n\t\t/* 2.5.192.114 */\n\t\tcase 0x10: /* SerErr -- error */\n\t\t\tval[1] = BErr[blob[blob.l]];\n\t\t\tblob.l += 8; break;\n\t\t/* 2.5.192.115 */\n\t\tcase 0x00: /* SerNil -- honestly, I'm not sure how to reproduce this */\n\t\t\tblob.l += 8; break;\n\t\t/* 2.5.192.116 */\n\t\tcase 0x01: /* SerNum -- Xnum */\n\t\t\tval[1] = parse_Xnum(blob, 8); break;\n\t\t/* 2.5.192.117 */\n\t\tcase 0x02: /* SerStr -- XLUnicodeString (<256 chars) */\n\t\t\tval[1] = parse_XLUnicodeString2(blob, 0, {biff:biff > 0 && biff < 8 ? 2 : biff}); break;\n\t\t// default: throw \"Bad SerAr: \" + val[0]; /* Unreachable */\n\t}\n\treturn val;\n}\n\n/* 2.5.198.61 */\nfunction parse_PtgExtraMem(blob, cce) {\n\tvar count = blob.read_shift(2);\n\tvar out = [];\n\tfor(var i = 0; i != count; ++i) out.push(parse_Ref8U(blob, 8));\n\treturn out;\n}\n\n/* 2.5.198.59 */\nfunction parse_PtgExtraArray(blob, length, opts) {\n\tvar cols = 1 + blob.read_shift(1); //DColByteU\n\tvar rows = 1 + blob.read_shift(2); //DRw\n\tif(opts.biff >= 2 && opts.biff < 8) { --rows; if(--cols == 0) cols = 0x100; }\n\tfor(var i = 0, o=[]; i != rows && (o[i] = []); ++i)\n\t\tfor(var j = 0; j != cols; ++j) o[i][j] = parse_SerAr(blob, opts.biff);\n\treturn o;\n}\n\n/* 2.5.198.76 */\nfunction parse_PtgName(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar w = (!opts || (opts.biff >= 8)) ? 4 : 2;\n\tvar nameindex = blob.read_shift(w);\n\tswitch(opts.biff) {\n\t\tcase 2: blob.l += 5; break;\n\t\tcase 3: case 4: blob.l += 8; break;\n\t\tcase 5: blob.l += 12; break;\n\t}\n\treturn [type, 0, nameindex];\n}\n\n/* 2.5.198.77 */\nfunction parse_PtgNameX(blob, length, opts) {\n\tif(opts.biff == 5) return parse_PtgNameX_BIFF5(blob, length, opts);\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2); // XtiIndex\n\tvar nameindex = blob.read_shift(4);\n\treturn [type, ixti, nameindex];\n}\nfunction parse_PtgNameX_BIFF5(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar ixti = blob.read_shift(2, 'i'); // XtiIndex\n\tblob.l += 8;\n\tvar nameindex = blob.read_shift(2);\n\tblob.l += 12;\n\treturn [type, ixti, nameindex];\n}\n\n/* 2.5.198.70 */\nfunction parse_PtgMemArea(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += (opts && opts.biff == 2 ? 3 : 4);\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n/* 2.5.198.72 */\nfunction parse_PtgMemFunc(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tvar cce = blob.read_shift(opts && opts.biff == 2 ? 1 : 2);\n\treturn [type, cce];\n}\n\n\n/* 2.5.198.86 */\nfunction parse_PtgRefErr(blob, length, opts) {\n\tvar type = (blob.read_shift(1) >>> 5) & 0x03;\n\tblob.l += 4;\n\treturn [type];\n}\n\n/* 2.5.198.26 */\nvar parse_PtgAdd = parseread1;\n/* 2.5.198.45 */\nvar parse_PtgDiv = parseread1;\n/* 2.5.198.56 */\nvar parse_PtgEq = parseread1;\n/* 2.5.198.64 */\nvar parse_PtgGe = parseread1;\n/* 2.5.198.65 */\nvar parse_PtgGt = parseread1;\n/* 2.5.198.67 */\nvar parse_PtgIsect = parseread1;\n/* 2.5.198.68 */\nvar parse_PtgLe = parseread1;\n/* 2.5.198.69 */\nvar parse_PtgLt = parseread1;\n/* 2.5.198.74 */\nvar parse_PtgMissArg = parseread1;\n/* 2.5.198.75 */\nvar parse_PtgMul = parseread1;\n/* 2.5.198.78 */\nvar parse_PtgNe = parseread1;\n/* 2.5.198.80 */\nvar parse_PtgParen = parseread1;\n/* 2.5.198.81 */\nvar parse_PtgPercent = parseread1;\n/* 2.5.198.82 */\nvar parse_PtgPower = parseread1;\n/* 2.5.198.83 */\nvar parse_PtgRange = parseread1;\n/* 2.5.198.90 */\nvar parse_PtgSub = parseread1;\n/* 2.5.198.93 */\nvar parse_PtgUminus = parseread1;\n/* 2.5.198.94 */\nvar parse_PtgUnion = parseread1;\n/* 2.5.198.95 */\nvar parse_PtgUplus = parseread1;\n\n/* 2.5.198.71 */\nvar parse_PtgMemErr = parsenoop;\n/* 2.5.198.73 */\nvar parse_PtgMemNoMem = parsenoop;\n/* 2.5.198.87 */\nvar parse_PtgRefErr3d = parsenoop;\n/* 2.5.198.92 */\nvar parse_PtgTbl = parsenoop;\n\n/* 2.5.198.25 */\nvar PtgTypes = {\n\t0x01: { n:'PtgExp', f:parse_PtgExp },\n\t0x02: { n:'PtgTbl', f:parse_PtgTbl },\n\t0x03: { n:'PtgAdd', f:parse_PtgAdd },\n\t0x04: { n:'PtgSub', f:parse_PtgSub },\n\t0x05: { n:'PtgMul', f:parse_PtgMul },\n\t0x06: { n:'PtgDiv', f:parse_PtgDiv },\n\t0x07: { n:'PtgPower', f:parse_PtgPower },\n\t0x08: { n:'PtgConcat', f:parse_PtgConcat },\n\t0x09: { n:'PtgLt', f:parse_PtgLt },\n\t0x0A: { n:'PtgLe', f:parse_PtgLe },\n\t0x0B: { n:'PtgEq', f:parse_PtgEq },\n\t0x0C: { n:'PtgGe', f:parse_PtgGe },\n\t0x0D: { n:'PtgGt', f:parse_PtgGt },\n\t0x0E: { n:'PtgNe', f:parse_PtgNe },\n\t0x0F: { n:'PtgIsect', f:parse_PtgIsect },\n\t0x10: { n:'PtgUnion', f:parse_PtgUnion },\n\t0x11: { n:'PtgRange', f:parse_PtgRange },\n\t0x12: { n:'PtgUplus', f:parse_PtgUplus },\n\t0x13: { n:'PtgUminus', f:parse_PtgUminus },\n\t0x14: { n:'PtgPercent', f:parse_PtgPercent },\n\t0x15: { n:'PtgParen', f:parse_PtgParen },\n\t0x16: { n:'PtgMissArg', f:parse_PtgMissArg },\n\t0x17: { n:'PtgStr', f:parse_PtgStr },\n\t0x1C: { n:'PtgErr', f:parse_PtgErr },\n\t0x1D: { n:'PtgBool', f:parse_PtgBool },\n\t0x1E: { n:'PtgInt', f:parse_PtgInt },\n\t0x1F: { n:'PtgNum', f:parse_PtgNum },\n\t0x20: { n:'PtgArray', f:parse_PtgArray },\n\t0x21: { n:'PtgFunc', f:parse_PtgFunc },\n\t0x22: { n:'PtgFuncVar', f:parse_PtgFuncVar },\n\t0x23: { n:'PtgName', f:parse_PtgName },\n\t0x24: { n:'PtgRef', f:parse_PtgRef },\n\t0x25: { n:'PtgArea', f:parse_PtgArea },\n\t0x26: { n:'PtgMemArea', f:parse_PtgMemArea },\n\t0x27: { n:'PtgMemErr', f:parse_PtgMemErr },\n\t0x28: { n:'PtgMemNoMem', f:parse_PtgMemNoMem },\n\t0x29: { n:'PtgMemFunc', f:parse_PtgMemFunc },\n\t0x2A: { n:'PtgRefErr', f:parse_PtgRefErr },\n\t0x2B: { n:'PtgAreaErr', f:parse_PtgAreaErr },\n\t0x2C: { n:'PtgRefN', f:parse_PtgRefN },\n\t0x2D: { n:'PtgAreaN', f:parse_PtgAreaN },\n\t0x39: { n:'PtgNameX', f:parse_PtgNameX },\n\t0x3A: { n:'PtgRef3d', f:parse_PtgRef3d },\n\t0x3B: { n:'PtgArea3d', f:parse_PtgArea3d },\n\t0x3C: { n:'PtgRefErr3d', f:parse_PtgRefErr3d },\n\t0x3D: { n:'PtgAreaErr3d', f:parse_PtgAreaErr3d },\n\t0xFF: {}\n};\n/* These are duplicated in the PtgTypes table */\nvar PtgDupes = {\n\t0x40: 0x20, 0x60: 0x20,\n\t0x41: 0x21, 0x61: 0x21,\n\t0x42: 0x22, 0x62: 0x22,\n\t0x43: 0x23, 0x63: 0x23,\n\t0x44: 0x24, 0x64: 0x24,\n\t0x45: 0x25, 0x65: 0x25,\n\t0x46: 0x26, 0x66: 0x26,\n\t0x47: 0x27, 0x67: 0x27,\n\t0x48: 0x28, 0x68: 0x28,\n\t0x49: 0x29, 0x69: 0x29,\n\t0x4A: 0x2A, 0x6A: 0x2A,\n\t0x4B: 0x2B, 0x6B: 0x2B,\n\t0x4C: 0x2C, 0x6C: 0x2C,\n\t0x4D: 0x2D, 0x6D: 0x2D,\n\t0x59: 0x39, 0x79: 0x39,\n\t0x5A: 0x3A, 0x7A: 0x3A,\n\t0x5B: 0x3B, 0x7B: 0x3B,\n\t0x5C: 0x3C, 0x7C: 0x3C,\n\t0x5D: 0x3D, 0x7D: 0x3D\n};\n(function(){for(var y in PtgDupes) PtgTypes[y] = PtgTypes[PtgDupes[y]];})();\n\nvar Ptg18 = {};\nvar Ptg19 = {\n\t0x01: { n:'PtgAttrSemi', f:parse_PtgAttrSemi },\n\t0x02: { n:'PtgAttrIf', f:parse_PtgAttrIf },\n\t0x04: { n:'PtgAttrChoose', f:parse_PtgAttrChoose },\n\t0x08: { n:'PtgAttrGoto', f:parse_PtgAttrGoto },\n\t0x10: { n:'PtgAttrSum', f:parse_PtgAttrSum },\n\t0x20: { n:'PtgAttrBaxcel', f:parse_PtgAttrBaxcel },\n\t0x40: { n:'PtgAttrSpace', f:parse_PtgAttrSpace },\n\t0x41: { n:'PtgAttrSpaceSemi', f:parse_PtgAttrSpaceSemi },\n\t0xFF: {}\n};\n\n/* TODO: it will be useful to parse the function str */\nvar rc_to_a1 = (function(){\n\tvar rcregex = /(^|[^A-Za-z])R(\\[?)(-?\\d+|)\\]?C(\\[?)(-?\\d+|)\\]?/g;\n\tvar rcbase;\n\tfunction rcfunc($$,$1,$2,$3,$4,$5) {\n\t\tvar R = $3.length>0?parseInt($3,10)|0:0, C = $5.length>0?parseInt($5,10)|0:0;\n\t\tif(C<0 && $4.length === 0) C=0;\n\t\tvar cRel = false, rRel = false;\n\t\tif($4.length > 0 || $5.length == 0) cRel = true; if(cRel) C += rcbase.c; else --C;\n\t\tif($2.length > 0 || $3.length == 0) rRel = true; if(rRel) R += rcbase.r; else --R;\n\t\treturn $1 + (cRel ? \"\" : \"$\") + encode_col(C) + (rRel ? \"\" : \"$\") + encode_row(R);\n\t}\n\treturn function rc_to_a1(fstr, base) {\n\t\trcbase = base;\n\t\treturn fstr.replace(rcregex, rcfunc);\n\t};\n})();\n/* 2.4.127 TODO */\nfunction parse_Formula(blob, length, opts) {\n\tvar end = blob.l + length;\n\tvar cell = parse_Cell(blob, 6);\n\tif(opts.biff == 2) ++blob.l;\n\tvar val = parse_FormulaValue(blob,8);\n\tvar flags = blob.read_shift(1);\n\tif(opts.biff != 2) {\n\t\tblob.read_shift(1);\n\t\tif(opts.biff >= 5) {\n\t\t\tvar chn = blob.read_shift(4);\n\t\t}\n\t}\n\tvar cbf = parse_CellParsedFormula(blob, end - blob.l, opts);\n\treturn {cell:cell, val:val[0], formula:cbf, shared: (flags >> 3) & 1, tt:val[1]};\n}\n\n/* 2.5.133 TODO: how to emit empty strings? */\nfunction parse_FormulaValue(blob) {\n\tvar b;\n\tif(__readUInt16LE(blob,blob.l + 6) !== 0xFFFF) return [parse_Xnum(blob),'n'];\n\tswitch(blob[blob.l]) {\n\t\tcase 0x00: blob.l += 8; return [\"String\", 's'];\n\t\tcase 0x01: b = blob[blob.l+2] === 0x1; blob.l += 8; return [b,'b'];\n\t\tcase 0x02: b = blob[blob.l+2]; blob.l += 8; return [b,'e'];\n\t\tcase 0x03: blob.l += 8; return [\"\",'s'];\n\t}\n\treturn [];\n}\n\n/* 2.5.198.103 */\nfunction parse_RgbExtra(blob, length, rgce, opts) {\n\tif(opts.biff < 8) return parsenoop(blob, length);\n\tvar target = blob.l + length;\n\tvar o = [];\n\tfor(var i = 0; i !== rgce.length; ++i) {\n\t\tswitch(rgce[i][0]) {\n\t\t\tcase 'PtgArray': /* PtgArray -> PtgExtraArray */\n\t\t\t\trgce[i][1] = parse_PtgExtraArray(blob, 0, opts);\n\t\t\t\to.push(rgce[i][1]);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgMemArea': /* PtgMemArea -> PtgExtraMem */\n\t\t\t\trgce[i][2] = parse_PtgExtraMem(blob, rgce[i][1]);\n\t\t\t\to.push(rgce[i][2]);\n\t\t\t\tbreak;\n\t\t\tdefault: break;\n\t\t}\n\t}\n\tlength = target - blob.l;\n\tif(length !== 0) o.push(parsenoop(blob, length));\n\treturn o;\n}\n\n/* 2.5.198.21 */\nfunction parse_NameParsedFormula(blob, length, opts, cce) {\n\tvar target = blob.l + length;\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tvar rgcb;\n\tif(target !== blob.l) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* 2.5.198.3 TODO */\nfunction parse_CellParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, length - cce - len, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* 2.5.198.118 TODO */\nfunction parse_SharedParsedFormula(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar rgcb, cce = blob.read_shift(2); // length of rgce\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tif(length !== cce + 2) rgcb = parse_RgbExtra(blob, target - cce - 2, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* 2.5.198.1 TODO */\nfunction parse_ArrayParsedFormula(blob, length, opts, ref) {\n\tvar target = blob.l + length, len = opts.biff == 2 ? 1 : 2;\n\tvar rgcb, cce = blob.read_shift(len); // length of rgce\n\tif(cce == 0xFFFF) return [[],parsenoop(blob, length-2)];\n\tvar rgce = parse_Rgce(blob, cce, opts);\n\tif(length !== cce + len) rgcb = parse_RgbExtra(blob, target - blob.l, rgce, opts);\n\treturn [rgce, rgcb];\n}\n\n/* 2.5.198.104 */\nfunction parse_Rgce(blob, length, opts) {\n\tvar target = blob.l + length;\n\tvar R, id, ptgs = [];\n\twhile(target != blob.l) {\n\t\tlength = target - blob.l;\n\t\tid = blob[blob.l];\n\t\tR = PtgTypes[id];\n\t\tif(id === 0x18 || id === 0x19) {\n\t\t\tid = blob[blob.l + 1];\n\t\t\tR = (id === 0x18 ? Ptg18 : Ptg19)[id];\n\t\t}\n\t\tif(!R || !R.f) { ptgs.push(parsenoop(blob, length)); }\n\t\telse { ptgs.push([R.n, R.f(blob, length, opts)]); }\n\t}\n\treturn ptgs;\n}\n\nfunction stringify_array(f) {\n\tvar o = [];\n\tfor(var i = 0; i < f.length; ++i) {\n\t\tvar x = f[i], r = [];\n\t\tfor(var j = 0; j < x.length; ++j) {\n\t\t\tvar y = x[j];\n\t\t\tif(y) switch(y[0]) {\n\t\t\t\t// TODO: handle embedded quotes\n\t\t\t\tcase 0x02: r.push('\"' + y[1].replace(/\"/g,'\"\"') + '\"'); break;\n\t\t\t\tdefault: r.push(y[1]);\n\t\t\t} else r.push(\"\");\n\t\t}\n\t\to.push(r.join(\",\"));\n\t}\n\treturn o.join(\";\");\n}\n\n/* 2.2.2 TODO */\nvar PtgBinOp = {\n\tPtgAdd: \"+\",\n\tPtgConcat: \"&\",\n\tPtgDiv: \"/\",\n\tPtgEq: \"=\",\n\tPtgGe: \">=\",\n\tPtgGt: \">\",\n\tPtgLe: \"<=\",\n\tPtgLt: \"<\",\n\tPtgMul: \"*\",\n\tPtgNe: \"<>\",\n\tPtgPower: \"^\",\n\tPtgSub: \"-\"\n};\nfunction stringify_formula(formula, range, cell, supbooks, opts) {\n\tvar _range = {s:{c:0, r:0},e:{c:0, r:0}};\n\tvar stack = [], e1, e2, type, c, ixti, nameidx, r, sname=\"\";\n\tif(!formula[0] || !formula[0][0]) return \"\";\n\tvar last_sp = -1, sp = \"\";\n\t//console.log(\"--\",cell,formula[0])\n\tfor(var ff = 0, fflen = formula[0].length; ff < fflen; ++ff) {\n\t\tvar f = formula[0][ff];\n\t\t//console.log(\"++\",f, stack)\n\t\tswitch(f[0]) {\n\t\t/* 2.2.2.1 Unary Operator Tokens */\n\t\t\t/* 2.5.198.93 */\n\t\t\tcase 'PtgUminus': stack.push(\"-\" + stack.pop()); break;\n\t\t\t/* 2.5.198.95 */\n\t\t\tcase 'PtgUplus': stack.push(\"+\" + stack.pop()); break;\n\t\t\t/* 2.5.198.81 */\n\t\t\tcase 'PtgPercent': stack.push(stack.pop() + \"%\"); break;\n\n\t\t/* 2.2.2.1 Binary Value Operator Token */\n\t\t\tcase 'PtgAdd':    /* 2.5.198.26 */\n\t\t\tcase 'PtgConcat': /* 2.5.198.43 */\n\t\t\tcase 'PtgDiv':    /* 2.5.198.45 */\n\t\t\tcase 'PtgEq':     /* 2.5.198.56 */\n\t\t\tcase 'PtgGe':     /* 2.5.198.64 */\n\t\t\tcase 'PtgGt':     /* 2.5.198.65 */\n\t\t\tcase 'PtgLe':     /* 2.5.198.68 */\n\t\t\tcase 'PtgLt':     /* 2.5.198.69 */\n\t\t\tcase 'PtgMul':    /* 2.5.198.75 */\n\t\t\tcase 'PtgNe':     /* 2.5.198.78 */\n\t\t\tcase 'PtgPower':  /* 2.5.198.82 */\n\t\t\tcase 'PtgSub':    /* 2.5.198.90 */\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\tcase 0: sp = fill(\" \", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tcase 1: sp = fill(\"\\r\", formula[0][last_sp][1][1]); break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tsp = \"\";\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgSpace type \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\te2 = e2 + sp;\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(e2+PtgBinOp[f[0]]+e1);\n\t\t\t\tbreak;\n\n\t\t/* 2.2.2.1 Binary Reference Operator Token */\n\t\t\t/* 2.5.198.67 */\n\t\t\tcase 'PtgIsect':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\" \"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgUnion':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\",\"+e1);\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRange':\n\t\t\t\te1 = stack.pop(); e2 = stack.pop();\n\t\t\t\tstack.push(e2+\":\"+e1);\n\t\t\t\tbreak;\n\n\t\t/* 2.2.2.3 Control Tokens \"can be ignored\" */\n\t\t\t/* 2.5.198.34 */\n\t\t\tcase 'PtgAttrChoose': break;\n\t\t\t/* 2.5.198.35 */\n\t\t\tcase 'PtgAttrGoto': break;\n\t\t\t/* 2.5.198.36 */\n\t\t\tcase 'PtgAttrIf': break;\n\n\n\t\t\t/* 2.5.198.84 */\n\t\t\tcase 'PtgRef':\n\t\t\t\ttype = f[1][0]; c = shift_cell(f[1][1], _range, opts);\n\t\t\t\tstack.push(encode_cell_xls(c));\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.88 */\n\t\t\tcase 'PtgRefN':\n\t\t\t\ttype = f[1][0]; c = shift_cell(f[1][1], cell, opts);\n\t\t\t\tstack.push(encode_cell_xls(c));\n\t\t\t\tbreak;\n\t\t\tcase 'PtgRef3d': // TODO: lots of stuff\n\t\t\t\ttype = f[1][0]; ixti = f[1][1]; c = shift_cell(f[1][2], _range, opts);\n\t\t\t\tsname = (supbooks && supbooks[1] ? supbooks[1][ixti+1] : \"**MISSING**\");\n\t\t\t\tstack.push(sname + \"!\" + encode_cell(c));\n\t\t\t\tbreak;\n\n\t\t/* Function Call */\n\t\t\t/* 2.5.198.62 */\n\t\t\tcase 'PtgFunc':\n\t\t\t/* 2.5.198.63 */\n\t\t\tcase 'PtgFuncVar':\n\t\t\t\t/* f[1] = [argc, func, type] */\n\t\t\t\tvar argc = f[1][0], func = f[1][1];\n\t\t\t\tif(!argc) argc = 0;\n\t\t\t\tvar args = argc == 0 ? [] : stack.slice(-argc);\n\t\t\t\tstack.length -= argc;\n\t\t\t\tif(func === 'User') func = args.shift();\n\t\t\t\tstack.push(func + \"(\" + args.join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.42 */\n\t\t\tcase 'PtgBool': stack.push(f[1] ? \"TRUE\" : \"FALSE\"); break;\n\t\t\t/* 2.5.198.66 */\n\t\t\tcase 'PtgInt': stack.push(f[1]); break;\n\t\t\t/* 2.5.198.79 TODO: precision? */\n\t\t\tcase 'PtgNum': stack.push(String(f[1])); break;\n\t\t\t/* 2.5.198.89 */\n\t\t\tcase 'PtgStr': stack.push('\"' + f[1] + '\"'); break;\n\t\t\t/* 2.5.198.57 */\n\t\t\tcase 'PtgErr': stack.push(f[1]); break;\n\t\t\t/* 2.5.198.27 TODO: fixed points */\n\t\t\tcase 'PtgArea':\n\t\t\t\ttype = f[1][0]; r = shift_range(f[1][1], _range);\n\t\t\t\tstack.push(encode_range_xls(r));\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.28 */\n\t\t\tcase 'PtgArea3d': // TODO: lots of stuff\n\t\t\t\ttype = f[1][0]; ixti = f[1][1]; r = f[1][2];\n\t\t\t\tsname = (supbooks && supbooks[1] ? supbooks[1][ixti+1] : \"**MISSING**\");\n\t\t\t\tstack.push(sname + \"!\" + encode_range(r));\n\t\t\t\tbreak;\n\t\t\t/* 2.5.198.41 */\n\t\t\tcase 'PtgAttrSum':\n\t\t\t\tstack.push(\"SUM(\" + stack.pop() + \")\");\n\t\t\t\tbreak;\n\n\t\t/* Expression Prefixes */\n\t\t\t/* 2.5.198.37 */\n\t\t\tcase 'PtgAttrSemi': break;\n\n\t\t\t/* 2.5.97.60 TODO: do something different for revisions */\n\t\t\tcase 'PtgName':\n\t\t\t\t/* f[1] = type, 0, nameindex */\n\t\t\t\tnameidx = f[1][2];\n\t\t\t\tvar lbl = supbooks[0][nameidx];\n\t\t\t\tvar name = lbl ? lbl.Name : \"**MISSING**\" + nameidx;\n\t\t\t\tif(name in XLSXFutureFunctions) name = XLSXFutureFunctions[name];\n\t\t\t\tstack.push(name);\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.97.61 TODO: do something different for revisions */\n\t\t\tcase 'PtgNameX':\n\t\t\t\t/* f[1] = type, ixti, nameindex */\n\t\t\t\tvar bookidx = f[1][1]; nameidx = f[1][2]; var externbook;\n\t\t\t\t/* TODO: Properly handle missing values */\n\t\t\t\tif(opts.biff == 5) {\n\t\t\t\t\tif(bookidx < 0) bookidx = -bookidx;\n\t\t\t\t\tif(supbooks[bookidx]) externbook = supbooks[bookidx][nameidx];\n\t\t\t\t} else {\n\t\t\t\t\tif(supbooks[bookidx+1]) externbook = supbooks[bookidx+1][nameidx];\n\t\t\t\t\telse if(supbooks[bookidx-1]) externbook = supbooks[bookidx-1][nameidx];\n\t\t\t\t}\n\t\t\t\tif(!externbook) externbook = {body: \"??NAMEX??\"};\n\t\t\t\tstack.push(externbook.body);\n\t\t\t\tbreak;\n\n\t\t/* 2.2.2.4 Display Tokens */\n\t\t\t/* 2.5.198.80 */\n\t\t\tcase 'PtgParen':\n\t\t\t\tvar lp = '(', rp = ')';\n\t\t\t\tif(last_sp >= 0) {\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\tswitch(formula[0][last_sp][1][0]) {\n\t\t\t\t\t\tcase 2: lp = fill(\" \", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\tcase 3: lp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\tcase 4: rp = fill(\" \", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\tcase 5: rp = fill(\"\\r\", formula[0][last_sp][1][1]) + lp; break;\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgSpace type \" + formula[0][last_sp][1][0]);\n\t\t\t\t\t}\n\t\t\t\t\tlast_sp = -1;\n\t\t\t\t}\n\t\t\t\tstack.push(lp + stack.pop() + rp); break;\n\n\t\t\t/* 2.5.198.86 */\n\t\t\tcase 'PtgRefErr': stack.push('#REF!'); break;\n\n\t\t/* */\n\t\t\t/* 2.5.198.58 TODO */\n\t\t\tcase 'PtgExp':\n\t\t\t\tc = {c:f[1][1],r:f[1][0]};\n\t\t\t\tvar q = {c: cell.c, r:cell.r};\n\t\t\t\tif(supbooks.sharedf[encode_cell(c)]) {\n\t\t\t\t\tvar parsedf = (supbooks.sharedf[encode_cell(c)]);\n\t\t\t\t\tstack.push(stringify_formula(parsedf, _range, q, supbooks, opts));\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tvar fnd = false;\n\t\t\t\t\tfor(e1=0;e1!=supbooks.arrayf.length; ++e1) {\n\t\t\t\t\t\t/* TODO: should be something like range_has */\n\t\t\t\t\t\te2 = supbooks.arrayf[e1];\n\t\t\t\t\t\tif(c.c < e2[0].s.c || c.c > e2[0].e.c) continue;\n\t\t\t\t\t\tif(c.r < e2[0].s.r || c.r > e2[0].e.r) continue;\n\t\t\t\t\t\tstack.push(stringify_formula(e2[1], _range, q, supbooks, opts));\n\t\t\t\t\t\tfnd = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t\tif(!fnd) stack.push(f[1]);\n\t\t\t\t}\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.32 TODO */\n\t\t\tcase 'PtgArray':\n\t\t\t\tstack.push(\"{\" + stringify_array(f[1]) + \"}\");\n\t\t\t\tbreak;\n\n\t\t/* 2.2.2.5 Mem Tokens */\n\t\t\t/* 2.5.198.70 TODO: confirm this is a non-display */\n\t\t\tcase 'PtgMemArea':\n\t\t\t\t//stack.push(\"(\" + f[2].map(encode_range).join(\",\") + \")\");\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.38 */\n\t\t\tcase 'PtgAttrSpace':\n\t\t\t/* 2.5.198.39 */\n\t\t\tcase 'PtgAttrSpaceSemi':\n\t\t\t\tlast_sp = ff;\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.92 TODO */\n\t\t\tcase 'PtgTbl': break;\n\n\t\t\t/* 2.5.198.71 */\n\t\t\tcase 'PtgMemErr': break;\n\n\t\t\t/* 2.5.198.74 */\n\t\t\tcase 'PtgMissArg':\n\t\t\t\tstack.push(\"\");\n\t\t\t\tbreak;\n\n\t\t\t/* 2.5.198.29 TODO */\n\t\t\tcase 'PtgAreaErr': break;\n\n\t\t\t/* 2.5.198.31 TODO */\n\t\t\tcase 'PtgAreaN': stack.push(\"\"); break;\n\n\t\t\t/* 2.5.198.87 TODO */\n\t\t\tcase 'PtgRefErr3d': break;\n\n\t\t\t/* 2.5.198.72 TODO */\n\t\t\tcase 'PtgMemFunc': break;\n\n\t\t\tdefault: throw 'Unrecognized Formula Token: ' + f;\n\t\t}\n\t\tvar PtgNonDisp = ['PtgAttrSpace', 'PtgAttrSpaceSemi', 'PtgAttrGoto'];\n\t\tif(last_sp >= 0 && PtgNonDisp.indexOf(formula[0][ff][0]) == -1) {\n\t\t\tf = formula[0][last_sp];\n\t\t\tswitch(f[1][0]) {\n\t\t\t\tcase 0: sp = fill(\" \", f[1][1]); break;\n\t\t\t\tcase 1: sp = fill(\"\\r\", f[1][1]); break;\n\t\t\t\tdefault:\n\t\t\t\t\tsp = \"\";\n\t\t\t\t\tif(opts.WTF) throw new Error(\"Unexpected PtgSpace type \" + f[1][0]);\n\t\t\t}\n\t\t\tstack.push(sp + stack.pop());\n\t\t\tlast_sp = -1;\n\t\t}\n\t\t//console.log(\"::\",f, stack)\n\t}\n\t//console.log(\"--\",stack);\n\tif(stack.length > 1 && opts.WTF) throw new Error(\"bad formula stack\");\n\treturn stack[0];\n}\n/* [MS-XLS] 2.5.198.44 */\nvar PtgDataType = {\n0x1: \"REFERENCE\", // reference to range\n0x2: \"VALUE\", // single value\n0x3: \"ARRAY\" // array of values\n};\n\n/* [MS-XLS] 2.5.198.4 */\nvar Cetab = {\n0x0000: 'BEEP',\n0x0001: 'OPEN',\n0x0002: 'OPEN.LINKS',\n0x0003: 'CLOSE.ALL',\n0x0004: 'SAVE',\n0x0005: 'SAVE.AS',\n0x0006: 'FILE.DELETE',\n0x0007: 'PAGE.SETUP',\n0x0008: 'PRINT',\n0x0009: 'PRINTER.SETUP',\n0x000A: 'QUIT',\n0x000B: 'NEW.WINDOW',\n0x000C: 'ARRANGE.ALL',\n0x000D: 'WINDOW.SIZE',\n0x000E: 'WINDOW.MOVE',\n0x000F: 'FULL',\n0x0010: 'CLOSE',\n0x0011: 'RUN',\n0x0016: 'SET.PRINT.AREA',\n0x0017: 'SET.PRINT.TITLES',\n0x0018: 'SET.PAGE.BREAK',\n0x0019: 'REMOVE.PAGE.BREAK',\n0x001A: 'FONT',\n0x001B: 'DISPLAY',\n0x001C: 'PROTECT.DOCUMENT',\n0x001D: 'PRECISION',\n0x001E: 'A1.R1C1',\n0x001F: 'CALCULATE.NOW',\n0x0020: 'CALCULATION',\n0x0022: 'DATA.FIND',\n0x0023: 'EXTRACT',\n0x0024: 'DATA.DELETE',\n0x0025: 'SET.DATABASE',\n0x0026: 'SET.CRITERIA',\n0x0027: 'SORT',\n0x0028: 'DATA.SERIES',\n0x0029: 'TABLE',\n0x002A: 'FORMAT.NUMBER',\n0x002B: 'ALIGNMENT',\n0x002C: 'STYLE',\n0x002D: 'BORDER',\n0x002E: 'CELL.PROTECTION',\n0x002F: 'COLUMN.WIDTH',\n0x0030: 'UNDO',\n0x0031: 'CUT',\n0x0032: 'COPY',\n0x0033: 'PASTE',\n0x0034: 'CLEAR',\n0x0035: 'PASTE.SPECIAL',\n0x0036: 'EDIT.DELETE',\n0x0037: 'INSERT',\n0x0038: 'FILL.RIGHT',\n0x0039: 'FILL.DOWN',\n0x003D: 'DEFINE.NAME',\n0x003E: 'CREATE.NAMES',\n0x003F: 'FORMULA.GOTO',\n0x0040: 'FORMULA.FIND',\n0x0041: 'SELECT.LAST.CELL',\n0x0042: 'SHOW.ACTIVE.CELL',\n0x0043: 'GALLERY.AREA',\n0x0044: 'GALLERY.BAR',\n0x0045: 'GALLERY.COLUMN',\n0x0046: 'GALLERY.LINE',\n0x0047: 'GALLERY.PIE',\n0x0048: 'GALLERY.SCATTER',\n0x0049: 'COMBINATION',\n0x004A: 'PREFERRED',\n0x004B: 'ADD.OVERLAY',\n0x004C: 'GRIDLINES',\n0x004D: 'SET.PREFERRED',\n0x004E: 'AXES',\n0x004F: 'LEGEND',\n0x0050: 'ATTACH.TEXT',\n0x0051: 'ADD.ARROW',\n0x0052: 'SELECT.CHART',\n0x0053: 'SELECT.PLOT.AREA',\n0x0054: 'PATTERNS',\n0x0055: 'MAIN.CHART',\n0x0056: 'OVERLAY',\n0x0057: 'SCALE',\n0x0058: 'FORMAT.LEGEND',\n0x0059: 'FORMAT.TEXT',\n0x005A: 'EDIT.REPEAT',\n0x005B: 'PARSE',\n0x005C: 'JUSTIFY',\n0x005D: 'HIDE',\n0x005E: 'UNHIDE',\n0x005F: 'WORKSPACE',\n0x0060: 'FORMULA',\n0x0061: 'FORMULA.FILL',\n0x0062: 'FORMULA.ARRAY',\n0x0063: 'DATA.FIND.NEXT',\n0x0064: 'DATA.FIND.PREV',\n0x0065: 'FORMULA.FIND.NEXT',\n0x0066: 'FORMULA.FIND.PREV',\n0x0067: 'ACTIVATE',\n0x0068: 'ACTIVATE.NEXT',\n0x0069: 'ACTIVATE.PREV',\n0x006A: 'UNLOCKED.NEXT',\n0x006B: 'UNLOCKED.PREV',\n0x006C: 'COPY.PICTURE',\n0x006D: 'SELECT',\n0x006E: 'DELETE.NAME',\n0x006F: 'DELETE.FORMAT',\n0x0070: 'VLINE',\n0x0071: 'HLINE',\n0x0072: 'VPAGE',\n0x0073: 'HPAGE',\n0x0074: 'VSCROLL',\n0x0075: 'HSCROLL',\n0x0076: 'ALERT',\n0x0077: 'NEW',\n0x0078: 'CANCEL.COPY',\n0x0079: 'SHOW.CLIPBOARD',\n0x007A: 'MESSAGE',\n0x007C: 'PASTE.LINK',\n0x007D: 'APP.ACTIVATE',\n0x007E: 'DELETE.ARROW',\n0x007F: 'ROW.HEIGHT',\n0x0080: 'FORMAT.MOVE',\n0x0081: 'FORMAT.SIZE',\n0x0082: 'FORMULA.REPLACE',\n0x0083: 'SEND.KEYS',\n0x0084: 'SELECT.SPECIAL',\n0x0085: 'APPLY.NAMES',\n0x0086: 'REPLACE.FONT',\n0x0087: 'FREEZE.PANES',\n0x0088: 'SHOW.INFO',\n0x0089: 'SPLIT',\n0x008A: 'ON.WINDOW',\n0x008B: 'ON.DATA',\n0x008C: 'DISABLE.INPUT',\n0x008E: 'OUTLINE',\n0x008F: 'LIST.NAMES',\n0x0090: 'FILE.CLOSE',\n0x0091: 'SAVE.WORKBOOK',\n0x0092: 'DATA.FORM',\n0x0093: 'COPY.CHART',\n0x0094: 'ON.TIME',\n0x0095: 'WAIT',\n0x0096: 'FORMAT.FONT',\n0x0097: 'FILL.UP',\n0x0098: 'FILL.LEFT',\n0x0099: 'DELETE.OVERLAY',\n0x009B: 'SHORT.MENUS',\n0x009F: 'SET.UPDATE.STATUS',\n0x00A1: 'COLOR.PALETTE',\n0x00A2: 'DELETE.STYLE',\n0x00A3: 'WINDOW.RESTORE',\n0x00A4: 'WINDOW.MAXIMIZE',\n0x00A6: 'CHANGE.LINK',\n0x00A7: 'CALCULATE.DOCUMENT',\n0x00A8: 'ON.KEY',\n0x00A9: 'APP.RESTORE',\n0x00AA: 'APP.MOVE',\n0x00AB: 'APP.SIZE',\n0x00AC: 'APP.MINIMIZE',\n0x00AD: 'APP.MAXIMIZE',\n0x00AE: 'BRING.TO.FRONT',\n0x00AF: 'SEND.TO.BACK',\n0x00B9: 'MAIN.CHART.TYPE',\n0x00BA: 'OVERLAY.CHART.TYPE',\n0x00BB: 'SELECT.END',\n0x00BC: 'OPEN.MAIL',\n0x00BD: 'SEND.MAIL',\n0x00BE: 'STANDARD.FONT',\n0x00BF: 'CONSOLIDATE',\n0x00C0: 'SORT.SPECIAL',\n0x00C1: 'GALLERY.3D.AREA',\n0x00C2: 'GALLERY.3D.COLUMN',\n0x00C3: 'GALLERY.3D.LINE',\n0x00C4: 'GALLERY.3D.PIE',\n0x00C5: 'VIEW.3D',\n0x00C6: 'GOAL.SEEK',\n0x00C7: 'WORKGROUP',\n0x00C8: 'FILL.GROUP',\n0x00C9: 'UPDATE.LINK',\n0x00CA: 'PROMOTE',\n0x00CB: 'DEMOTE',\n0x00CC: 'SHOW.DETAIL',\n0x00CE: 'UNGROUP',\n0x00CF: 'OBJECT.PROPERTIES',\n0x00D0: 'SAVE.NEW.OBJECT',\n0x00D1: 'SHARE',\n0x00D2: 'SHARE.NAME',\n0x00D3: 'DUPLICATE',\n0x00D4: 'APPLY.STYLE',\n0x00D5: 'ASSIGN.TO.OBJECT',\n0x00D6: 'OBJECT.PROTECTION',\n0x00D7: 'HIDE.OBJECT',\n0x00D8: 'SET.EXTRACT',\n0x00D9: 'CREATE.PUBLISHER',\n0x00DA: 'SUBSCRIBE.TO',\n0x00DB: 'ATTRIBUTES',\n0x00DC: 'SHOW.TOOLBAR',\n0x00DE: 'PRINT.PREVIEW',\n0x00DF: 'EDIT.COLOR',\n0x00E0: 'SHOW.LEVELS',\n0x00E1: 'FORMAT.MAIN',\n0x00E2: 'FORMAT.OVERLAY',\n0x00E3: 'ON.RECALC',\n0x00E4: 'EDIT.SERIES',\n0x00E5: 'DEFINE.STYLE',\n0x00F0: 'LINE.PRINT',\n0x00F3: 'ENTER.DATA',\n0x00F9: 'GALLERY.RADAR',\n0x00FA: 'MERGE.STYLES',\n0x00FB: 'EDITION.OPTIONS',\n0x00FC: 'PASTE.PICTURE',\n0x00FD: 'PASTE.PICTURE.LINK',\n0x00FE: 'SPELLING',\n0x0100: 'ZOOM',\n0x0103: 'INSERT.OBJECT',\n0x0104: 'WINDOW.MINIMIZE',\n0x0109: 'SOUND.NOTE',\n0x010A: 'SOUND.PLAY',\n0x010B: 'FORMAT.SHAPE',\n0x010C: 'EXTEND.POLYGON',\n0x010D: 'FORMAT.AUTO',\n0x0110: 'GALLERY.3D.BAR',\n0x0111: 'GALLERY.3D.SURFACE',\n0x0112: 'FILL.AUTO',\n0x0114: 'CUSTOMIZE.TOOLBAR',\n0x0115: 'ADD.TOOL',\n0x0116: 'EDIT.OBJECT',\n0x0117: 'ON.DOUBLECLICK',\n0x0118: 'ON.ENTRY',\n0x0119: 'WORKBOOK.ADD',\n0x011A: 'WORKBOOK.MOVE',\n0x011B: 'WORKBOOK.COPY',\n0x011C: 'WORKBOOK.OPTIONS',\n0x011D: 'SAVE.WORKSPACE',\n0x0120: 'CHART.WIZARD',\n0x0121: 'DELETE.TOOL',\n0x0122: 'MOVE.TOOL',\n0x0123: 'WORKBOOK.SELECT',\n0x0124: 'WORKBOOK.ACTIVATE',\n0x0125: 'ASSIGN.TO.TOOL',\n0x0127: 'COPY.TOOL',\n0x0128: 'RESET.TOOL',\n0x0129: 'CONSTRAIN.NUMERIC',\n0x012A: 'PASTE.TOOL',\n0x012E: 'WORKBOOK.NEW',\n0x0131: 'SCENARIO.CELLS',\n0x0132: 'SCENARIO.DELETE',\n0x0133: 'SCENARIO.ADD',\n0x0134: 'SCENARIO.EDIT',\n0x0135: 'SCENARIO.SHOW',\n0x0136: 'SCENARIO.SHOW.NEXT',\n0x0137: 'SCENARIO.SUMMARY',\n0x0138: 'PIVOT.TABLE.WIZARD',\n0x0139: 'PIVOT.FIELD.PROPERTIES',\n0x013A: 'PIVOT.FIELD',\n0x013B: 'PIVOT.ITEM',\n0x013C: 'PIVOT.ADD.FIELDS',\n0x013E: 'OPTIONS.CALCULATION',\n0x013F: 'OPTIONS.EDIT',\n0x0140: 'OPTIONS.VIEW',\n0x0141: 'ADDIN.MANAGER',\n0x0142: 'MENU.EDITOR',\n0x0143: 'ATTACH.TOOLBARS',\n0x0144: 'VBAActivate',\n0x0145: 'OPTIONS.CHART',\n0x0148: 'VBA.INSERT.FILE',\n0x014A: 'VBA.PROCEDURE.DEFINITION',\n0x0150: 'ROUTING.SLIP',\n0x0152: 'ROUTE.DOCUMENT',\n0x0153: 'MAIL.LOGON',\n0x0156: 'INSERT.PICTURE',\n0x0157: 'EDIT.TOOL',\n0x0158: 'GALLERY.DOUGHNUT',\n0x015E: 'CHART.TREND',\n0x0160: 'PIVOT.ITEM.PROPERTIES',\n0x0162: 'WORKBOOK.INSERT',\n0x0163: 'OPTIONS.TRANSITION',\n0x0164: 'OPTIONS.GENERAL',\n0x0172: 'FILTER.ADVANCED',\n0x0175: 'MAIL.ADD.MAILER',\n0x0176: 'MAIL.DELETE.MAILER',\n0x0177: 'MAIL.REPLY',\n0x0178: 'MAIL.REPLY.ALL',\n0x0179: 'MAIL.FORWARD',\n0x017A: 'MAIL.NEXT.LETTER',\n0x017B: 'DATA.LABEL',\n0x017C: 'INSERT.TITLE',\n0x017D: 'FONT.PROPERTIES',\n0x017E: 'MACRO.OPTIONS',\n0x017F: 'WORKBOOK.HIDE',\n0x0180: 'WORKBOOK.UNHIDE',\n0x0181: 'WORKBOOK.DELETE',\n0x0182: 'WORKBOOK.NAME',\n0x0184: 'GALLERY.CUSTOM',\n0x0186: 'ADD.CHART.AUTOFORMAT',\n0x0187: 'DELETE.CHART.AUTOFORMAT',\n0x0188: 'CHART.ADD.DATA',\n0x0189: 'AUTO.OUTLINE',\n0x018A: 'TAB.ORDER',\n0x018B: 'SHOW.DIALOG',\n0x018C: 'SELECT.ALL',\n0x018D: 'UNGROUP.SHEETS',\n0x018E: 'SUBTOTAL.CREATE',\n0x018F: 'SUBTOTAL.REMOVE',\n0x0190: 'RENAME.OBJECT',\n0x019C: 'WORKBOOK.SCROLL',\n0x019D: 'WORKBOOK.NEXT',\n0x019E: 'WORKBOOK.PREV',\n0x019F: 'WORKBOOK.TAB.SPLIT',\n0x01A0: 'FULL.SCREEN',\n0x01A1: 'WORKBOOK.PROTECT',\n0x01A4: 'SCROLLBAR.PROPERTIES',\n0x01A5: 'PIVOT.SHOW.PAGES',\n0x01A6: 'TEXT.TO.COLUMNS',\n0x01A7: 'FORMAT.CHARTTYPE',\n0x01A8: 'LINK.FORMAT',\n0x01A9: 'TRACER.DISPLAY',\n0x01AE: 'TRACER.NAVIGATE',\n0x01AF: 'TRACER.CLEAR',\n0x01B0: 'TRACER.ERROR',\n0x01B1: 'PIVOT.FIELD.GROUP',\n0x01B2: 'PIVOT.FIELD.UNGROUP',\n0x01B3: 'CHECKBOX.PROPERTIES',\n0x01B4: 'LABEL.PROPERTIES',\n0x01B5: 'LISTBOX.PROPERTIES',\n0x01B6: 'EDITBOX.PROPERTIES',\n0x01B7: 'PIVOT.REFRESH',\n0x01B8: 'LINK.COMBO',\n0x01B9: 'OPEN.TEXT',\n0x01BA: 'HIDE.DIALOG',\n0x01BB: 'SET.DIALOG.FOCUS',\n0x01BC: 'ENABLE.OBJECT',\n0x01BD: 'PUSHBUTTON.PROPERTIES',\n0x01BE: 'SET.DIALOG.DEFAULT',\n0x01BF: 'FILTER',\n0x01C0: 'FILTER.SHOW.ALL',\n0x01C1: 'CLEAR.OUTLINE',\n0x01C2: 'FUNCTION.WIZARD',\n0x01C3: 'ADD.LIST.ITEM',\n0x01C4: 'SET.LIST.ITEM',\n0x01C5: 'REMOVE.LIST.ITEM',\n0x01C6: 'SELECT.LIST.ITEM',\n0x01C7: 'SET.CONTROL.VALUE',\n0x01C8: 'SAVE.COPY.AS',\n0x01CA: 'OPTIONS.LISTS.ADD',\n0x01CB: 'OPTIONS.LISTS.DELETE',\n0x01CC: 'SERIES.AXES',\n0x01CD: 'SERIES.X',\n0x01CE: 'SERIES.Y',\n0x01CF: 'ERRORBAR.X',\n0x01D0: 'ERRORBAR.Y',\n0x01D1: 'FORMAT.CHART',\n0x01D2: 'SERIES.ORDER',\n0x01D3: 'MAIL.LOGOFF',\n0x01D4: 'CLEAR.ROUTING.SLIP',\n0x01D5: 'APP.ACTIVATE.MICROSOFT',\n0x01D6: 'MAIL.EDIT.MAILER',\n0x01D7: 'ON.SHEET',\n0x01D8: 'STANDARD.WIDTH',\n0x01D9: 'SCENARIO.MERGE',\n0x01DA: 'SUMMARY.INFO',\n0x01DB: 'FIND.FILE',\n0x01DC: 'ACTIVE.CELL.FONT',\n0x01DD: 'ENABLE.TIPWIZARD',\n0x01DE: 'VBA.MAKE.ADDIN',\n0x01E0: 'INSERTDATATABLE',\n0x01E1: 'WORKGROUP.OPTIONS',\n0x01E2: 'MAIL.SEND.MAILER',\n0x01E5: 'AUTOCORRECT',\n0x01E9: 'POST.DOCUMENT',\n0x01EB: 'PICKLIST',\n0x01ED: 'VIEW.SHOW',\n0x01EE: 'VIEW.DEFINE',\n0x01EF: 'VIEW.DELETE',\n0x01FD: 'SHEET.BACKGROUND',\n0x01FE: 'INSERT.MAP.OBJECT',\n0x01FF: 'OPTIONS.MENONO',\n0x0205: 'MSOCHECKS',\n0x0206: 'NORMAL',\n0x0207: 'LAYOUT',\n0x0208: 'RM.PRINT.AREA',\n0x0209: 'CLEAR.PRINT.AREA',\n0x020A: 'ADD.PRINT.AREA',\n0x020B: 'MOVE.BRK',\n0x0221: 'HIDECURR.NOTE',\n0x0222: 'HIDEALL.NOTES',\n0x0223: 'DELETE.NOTE',\n0x0224: 'TRAVERSE.NOTES',\n0x0225: 'ACTIVATE.NOTES',\n0x026C: 'PROTECT.REVISIONS',\n0x026D: 'UNPROTECT.REVISIONS',\n0x0287: 'OPTIONS.ME',\n0x028D: 'WEB.PUBLISH',\n0x029B: 'NEWWEBQUERY',\n0x02A1: 'PIVOT.TABLE.CHART',\n0x02F1: 'OPTIONS.SAVE',\n0x02F3: 'OPTIONS.SPELL',\n0x0328: 'HIDEALL.INKANNOTS'\n};\n\n/* [MS-XLS] 2.5.198.17 */\n/* [MS-XLSB] 2.5.97.10 */\nvar Ftab = {\n0x0000: 'COUNT',\n0x0001: 'IF',\n0x0002: 'ISNA',\n0x0003: 'ISERROR',\n0x0004: 'SUM',\n0x0005: 'AVERAGE',\n0x0006: 'MIN',\n0x0007: 'MAX',\n0x0008: 'ROW',\n0x0009: 'COLUMN',\n0x000A: 'NA',\n0x000B: 'NPV',\n0x000C: 'STDEV',\n0x000D: 'DOLLAR',\n0x000E: 'FIXED',\n0x000F: 'SIN',\n0x0010: 'COS',\n0x0011: 'TAN',\n0x0012: 'ATAN',\n0x0013: 'PI',\n0x0014: 'SQRT',\n0x0015: 'EXP',\n0x0016: 'LN',\n0x0017: 'LOG10',\n0x0018: 'ABS',\n0x0019: 'INT',\n0x001A: 'SIGN',\n0x001B: 'ROUND',\n0x001C: 'LOOKUP',\n0x001D: 'INDEX',\n0x001E: 'REPT',\n0x001F: 'MID',\n0x0020: 'LEN',\n0x0021: 'VALUE',\n0x0022: 'TRUE',\n0x0023: 'FALSE',\n0x0024: 'AND',\n0x0025: 'OR',\n0x0026: 'NOT',\n0x0027: 'MOD',\n0x0028: 'DCOUNT',\n0x0029: 'DSUM',\n0x002A: 'DAVERAGE',\n0x002B: 'DMIN',\n0x002C: 'DMAX',\n0x002D: 'DSTDEV',\n0x002E: 'VAR',\n0x002F: 'DVAR',\n0x0030: 'TEXT',\n0x0031: 'LINEST',\n0x0032: 'TREND',\n0x0033: 'LOGEST',\n0x0034: 'GROWTH',\n0x0035: 'GOTO',\n0x0036: 'HALT',\n0x0037: 'RETURN',\n0x0038: 'PV',\n0x0039: 'FV',\n0x003A: 'NPER',\n0x003B: 'PMT',\n0x003C: 'RATE',\n0x003D: 'MIRR',\n0x003E: 'IRR',\n0x003F: 'RAND',\n0x0040: 'MATCH',\n0x0041: 'DATE',\n0x0042: 'TIME',\n0x0043: 'DAY',\n0x0044: 'MONTH',\n0x0045: 'YEAR',\n0x0046: 'WEEKDAY',\n0x0047: 'HOUR',\n0x0048: 'MINUTE',\n0x0049: 'SECOND',\n0x004A: 'NOW',\n0x004B: 'AREAS',\n0x004C: 'ROWS',\n0x004D: 'COLUMNS',\n0x004E: 'OFFSET',\n0x004F: 'ABSREF',\n0x0050: 'RELREF',\n0x0051: 'ARGUMENT',\n0x0052: 'SEARCH',\n0x0053: 'TRANSPOSE',\n0x0054: 'ERROR',\n0x0055: 'STEP',\n0x0056: 'TYPE',\n0x0057: 'ECHO',\n0x0058: 'SET.NAME',\n0x0059: 'CALLER',\n0x005A: 'DEREF',\n0x005B: 'WINDOWS',\n0x005C: 'SERIES',\n0x005D: 'DOCUMENTS',\n0x005E: 'ACTIVE.CELL',\n0x005F: 'SELECTION',\n0x0060: 'RESULT',\n0x0061: 'ATAN2',\n0x0062: 'ASIN',\n0x0063: 'ACOS',\n0x0064: 'CHOOSE',\n0x0065: 'HLOOKUP',\n0x0066: 'VLOOKUP',\n0x0067: 'LINKS',\n0x0068: 'INPUT',\n0x0069: 'ISREF',\n0x006A: 'GET.FORMULA',\n0x006B: 'GET.NAME',\n0x006C: 'SET.VALUE',\n0x006D: 'LOG',\n0x006E: 'EXEC',\n0x006F: 'CHAR',\n0x0070: 'LOWER',\n0x0071: 'UPPER',\n0x0072: 'PROPER',\n0x0073: 'LEFT',\n0x0074: 'RIGHT',\n0x0075: 'EXACT',\n0x0076: 'TRIM',\n0x0077: 'REPLACE',\n0x0078: 'SUBSTITUTE',\n0x0079: 'CODE',\n0x007A: 'NAMES',\n0x007B: 'DIRECTORY',\n0x007C: 'FIND',\n0x007D: 'CELL',\n0x007E: 'ISERR',\n0x007F: 'ISTEXT',\n0x0080: 'ISNUMBER',\n0x0081: 'ISBLANK',\n0x0082: 'T',\n0x0083: 'N',\n0x0084: 'FOPEN',\n0x0085: 'FCLOSE',\n0x0086: 'FSIZE',\n0x0087: 'FREADLN',\n0x0088: 'FREAD',\n0x0089: 'FWRITELN',\n0x008A: 'FWRITE',\n0x008B: 'FPOS',\n0x008C: 'DATEVALUE',\n0x008D: 'TIMEVALUE',\n0x008E: 'SLN',\n0x008F: 'SYD',\n0x0090: 'DDB',\n0x0091: 'GET.DEF',\n0x0092: 'REFTEXT',\n0x0093: 'TEXTREF',\n0x0094: 'INDIRECT',\n0x0095: 'REGISTER',\n0x0096: 'CALL',\n0x0097: 'ADD.BAR',\n0x0098: 'ADD.MENU',\n0x0099: 'ADD.COMMAND',\n0x009A: 'ENABLE.COMMAND',\n0x009B: 'CHECK.COMMAND',\n0x009C: 'RENAME.COMMAND',\n0x009D: 'SHOW.BAR',\n0x009E: 'DELETE.MENU',\n0x009F: 'DELETE.COMMAND',\n0x00A0: 'GET.CHART.ITEM',\n0x00A1: 'DIALOG.BOX',\n0x00A2: 'CLEAN',\n0x00A3: 'MDETERM',\n0x00A4: 'MINVERSE',\n0x00A5: 'MMULT',\n0x00A6: 'FILES',\n0x00A7: 'IPMT',\n0x00A8: 'PPMT',\n0x00A9: 'COUNTA',\n0x00AA: 'CANCEL.KEY',\n0x00AB: 'FOR',\n0x00AC: 'WHILE',\n0x00AD: 'BREAK',\n0x00AE: 'NEXT',\n0x00AF: 'INITIATE',\n0x00B0: 'REQUEST',\n0x00B1: 'POKE',\n0x00B2: 'EXECUTE',\n0x00B3: 'TERMINATE',\n0x00B4: 'RESTART',\n0x00B5: 'HELP',\n0x00B6: 'GET.BAR',\n0x00B7: 'PRODUCT',\n0x00B8: 'FACT',\n0x00B9: 'GET.CELL',\n0x00BA: 'GET.WORKSPACE',\n0x00BB: 'GET.WINDOW',\n0x00BC: 'GET.DOCUMENT',\n0x00BD: 'DPRODUCT',\n0x00BE: 'ISNONTEXT',\n0x00BF: 'GET.NOTE',\n0x00C0: 'NOTE',\n0x00C1: 'STDEVP',\n0x00C2: 'VARP',\n0x00C3: 'DSTDEVP',\n0x00C4: 'DVARP',\n0x00C5: 'TRUNC',\n0x00C6: 'ISLOGICAL',\n0x00C7: 'DCOUNTA',\n0x00C8: 'DELETE.BAR',\n0x00C9: 'UNREGISTER',\n0x00CC: 'USDOLLAR',\n0x00CD: 'FINDB',\n0x00CE: 'SEARCHB',\n0x00CF: 'REPLACEB',\n0x00D0: 'LEFTB',\n0x00D1: 'RIGHTB',\n0x00D2: 'MIDB',\n0x00D3: 'LENB',\n0x00D4: 'ROUNDUP',\n0x00D5: 'ROUNDDOWN',\n0x00D6: 'ASC',\n0x00D7: 'DBCS',\n0x00D8: 'RANK',\n0x00DB: 'ADDRESS',\n0x00DC: 'DAYS360',\n0x00DD: 'TODAY',\n0x00DE: 'VDB',\n0x00DF: 'ELSE',\n0x00E0: 'ELSE.IF',\n0x00E1: 'END.IF',\n0x00E2: 'FOR.CELL',\n0x00E3: 'MEDIAN',\n0x00E4: 'SUMPRODUCT',\n0x00E5: 'SINH',\n0x00E6: 'COSH',\n0x00E7: 'TANH',\n0x00E8: 'ASINH',\n0x00E9: 'ACOSH',\n0x00EA: 'ATANH',\n0x00EB: 'DGET',\n0x00EC: 'CREATE.OBJECT',\n0x00ED: 'VOLATILE',\n0x00EE: 'LAST.ERROR',\n0x00EF: 'CUSTOM.UNDO',\n0x00F0: 'CUSTOM.REPEAT',\n0x00F1: 'FORMULA.CONVERT',\n0x00F2: 'GET.LINK.INFO',\n0x00F3: 'TEXT.BOX',\n0x00F4: 'INFO',\n0x00F5: 'GROUP',\n0x00F6: 'GET.OBJECT',\n0x00F7: 'DB',\n0x00F8: 'PAUSE',\n0x00FB: 'RESUME',\n0x00FC: 'FREQUENCY',\n0x00FD: 'ADD.TOOLBAR',\n0x00FE: 'DELETE.TOOLBAR',\n0x00FF: 'User',\n0x0100: 'RESET.TOOLBAR',\n0x0101: 'EVALUATE',\n0x0102: 'GET.TOOLBAR',\n0x0103: 'GET.TOOL',\n0x0104: 'SPELLING.CHECK',\n0x0105: 'ERROR.TYPE',\n0x0106: 'APP.TITLE',\n0x0107: 'WINDOW.TITLE',\n0x0108: 'SAVE.TOOLBAR',\n0x0109: 'ENABLE.TOOL',\n0x010A: 'PRESS.TOOL',\n0x010B: 'REGISTER.ID',\n0x010C: 'GET.WORKBOOK',\n0x010D: 'AVEDEV',\n0x010E: 'BETADIST',\n0x010F: 'GAMMALN',\n0x0110: 'BETAINV',\n0x0111: 'BINOMDIST',\n0x0112: 'CHIDIST',\n0x0113: 'CHIINV',\n0x0114: 'COMBIN',\n0x0115: 'CONFIDENCE',\n0x0116: 'CRITBINOM',\n0x0117: 'EVEN',\n0x0118: 'EXPONDIST',\n0x0119: 'FDIST',\n0x011A: 'FINV',\n0x011B: 'FISHER',\n0x011C: 'FISHERINV',\n0x011D: 'FLOOR',\n0x011E: 'GAMMADIST',\n0x011F: 'GAMMAINV',\n0x0120: 'CEILING',\n0x0121: 'HYPGEOMDIST',\n0x0122: 'LOGNORMDIST',\n0x0123: 'LOGINV',\n0x0124: 'NEGBINOMDIST',\n0x0125: 'NORMDIST',\n0x0126: 'NORMSDIST',\n0x0127: 'NORMINV',\n0x0128: 'NORMSINV',\n0x0129: 'STANDARDIZE',\n0x012A: 'ODD',\n0x012B: 'PERMUT',\n0x012C: 'POISSON',\n0x012D: 'TDIST',\n0x012E: 'WEIBULL',\n0x012F: 'SUMXMY2',\n0x0130: 'SUMX2MY2',\n0x0131: 'SUMX2PY2',\n0x0132: 'CHITEST',\n0x0133: 'CORREL',\n0x0134: 'COVAR',\n0x0135: 'FORECAST',\n0x0136: 'FTEST',\n0x0137: 'INTERCEPT',\n0x0138: 'PEARSON',\n0x0139: 'RSQ',\n0x013A: 'STEYX',\n0x013B: 'SLOPE',\n0x013C: 'TTEST',\n0x013D: 'PROB',\n0x013E: 'DEVSQ',\n0x013F: 'GEOMEAN',\n0x0140: 'HARMEAN',\n0x0141: 'SUMSQ',\n0x0142: 'KURT',\n0x0143: 'SKEW',\n0x0144: 'ZTEST',\n0x0145: 'LARGE',\n0x0146: 'SMALL',\n0x0147: 'QUARTILE',\n0x0148: 'PERCENTILE',\n0x0149: 'PERCENTRANK',\n0x014A: 'MODE',\n0x014B: 'TRIMMEAN',\n0x014C: 'TINV',\n0x014E: 'MOVIE.COMMAND',\n0x014F: 'GET.MOVIE',\n0x0150: 'CONCATENATE',\n0x0151: 'POWER',\n0x0152: 'PIVOT.ADD.DATA',\n0x0153: 'GET.PIVOT.TABLE',\n0x0154: 'GET.PIVOT.FIELD',\n0x0155: 'GET.PIVOT.ITEM',\n0x0156: 'RADIANS',\n0x0157: 'DEGREES',\n0x0158: 'SUBTOTAL',\n0x0159: 'SUMIF',\n0x015A: 'COUNTIF',\n0x015B: 'COUNTBLANK',\n0x015C: 'SCENARIO.GET',\n0x015D: 'OPTIONS.LISTS.GET',\n0x015E: 'ISPMT',\n0x015F: 'DATEDIF',\n0x0160: 'DATESTRING',\n0x0161: 'NUMBERSTRING',\n0x0162: 'ROMAN',\n0x0163: 'OPEN.DIALOG',\n0x0164: 'SAVE.DIALOG',\n0x0165: 'VIEW.GET',\n0x0166: 'GETPIVOTDATA',\n0x0167: 'HYPERLINK',\n0x0168: 'PHONETIC',\n0x0169: 'AVERAGEA',\n0x016A: 'MAXA',\n0x016B: 'MINA',\n0x016C: 'STDEVPA',\n0x016D: 'VARPA',\n0x016E: 'STDEVA',\n0x016F: 'VARA',\n0x0170: 'BAHTTEXT',\n0x0171: 'THAIDAYOFWEEK',\n0x0172: 'THAIDIGIT',\n0x0173: 'THAIMONTHOFYEAR',\n0x0174: 'THAINUMSOUND',\n0x0175: 'THAINUMSTRING',\n0x0176: 'THAISTRINGLENGTH',\n0x0177: 'ISTHAIDIGIT',\n0x0178: 'ROUNDBAHTDOWN',\n0x0179: 'ROUNDBAHTUP',\n0x017A: 'THAIYEAR',\n0x017B: 'RTD',\n\n0x017C: 'CUBEVALUE',\n0x017D: 'CUBEMEMBER',\n0x017E: 'CUBEMEMBERPROPERTY',\n0x017F: 'CUBERANKEDMEMBER',\n0x0180: 'HEX2BIN',\n0x0181: 'HEX2DEC',\n0x0182: 'HEX2OCT',\n0x0183: 'DEC2BIN',\n0x0184: 'DEC2HEX',\n0x0185: 'DEC2OCT',\n0x0186: 'OCT2BIN',\n0x0187: 'OCT2HEX',\n0x0188: 'OCT2DEC',\n0x0189: 'BIN2DEC',\n0x018A: 'BIN2OCT',\n0x018B: 'BIN2HEX',\n0x018C: 'IMSUB',\n0x018D: 'IMDIV',\n0x018E: 'IMPOWER',\n0x018F: 'IMABS',\n0x0190: 'IMSQRT',\n0x0191: 'IMLN',\n0x0192: 'IMLOG2',\n0x0193: 'IMLOG10',\n0x0194: 'IMSIN',\n0x0195: 'IMCOS',\n0x0196: 'IMEXP',\n0x0197: 'IMARGUMENT',\n0x0198: 'IMCONJUGATE',\n0x0199: 'IMAGINARY',\n0x019A: 'IMREAL',\n0x019B: 'COMPLEX',\n0x019C: 'IMSUM',\n0x019D: 'IMPRODUCT',\n0x019E: 'SERIESSUM',\n0x019F: 'FACTDOUBLE',\n0x01A0: 'SQRTPI',\n0x01A1: 'QUOTIENT',\n0x01A2: 'DELTA',\n0x01A3: 'GESTEP',\n0x01A4: 'ISEVEN',\n0x01A5: 'ISODD',\n0x01A6: 'MROUND',\n0x01A7: 'ERF',\n0x01A8: 'ERFC',\n0x01A9: 'BESSELJ',\n0x01AA: 'BESSELK',\n0x01AB: 'BESSELY',\n0x01AC: 'BESSELI',\n0x01AD: 'XIRR',\n0x01AE: 'XNPV',\n0x01AF: 'PRICEMAT',\n0x01B0: 'YIELDMAT',\n0x01B1: 'INTRATE',\n0x01B2: 'RECEIVED',\n0x01B3: 'DISC',\n0x01B4: 'PRICEDISC',\n0x01B5: 'YIELDDISC',\n0x01B6: 'TBILLEQ',\n0x01B7: 'TBILLPRICE',\n0x01B8: 'TBILLYIELD',\n0x01B9: 'PRICE',\n0x01BA: 'YIELD',\n0x01BB: 'DOLLARDE',\n0x01BC: 'DOLLARFR',\n0x01BD: 'NOMINAL',\n0x01BE: 'EFFECT',\n0x01BF: 'CUMPRINC',\n0x01C0: 'CUMIPMT',\n0x01C1: 'EDATE',\n0x01C2: 'EOMONTH',\n0x01C3: 'YEARFRAC',\n0x01C4: 'COUPDAYBS',\n0x01C5: 'COUPDAYS',\n0x01C6: 'COUPDAYSNC',\n0x01C7: 'COUPNCD',\n0x01C8: 'COUPNUM',\n0x01C9: 'COUPPCD',\n0x01CA: 'DURATION',\n0x01CB: 'MDURATION',\n0x01CC: 'ODDLPRICE',\n0x01CD: 'ODDLYIELD',\n0x01CE: 'ODDFPRICE',\n0x01CF: 'ODDFYIELD',\n0x01D0: 'RANDBETWEEN',\n0x01D1: 'WEEKNUM',\n0x01D2: 'AMORDEGRC',\n0x01D3: 'AMORLINC',\n0x01D4: 'SHEETJS',\n0x01D5: 'ACCRINT',\n0x01D6: 'ACCRINTM',\n0x01D7: 'WORKDAY',\n0x01D8: 'NETWORKDAYS',\n0x01D9: 'GCD',\n0x01DA: 'MULTINOMIAL',\n0x01DB: 'LCM',\n0x01DC: 'FVSCHEDULE',\n0x01DD: 'CUBEKPIMEMBER',\n0x01DE: 'CUBESET',\n0x01DF: 'CUBESETCOUNT',\n0x01E0: 'IFERROR',\n0x01E1: 'COUNTIFS',\n0x01E2: 'SUMIFS',\n0x01E3: 'AVERAGEIF',\n0x01E4: 'AVERAGEIFS'\n};\nvar FtabArgc = {\n0x0002: 1, /* ISNA */\n0x0003: 1, /* ISERROR */\n0x000F: 1, /* SIN */\n0x0010: 1, /* COS */\n0x0011: 1, /* TAN */\n0x0012: 1, /* ATAN */\n0x0013: 0, /* PI */\n0x0014: 1, /* SQRT */\n0x0015: 1, /* EXP */\n0x0016: 1, /* LN */\n0x0017: 1, /* LOG10 */\n0x0018: 1, /* ABS */\n0x0019: 1, /* INT */\n0x001A: 1, /* SIGN */\n0x001B: 2, /* ROUND */\n0x001E: 2, /* REPT */\n0x001F: 3, /* MID */\n0x0020: 1, /* LEN */\n0x0021: 1, /* VALUE */\n0x0026: 1, /* NOT */\n0x0027: 2, /* MOD */\n0x0028: 3, /* DCOUNT */\n0x0029: 3, /* DSUM */\n0x002A: 3, /* DAVERAGE */\n0x002B: 3, /* DMIN */\n0x002C: 3, /* DMAX */\n0x002D: 3, /* DSTDEV */\n0x002F: 3, /* DVAR */\n0x0030: 2, /* TEXT */\n0x0035: 1, /* GOTO */\n0x003D: 3, /* MIRR */\n0x0041: 3, /* DATE */\n0x0042: 3, /* TIME */\n0x0043: 1, /* DAY */\n0x0044: 1, /* MONTH */\n0x0045: 1, /* YEAR */\n0x0046: 1, /* WEEKDAY */\n0x0047: 1, /* HOUR */\n0x0048: 1, /* MINUTE */\n0x0049: 1, /* SECOND */\n0x004B: 1, /* AREAS */\n0x004C: 1, /* ROWS */\n0x004D: 1, /* COLUMNS */\n0x004F: 2, /* ABSREF */\n0x0050: 2, /* RELREF */\n0x0053: 1, /* TRANSPOSE */\n0x0055: 0, /* STEP */\n0x0056: 1, /* TYPE */\n0x005A: 1, /* DEREF */\n0x0061: 2, /* ATAN2 */\n0x0062: 1, /* ASIN */\n0x0063: 1, /* ACOS */\n0x0065: 3, /* HLOOKUP */\n0x0066: 3, /* VLOOKUP */\n0x0069: 1, /* ISREF */\n0x006F: 1, /* CHAR */\n0x0070: 1, /* LOWER */\n0x0071: 1, /* UPPER */\n0x0072: 1, /* PROPER */\n0x0075: 2, /* EXACT */\n0x0076: 1, /* TRIM */\n0x0077: 4, /* REPLACE */\n0x0079: 1, /* CODE */\n0x007E: 1, /* ISERR */\n0x007F: 1, /* ISTEXT */\n0x0080: 1, /* ISNUMBER */\n0x0081: 1, /* ISBLANK */\n0x0082: 1, /* T */\n0x0083: 1, /* N */\n0x0085: 1, /* FCLOSE */\n0x0086: 1, /* FSIZE */\n0x0087: 1, /* FREADLN */\n0x0088: 2, /* FREAD */\n0x0089: 2, /* FWRITELN */\n0x008A: 2, /* FWRITE */\n0x008C: 1, /* DATEVALUE */\n0x008D: 1, /* TIMEVALUE */\n0x008E: 3, /* SLN */\n0x008F: 4, /* SYD */\n0x0090: 4, /* DDB */\n0x00A2: 1, /* CLEAN */\n0x00A3: 1, /* MDETERM */\n0x00A4: 1, /* MINVERSE */\n0x00A5: 2, /* MMULT */\n0x00AC: 1, /* WHILE */\n0x00AF: 2, /* INITIATE */\n0x00B0: 2, /* REQUEST */\n0x00B1: 3, /* POKE */\n0x00B2: 2, /* EXECUTE */\n0x00B3: 1, /* TERMINATE */\n0x00B8: 1, /* FACT */\n0x00BD: 3, /* DPRODUCT */\n0x00BE: 1, /* ISNONTEXT */\n0x00C3: 3, /* DSTDEVP */\n0x00C4: 3, /* DVARP */\n0x00C5: 1, /* TRUNC */\n0x00C6: 1, /* ISLOGICAL */\n0x00C7: 3, /* DCOUNTA */\n0x00C9: 1, /* UNREGISTER */\n0x00CF: 4, /* REPLACEB */\n0x00D2: 3, /* MIDB */\n0x00D3: 1, /* LENB */\n0x00D4: 2, /* ROUNDUP */\n0x00D5: 2, /* ROUNDDOWN */\n0x00D6: 1, /* ASC */\n0x00D7: 1, /* DBCS */\n0x00E5: 1, /* SINH */\n0x00E6: 1, /* COSH */\n0x00E7: 1, /* TANH */\n0x00E8: 1, /* ASINH */\n0x00E9: 1, /* ACOSH */\n0x00EA: 1, /* ATANH */\n0x00EB: 3, /* DGET */\n0x00F4: 1, /* INFO */\n0x00F7: 4, /* DB */\n0x00FC: 2, /* FREQUENCY */\n0x0101: 1, /* EVALUATE */\n0x0105: 1, /* ERROR.TYPE */\n0x010F: 1, /* GAMMALN */\n0x0111: 4, /* BINOMDIST */\n0x0112: 2, /* CHIDIST */\n0x0113: 2, /* CHIINV */\n0x0114: 2, /* COMBIN */\n0x0115: 3, /* CONFIDENCE */\n0x0116: 3, /* CRITBINOM */\n0x0117: 1, /* EVEN */\n0x0118: 3, /* EXPONDIST */\n0x0119: 3, /* FDIST */\n0x011A: 3, /* FINV */\n0x011B: 1, /* FISHER */\n0x011C: 1, /* FISHERINV */\n0x011D: 2, /* FLOOR */\n0x011E: 4, /* GAMMADIST */\n0x011F: 3, /* GAMMAINV */\n0x0120: 2, /* CEILING */\n0x0121: 4, /* HYPGEOMDIST */\n0x0122: 3, /* LOGNORMDIST */\n0x0123: 3, /* LOGINV */\n0x0124: 3, /* NEGBINOMDIST */\n0x0125: 4, /* NORMDIST */\n0x0126: 1, /* NORMSDIST */\n0x0127: 3, /* NORMINV */\n0x0128: 1, /* NORMSINV */\n0x0129: 3, /* STANDARDIZE */\n0x012A: 1, /* ODD */\n0x012B: 2, /* PERMUT */\n0x012C: 3, /* POISSON */\n0x012D: 3, /* TDIST */\n0x012E: 4, /* WEIBULL */\n0x012F: 2, /* SUMXMY2 */\n0x0130: 2, /* SUMX2MY2 */\n0x0131: 2, /* SUMX2PY2 */\n0x0132: 2, /* CHITEST */\n0x0133: 2, /* CORREL */\n0x0134: 2, /* COVAR */\n0x0135: 3, /* FORECAST */\n0x0136: 2, /* FTEST */\n0x0137: 2, /* INTERCEPT */\n0x0138: 2, /* PEARSON */\n0x0139: 2, /* RSQ */\n0x013A: 2, /* STEYX */\n0x013B: 2, /* SLOPE */\n0x013C: 4, /* TTEST */\n0x0145: 2, /* LARGE */\n0x0146: 2, /* SMALL */\n0x0147: 2, /* QUARTILE */\n0x0148: 2, /* PERCENTILE */\n0x014B: 2, /* TRIMMEAN */\n0x014C: 2, /* TINV */\n0x0151: 2, /* POWER */\n0x0156: 1, /* RADIANS */\n0x0157: 1, /* DEGREES */\n0x015A: 2, /* COUNTIF */\n0x015B: 1, /* COUNTBLANK */\n0x015E: 4, /* ISPMT */\n0x015F: 3, /* DATEDIF */\n0x0160: 1, /* DATESTRING */\n0x0161: 2, /* NUMBERSTRING */\n0x0168: 1, /* PHONETIC */\n0x0170: 1, /* BAHTTEXT */\n0x0171: 1, /* THAIDAYOFWEEK */\n0x0172: 1, /* THAIDIGIT */\n0x0173: 1, /* THAIMONTHOFYEAR */\n0x0174: 1, /* THAINUMSOUND */\n0x0175: 1, /* THAINUMSTRING */\n0x0176: 1, /* THAISTRINGLENGTH */\n0x0177: 1, /* ISTHAIDIGIT */\n0x0178: 1, /* ROUNDBAHTDOWN */\n0x0179: 1, /* ROUNDBAHTUP */\n0x017A: 1, /* THAIYEAR */\n0x01A0: 1, /* SQRTPI */\n0x01C1: 2, /* EDATE */\n0x01C2: 2, /* EOMONTH */\n0xFFFF: 0\n};\n/* [MS-XLSX] 2.2.3 Functions */\n/* [MS-XLSB] 2.5.97.10 Ftab */\nvar XLSXFutureFunctions = {\n\t\"_xlfn.ACOT\": \"ACOT\",\n\t\"_xlfn.ACOTH\": \"ACOTH\",\n\t\"_xlfn.AGGREGATE\": \"AGGREGATE\",\n\t\"_xlfn.ARABIC\": \"ARABIC\",\n\t\"_xlfn.AVERAGEIF\": \"AVERAGEIF\",\n\t\"_xlfn.AVERAGEIFS\": \"AVERAGEIFS\",\n\t\"_xlfn.BASE\": \"BASE\",\n\t\"_xlfn.BETA.DIST\": \"BETA.DIST\",\n\t\"_xlfn.BETA.INV\": \"BETA.INV\",\n\t\"_xlfn.BINOM.DIST\": \"BINOM.DIST\",\n\t\"_xlfn.BINOM.DIST.RANGE\": \"BINOM.DIST.RANGE\",\n\t\"_xlfn.BINOM.INV\": \"BINOM.INV\",\n\t\"_xlfn.BITAND\": \"BITAND\",\n\t\"_xlfn.BITLSHIFT\": \"BITLSHIFT\",\n\t\"_xlfn.BITOR\": \"BITOR\",\n\t\"_xlfn.BITRSHIFT\": \"BITRSHIFT\",\n\t\"_xlfn.BITXOR\": \"BITXOR\",\n\t\"_xlfn.CEILING.MATH\": \"CEILING.MATH\",\n\t\"_xlfn.CEILING.PRECISE\": \"CEILING.PRECISE\",\n\t\"_xlfn.CHISQ.DIST\": \"CHISQ.DIST\",\n\t\"_xlfn.CHISQ.DIST.RT\": \"CHISQ.DIST.RT\",\n\t\"_xlfn.CHISQ.INV\": \"CHISQ.INV\",\n\t\"_xlfn.CHISQ.INV.RT\": \"CHISQ.INV.RT\",\n\t\"_xlfn.CHISQ.TEST\": \"CHISQ.TEST\",\n\t\"_xlfn.COMBINA\": \"COMBINA\",\n\t\"_xlfn.CONFIDENCE.NORM\": \"CONFIDENCE.NORM\",\n\t\"_xlfn.CONFIDENCE.T\": \"CONFIDENCE.T\",\n\t\"_xlfn.COT\": \"COT\",\n\t\"_xlfn.COTH\": \"COTH\",\n\t\"_xlfn.COUNTIFS\": \"COUNTIFS\",\n\t\"_xlfn.COVARIANCE.P\": \"COVARIANCE.P\",\n\t\"_xlfn.COVARIANCE.S\": \"COVARIANCE.S\",\n\t\"_xlfn.CSC\": \"CSC\",\n\t\"_xlfn.CSCH\": \"CSCH\",\n\t\"_xlfn.DAYS\": \"DAYS\",\n\t\"_xlfn.DECIMAL\": \"DECIMAL\",\n\t\"_xlfn.ECMA.CEILING\": \"ECMA.CEILING\",\n\t\"_xlfn.ERF.PRECISE\": \"ERF.PRECISE\",\n\t\"_xlfn.ERFC.PRECISE\": \"ERFC.PRECISE\",\n\t\"_xlfn.EXPON.DIST\": \"EXPON.DIST\",\n\t\"_xlfn.F.DIST\": \"F.DIST\",\n\t\"_xlfn.F.DIST.RT\": \"F.DIST.RT\",\n\t\"_xlfn.F.INV\": \"F.INV\",\n\t\"_xlfn.F.INV.RT\": \"F.INV.RT\",\n\t\"_xlfn.F.TEST\": \"F.TEST\",\n\t\"_xlfn.FILTERXML\": \"FILTERXML\",\n\t\"_xlfn.FLOOR.MATH\": \"FLOOR.MATH\",\n\t\"_xlfn.FLOOR.PRECISE\": \"FLOOR.PRECISE\",\n\t\"_xlfn.FORMULATEXT\": \"FORMULATEXT\",\n\t\"_xlfn.GAMMA\": \"GAMMA\",\n\t\"_xlfn.GAMMA.DIST\": \"GAMMA.DIST\",\n\t\"_xlfn.GAMMA.INV\": \"GAMMA.INV\",\n\t\"_xlfn.GAMMALN.PRECISE\": \"GAMMALN.PRECISE\",\n\t\"_xlfn.GAUSS\": \"GAUSS\",\n\t\"_xlfn.HYPGEOM.DIST\": \"HYPGEOM.DIST\",\n\t\"_xlfn.IFNA\": \"IFNA\",\n\t\"_xlfn.IFERROR\": \"IFERROR\",\n\t\"_xlfn.IMCOSH\": \"IMCOSH\",\n\t\"_xlfn.IMCOT\": \"IMCOT\",\n\t\"_xlfn.IMCSC\": \"IMCSC\",\n\t\"_xlfn.IMCSCH\": \"IMCSCH\",\n\t\"_xlfn.IMSEC\": \"IMSEC\",\n\t\"_xlfn.IMSECH\": \"IMSECH\",\n\t\"_xlfn.IMSINH\": \"IMSINH\",\n\t\"_xlfn.IMTAN\": \"IMTAN\",\n\t\"_xlfn.ISFORMULA\": \"ISFORMULA\",\n\t\"_xlfn.ISO.CEILING\": \"ISO.CEILING\",\n\t\"_xlfn.ISOWEEKNUM\": \"ISOWEEKNUM\",\n\t\"_xlfn.LOGNORM.DIST\": \"LOGNORM.DIST\",\n\t\"_xlfn.LOGNORM.INV\": \"LOGNORM.INV\",\n\t\"_xlfn.MODE.MULT\": \"MODE.MULT\",\n\t\"_xlfn.MODE.SNGL\": \"MODE.SNGL\",\n\t\"_xlfn.MUNIT\": \"MUNIT\",\n\t\"_xlfn.NEGBINOM.DIST\": \"NEGBINOM.DIST\",\n\t\"_xlfn.NETWORKDAYS.INTL\": \"NETWORKDAYS.INTL\",\n\t\"_xlfn.NIGBINOM\": \"NIGBINOM\",\n\t\"_xlfn.NORM.DIST\": \"NORM.DIST\",\n\t\"_xlfn.NORM.INV\": \"NORM.INV\",\n\t\"_xlfn.NORM.S.DIST\": \"NORM.S.DIST\",\n\t\"_xlfn.NORM.S.INV\": \"NORM.S.INV\",\n\t\"_xlfn.NUMBERVALUE\": \"NUMBERVALUE\",\n\t\"_xlfn.PDURATION\": \"PDURATION\",\n\t\"_xlfn.PERCENTILE.EXC\": \"PERCENTILE.EXC\",\n\t\"_xlfn.PERCENTILE.INC\": \"PERCENTILE.INC\",\n\t\"_xlfn.PERCENTRANK.EXC\": \"PERCENTRANK.EXC\",\n\t\"_xlfn.PERCENTRANK.INC\": \"PERCENTRANK.INC\",\n\t\"_xlfn.PERMUTATIONA\": \"PERMUTATIONA\",\n\t\"_xlfn.PHI\": \"PHI\",\n\t\"_xlfn.POISSON.DIST\": \"POISSON.DIST\",\n\t\"_xlfn.QUARTILE.EXC\": \"QUARTILE.EXC\",\n\t\"_xlfn.QUARTILE.INC\": \"QUARTILE.INC\",\n\t\"_xlfn.QUERYSTRING\": \"QUERYSTRING\",\n\t\"_xlfn.RANK.AVG\": \"RANK.AVG\",\n\t\"_xlfn.RANK.EQ\": \"RANK.EQ\",\n\t\"_xlfn.RRI\": \"RRI\",\n\t\"_xlfn.SEC\": \"SEC\",\n\t\"_xlfn.SECH\": \"SECH\",\n\t\"_xlfn.SHEET\": \"SHEET\",\n\t\"_xlfn.SHEETS\": \"SHEETS\",\n\t\"_xlfn.SKEW.P\": \"SKEW.P\",\n\t\"_xlfn.STDEV.P\": \"STDEV.P\",\n\t\"_xlfn.STDEV.S\": \"STDEV.S\",\n\t\"_xlfn.SUMIFS\": \"SUMIFS\",\n\t\"_xlfn.T.DIST\": \"T.DIST\",\n\t\"_xlfn.T.DIST.2T\": \"T.DIST.2T\",\n\t\"_xlfn.T.DIST.RT\": \"T.DIST.RT\",\n\t\"_xlfn.T.INV\": \"T.INV\",\n\t\"_xlfn.T.INV.2T\": \"T.INV.2T\",\n\t\"_xlfn.T.TEST\": \"T.TEST\",\n\t\"_xlfn.UNICHAR\": \"UNICHAR\",\n\t\"_xlfn.UNICODE\": \"UNICODE\",\n\t\"_xlfn.VAR.P\": \"VAR.P\",\n\t\"_xlfn.VAR.S\": \"VAR.S\",\n\t\"_xlfn.WEBSERVICE\": \"WEBSERVICE\",\n\t\"_xlfn.WEIBULL.DIST\": \"WEIBULL.DIST\",\n\t\"_xlfn.WORKDAY.INTL\": \"WORKDAY.INTL\",\n\t\"_xlfn.XOR\": \"XOR\",\n\t\"_xlfn.Z.TEST\": \"Z.TEST\"\n};\n\n/* 2.4.326 TODO: payload is a zip file */\nfunction parse_Theme(blob, length) {\n\tvar dwThemeVersion = blob.read_shift(4);\n\tif(dwThemeVersion === 124226) return;\n\tblob.l += length-4;\n}\n\n/* 2.5.49 */\nfunction parse_ColorTheme(blob, length) { return blob.read_shift(4); }\n\n/* 2.5.155 */\nfunction parse_FullColorExt(blob, length) {\n\tvar o = {};\n\to.xclrType = blob.read_shift(2);\n\to.nTintShade = blob.read_shift(2);\n\tswitch(o.xclrType) {\n\t\tcase 0: blob.l += 4; break;\n\t\tcase 1: o.xclrValue = parse_IcvXF(blob, 4); break;\n\t\tcase 2: o.xclrValue = parse_LongRGBA(blob, 4); break;\n\t\tcase 3: o.xclrValue = parse_ColorTheme(blob, 4); break;\n\t\tcase 4: blob.l += 4; break;\n\t}\n\tblob.l += 8;\n\treturn o;\n}\n\n/* 2.5.164 TODO: read 7 bits*/\nfunction parse_IcvXF(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* 2.5.280 */\nfunction parse_XFExtGradient(blob, length) {\n\treturn parsenoop(blob, length);\n}\n\n/* 2.5.108 */\nfunction parse_ExtProp(blob, length) {\n\tvar extType = blob.read_shift(2);\n\tvar cb = blob.read_shift(2);\n\tvar o = [extType];\n\tswitch(extType) {\n\t\tcase 0x04: case 0x05: case 0x07: case 0x08:\n\t\tcase 0x09: case 0x0A: case 0x0B: case 0x0D:\n\t\t\to[1] = parse_FullColorExt(blob, cb); break;\n\t\tcase 0x06: o[1] = parse_XFExtGradient(blob, cb); break;\n\t\tcase 0x0E: case 0x0F: o[1] = blob.read_shift(cb === 5 ? 1 : 2); break;\n\t\tdefault: throw new Error(\"Unrecognized ExtProp type: \" + extType + \" \" + cb);\n\t}\n\treturn o;\n}\n\n/* 2.4.355 */\nfunction parse_XFExt(blob, length) {\n\tvar end = blob.l + length;\n\tblob.l += 2;\n\tvar ixfe = blob.read_shift(2);\n\tblob.l += 2;\n\tvar cexts = blob.read_shift(2);\n\tvar ext = [];\n\twhile(cexts-- > 0) ext.push(parse_ExtProp(blob, end-blob.l));\n\treturn {ixfe:ixfe, ext:ext};\n}\n\n/* xf is an XF, see parse_XFExt for xfext */\nfunction update_xfext(xf, xfext) {\n\txfext.forEach(function(xfe) {\n\t\tswitch(xfe[0]) { /* 2.5.108 extPropData */\n\t\t\tcase 0x04: break; /* foreground color */\n\t\t\tcase 0x05: break; /* background color */\n\t\t\tcase 0x07: case 0x08: case 0x09: case 0x0a: break;\n\t\t\tcase 0x0d: break; /* text color */\n\t\t\tcase 0x0e: break; /* font scheme */\n\t\t\tdefault: throw \"bafuq\" + xfe[0].toString(16);\n\t\t}\n\t});\n}\n/* [MS-XLS] 2.3 Record Enumeration */\nvar RecordEnum = {\n\t0x0003: { n:\"BIFF2NUM\", f:parse_BIFF2NUM },\n\t0x0004: { n:\"BIFF2STR\", f:parse_BIFF2STR },\n\t0x0006: { n:\"Formula\", f:parse_Formula },\n\t0x0009: { n:'BOF', f:parse_BOF },\n\t0x000a: { n:'EOF', f:parse_EOF },\n\t0x000c: { n:\"CalcCount\", f:parse_CalcCount },\n\t0x000d: { n:\"CalcMode\", f:parse_CalcMode },\n\t0x000e: { n:\"CalcPrecision\", f:parse_CalcPrecision },\n\t0x000f: { n:\"CalcRefMode\", f:parse_CalcRefMode },\n\t0x0010: { n:\"CalcDelta\", f:parse_CalcDelta },\n\t0x0011: { n:\"CalcIter\", f:parse_CalcIter },\n\t0x0012: { n:\"Protect\", f:parse_Protect },\n\t0x0013: { n:\"Password\", f:parse_Password },\n\t0x0014: { n:\"Header\", f:parse_Header },\n\t0x0015: { n:\"Footer\", f:parse_Footer },\n\t0x0017: { n:\"ExternSheet\", f:parse_ExternSheet },\n\t0x0018: { n:\"Lbl\", f:parse_Lbl },\n\t0x0019: { n:\"WinProtect\", f:parse_WinProtect },\n\t0x001a: { n:\"VerticalPageBreaks\", f:parse_VerticalPageBreaks },\n\t0x001b: { n:\"HorizontalPageBreaks\", f:parse_HorizontalPageBreaks },\n\t0x001c: { n:\"Note\", f:parse_Note },\n\t0x001d: { n:\"Selection\", f:parse_Selection },\n\t0x0022: { n:\"Date1904\", f:parse_Date1904 },\n\t0x0023: { n:\"ExternName\", f:parse_ExternName },\n\t0x0026: { n:\"LeftMargin\", f:parse_LeftMargin },\n\t0x0027: { n:\"RightMargin\", f:parse_RightMargin },\n\t0x0028: { n:\"TopMargin\", f:parse_TopMargin },\n\t0x0029: { n:\"BottomMargin\", f:parse_BottomMargin },\n\t0x002a: { n:\"PrintRowCol\", f:parse_PrintRowCol },\n\t0x002b: { n:\"PrintGrid\", f:parse_PrintGrid },\n\t0x002f: { n:\"FilePass\", f:parse_FilePass },\n\t0x0031: { n:\"Font\", f:parse_Font },\n\t0x0033: { n:\"PrintSize\", f:parse_PrintSize },\n\t0x003c: { n:\"Continue\", f:parse_Continue },\n\t0x003d: { n:\"Window1\", f:parse_Window1 },\n\t0x0040: { n:\"Backup\", f:parse_Backup },\n\t0x0041: { n:\"Pane\", f:parse_Pane },\n\t0x0042: { n:'CodePage', f:parse_CodePage },\n\t0x004d: { n:\"Pls\", f:parse_Pls },\n\t0x0050: { n:\"DCon\", f:parse_DCon },\n\t0x0051: { n:\"DConRef\", f:parse_DConRef },\n\t0x0052: { n:\"DConName\", f:parse_DConName },\n\t0x0055: { n:\"DefColWidth\", f:parse_DefColWidth },\n\t0x0059: { n:\"XCT\", f:parse_XCT },\n\t0x005a: { n:\"CRN\", f:parse_CRN },\n\t0x005b: { n:\"FileSharing\", f:parse_FileSharing },\n\t0x005c: { n:'WriteAccess', f:parse_WriteAccess },\n\t0x005d: { n:\"Obj\", f:parse_Obj },\n\t0x005e: { n:\"Uncalced\", f:parse_Uncalced },\n\t0x005f: { n:\"CalcSaveRecalc\", f:parse_CalcSaveRecalc },\n\t0x0060: { n:\"Template\", f:parse_Template },\n\t0x0061: { n:\"Intl\", f:parse_Intl },\n\t0x0063: { n:\"ObjProtect\", f:parse_ObjProtect },\n\t0x007d: { n:\"ColInfo\", f:parse_ColInfo },\n\t0x0080: { n:\"Guts\", f:parse_Guts },\n\t0x0081: { n:\"WsBool\", f:parse_WsBool },\n\t0x0082: { n:\"GridSet\", f:parse_GridSet },\n\t0x0083: { n:\"HCenter\", f:parse_HCenter },\n\t0x0084: { n:\"VCenter\", f:parse_VCenter },\n\t0x0085: { n:'BoundSheet8', f:parse_BoundSheet8 },\n\t0x0086: { n:\"WriteProtect\", f:parse_WriteProtect },\n\t0x008c: { n:\"Country\", f:parse_Country },\n\t0x008d: { n:\"HideObj\", f:parse_HideObj },\n\t0x0090: { n:\"Sort\", f:parse_Sort },\n\t0x0092: { n:\"Palette\", f:parse_Palette },\n\t0x0097: { n:\"Sync\", f:parse_Sync },\n\t0x0098: { n:\"LPr\", f:parse_LPr },\n\t0x0099: { n:\"DxGCol\", f:parse_DxGCol },\n\t0x009a: { n:\"FnGroupName\", f:parse_FnGroupName },\n\t0x009b: { n:\"FilterMode\", f:parse_FilterMode },\n\t0x009c: { n:\"BuiltInFnGroupCount\", f:parse_BuiltInFnGroupCount },\n\t0x009d: { n:\"AutoFilterInfo\", f:parse_AutoFilterInfo },\n\t0x009e: { n:\"AutoFilter\", f:parse_AutoFilter },\n\t0x00a0: { n:\"Scl\", f:parse_Scl },\n\t0x00a1: { n:\"Setup\", f:parse_Setup },\n\t0x00ae: { n:\"ScenMan\", f:parse_ScenMan },\n\t0x00af: { n:\"SCENARIO\", f:parse_SCENARIO },\n\t0x00b0: { n:\"SxView\", f:parse_SxView },\n\t0x00b1: { n:\"Sxvd\", f:parse_Sxvd },\n\t0x00b2: { n:\"SXVI\", f:parse_SXVI },\n\t0x00b4: { n:\"SxIvd\", f:parse_SxIvd },\n\t0x00b5: { n:\"SXLI\", f:parse_SXLI },\n\t0x00b6: { n:\"SXPI\", f:parse_SXPI },\n\t0x00b8: { n:\"DocRoute\", f:parse_DocRoute },\n\t0x00b9: { n:\"RecipName\", f:parse_RecipName },\n\t0x00bd: { n:\"MulRk\", f:parse_MulRk },\n\t0x00be: { n:\"MulBlank\", f:parse_MulBlank },\n\t0x00c1: { n:'Mms', f:parse_Mms },\n\t0x00c5: { n:\"SXDI\", f:parse_SXDI },\n\t0x00c6: { n:\"SXDB\", f:parse_SXDB },\n\t0x00c7: { n:\"SXFDB\", f:parse_SXFDB },\n\t0x00c8: { n:\"SXDBB\", f:parse_SXDBB },\n\t0x00c9: { n:\"SXNum\", f:parse_SXNum },\n\t0x00ca: { n:\"SxBool\", f:parse_SxBool },\n\t0x00cb: { n:\"SxErr\", f:parse_SxErr },\n\t0x00cc: { n:\"SXInt\", f:parse_SXInt },\n\t0x00cd: { n:\"SXString\", f:parse_SXString },\n\t0x00ce: { n:\"SXDtr\", f:parse_SXDtr },\n\t0x00cf: { n:\"SxNil\", f:parse_SxNil },\n\t0x00d0: { n:\"SXTbl\", f:parse_SXTbl },\n\t0x00d1: { n:\"SXTBRGIITM\", f:parse_SXTBRGIITM },\n\t0x00d2: { n:\"SxTbpg\", f:parse_SxTbpg },\n\t0x00d3: { n:\"ObProj\", f:parse_ObProj },\n\t0x00d5: { n:\"SXStreamID\", f:parse_SXStreamID },\n\t0x00d7: { n:\"DBCell\", f:parse_DBCell },\n\t0x00d8: { n:\"SXRng\", f:parse_SXRng },\n\t0x00d9: { n:\"SxIsxoper\", f:parse_SxIsxoper },\n\t0x00da: { n:\"BookBool\", f:parse_BookBool },\n\t0x00dc: { n:\"DbOrParamQry\", f:parse_DbOrParamQry },\n\t0x00dd: { n:\"ScenarioProtect\", f:parse_ScenarioProtect },\n\t0x00de: { n:\"OleObjectSize\", f:parse_OleObjectSize },\n\t0x00e0: { n:\"XF\", f:parse_XF },\n\t0x00e1: { n:'InterfaceHdr', f:parse_InterfaceHdr },\n\t0x00e2: { n:'InterfaceEnd', f:parse_InterfaceEnd },\n\t0x00e3: { n:\"SXVS\", f:parse_SXVS },\n\t0x00e5: { n:\"MergeCells\", f:parse_MergeCells },\n\t0x00e9: { n:\"BkHim\", f:parse_BkHim },\n\t0x00eb: { n:\"MsoDrawingGroup\", f:parse_MsoDrawingGroup },\n\t0x00ec: { n:\"MsoDrawing\", f:parse_MsoDrawing },\n\t0x00ed: { n:\"MsoDrawingSelection\", f:parse_MsoDrawingSelection },\n\t0x00ef: { n:\"PhoneticInfo\", f:parse_PhoneticInfo },\n\t0x00f0: { n:\"SxRule\", f:parse_SxRule },\n\t0x00f1: { n:\"SXEx\", f:parse_SXEx },\n\t0x00f2: { n:\"SxFilt\", f:parse_SxFilt },\n\t0x00f4: { n:\"SxDXF\", f:parse_SxDXF },\n\t0x00f5: { n:\"SxItm\", f:parse_SxItm },\n\t0x00f6: { n:\"SxName\", f:parse_SxName },\n\t0x00f7: { n:\"SxSelect\", f:parse_SxSelect },\n\t0x00f8: { n:\"SXPair\", f:parse_SXPair },\n\t0x00f9: { n:\"SxFmla\", f:parse_SxFmla },\n\t0x00fb: { n:\"SxFormat\", f:parse_SxFormat },\n\t0x00fc: { n:\"SST\", f:parse_SST },\n\t0x00fd: { n:\"LabelSst\", f:parse_LabelSst },\n\t0x00ff: { n:\"ExtSST\", f:parse_ExtSST },\n\t0x0100: { n:\"SXVDEx\", f:parse_SXVDEx },\n\t0x0103: { n:\"SXFormula\", f:parse_SXFormula },\n\t0x0122: { n:\"SXDBEx\", f:parse_SXDBEx },\n\t0x0137: { n:\"RRDInsDel\", f:parse_RRDInsDel },\n\t0x0138: { n:\"RRDHead\", f:parse_RRDHead },\n\t0x013b: { n:\"RRDChgCell\", f:parse_RRDChgCell },\n\t0x013d: { n:\"RRTabId\", f:parse_RRTabId },\n\t0x013e: { n:\"RRDRenSheet\", f:parse_RRDRenSheet },\n\t0x013f: { n:\"RRSort\", f:parse_RRSort },\n\t0x0140: { n:\"RRDMove\", f:parse_RRDMove },\n\t0x014a: { n:\"RRFormat\", f:parse_RRFormat },\n\t0x014b: { n:\"RRAutoFmt\", f:parse_RRAutoFmt },\n\t0x014d: { n:\"RRInsertSh\", f:parse_RRInsertSh },\n\t0x014e: { n:\"RRDMoveBegin\", f:parse_RRDMoveBegin },\n\t0x014f: { n:\"RRDMoveEnd\", f:parse_RRDMoveEnd },\n\t0x0150: { n:\"RRDInsDelBegin\", f:parse_RRDInsDelBegin },\n\t0x0151: { n:\"RRDInsDelEnd\", f:parse_RRDInsDelEnd },\n\t0x0152: { n:\"RRDConflict\", f:parse_RRDConflict },\n\t0x0153: { n:\"RRDDefName\", f:parse_RRDDefName },\n\t0x0154: { n:\"RRDRstEtxp\", f:parse_RRDRstEtxp },\n\t0x015f: { n:\"LRng\", f:parse_LRng },\n\t0x0160: { n:\"UsesELFs\", f:parse_UsesELFs },\n\t0x0161: { n:\"DSF\", f:parse_DSF },\n\t0x0191: { n:\"CUsr\", f:parse_CUsr },\n\t0x0192: { n:\"CbUsr\", f:parse_CbUsr },\n\t0x0193: { n:\"UsrInfo\", f:parse_UsrInfo },\n\t0x0194: { n:\"UsrExcl\", f:parse_UsrExcl },\n\t0x0195: { n:\"FileLock\", f:parse_FileLock },\n\t0x0196: { n:\"RRDInfo\", f:parse_RRDInfo },\n\t0x0197: { n:\"BCUsrs\", f:parse_BCUsrs },\n\t0x0198: { n:\"UsrChk\", f:parse_UsrChk },\n\t0x01a9: { n:\"UserBView\", f:parse_UserBView },\n\t0x01aa: { n:\"UserSViewBegin\", f:parse_UserSViewBegin },\n\t0x01ab: { n:\"UserSViewEnd\", f:parse_UserSViewEnd },\n\t0x01ac: { n:\"RRDUserView\", f:parse_RRDUserView },\n\t0x01ad: { n:\"Qsi\", f:parse_Qsi },\n\t0x01ae: { n:\"SupBook\", f:parse_SupBook },\n\t0x01af: { n:\"Prot4Rev\", f:parse_Prot4Rev },\n\t0x01b0: { n:\"CondFmt\", f:parse_CondFmt },\n\t0x01b1: { n:\"CF\", f:parse_CF },\n\t0x01b2: { n:\"DVal\", f:parse_DVal },\n\t0x01b5: { n:\"DConBin\", f:parse_DConBin },\n\t0x01b6: { n:\"TxO\", f:parse_TxO },\n\t0x01b7: { n:\"RefreshAll\", f:parse_RefreshAll },\n\t0x01b8: { n:\"HLink\", f:parse_HLink },\n\t0x01b9: { n:\"Lel\", f:parse_Lel },\n\t0x01ba: { n:\"CodeName\", f:parse_CodeName },\n\t0x01bb: { n:\"SXFDBType\", f:parse_SXFDBType },\n\t0x01bc: { n:\"Prot4RevPass\", f:parse_Prot4RevPass },\n\t0x01bd: { n:\"ObNoMacros\", f:parse_ObNoMacros },\n\t0x01be: { n:\"Dv\", f:parse_Dv },\n\t0x01c0: { n:\"Excel9File\", f:parse_Excel9File },\n\t0x01c1: { n:\"RecalcId\", f:parse_RecalcId, r:2},\n\t0x01c2: { n:\"EntExU2\", f:parse_EntExU2 },\n\t0x0200: { n:\"Dimensions\", f:parse_Dimensions },\n\t0x0201: { n:\"Blank\", f:parse_Blank },\n\t0x0203: { n:\"Number\", f:parse_Number },\n\t0x0204: { n:\"Label\", f:parse_Label },\n\t0x0205: { n:\"BoolErr\", f:parse_BoolErr },\n\t0x0206: { n:\"Formula\", f:parse_Formula },\n\t0x0207: { n:\"String\", f:parse_String },\n\t0x0208: { n:'Row', f:parse_Row },\n\t0x020b: { n:\"Index\", f:parse_Index },\n\t0x0221: { n:\"Array\", f:parse_Array },\n\t0x0225: { n:\"DefaultRowHeight\", f:parse_DefaultRowHeight },\n\t0x0236: { n:\"Table\", f:parse_Table },\n\t0x023e: { n:\"Window2\", f:parse_Window2 },\n\t0x027e: { n:\"RK\", f:parse_RK },\n\t0x0293: { n:\"Style\", f:parse_Style },\n\t0x0406: { n:\"Formula\", f:parse_Formula },\n\t0x0418: { n:\"BigName\", f:parse_BigName },\n\t0x041e: { n:\"Format\", f:parse_Format },\n\t0x043c: { n:\"ContinueBigName\", f:parse_ContinueBigName },\n\t0x04bc: { n:\"ShrFmla\", f:parse_ShrFmla },\n\t0x0800: { n:\"HLinkTooltip\", f:parse_HLinkTooltip },\n\t0x0801: { n:\"WebPub\", f:parse_WebPub },\n\t0x0802: { n:\"QsiSXTag\", f:parse_QsiSXTag },\n\t0x0803: { n:\"DBQueryExt\", f:parse_DBQueryExt },\n\t0x0804: { n:\"ExtString\", f:parse_ExtString },\n\t0x0805: { n:\"TxtQry\", f:parse_TxtQry },\n\t0x0806: { n:\"Qsir\", f:parse_Qsir },\n\t0x0807: { n:\"Qsif\", f:parse_Qsif },\n\t0x0808: { n:\"RRDTQSIF\", f:parse_RRDTQSIF },\n\t0x0809: { n:'BOF', f:parse_BOF },\n\t0x080a: { n:\"OleDbConn\", f:parse_OleDbConn },\n\t0x080b: { n:\"WOpt\", f:parse_WOpt },\n\t0x080c: { n:\"SXViewEx\", f:parse_SXViewEx },\n\t0x080d: { n:\"SXTH\", f:parse_SXTH },\n\t0x080e: { n:\"SXPIEx\", f:parse_SXPIEx },\n\t0x080f: { n:\"SXVDTEx\", f:parse_SXVDTEx },\n\t0x0810: { n:\"SXViewEx9\", f:parse_SXViewEx9 },\n\t0x0812: { n:\"ContinueFrt\", f:parse_ContinueFrt },\n\t0x0813: { n:\"RealTimeData\", f:parse_RealTimeData },\n\t0x0850: { n:\"ChartFrtInfo\", f:parse_ChartFrtInfo },\n\t0x0851: { n:\"FrtWrapper\", f:parse_FrtWrapper },\n\t0x0852: { n:\"StartBlock\", f:parse_StartBlock },\n\t0x0853: { n:\"EndBlock\", f:parse_EndBlock },\n\t0x0854: { n:\"StartObject\", f:parse_StartObject },\n\t0x0855: { n:\"EndObject\", f:parse_EndObject },\n\t0x0856: { n:\"CatLab\", f:parse_CatLab },\n\t0x0857: { n:\"YMult\", f:parse_YMult },\n\t0x0858: { n:\"SXViewLink\", f:parse_SXViewLink },\n\t0x0859: { n:\"PivotChartBits\", f:parse_PivotChartBits },\n\t0x085a: { n:\"FrtFontList\", f:parse_FrtFontList },\n\t0x0862: { n:\"SheetExt\", f:parse_SheetExt },\n\t0x0863: { n:\"BookExt\", f:parse_BookExt, r:12},\n\t0x0864: { n:\"SXAddl\", f:parse_SXAddl },\n\t0x0865: { n:\"CrErr\", f:parse_CrErr },\n\t0x0866: { n:\"HFPicture\", f:parse_HFPicture },\n\t0x0867: { n:'FeatHdr', f:parse_FeatHdr },\n\t0x0868: { n:\"Feat\", f:parse_Feat },\n\t0x086a: { n:\"DataLabExt\", f:parse_DataLabExt },\n\t0x086b: { n:\"DataLabExtContents\", f:parse_DataLabExtContents },\n\t0x086c: { n:\"CellWatch\", f:parse_CellWatch },\n\t0x0871: { n:\"FeatHdr11\", f:parse_FeatHdr11 },\n\t0x0872: { n:\"Feature11\", f:parse_Feature11 },\n\t0x0874: { n:\"DropDownObjIds\", f:parse_DropDownObjIds },\n\t0x0875: { n:\"ContinueFrt11\", f:parse_ContinueFrt11 },\n\t0x0876: { n:\"DConn\", f:parse_DConn },\n\t0x0877: { n:\"List12\", f:parse_List12 },\n\t0x0878: { n:\"Feature12\", f:parse_Feature12 },\n\t0x0879: { n:\"CondFmt12\", f:parse_CondFmt12 },\n\t0x087a: { n:\"CF12\", f:parse_CF12 },\n\t0x087b: { n:\"CFEx\", f:parse_CFEx },\n\t0x087c: { n:\"XFCRC\", f:parse_XFCRC, r:12 },\n\t0x087d: { n:\"XFExt\", f:parse_XFExt, r:12 },\n\t0x087e: { n:\"AutoFilter12\", f:parse_AutoFilter12 },\n\t0x087f: { n:\"ContinueFrt12\", f:parse_ContinueFrt12 },\n\t0x0884: { n:\"MDTInfo\", f:parse_MDTInfo },\n\t0x0885: { n:\"MDXStr\", f:parse_MDXStr },\n\t0x0886: { n:\"MDXTuple\", f:parse_MDXTuple },\n\t0x0887: { n:\"MDXSet\", f:parse_MDXSet },\n\t0x0888: { n:\"MDXProp\", f:parse_MDXProp },\n\t0x0889: { n:\"MDXKPI\", f:parse_MDXKPI },\n\t0x088a: { n:\"MDB\", f:parse_MDB },\n\t0x088b: { n:\"PLV\", f:parse_PLV },\n\t0x088c: { n:\"Compat12\", f:parse_Compat12, r:12 },\n\t0x088d: { n:\"DXF\", f:parse_DXF },\n\t0x088e: { n:\"TableStyles\", f:parse_TableStyles, r:12 },\n\t0x088f: { n:\"TableStyle\", f:parse_TableStyle },\n\t0x0890: { n:\"TableStyleElement\", f:parse_TableStyleElement },\n\t0x0892: { n:\"StyleExt\", f:parse_StyleExt },\n\t0x0893: { n:\"NamePublish\", f:parse_NamePublish },\n\t0x0894: { n:\"NameCmt\", f:parse_NameCmt },\n\t0x0895: { n:\"SortData\", f:parse_SortData },\n\t0x0896: { n:\"Theme\", f:parse_Theme, r:12 },\n\t0x0897: { n:\"GUIDTypeLib\", f:parse_GUIDTypeLib },\n\t0x0898: { n:\"FnGrp12\", f:parse_FnGrp12 },\n\t0x0899: { n:\"NameFnGrp12\", f:parse_NameFnGrp12 },\n\t0x089a: { n:\"MTRSettings\", f:parse_MTRSettings, r:12 },\n\t0x089b: { n:\"CompressPictures\", f:parse_CompressPictures },\n\t0x089c: { n:\"HeaderFooter\", f:parse_HeaderFooter },\n\t0x089d: { n:\"CrtLayout12\", f:parse_CrtLayout12 },\n\t0x089e: { n:\"CrtMlFrt\", f:parse_CrtMlFrt },\n\t0x089f: { n:\"CrtMlFrtContinue\", f:parse_CrtMlFrtContinue },\n\t0x08a3: { n:\"ForceFullCalculation\", f:parse_ForceFullCalculation },\n\t0x08a4: { n:\"ShapePropsStream\", f:parse_ShapePropsStream },\n\t0x08a5: { n:\"TextPropsStream\", f:parse_TextPropsStream },\n\t0x08a6: { n:\"RichTextStream\", f:parse_RichTextStream },\n\t0x08a7: { n:\"CrtLayout12A\", f:parse_CrtLayout12A },\n\t0x1001: { n:\"Units\", f:parse_Units },\n\t0x1002: { n:\"Chart\", f:parse_Chart },\n\t0x1003: { n:\"Series\", f:parse_Series },\n\t0x1006: { n:\"DataFormat\", f:parse_DataFormat },\n\t0x1007: { n:\"LineFormat\", f:parse_LineFormat },\n\t0x1009: { n:\"MarkerFormat\", f:parse_MarkerFormat },\n\t0x100a: { n:\"AreaFormat\", f:parse_AreaFormat },\n\t0x100b: { n:\"PieFormat\", f:parse_PieFormat },\n\t0x100c: { n:\"AttachedLabel\", f:parse_AttachedLabel },\n\t0x100d: { n:\"SeriesText\", f:parse_SeriesText },\n\t0x1014: { n:\"ChartFormat\", f:parse_ChartFormat },\n\t0x1015: { n:\"Legend\", f:parse_Legend },\n\t0x1016: { n:\"SeriesList\", f:parse_SeriesList },\n\t0x1017: { n:\"Bar\", f:parse_Bar },\n\t0x1018: { n:\"Line\", f:parse_Line },\n\t0x1019: { n:\"Pie\", f:parse_Pie },\n\t0x101a: { n:\"Area\", f:parse_Area },\n\t0x101b: { n:\"Scatter\", f:parse_Scatter },\n\t0x101c: { n:\"CrtLine\", f:parse_CrtLine },\n\t0x101d: { n:\"Axis\", f:parse_Axis },\n\t0x101e: { n:\"Tick\", f:parse_Tick },\n\t0x101f: { n:\"ValueRange\", f:parse_ValueRange },\n\t0x1020: { n:\"CatSerRange\", f:parse_CatSerRange },\n\t0x1021: { n:\"AxisLine\", f:parse_AxisLine },\n\t0x1022: { n:\"CrtLink\", f:parse_CrtLink },\n\t0x1024: { n:\"DefaultText\", f:parse_DefaultText },\n\t0x1025: { n:\"Text\", f:parse_Text },\n\t0x1026: { n:\"FontX\", f:parse_FontX },\n\t0x1027: { n:\"ObjectLink\", f:parse_ObjectLink },\n\t0x1032: { n:\"Frame\", f:parse_Frame },\n\t0x1033: { n:\"Begin\", f:parse_Begin },\n\t0x1034: { n:\"End\", f:parse_End },\n\t0x1035: { n:\"PlotArea\", f:parse_PlotArea },\n\t0x103a: { n:\"Chart3d\", f:parse_Chart3d },\n\t0x103c: { n:\"PicF\", f:parse_PicF },\n\t0x103d: { n:\"DropBar\", f:parse_DropBar },\n\t0x103e: { n:\"Radar\", f:parse_Radar },\n\t0x103f: { n:\"Surf\", f:parse_Surf },\n\t0x1040: { n:\"RadarArea\", f:parse_RadarArea },\n\t0x1041: { n:\"AxisParent\", f:parse_AxisParent },\n\t0x1043: { n:\"LegendException\", f:parse_LegendException },\n\t0x1044: { n:\"ShtProps\", f:parse_ShtProps },\n\t0x1045: { n:\"SerToCrt\", f:parse_SerToCrt },\n\t0x1046: { n:\"AxesUsed\", f:parse_AxesUsed },\n\t0x1048: { n:\"SBaseRef\", f:parse_SBaseRef },\n\t0x104a: { n:\"SerParent\", f:parse_SerParent },\n\t0x104b: { n:\"SerAuxTrend\", f:parse_SerAuxTrend },\n\t0x104e: { n:\"IFmtRecord\", f:parse_IFmtRecord },\n\t0x104f: { n:\"Pos\", f:parse_Pos },\n\t0x1050: { n:\"AlRuns\", f:parse_AlRuns },\n\t0x1051: { n:\"BRAI\", f:parse_BRAI },\n\t0x105b: { n:\"SerAuxErrBar\", f:parse_SerAuxErrBar },\n\t0x105c: { n:\"ClrtClient\", f:parse_ClrtClient },\n\t0x105d: { n:\"SerFmt\", f:parse_SerFmt },\n\t0x105f: { n:\"Chart3DBarShape\", f:parse_Chart3DBarShape },\n\t0x1060: { n:\"Fbi\", f:parse_Fbi },\n\t0x1061: { n:\"BopPop\", f:parse_BopPop },\n\t0x1062: { n:\"AxcExt\", f:parse_AxcExt },\n\t0x1063: { n:\"Dat\", f:parse_Dat },\n\t0x1064: { n:\"PlotGrowth\", f:parse_PlotGrowth },\n\t0x1065: { n:\"SIIndex\", f:parse_SIIndex },\n\t0x1066: { n:\"GelFrame\", f:parse_GelFrame },\n\t0x1067: { n:\"BopPopCustom\", f:parse_BopPopCustom },\n\t0x1068: { n:\"Fbi2\", f:parse_Fbi2 },\n\n\t/* These are specified in an older version of the spec */\n\t0x0000: { n:\"Dimensions\", f:parse_Dimensions },\n\t0x0002: { n:\"BIFF2INT\", f:parse_BIFF2INT },\n\t0x0005: { n:\"BoolErr\", f:parse_BoolErr },\n\t0x0007: { n:\"String\", f:parse_BIFF2STRING },\n\t0x0008: { n:\"BIFF2ROW\", f:parsenoop },\n\t0x000b: { n:\"Index\", f:parse_Index },\n\t0x001e: { n:\"BIFF2FORMAT\", f:parse_BIFF2Format },\n\t0x001f: { n:\"BIFF2FMTCNT\", f:parsenoop }, /* 16-bit cnt of BIFF2FORMAT records */\n\t0x0016: { n:\"ExternCount\", f:parsenoop },\n\t0x0021: { n:\"Array\", f:parse_Array },\n\t0x0025: { n:\"DefaultRowHeight\", f:parse_DefaultRowHeight },\n\t0x0032: { n:\"BIFF2FONTXTRA\", f:parse_BIFF2FONTXTRA },\n\t0x003e: { n:\"BIFF2WINDOW2\", f:parsenoop },\n\t0x0045: { n:\"BIFF2FONTCLR\", f:parsenoop },\n\t0x0056: { n:\"BIFF4FMTCNT\", f:parsenoop }, /* 16-bit cnt, similar to BIFF2 */\n\t0x007e: { n:\"RK\", f:parsenoop }, /* Not necessarily same as 0x027e */\n\t0x007f: { n:\"ImData\", f:parsenoop },\n\t0x0087: { n:\"Addin\", f:parsenoop },\n\t0x0088: { n:\"Edg\", f:parsenoop },\n\t0x0089: { n:\"Pub\", f:parsenoop },\n\t0x0091: { n:\"Sub\", f:parsenoop },\n\t0x0094: { n:\"LHRecord\", f:parsenoop },\n\t0x0095: { n:\"LHNGraph\", f:parsenoop },\n\t0x0096: { n:\"Sound\", f:parsenoop },\n\t0x00a9: { n:\"CoordList\", f:parsenoop },\n\t0x00ab: { n:\"GCW\", f:parsenoop },\n\t0x00bc: { n:\"ShrFmla\", f:parsenoop }, /* Not necessarily same as 0x04bc */\n\t0x00c2: { n:\"AddMenu\", f:parsenoop },\n\t0x00c3: { n:\"DelMenu\", f:parsenoop },\n\t0x00d6: { n:\"RString\", f:parse_RString },\n\t0x00df: { n:\"UDDesc\", f:parsenoop },\n\t0x00ea: { n:\"TabIdConf\", f:parsenoop },\n\t0x0162: { n:\"XL5Modify\", f:parsenoop },\n\t0x01a5: { n:\"FileSharing2\", f:parsenoop },\n\t0x0209: { n:'BOF', f:parse_BOF },\n\t0x0218: { n:\"Lbl\", f:parse_Lbl },\n\t0x0223: { n:\"ExternName\", f:parse_ExternName },\n\t0x0231: { n:\"Font\", f:parsenoop },\n\t0x0409: { n:'BOF', f:parse_BOF },\n\t0x086d: { n:\"FeatInfo\", f:parsenoop },\n\t0x0873: { n:\"FeatInfo11\", f:parsenoop },\n\t0x0881: { n:\"SXAddl12\", f:parsenoop },\n\t0x08c0: { n:\"AutoWebPub\", f:parsenoop },\n\t0x08c1: { n:\"ListObj\", f:parsenoop },\n\t0x08c2: { n:\"ListField\", f:parsenoop },\n\t0x08c3: { n:\"ListDV\", f:parsenoop },\n\t0x08c4: { n:\"ListCondFmt\", f:parsenoop },\n\t0x08c5: { n:\"ListCF\", f:parsenoop },\n\t0x08c6: { n:\"FMQry\", f:parsenoop },\n\t0x08c7: { n:\"FMSQry\", f:parsenoop },\n\t0x08c8: { n:\"PLV\", f:parsenoop }, /* supposedly PLV for Excel 11 */\n\t0x08c9: { n:\"LnExt\", f:parsenoop },\n\t0x08ca: { n:\"MkrExt\", f:parsenoop },\n\t0x08cb: { n:\"CrtCoopt\", f:parsenoop },\n\n\t0x0043: { n:\"BIFF2XF\", f:parsenoop },\n\t0x0243: { n:\"BIFF3XF\", f:parsenoop },\n\t0x0443: { n:\"BIFF4XF\", f:parsenoop },\n\n\t0x7262: {}\n};\n\n/* 2.4.63 Country/Region codes */\nvar CountryEnum = {\n\t0x0001: \"US\", // United States\n\t0x0002: \"CA\", // Canada\n\t0x0003: \"\", // Latin America (except Brazil)\n\t0x0007: \"RU\", // Russia\n\t0x0014: \"EG\", // Egypt\n\t0x001E: \"GR\", // Greece\n\t0x001F: \"NL\", // Netherlands\n\t0x0020: \"BE\", // Belgium\n\t0x0021: \"FR\", // France\n\t0x0022: \"ES\", // Spain\n\t0x0024: \"HU\", // Hungary\n\t0x0027: \"IT\", // Italy\n\t0x0029: \"CH\", // Switzerland\n\t0x002B: \"AT\", // Austria\n\t0x002C: \"GB\", // United Kingdom\n\t0x002D: \"DK\", // Denmark\n\t0x002E: \"SE\", // Sweden\n\t0x002F: \"NO\", // Norway\n\t0x0030: \"PL\", // Poland\n\t0x0031: \"DE\", // Germany\n\t0x0034: \"MX\", // Mexico\n\t0x0037: \"BR\", // Brazil\n\t0x003d: \"AU\", // Australia\n\t0x0040: \"NZ\", // New Zealand\n\t0x0042: \"TH\", // Thailand\n\t0x0051: \"JP\", // Japan\n\t0x0052: \"KR\", // Korea\n\t0x0054: \"VN\", // Viet Nam\n\t0x0056: \"CN\", // China\n\t0x005A: \"TR\", // Turkey\n\t0x0069: \"JS\", // Ramastan\n\t0x00D5: \"DZ\", // Algeria\n\t0x00D8: \"MA\", // Morocco\n\t0x00DA: \"LY\", // Libya\n\t0x015F: \"PT\", // Portugal\n\t0x0162: \"IS\", // Iceland\n\t0x0166: \"FI\", // Finland\n\t0x01A4: \"CZ\", // Czech Republic\n\t0x0376: \"TW\", // Taiwan\n\t0x03C1: \"LB\", // Lebanon\n\t0x03C2: \"JO\", // Jordan\n\t0x03C3: \"SY\", // Syria\n\t0x03C4: \"IQ\", // Iraq\n\t0x03C5: \"KW\", // Kuwait\n\t0x03C6: \"SA\", // Saudi Arabia\n\t0x03CB: \"AE\", // United Arab Emirates\n\t0x03CC: \"IL\", // Israel\n\t0x03CE: \"QA\", // Qatar\n\t0x03D5: \"IR\", // Iran\n\t0xFFFF: \"US\"  // United States\n};\nfunction fix_opts_func(defaults) {\n\treturn function fix_opts(opts) {\n\t\tfor(var i = 0; i != defaults.length; ++i) {\n\t\t\tvar d = defaults[i];\n\t\t\tif(opts[d[0]] === undefined) opts[d[0]] = d[1];\n\t\t\tif(d[2] === 'n') opts[d[0]] = Number(opts[d[0]]);\n\t\t}\n\t};\n}\n\nvar fix_read_opts = fix_opts_func([\n\t['cellNF', false], /* emit cell number format string as .z */\n\t['cellFormula', true], /* emit formulae as .f */\n\t['cellStyles', false], /* emits style/theme as .s */\n\n\t['sheetRows', 0, 'n'], /* read n rows (0 = read all rows) */\n\n\t['bookSheets', false], /* only try to get sheet names (no Sheets) */\n\t['bookProps', false], /* only try to get properties (no Sheets) */\n\t['bookFiles', false], /* include raw file structure (cfb) */\n\n\t['password',''], /* password */\n\t['WTF', false] /* WTF mode (throws errors) */\n]);\n/* [MS-OLEDS] 2.3.8 CompObjStream */\nfunction parse_compobj(obj) {\n\tvar v = {};\n\tvar o = obj.content;\n\n\t/* [MS-OLEDS] 2.3.7 CompObjHeader -- All fields MUST be ignored */\n\tvar l = 28, m;\n\tm = __lpstr(o, l);\n\tl += 4 + __readUInt32LE(o,l);\n\tv.UserType = m;\n\n\t/* [MS-OLEDS] 2.3.1 ClipboardFormatOrAnsiString */\n\tm = __readUInt32LE(o,l); l+= 4;\n\tswitch(m) {\n\t\tcase 0x00000000: break;\n\t\tcase 0xffffffff: case 0xfffffffe: l+=4; break;\n\t\tdefault:\n\t\t\tif(m > 0x190) throw new Error(\"Unsupported Clipboard: \" + m.toString(16));\n\t\t\tl += m;\n\t}\n\n\tm = __lpstr(o, l); l += m.length === 0 ? 0 : 5 + m.length; v.Reserved1 = m;\n\n\tif((m = __readUInt32LE(o,l)) !== 0x71b2e9f4) return v;\n\tthrow new Error(\"Unsupported Unicode Extension\");\n}\n\n/* 2.4.58 Continue logic */\nfunction slurp(R, blob, length, opts) {\n\tvar l = length;\n\tvar bufs = [];\n\tvar d = blob.slice(blob.l,blob.l+l);\n\tif(opts && opts.enc && opts.enc.insitu_decrypt) switch(R.n) {\n\tcase 'BOF': case 'FilePass': case 'FileLock': case 'InterfaceHdr': case 'RRDInfo': case 'RRDHead': case 'UsrExcl': break;\n\tdefault:\n\t\tif(d.length === 0) break;\n\t\topts.enc.insitu_decrypt(d);\n\t}\n\tbufs.push(d);\n\tblob.l += l;\n\tvar next = (RecordEnum[__readUInt16LE(blob,blob.l)]);\n\twhile(next != null && next.n === 'Continue') {\n\t\tl = __readUInt16LE(blob,blob.l+2);\n\t\tbufs.push(blob.slice(blob.l+4,blob.l+4+l));\n\t\tblob.l += 4+l;\n\t\tnext = (RecordEnum[__readUInt16LE(blob, blob.l)]);\n\t}\n\tvar b = (bconcat(bufs));\n\tprep_blob(b, 0);\n\tvar ll = 0; b.lens = [];\n\tfor(var j = 0; j < bufs.length; ++j) { b.lens.push(ll); ll += bufs[j].length; }\n\treturn R.f(b, b.length, opts);\n}\n\nfunction safe_format_xf(p, opts, date1904) {\n\tif(p.t === 'e') { p.w = p.w || BErr[p.v]; }\n\tif(!p.XF) return;\n\ttry {\n\t\tvar fmtid = p.XF.ifmt||0;\n\t\tif(p.t === 'e');\n\t\telse if(fmtid === 0) {\n\t\t\tif(p.t === 'n') {\n\t\t\t\tif((p.v|0) === p.v) p.w = SSF._general_int(p.v);\n\t\t\t\telse p.w = SSF._general_num(p.v);\n\t\t\t}\n\t\t\telse p.w = SSF._general(p.v);\n\t\t}\n\t\telse p.w = SSF.format(fmtid,p.v, {date1904:date1904||false});\n\t\tif(opts.cellNF) p.z = SSF._table[fmtid];\n\t} catch(e) { if(opts.WTF) throw e; }\n}\n\nfunction make_cell(val, ixfe, t) {\n\treturn ({v:val, ixfe:ixfe, t:t});\n}\n\n// 2.3.2\nfunction parse_workbook(blob, options) {\n\tvar wb = ({opts:{}});\n\tvar Sheets = {};\n\tvar out = {};\n\tvar Directory = {};\n\tvar found_sheet = false;\n\tvar range = {};\n\tvar last_formula = null;\n\tvar sst = [];\n\tvar cur_sheet = \"\";\n\tvar Preamble = {};\n\tvar lastcell, last_cell, cc, cmnt, rng, rngC, rngR;\n\tvar shared_formulae = {};\n\tvar array_formulae = []; /* TODO: something more clever */\n\tvar temp_val;\n\tvar country;\n\tvar cell_valid = true;\n\tvar XFs = []; /* XF records */\n\tvar palette = [];\n\tvar get_rgb = function getrgb(icv) {\n\t\tif(icv < 8) return Icv[icv];\n\t\tif(icv < 64) return palette[icv-8] || Icv[icv];\n\t\treturn Icv[icv];\n\t};\n\tvar process_cell_style = function pcs(cell, line) {\n\t\tvar xfd = line.XF.data;\n\t\tif(!xfd || !xfd.patternType) return;\n\t\tline.s = {};\n\t\tline.s.patternType = xfd.patternType;\n\t\tvar t;\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvFore)))) { line.s.fgColor = {rgb:t}; }\n\t\tif((t = rgb2Hex(get_rgb(xfd.icvBack)))) { line.s.bgColor = {rgb:t}; }\n\t};\n\tvar addcell = function addcell(cell, line, options) {\n\t\tif(!cell_valid) return;\n\t\tif(options.cellStyles && line.XF && line.XF.data) process_cell_style(cell, line);\n\t\tlastcell = cell;\n\t\tlast_cell = encode_cell(cell);\n\t\tif(range.s) {\n\t\t\tif(cell.r < range.s.r) range.s.r = cell.r;\n\t\t\tif(cell.c < range.s.c) range.s.c = cell.c;\n\t\t}\n\t\tif(range.e) {\n\t\t\tif(cell.r + 1 > range.e.r) range.e.r = cell.r + 1;\n\t\t\tif(cell.c + 1 > range.e.c) range.e.c = cell.c + 1;\n\t\t}\n\t\tif(options.sheetRows && lastcell.r >= options.sheetRows) cell_valid = false;\n\t\telse out[last_cell] = line;\n\t};\n\tvar opts = ({\n\t\tenc: false, // encrypted\n\t\tsbcch: 0, // cch in the preceding SupBook\n\t\tsnames: [], // sheetnames\n\t\tsharedf: shared_formulae, // shared formulae by address\n\t\tarrayf: array_formulae, // array formulae array\n\t\trrtabid: [], // RRTabId\n\t\tlastuser: \"\", // Last User from WriteAccess\n\t\tbiff: 8, // BIFF version\n\t\tcodepage: 0, // CP from CodePage record\n\t\twinlocked: 0, // fLockWn from WinProtect\n\t\twtf: false\n\t});\n\tif(options.password) opts.password = options.password;\n\tvar mergecells = [];\n\tvar objects = [];\n\tvar supbooks = ([[]]); // 1-indexed, will hold extern names\n\tvar sbc = 0, sbci = 0, sbcli = 0;\n\tsupbooks.SheetNames = opts.snames;\n\tsupbooks.sharedf = opts.sharedf;\n\tsupbooks.arrayf = opts.arrayf;\n\tvar last_Rn = '';\n\tvar file_depth = 0; /* TODO: make a real stack */\n\tvar BIFF2Fmt = 0;\n\n\t/* explicit override for some broken writers */\n\topts.codepage = 1200;\n\tset_cp(1200);\n\n\twhile(blob.l < blob.length - 1) {\n\t\tvar s = blob.l;\n\t\tvar RecordType = blob.read_shift(2);\n\t\tif(RecordType === 0 && last_Rn === 'EOF') break;\n\t\tvar length = (blob.l === blob.length ? 0 : blob.read_shift(2)), y;\n\t\tvar R = RecordEnum[RecordType];\n\t\tif(R && R.f) {\n\t\t\tif(options.bookSheets) {\n\t\t\t\tif(last_Rn === 'BoundSheet8' && R.n !== 'BoundSheet8') break;\n\t\t\t}\n\t\t\tlast_Rn = R.n;\n\t\t\tif(R.r === 2 || R.r == 12) {\n\t\t\t\tvar rt = blob.read_shift(2); length -= 2;\n\t\t\t\tif(!opts.enc && rt !== RecordType) throw \"rt mismatch\";\n\t\t\t\tif(R.r == 12){ blob.l += 10; length -= 10; } // skip FRT\n\t\t\t}\n\t\t\t//console.error(R,blob.l,length,blob.length);\n\t\t\tvar val;\n\t\t\tif(R.n === 'EOF') val = R.f(blob, length, opts);\n\t\t\telse val = slurp(R, blob, length, opts);\n\t\t\tvar Rn = R.n;\n\t\t\t/* nested switch statements to workaround V8 128 limit */\n\t\t\tswitch(Rn) {\n\t\t\t\t/* Workbook Options */\n\t\t\t\tcase 'Date1904': wb.opts.Date1904 = val; break;\n\t\t\t\tcase 'WriteProtect': wb.opts.WriteProtect = true; break;\n\t\t\t\tcase 'FilePass':\n\t\t\t\t\tif(!opts.enc) blob.l = 0;\n\t\t\t\t\topts.enc = val;\n\t\t\t\t\tif(opts.WTF) console.error(val);\n\t\t\t\t\tif(!options.password) throw new Error(\"File is password-protected\");\n\t\t\t\t\tif(val.Type !== 0) throw new Error(\"Encryption scheme unsupported\");\n\t\t\t\t\tif(!val.valid) throw new Error(\"Password is incorrect\");\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'WriteAccess': opts.lastuser = val; break;\n\t\t\t\tcase 'FileSharing': break; //TODO\n\t\t\t\tcase 'CodePage':\n\t\t\t\t\t/* overrides based on test cases */\n\t\t\t\t\tif(val === 0x5212) val = 1200;\n\t\t\t\t\telse if(val === 0x8001) val = 1252;\n\t\t\t\t\topts.codepage = val;\n\t\t\t\t\tset_cp(val);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'RRTabId': opts.rrtabid = val; break;\n\t\t\t\tcase 'WinProtect': opts.winlocked = val; break;\n\t\t\t\tcase 'Template': break; // TODO\n\t\t\t\tcase 'RefreshAll': wb.opts.RefreshAll = val; break;\n\t\t\t\tcase 'BookBool': break; // TODO\n\t\t\t\tcase 'UsesELFs': /* if(val) console.error(\"Unsupported ELFs\"); */ break;\n\t\t\t\tcase 'MTRSettings': {\n\t\t\t\t\tif(val[0] && val[1]) throw \"Unsupported threads: \" + val;\n\t\t\t\t} break; // TODO: actually support threads\n\t\t\t\tcase 'CalcCount': wb.opts.CalcCount = val; break;\n\t\t\t\tcase 'CalcDelta': wb.opts.CalcDelta = val; break;\n\t\t\t\tcase 'CalcIter': wb.opts.CalcIter = val; break;\n\t\t\t\tcase 'CalcMode': wb.opts.CalcMode = val; break;\n\t\t\t\tcase 'CalcPrecision': wb.opts.CalcPrecision = val; break;\n\t\t\t\tcase 'CalcSaveRecalc': wb.opts.CalcSaveRecalc = val; break;\n\t\t\t\tcase 'CalcRefMode': opts.CalcRefMode = val; break; // TODO: implement R1C1\n\t\t\t\tcase 'Uncalced': break;\n\t\t\t\tcase 'ForceFullCalculation': wb.opts.FullCalc = val; break;\n\t\t\t\tcase 'WsBool': break; // TODO\n\t\t\t\tcase 'XF': XFs.push(val); break;\n\t\t\t\tcase 'ExtSST': break; // TODO\n\t\t\t\tcase 'BookExt': break; // TODO\n\t\t\t\tcase 'RichTextStream': break;\n\t\t\t\tcase 'BkHim': break;\n\n\t\t\t\tcase 'SupBook': supbooks[++sbc] = [val]; sbci = 0; break;\n\t\t\t\tcase 'ExternName': supbooks[sbc][++sbci] = val; break;\n\t\t\t\tcase 'Index': break; // TODO\n\t\t\t\tcase 'Lbl': supbooks[0][++sbcli] = val; break;\n\t\t\t\tcase 'ExternSheet': supbooks[sbc] = supbooks[sbc].concat(val); sbci += val.length; break;\n\n\t\t\t\tcase 'Protect': out[\"!protect\"] = val; break; /* for sheet or book */\n\t\t\t\tcase 'Password': if(val !== 0 && opts.WTF) console.error(\"Password verifier: \" + val); break;\n\t\t\t\tcase 'Prot4Rev': case 'Prot4RevPass': break; /*TODO: Revision Control*/\n\n\t\t\t\tcase 'BoundSheet8': {\n\t\t\t\t\tDirectory[val.pos] = val;\n\t\t\t\t\topts.snames.push(val.name);\n\t\t\t\t} break;\n\t\t\t\tcase 'EOF': {\n\t\t\t\t\tif(--file_depth) break;\n\t\t\t\t\tif(range.e) {\n\t\t\t\t\t\tout[\"!range\"] = range;\n\t\t\t\t\t\tif(range.e.r > 0 && range.e.c > 0) {\n\t\t\t\t\t\t\trange.e.r--; range.e.c--;\n\t\t\t\t\t\t\tout[\"!ref\"] = encode_range(range);\n\t\t\t\t\t\t\trange.e.r++; range.e.c++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(mergecells.length > 0) out[\"!merges\"] = mergecells;\n\t\t\t\t\t\tif(objects.length > 0) out[\"!objects\"] = objects;\n\t\t\t\t\t}\n\t\t\t\t\tif(cur_sheet === \"\") Preamble = out; else Sheets[cur_sheet] = out;\n\t\t\t\t\tout = {};\n\t\t\t\t} break;\n\t\t\t\tcase 'BOF': {\n\t\t\t\t\tif(opts.biff !== 8){}\n\t\t\t\t\telse if(val.BIFFVer === 0x0500) opts.biff = 5;\n\t\t\t\t\telse if(val.BIFFVer === 0x0002) opts.biff = 2;\n\t\t\t\t\telse if(val.BIFFVer === 0x0007) opts.biff = 2;\n\t\t\t\t\telse if(RecordType  === 0x0009) opts.biff = 2;\n\t\t\t\t\telse if(RecordType  === 0x0209) opts.biff = 3;\n\t\t\t\t\telse if(RecordType  === 0x0409) opts.biff = 4;\n\t\t\t\t\tif(file_depth++) break;\n\t\t\t\t\tcell_valid = true;\n\t\t\t\t\tout = {};\n\t\t\t\t\tif(opts.biff < 5) {\n\t\t\t\t\t\tif(cur_sheet === \"\") cur_sheet = \"Sheet1\";\n\t\t\t\t\t\trange = {s:{r:0,c:0},e:{r:0,c:0}};\n\t\t\t\t\t\t/* fake BoundSheet8 */\n\t\t\t\t\t\tvar fakebs8 = {pos: blob.l - length, name:cur_sheet};\n\t\t\t\t\t\tDirectory[fakebs8.pos] = fakebs8;\n\t\t\t\t\t\topts.snames.push(cur_sheet);\n\t\t\t\t\t}\n\t\t\t\t\telse cur_sheet = (Directory[s] || {name:\"\"}).name;\n\t\t\t\t\tmergecells = [];\n\t\t\t\t\tobjects = [];\n\t\t\t\t} break;\n\t\t\t\tcase 'Number': case 'BIFF2NUM': case 'BIFF2INT': {\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:'n'};\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 'BoolErr': {\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.val, t:val.t};\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 'RK': {\n\t\t\t\t\ttemp_val = {ixfe: val.ixfe, XF: XFs[val.ixfe], v:val.rknum, t:'n'};\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t} break;\n\t\t\t\tcase 'MulRk': {\n\t\t\t\t\tfor(var j = val.c; j <= val.C; ++j) {\n\t\t\t\t\t\tvar ixfe = val.rkrec[j-val.c][0];\n\t\t\t\t\t\ttemp_val= {ixfe:ixfe, XF:XFs[ixfe], v:val.rkrec[j-val.c][1], t:'n'};\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell({c:j, r:val.r}, temp_val, options);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 'Formula': {\n\t\t\t\t\tswitch(val.val) {\n\t\t\t\t\t\tcase 'String': last_formula = val; break;\n\t\t\t\t\t\tcase 'Array Formula': throw \"Array Formula unsupported\";\n\t\t\t\t\t\tdefault:\n\t\t\t\t\t\t\ttemp_val = ({v:val.val, ixfe:val.cell.ixfe, t:val.tt});\n\t\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\t\t\tif(options.cellFormula) {\n\t\t\t\t\t\t\t\tvar _f = val.formula;\n\t\t\t\t\t\t\t\tif(_f && _f[0] && _f[0][0] && _f[0][0][0] == 'PtgExp') {\n\t\t\t\t\t\t\t\t\tvar _fr = _f[0][0][1][0], _fc = _f[0][0][1][1];\n\t\t\t\t\t\t\t\t\tvar _fe = encode_cell({r:_fr, c:_fc});\n\t\t\t\t\t\t\t\t\tif(shared_formulae[_fe]) temp_val.f = stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t\t\t\t\telse temp_val.F = (out[_fe] || {}).F;\n\t\t\t\t\t\t\t\t} else temp_val.f = stringify_formula(val.formula,range,val.cell,supbooks, opts);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\t\taddcell(val.cell, temp_val, options);\n\t\t\t\t\t\t\tlast_formula = val;\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 'String': {\n\t\t\t\t\tif(last_formula) {\n\t\t\t\t\t\tlast_formula.val = val;\n\t\t\t\t\t\ttemp_val = ({v:last_formula.val, ixfe:last_formula.cell.ixfe, t:'s'});\n\t\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\t\tif(options.cellFormula) temp_val.f = stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n\t\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\t\taddcell(last_formula.cell, temp_val, options);\n\t\t\t\t\t\tlast_formula = null;\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 'Array': {\n\t\t\t\t\tarray_formulae.push(val);\n\t\t\t\t\tif(options.cellFormula && out[last_cell]) {\n\t\t\t\t\t\tout[last_cell].f = stringify_formula(last_formula.formula, range, last_formula.cell, supbooks, opts);\n\t\t\t\t\t\tout[last_cell].F = encode_range(val[0]);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 'ShrFmla': {\n\t\t\t\t\tif(!cell_valid) break;\n\t\t\t\t\tif(!options.cellFormula) break;\n\t\t\t\t\tif(last_cell) {\n\t\t\t\t\t\t/* TODO: capture range */\n\t\t\t\t\t\tshared_formulae[encode_cell(last_formula.cell)]= val[0];\n\t\t\t\t\t\t(out[encode_cell(last_formula.cell)]||{}).f = stringify_formula(val[0], range, lastcell, supbooks, opts);\n\t\t\t\t\t}\n\t\t\t\t} break;\n\t\t\t\tcase 'LabelSst':\n\t\t\t\t\ttemp_val=make_cell(sst[val.isst].t, val.ixfe, 's');\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'RString':\n\t\t\t\tcase 'Label': case 'BIFF2STR':\n\t\t\t\t\ttemp_val=make_cell(val.val, val.ixfe, 's');\n\t\t\t\t\ttemp_val.XF = XFs[temp_val.ixfe];\n\t\t\t\t\tsafe_format_xf(temp_val, options, wb.opts.Date1904);\n\t\t\t\t\taddcell({c:val.c, r:val.r}, temp_val, options);\n\t\t\t\t\tbreak;\n\t\t\t\tcase 'Dimensions': {\n\t\t\t\t\tif(file_depth === 1) range = val; /* TODO: stack */\n\t\t\t\t} break;\n\t\t\t\tcase 'SST': {\n\t\t\t\t\tsst = val;\n\t\t\t\t} break;\n\t\t\t\tcase 'Format': { /* val = [id, fmt] */\n\t\t\t\t\tSSF.load(val[1], val[0]);\n\t\t\t\t} break;\n\t\t\t\tcase 'BIFF2FORMAT': {\n\t\t\t\t\tSSF.load(val, BIFF2Fmt++);\n\t\t\t\t} break;\n\n\t\t\t\tcase 'MergeCells': mergecells = mergecells.concat(val); break;\n\n\t\t\t\tcase 'Obj': objects[val.cmo[0]] = opts.lastobj = val; break;\n\t\t\t\tcase 'TxO': opts.lastobj.TxO = val; break;\n\n\t\t\t\tcase 'HLink': {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC)\n\t\t\t\t\t\t\tif(out[encode_cell({c:rngC,r:rngR})])\n\t\t\t\t\t\t\t\tout[encode_cell({c:rngC,r:rngR})].l = val[1];\n\t\t\t\t} break;\n\t\t\t\tcase 'HLinkTooltip': {\n\t\t\t\t\tfor(rngR = val[0].s.r; rngR <= val[0].e.r; ++rngR)\n\t\t\t\t\t\tfor(rngC = val[0].s.c; rngC <= val[0].e.c; ++rngC)\n\t\t\t\t\t\t\tif(out[encode_cell({c:rngC,r:rngR})])\n\t\t\t\t\t\t\t\tout[encode_cell({c:rngC,r:rngR})].l.tooltip = val[1];\n\t\t\t\t} break;\n\n\t\t\t\t/* Comments */\n\t\t\t\tcase 'Note': {\n\t\t\t\t\tif(opts.biff <= 5 && opts.biff >= 2) break; /* TODO: BIFF5 */\n\t\t\t\t\tcc = out[encode_cell(val[0])];\n\t\t\t\t\tvar noteobj = objects[val[2]];\n\t\t\t\t\tif(!cc) break;\n\t\t\t\t\tif(!cc.c) cc.c = [];\n\t\t\t\t\tcmnt = {a:val[1],t:noteobj.TxO.t};\n\t\t\t\t\tcc.c.push(cmnt);\n\t\t\t\t} break;\n\n\t\t\t\tdefault: switch(R.n) { /* nested */\n\t\t\t\tcase 'ClrtClient': break;\n\t\t\t\tcase 'XFExt': update_xfext(XFs[val.ixfe], val.ext); break;\n\n\t\t\t\tcase 'NameCmt': break;\n\t\t\t\tcase 'Header': break; // TODO\n\t\t\t\tcase 'Footer': break; // TODO\n\t\t\t\tcase 'HCenter': break; // TODO\n\t\t\t\tcase 'VCenter': break; // TODO\n\t\t\t\tcase 'Pls': break; // TODO\n\t\t\t\tcase 'Setup': break; // TODO\n\t\t\t\tcase 'DefColWidth': break; // TODO\n\t\t\t\tcase 'GCW': break;\n\t\t\t\tcase 'LHRecord': break;\n\t\t\t\tcase 'ColInfo': break; // TODO\n\t\t\t\tcase 'Row': break; // TODO\n\t\t\t\tcase 'DBCell': break; // TODO\n\t\t\t\tcase 'MulBlank': break; // TODO\n\t\t\t\tcase 'EntExU2': break; // TODO\n\t\t\t\tcase 'SxView': break; // TODO\n\t\t\t\tcase 'Sxvd': break; // TODO\n\t\t\t\tcase 'SXVI': break; // TODO\n\t\t\t\tcase 'SXVDEx': break; // TODO\n\t\t\t\tcase 'SxIvd': break; // TODO\n\t\t\t\tcase 'SXDI': break; // TODO\n\t\t\t\tcase 'SXLI': break; // TODO\n\t\t\t\tcase 'SXEx': break; // TODO\n\t\t\t\tcase 'QsiSXTag': break; // TODO\n\t\t\t\tcase 'Selection': break;\n\t\t\t\tcase 'Feat': break;\n\t\t\t\tcase 'FeatHdr': case 'FeatHdr11': break;\n\t\t\t\tcase 'Feature11': case 'Feature12': case 'List12': break;\n\t\t\t\tcase 'Blank': break;\n\t\t\t\tcase 'Country': country = val; break;\n\t\t\t\tcase 'RecalcId': break;\n\t\t\t\tcase 'DefaultRowHeight': case 'DxGCol': break; // TODO: htmlify\n\t\t\t\tcase 'Fbi': case 'Fbi2': case 'GelFrame': break;\n\t\t\t\tcase 'Font': break; // TODO\n\t\t\t\tcase 'XFCRC': break; // TODO\n\t\t\t\tcase 'Style': break; // TODO\n\t\t\t\tcase 'StyleExt': break; // TODO\n\t\t\t\tcase 'Palette': palette = val; break; // TODO\n\t\t\t\tcase 'Theme': break; // TODO\n\t\t\t\t/* Protection */\n\t\t\t\tcase 'ScenarioProtect': break;\n\t\t\t\tcase 'ObjProtect': break;\n\n\t\t\t\t/* Conditional Formatting */\n\t\t\t\tcase 'CondFmt12': break;\n\n\t\t\t\t/* Table */\n\t\t\t\tcase 'Table': break; // TODO\n\t\t\t\tcase 'TableStyles': break; // TODO\n\t\t\t\tcase 'TableStyle': break; // TODO\n\t\t\t\tcase 'TableStyleElement': break; // TODO\n\n\t\t\t\t/* PivotTable */\n\t\t\t\tcase 'SXStreamID': break; // TODO\n\t\t\t\tcase 'SXVS': break; // TODO\n\t\t\t\tcase 'DConRef': break; // TODO\n\t\t\t\tcase 'SXAddl': break; // TODO\n\t\t\t\tcase 'DConBin': break; // TODO\n\t\t\t\tcase 'DConName': break; // TODO\n\t\t\t\tcase 'SXPI': break; // TODO\n\t\t\t\tcase 'SxFormat': break; // TODO\n\t\t\t\tcase 'SxSelect': break; // TODO\n\t\t\t\tcase 'SxRule': break; // TODO\n\t\t\t\tcase 'SxFilt': break; // TODO\n\t\t\t\tcase 'SxItm': break; // TODO\n\t\t\t\tcase 'SxDXF': break; // TODO\n\n\t\t\t\t/* Scenario Manager */\n\t\t\t\tcase 'ScenMan': break;\n\n\t\t\t\t/* Data Consolidation */\n\t\t\t\tcase 'DCon': break;\n\n\t\t\t\t/* Watched Cell */\n\t\t\t\tcase 'CellWatch': break;\n\n\t\t\t\t/* Print Settings */\n\t\t\t\tcase 'PrintRowCol': break;\n\t\t\t\tcase 'PrintGrid': break;\n\t\t\t\tcase 'PrintSize': break;\n\n\t\t\t\tcase 'XCT': break;\n\t\t\t\tcase 'CRN': break;\n\n\t\t\t\tcase 'Scl': {\n\t\t\t\t\t//console.log(\"Zoom Level:\", val[0]/val[1],val);\n\t\t\t\t} break;\n\t\t\t\tcase 'SheetExt': {\n\n\t\t\t\t} break;\n\t\t\t\tcase 'SheetExtOptional': {\n\n\t\t\t\t} break;\n\n\t\t\t\t/* VBA */\n\t\t\t\tcase 'ObNoMacros': {\n\n\t\t\t\t} break;\n\t\t\t\tcase 'ObProj': {\n\n\t\t\t\t} break;\n\t\t\t\tcase 'CodeName': {\n\n\t\t\t\t} break;\n\t\t\t\tcase 'GUIDTypeLib': {\n\n\t\t\t\t} break;\n\n\t\t\t\tcase 'WOpt': break; // TODO: WTF?\n\t\t\t\tcase 'PhoneticInfo': break;\n\n\t\t\t\tcase 'OleObjectSize': break;\n\n\t\t\t\t/* Differential Formatting */\n\t\t\t\tcase 'DXF': case 'DXFN': case 'DXFN12': case 'DXFN12List': case 'DXFN12NoCB': break;\n\n\t\t\t\t/* Data Validation */\n\t\t\t\tcase 'Dv': case 'DVal': break;\n\n\t\t\t\t/* Data Series */\n\t\t\t\tcase 'BRAI': case 'Series': case 'SeriesText': break;\n\n\t\t\t\t/* Data Connection */\n\t\t\t\tcase 'DConn': break;\n\t\t\t\tcase 'DbOrParamQry': break;\n\t\t\t\tcase 'DBQueryExt': break;\n\n\t\t\t\t/* Formatting */\n\t\t\t\tcase 'IFmtRecord': break;\n\t\t\t\tcase 'CondFmt': case 'CF': case 'CF12': case 'CFEx': break;\n\n\t\t\t\t/* Explicitly Ignored */\n\t\t\t\tcase 'Excel9File': break;\n\t\t\t\tcase 'Units': break;\n\t\t\t\tcase 'InterfaceHdr': case 'Mms': case 'InterfaceEnd': case 'DSF': case 'BuiltInFnGroupCount':\n\t\t\t\t/* View Stuff */\n\t\t\t\tcase 'Window1': case 'Window2': case 'HideObj': case 'GridSet': case 'Guts':\n\t\t\t\tcase 'UserBView': case 'UserSViewBegin': case 'UserSViewEnd':\n\t\t\t\tcase 'Pane': break;\n\t\t\t\tdefault: switch(R.n) { /* nested */\n\t\t\t\t/* Chart */\n\t\t\t\tcase 'Dat':\n\t\t\t\tcase 'Begin': case 'End':\n\t\t\t\tcase 'StartBlock': case 'EndBlock':\n\t\t\t\tcase 'Frame': case 'Area':\n\t\t\t\tcase 'Axis': case 'AxisLine': case 'Tick': break;\n\t\t\t\tcase 'AxesUsed':\n\t\t\t\tcase 'CrtLayout12': case 'CrtLayout12A': case 'CrtLink': case 'CrtLine': case 'CrtMlFrt': case 'CrtMlFrtContinue': break;\n\t\t\t\tcase 'LineFormat': case 'AreaFormat':\n\t\t\t\tcase 'Chart': case 'Chart3d': case 'Chart3DBarShape': case 'ChartFormat': case 'ChartFrtInfo': break;\n\t\t\t\tcase 'PlotArea': case 'PlotGrowth': break;\n\t\t\t\tcase 'SeriesList': case 'SerParent': case 'SerAuxTrend': break;\n\t\t\t\tcase 'DataFormat': case 'SerToCrt': case 'FontX': break;\n\t\t\t\tcase 'CatSerRange': case 'AxcExt': case 'SerFmt': break;\n\t\t\t\tcase 'ShtProps': break;\n\t\t\t\tcase 'DefaultText': case 'Text': case 'CatLab': break;\n\t\t\t\tcase 'DataLabExtContents': break;\n\t\t\t\tcase 'Legend': case 'LegendException': break;\n\t\t\t\tcase 'Pie': case 'Scatter': break;\n\t\t\t\tcase 'PieFormat': case 'MarkerFormat': break;\n\t\t\t\tcase 'StartObject': case 'EndObject': break;\n\t\t\t\tcase 'AlRuns': case 'ObjectLink': break;\n\t\t\t\tcase 'SIIndex': break;\n\t\t\t\tcase 'AttachedLabel': case 'YMult': break;\n\n\t\t\t\t/* Chart Group */\n\t\t\t\tcase 'Line': case 'Bar': break;\n\t\t\t\tcase 'Surf': break;\n\n\t\t\t\t/* Axis Group */\n\t\t\t\tcase 'AxisParent': break;\n\t\t\t\tcase 'Pos': break;\n\t\t\t\tcase 'ValueRange': break;\n\n\t\t\t\t/* Pivot Chart */\n\t\t\t\tcase 'SXViewEx9': break; // TODO\n\t\t\t\tcase 'SXViewLink': break;\n\t\t\t\tcase 'PivotChartBits': break;\n\t\t\t\tcase 'SBaseRef': break;\n\t\t\t\tcase 'TextPropsStream': break;\n\n\t\t\t\t/* Chart Misc */\n\t\t\t\tcase 'LnExt': break;\n\t\t\t\tcase 'MkrExt': break;\n\t\t\t\tcase 'CrtCoopt': break;\n\n\t\t\t\t/* Query Table */\n\t\t\t\tcase 'Qsi': case 'Qsif': case 'Qsir': case 'QsiSXTag': break;\n\t\t\t\tcase 'TxtQry': break;\n\n\t\t\t\t/* Filter */\n\t\t\t\tcase 'FilterMode': break;\n\t\t\t\tcase 'AutoFilter': case 'AutoFilterInfo': break;\n\t\t\t\tcase 'AutoFilter12': break;\n\t\t\t\tcase 'DropDownObjIds': break;\n\t\t\t\tcase 'Sort': break;\n\t\t\t\tcase 'SortData': break;\n\n\t\t\t\t/* Drawing */\n\t\t\t\tcase 'ShapePropsStream': break;\n\t\t\t\tcase 'MsoDrawing': case 'MsoDrawingGroup': case 'MsoDrawingSelection': break;\n\t\t\t\tcase 'ImData': break;\n\t\t\t\t/* Pub Stuff */\n\t\t\t\tcase 'WebPub': case 'AutoWebPub':\n\n\t\t\t\t/* Print Stuff */\n\t\t\t\tcase 'RightMargin': case 'LeftMargin': case 'TopMargin': case 'BottomMargin':\n\t\t\t\tcase 'HeaderFooter': case 'HFPicture': case 'PLV':\n\t\t\t\tcase 'HorizontalPageBreaks': case 'VerticalPageBreaks':\n\t\t\t\t/* Behavioral */\n\t\t\t\tcase 'Backup': case 'CompressPictures': case 'Compat12': break;\n\n\t\t\t\t/* Should not Happen */\n\t\t\t\tcase 'Continue': case 'ContinueFrt12': break;\n\n\t\t\t\t/* Future Records */\n\t\t\t\tcase 'FrtFontList': case 'FrtWrapper': break;\n\n\t\t\t\tdefault: switch(R.n) { /* nested */\n\t\t\t\t/* BIFF5 records */\n\t\t\t\tcase 'ExternCount': break;\n\t\t\t\tcase 'TabIdConf': case 'Radar': case 'RadarArea': case 'DropBar': case 'Intl': case 'CoordList': case 'SerAuxErrBar': break;\n\n\t\t\t\t/* BIFF2-4 records */\n\t\t\t\tcase 'BIFF2FONTCLR': case 'BIFF2FMTCNT': case 'BIFF2FONTXTRA': break;\n\t\t\t\tcase 'BIFF2XF': case 'BIFF3XF': case 'BIFF4XF': break;\n\t\t\t\tcase 'BIFF4FMTCNT': case 'BIFF2ROW': case 'BIFF2WINDOW2': break;\n\n\t\t\t\t/* Miscellaneous */\n\t\t\t\tcase 'SCENARIO': case 'DConBin': case 'PicF': case 'DataLabExt':\n\t\t\t\tcase 'Lel': case 'BopPop': case 'BopPopCustom': case 'RealTimeData':\n\t\t\t\tcase 'Name': break;\n\t\t\t\tdefault: if(options.WTF) throw 'Unrecognized Record ' + R.n;\n\t\t\t}}}}\n\t\t} else blob.l += length;\n\t}\n\tvar sheetnamesraw = Object.keys(Directory).sort(function(a,b) { return Number(a) - Number(b); }).map(function(x){return Directory[x].name;});\n\tvar sheetnames = sheetnamesraw.slice();\n\twb.Directory=sheetnamesraw;\n\twb.SheetNames=sheetnamesraw;\n\tif(!options.bookSheets) wb.Sheets=Sheets;\n\twb.Preamble=Preamble;\n\twb.Strings = sst;\n\twb.SSF = SSF.get_table();\n\tif(opts.enc) wb.Encryption = opts.enc;\n\twb.Metadata = {};\n\tif(country !== undefined) wb.Metadata.Country = country;\n\treturn wb;\n}\n\nfunction parse_xlscfb(cfb, options) {\nif(!options) options = {};\nfix_read_opts(options);\nreset_cp();\nvar CompObj, Summary, Workbook;\nif(cfb.FullPaths) {\n\tCompObj = cfb.find('!CompObj');\n\tSummary = cfb.find('!SummaryInformation');\n\tWorkbook = cfb.find('/Workbook');\n} else {\n\tprep_blob(cfb, 0);\n\tWorkbook = ({content: cfb});\n}\n\nif(!Workbook) Workbook = cfb.find('/Book');\nvar CompObjP, SummaryP, WorkbookP;\n\nif(CompObj) CompObjP = parse_compobj(CompObj);\nif(options.bookProps && !options.bookSheets) WorkbookP = {};\nelse {\n\tif(Workbook) WorkbookP = parse_workbook(Workbook.content, options, !!Workbook.find);\n\telse throw new Error(\"Cannot find Workbook stream\");\n}\n\nif(cfb.FullPaths) parse_props(cfb);\n\nvar props = {};\nfor(var y in cfb.Summary) props[y] = cfb.Summary[y];\nfor(y in cfb.DocSummary) props[y] = cfb.DocSummary[y];\nWorkbookP.Props = WorkbookP.Custprops = props; /* TODO: split up properties */\nif(options.bookFiles) WorkbookP.cfb = cfb;\nWorkbookP.CompObjP = CompObjP;\nreturn WorkbookP;\n}\n\n/* TODO: WTF */\nfunction parse_props(cfb) {\n\t/* [MS-OSHARED] 2.3.3.2.2 Document Summary Information Property Set */\n\tvar DSI = cfb.find('!DocumentSummaryInformation');\n\tif(DSI) try { cfb.DocSummary = parse_PropertySetStream(DSI, DocSummaryPIDDSI); } catch(e) {}\n\n\t/* [MS-OSHARED] 2.3.3.2.1 Summary Information Property Set*/\n\tvar SI = cfb.find('!SummaryInformation');\n\tif(SI) try { cfb.Summary = parse_PropertySetStream(SI, SummaryPIDSI); } catch(e) {}\n}\n// TODO: CP remap (need to read file version to determine OS)\nvar encregex = /&[a-z]*;/g, coderegex = /_x([0-9a-fA-F]+)_/g;\nfunction coderepl(m,c) {return _chr(parseInt(c,16));}\nfunction encrepl($$) { return encodings[$$]; }\nfunction unescapexml(s){\n\tif(s.indexOf(\"&\") > -1) s = s.replace(encregex, encrepl);\n\treturn s.indexOf(\"_\") === -1 ? s : s.replace(coderegex,coderepl);\n}\n\nfunction parsexmlbool(value, tag) {\n\tswitch(value) {\n\t\tcase '1': case 'true': case 'TRUE': return true;\n\t\t/* case '0': case 'false': case 'FALSE':*/\n\t\tdefault: return false;\n\t}\n}\n\n// matches <foo>...</foo> extracts content\nfunction matchtag(f,g) {return new RegExp('<'+f+'(?: xml:space=\"preserve\")?>([^\\u2603]*)</'+f+'>',(g||\"\")+\"m\");}\n\n/* TODO: handle codepages */\nvar entregex = /&#(\\d+);/g;\nfunction entrepl($$,$1) { return String.fromCharCode(parseInt($1,10)); }\nfunction fixstr(str) {\n\treturn str.replace(entregex,entrepl);\n}\n/* map from xlml named formats to SSF TODO: localize */\nvar XLMLFormatMap/*{[string]:string}*/ = ({\n\t\"General Number\": \"General\",\n\t\"General Date\": SSF._table[22],\n\t\"Long Date\": \"dddd, mmmm dd, yyyy\",\n\t\"Medium Date\": SSF._table[15],\n\t\"Short Date\": SSF._table[14],\n\t\"Long Time\": SSF._table[19],\n\t\"Medium Time\": SSF._table[18],\n\t\"Short Time\": SSF._table[20],\n\t\"Currency\": '\"$\"#,##0.00_);[Red]\\\\(\"$\"#,##0.00\\\\)',\n\t\"Fixed\": SSF._table[2],\n\t\"Standard\": SSF._table[4],\n\t\"Percent\": SSF._table[10],\n\t\"Scientific\": SSF._table[11],\n\t\"Yes/No\": '\"Yes\";\"Yes\";\"No\";@',\n\t\"True/False\": '\"True\";\"True\";\"False\";@',\n\t\"On/Off\": '\"Yes\";\"Yes\";\"No\";@'\n});\n\n/* [MS-EXSPXML3] 2.4.54 ST_enmPattern */\nvar PatternTypeMap = {\n\t\"None\": \"none\",\n\t\"Solid\": \"solid\",\n\t\"Gray50\": \"mediumGray\",\n\t\"Gray75\": \"darkGray\",\n\t\"Gray25\": \"lightGray\",\n\t\"HorzStripe\": \"darkHorizontal\",\n\t\"VertStripe\": \"darkVertical\",\n\t\"ReverseDiagStripe\": \"darkDown\",\n\t\"DiagStripe\": \"darkUp\",\n\t\"DiagCross\": \"darkGrid\",\n\t\"ThickDiagCross\": \"darkTrellis\",\n\t\"ThinHorzStripe\": \"lightHorizontal\",\n\t\"ThinVertStripe\": \"lightVertical\",\n\t\"ThinReverseDiagStripe\": \"lightDown\",\n\t\"ThinHorzCross\": \"lightGrid\"\n};\n\n/* TODO: Normalize the properties */\nfunction xlml_set_prop(Props, tag, val) {\n\tswitch(tag) {\n\t\tcase 'Description': tag = 'Comments'; break;\n\t}\n\tProps[tag] = val;\n}\n\nfunction xlml_format(format, value) {\n\tvar fmt = XLMLFormatMap[format] || unescapexml(format);\n\tif(fmt === \"General\") return SSF._general(value);\n\treturn SSF.format(fmt, value);\n}\n\nfunction xlml_set_custprop(Custprops, Rn, cp, val) {\n\tswitch((cp[0].match(/dt:dt=\"([\\w.]+)\"/)||[\"\",\"\"])[1]) {\n\t\tcase \"boolean\": val = parsexmlbool(val); break;\n\t\tcase \"i2\": case \"int\": val = parseInt(val, 10); break;\n\t\tcase \"r4\": case \"float\": val = parseFloat(val); break;\n\t\tcase \"date\": case \"dateTime.tz\": val = new Date(val); break;\n\t\tcase \"i8\": case \"string\": case \"fixed\": case \"uuid\": case \"bin.base64\": break;\n\t\tdefault: throw \"bad custprop:\" + cp[0];\n\t}\n\tCustprops[unescapexml(Rn[3])] = val;\n}\n\nfunction safe_format_xlml(cell, nf, o) {\n\ttry {\n\t\tif(cell.t === 'e') { cell.w = cell.w || BErr[cell.v]; }\n\t\telse if(nf === \"General\") {\n\t\t\tif(cell.t === 'n') {\n\t\t\t\tif((cell.v|0) === cell.v) cell.w = SSF._general_int(cell.v);\n\t\t\t\telse cell.w = SSF._general_num(cell.v);\n\t\t\t}\n\t\t\telse cell.w = SSF._general(cell.v);\n\t\t}\n\t\telse cell.w = xlml_format(nf||\"General\", cell.v);\n\t\tif(o.cellNF) cell.z = XLMLFormatMap[nf]||nf||\"General\";\n\t} catch(e) { if(o.WTF) throw e; }\n}\n\nfunction process_style_xlml(styles, stag, opts) {\n\tif(opts.cellStyles) {\n\t\tif(stag.Interior) {\n\t\t\tvar I = stag.Interior;\n\t\t\tif(I.Pattern) I.patternType = PatternTypeMap[I.Pattern] || I.Pattern;\n\t\t}\n\t}\n\tstyles[stag.ID] = stag;\n}\n\n/* TODO: there must exist some form of OSP-blessed spec */\nfunction parse_xlml_data(xml, ss, data, cell, base, styles, csty, row, arrayf, o) {\n\tvar nf = \"General\", sid = cell.StyleID, S = {}; o = o || {};\n\tvar interiors = [];\n\tif(sid === undefined && row) sid = row.StyleID;\n\tif(sid === undefined && csty) sid = csty.StyleID;\n\twhile(styles[sid] !== undefined) {\n\t\tif(styles[sid].nf) nf = styles[sid].nf;\n\t\tif(styles[sid].Interior) interiors.push(styles[sid].Interior);\n\t\tif(!styles[sid].Parent) break;\n\t\tsid = styles[sid].Parent;\n\t}\n\tswitch(data.Type) {\n\t\tcase 'Boolean':\n\t\t\tcell.t = 'b';\n\t\t\tcell.v = parsexmlbool(xml);\n\t\t\tbreak;\n\t\tcase 'String':\n\t\t\tcell.t = 's'; cell.r = fixstr(unescapexml(xml));\n\t\t\tcell.v = xml.indexOf(\"<\") > -1 ? unescapexml(ss) : cell.r;\n\t\t\tbreak;\n\t\tcase 'DateTime':\n\t\t\tcell.v = (Date.parse(xml) - new Date(Date.UTC(1899, 11, 30))) / (24 * 60 * 60 * 1000);\n\t\t\tif(cell.v !== cell.v) cell.v = unescapexml(xml);\n\t\t\telse if(cell.v >= 1 && cell.v<60) cell.v = cell.v -1;\n\t\t\tif(!nf || nf == \"General\") nf = \"yyyy-mm-dd\";\n\t\t\t/* falls through */\n\t\tcase 'Number':\n\t\t\tif(cell.v === undefined) cell.v=+xml;\n\t\t\tif(!cell.t) cell.t = 'n';\n\t\t\tbreak;\n\t\tcase 'Error': cell.t = 'e'; cell.v = RBErr[xml]; cell.w = xml; break;\n\t\tdefault: cell.t = 's'; cell.v = fixstr(ss); break;\n\t}\n\tsafe_format_xlml(cell, nf, o);\n\tif(o.cellFormula != null) {\n\t\tif(cell.Formula) {\n\t\t\tvar fstr = unescapexml(cell.Formula);\n\t\t\t/* strictly speaking, the leading = is required but some writers omit */\n\t\t\tif(fstr.charCodeAt(0) == 61 /* = */) fstr = fstr.substr(1);\n\t\t\tcell.f = rc_to_a1(fstr, base);\n\t\t\tcell.Formula = undefined;\n\t\t\tif(cell.ArrayRange == \"RC\") cell.F = rc_to_a1(\"RC:RC\", base);\n\t\t\telse if(cell.ArrayRange) {\n\t\t\t\tcell.F = rc_to_a1(cell.ArrayRange, base);\n\t\t\t\tarrayf.push([safe_decode_range(cell.F), cell.F]);\n\t\t\t}\n\t\t} else {\n\t\t\tfor(i = 0; i < arrayf.length; ++i)\n\t\t\t\tif(base.r >= arrayf[i][0].s.r && base.r <= arrayf[i][0].e.r)\n\t\t\t\t\tif(base.c >= arrayf[i][0].s.c && base.c <= arrayf[i][0].e.c)\n\t\t\t\t\t\tcell.F = arrayf[i][1];\n\t\t}\n\t}\n\tif(o.cellStyles) {\n\t\tinteriors.forEach(function(x) {\n\t\t\tif(!S.patternType && x.patternType) S.patternType = x.patternType;\n\t\t});\n\t\tcell.s = S;\n\t}\n\tcell.ixfe = cell.StyleID !== undefined ? cell.StyleID : 'Default';\n}\n\nfunction xlml_clean_comment(comment) {\n\tcomment.t = comment.v;\n\tcomment.v = comment.w = comment.ixfe = undefined;\n}\n\nfunction xlml_normalize(d) {\n\tif(has_buf && Buffer.isBuffer(d)) return d.toString('utf8');\n\tif(typeof d === 'string') return d;\n\tthrow new Error(\"Bad input format: expected Buffer or string\");\n}\n\n/* TODO: Everything */\nvar xlmlregex = /<(\\/?)([a-z0-9]*:|)(\\w+)[^>]*>/mg;\nfunction parse_xlml_xml(d, opts) {\n\tvar str = debom(xlml_normalize(d));\n\tvar Rn;\n\tvar state = [], tmp;\n\tvar sheets = {}, sheetnames = [], cursheet = {}, sheetname = \"\";\n\tvar table = {}, cell = ({}), row = {};\n\tvar dtag = parsexmltag('<Data ss:Type=\"String\">'), didx = 0;\n\tvar c = 0, r = 0;\n\tvar refguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\tvar styles = {}, stag = {};\n\tvar ss = \"\", fidx = 0;\n\tvar mergecells = [];\n\tvar Props = {}, Custprops = {}, pidx = 0, cp = {};\n\tvar comments = [], comment = {};\n\tvar cstys = [], csty;\n\tvar arrayf = [];\n\txlmlregex.lastIndex = 0;\n\twhile((Rn = xlmlregex.exec(str))) switch(Rn[3]) {\n\t\tcase 'Data':\n\t\t\tif(state[state.length-1][1]) break;\n\t\t\tif(Rn[1]==='/') parse_xlml_data(str.slice(didx, Rn.index), ss, dtag, state[state.length-1][0]==\"Comment\"?comment:cell, {c:c,r:r}, styles, cstys[c], row, arrayf, opts);\n\t\t\telse { ss = \"\"; dtag = parsexmltag(Rn[0]); didx = Rn.index + Rn[0].length; }\n\t\t\tbreak;\n\t\tcase 'Cell':\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif(comments.length > 0) cell.c = comments;\n\t\t\t\tif((!opts.sheetRows || opts.sheetRows > r) && cell.v !== undefined) cursheet[encode_col(c) + encode_row(r)] = cell;\n\t\t\t\tif(cell.HRef) {\n\t\t\t\t\tcell.l = {Target:cell.HRef, tooltip:cell.HRefScreenTip};\n\t\t\t\t\tcell.HRef = cell.HRefScreenTip = undefined;\n\t\t\t\t}\n\t\t\t\tif(cell.MergeAcross || cell.MergeDown) {\n\t\t\t\t\tvar cc = c + (parseInt(cell.MergeAcross,10)|0);\n\t\t\t\t\tvar rr = r + (parseInt(cell.MergeDown,10)|0);\n\t\t\t\t\tmergecells.push({s:{c:c,r:r},e:{c:cc,r:rr}});\n\t\t\t\t}\n\t\t\t\t++c;\n\t\t\t\tif(cell.MergeAcross) c += +cell.MergeAcross;\n\t\t\t} else {\n\t\t\t\tcell = parsexmltagobj(Rn[0]);\n\t\t\t\tif(cell.Index) c = +cell.Index - 1;\n\t\t\t\tif(c < refguess.s.c) refguess.s.c = c;\n\t\t\t\tif(c > refguess.e.c) refguess.e.c = c;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") ++c;\n\t\t\t\tcomments = [];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'Row':\n\t\t\tif(Rn[1]==='/' || Rn[0].slice(-2) === \"/>\") {\n\t\t\t\tif(r < refguess.s.r) refguess.s.r = r;\n\t\t\t\tif(r > refguess.e.r) refguess.e.r = r;\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") {\n\t\t\t\t\trow = parsexmltag(Rn[0]);\n\t\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t\t}\n\t\t\t\tc = 0; ++r;\n\t\t\t} else {\n\t\t\t\trow = parsexmltag(Rn[0]);\n\t\t\t\tif(row.Index) r = +row.Index - 1;\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'Worksheet': /* TODO: read range from FullRows/FullColumns */\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\tsheetnames.push(sheetname);\n\t\t\t\tif(refguess.s.r <= refguess.e.r && refguess.s.c <= refguess.e.c) cursheet[\"!ref\"] = encode_range(refguess);\n\t\t\t\tif(mergecells.length) cursheet[\"!merges\"] = mergecells;\n\t\t\t\tsheets[sheetname] = cursheet;\n\t\t\t} else {\n\t\t\t\trefguess = {s: {r:2000000, c:2000000}, e: {r:0, c:0} };\n\t\t\t\tr = c = 0;\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = parsexmltag(Rn[0]);\n\t\t\t\tsheetname = tmp.Name;\n\t\t\t\tcursheet = {};\n\t\t\t\tmergecells = [];\n\t\t\t}\n\t\t\tbreak;\n\t\tcase 'Table':\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\telse if(Rn[0].slice(-2) == \"/>\") break;\n\t\t\telse {\n\t\t\t\ttable = parsexmltag(Rn[0]);\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\tcstys = [];\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'Style':\n\t\t\tif(Rn[1]==='/') process_style_xlml(styles, stag, opts);\n\t\t\telse stag = parsexmltag(Rn[0]);\n\t\t\tbreak;\n\n\t\tcase 'NumberFormat':\n\t\t\tstag.nf = parsexmltag(Rn[0]).Format || \"General\";\n\t\t\tbreak;\n\n\t\tcase 'Column':\n\t\t\tif(state[state.length-1][0] !== 'Table') break;\n\t\t\tcsty = parsexmltag(Rn[0]);\n\t\t\tcstys[(csty.Index-1||cstys.length)] = csty;\n\t\t\tfor(var i = 0; i < +csty.Span; ++i) cstys[cstys.length] = csty;\n\t\t\tbreak;\n\n\t\tcase 'NamedRange': break;\n\t\tcase 'NamedCell': break;\n\t\tcase 'B': break;\n\t\tcase 'I': break;\n\t\tcase 'U': break;\n\t\tcase 'S': break;\n\t\tcase 'Sub': break;\n\t\tcase 'Sup': break;\n\t\tcase 'Span': break;\n\t\tcase 'Border': break;\n\t\tcase 'Alignment': break;\n\t\tcase 'Borders': break;\n\t\tcase 'Font':\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") ss += str.slice(fidx, Rn.index);\n\t\t\telse fidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'Interior':\n\t\t\tif(!opts.cellStyles) break;\n\t\t\tstag.Interior = parsexmltag(Rn[0]);\n\t\t\tbreak;\n\t\tcase 'Protection': break;\n\n\t\tcase 'Author':\n\t\tcase 'Title':\n\t\tcase 'Description':\n\t\tcase 'Created':\n\t\tcase 'Keywords':\n\t\tcase 'Subject':\n\t\tcase 'Category':\n\t\tcase 'Company':\n\t\tcase 'LastAuthor':\n\t\tcase 'LastSaved':\n\t\tcase 'LastPrinted':\n\t\tcase 'Version':\n\t\tcase 'Revision':\n\t\tcase 'TotalTime':\n\t\tcase 'HyperlinkBase':\n\t\tcase 'Manager':\n\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\telse if(Rn[1]===\"/\") xlml_set_prop(Props, Rn[3], str.slice(pidx, Rn.index));\n\t\t\telse pidx = Rn.index + Rn[0].length;\n\t\t\tbreak;\n\t\tcase 'Paragraphs': break;\n\n\t\tcase 'Styles':\n\t\tcase 'Workbook':\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\telse state.push([Rn[3], false]);\n\t\t\tbreak;\n\n\t\tcase 'Comment':\n\t\t\tif(Rn[1]==='/'){\n\t\t\t\tif((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;\n\t\t\t\txlml_clean_comment(comment);\n\t\t\t\tcomments.push(comment);\n\t\t\t} else {\n\t\t\t\tstate.push([Rn[3], false]);\n\t\t\t\ttmp = parsexmltag(Rn[0]);\n\t\t\t\tcomment = {a:tmp.Author};\n\t\t\t}\n\t\t\tbreak;\n\n\t\tcase 'Name': break;\n\n\t\tcase 'ComponentOptions':\n\t\tcase 'DocumentProperties':\n\t\tcase 'CustomDocumentProperties':\n\t\tcase 'OfficeDocumentSettings':\n\t\tcase 'PivotTable':\n\t\tcase 'PivotCache':\n\t\tcase 'Names':\n\t\tcase 'MapInfo':\n\t\tcase 'PageBreaks':\n\t\tcase 'QueryTable':\n\t\tcase 'DataValidation':\n\t\tcase 'AutoFilter':\n\t\tcase 'Sorting':\n\t\tcase 'Schema':\n\t\tcase 'data':\n\t\tcase 'ConditionalFormatting':\n\t\tcase 'SmartTagType':\n\t\tcase 'SmartTags':\n\t\tcase 'ExcelWorkbook':\n\t\tcase 'WorkbookOptions':\n\t\tcase 'WorksheetOptions':\n\t\t\tif(Rn[1]==='/'){if((tmp=state.pop())[0]!==Rn[3]) throw \"Bad state: \"+tmp;}\n\t\t\telse if(Rn[0].charAt(Rn[0].length-2) !== '/') state.push([Rn[3], true]);\n\t\t\tbreak;\n\n\t\tdefault:\n\t\t\t/* FODS file root is <office:document> */\n\t\t\tif(state.length == 0 && Rn[3] == \"document\") throw new Error(\"Unsupported FODS format\");\n\t\t\t/* UOS file root is <uof:UOF> */\n\t\t\tif(state.length == 0 && Rn[3] == \"UOF\") throw new Error(\"Unsupported UOS format\");\n\n\t\t\tvar seen = true;\n\t\t\tswitch(state[state.length-1][0]) {\n\t\t\t\t/* OfficeDocumentSettings */\n\t\t\t\tcase 'OfficeDocumentSettings': switch(Rn[3]) {\n\t\t\t\t\tcase 'AllowPNG': break;\n\t\t\t\t\tcase 'RemovePersonalInformation': break;\n\t\t\t\t\tcase 'DownloadComponents': break;\n\t\t\t\t\tcase 'LocationOfComponents': break;\n\t\t\t\t\tcase 'Colors': break;\n\t\t\t\t\tcase 'Color': break;\n\t\t\t\t\tcase 'Index': break;\n\t\t\t\t\tcase 'RGB': break;\n\t\t\t\t\tcase 'PixelsPerInch': break;\n\t\t\t\t\tcase 'TargetScreenSize': break;\n\t\t\t\t\tcase 'ReadOnlyRecommended': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ComponentOptions */\n\t\t\t\tcase 'ComponentOptions': switch(Rn[3]) {\n\t\t\t\t\tcase 'Toolbar': break;\n\t\t\t\t\tcase 'HideOfficeLogo': break;\n\t\t\t\t\tcase 'SpreadsheetAutoFit': break;\n\t\t\t\t\tcase 'Label': break;\n\t\t\t\t\tcase 'Caption': break;\n\t\t\t\t\tcase 'MaxHeight': break;\n\t\t\t\t\tcase 'MaxWidth': break;\n\t\t\t\t\tcase 'NextSheetNumber': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* ExcelWorkbook */\n\t\t\t\tcase 'ExcelWorkbook': switch(Rn[3]) {\n\t\t\t\t\tcase 'WindowHeight': break;\n\t\t\t\t\tcase 'WindowWidth': break;\n\t\t\t\t\tcase 'WindowTopX': break;\n\t\t\t\t\tcase 'WindowTopY': break;\n\t\t\t\t\tcase 'TabRatio': break;\n\t\t\t\t\tcase 'ProtectStructure': break;\n\t\t\t\t\tcase 'ProtectWindows': break;\n\t\t\t\t\tcase 'ActiveSheet': break;\n\t\t\t\t\tcase 'DisplayInkNotes': break;\n\t\t\t\t\tcase 'FirstVisibleSheet': break;\n\t\t\t\t\tcase 'SupBook': break;\n\t\t\t\t\tcase 'SheetName': break;\n\t\t\t\t\tcase 'SheetIndex': break;\n\t\t\t\t\tcase 'SheetIndexFirst': break;\n\t\t\t\t\tcase 'SheetIndexLast': break;\n\t\t\t\t\tcase 'Dll': break;\n\t\t\t\t\tcase 'AcceptLabelsInFormulas': break;\n\t\t\t\t\tcase 'DoNotSaveLinkValues': break;\n\t\t\t\t\tcase 'Date1904': break;\n\t\t\t\t\tcase 'Iteration': break;\n\t\t\t\t\tcase 'MaxIterations': break;\n\t\t\t\t\tcase 'MaxChange': break;\n\t\t\t\t\tcase 'Path': break;\n\t\t\t\t\tcase 'Xct': break;\n\t\t\t\t\tcase 'Count': break;\n\t\t\t\t\tcase 'SelectedSheets': break;\n\t\t\t\t\tcase 'Calculation': break;\n\t\t\t\t\tcase 'Uncalced': break;\n\t\t\t\t\tcase 'StartupPrompt': break;\n\t\t\t\t\tcase 'Crn': break;\n\t\t\t\t\tcase 'ExternName': break;\n\t\t\t\t\tcase 'Formula': break;\n\t\t\t\t\tcase 'ColFirst': break;\n\t\t\t\t\tcase 'ColLast': break;\n\t\t\t\t\tcase 'WantAdvise': break;\n\t\t\t\t\tcase 'Boolean': break;\n\t\t\t\t\tcase 'Error': break;\n\t\t\t\t\tcase 'Text': break;\n\t\t\t\t\tcase 'OLE': break;\n\t\t\t\t\tcase 'NoAutoRecover': break;\n\t\t\t\t\tcase 'PublishObjects': break;\n\t\t\t\t\tcase 'DoNotCalculateBeforeSave': break;\n\t\t\t\t\tcase 'Number': break;\n\t\t\t\t\tcase 'RefModeR1C1': break;\n\t\t\t\t\tcase 'EmbedSaveSmartTags': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorkbookOptions */\n\t\t\t\tcase 'WorkbookOptions': switch(Rn[3]) {\n\t\t\t\t\tcase 'OWCVersion': break;\n\t\t\t\t\tcase 'Height': break;\n\t\t\t\t\tcase 'Width': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* WorksheetOptions */\n\t\t\t\tcase 'WorksheetOptions': switch(Rn[3]) {\n\t\t\t\t\tcase 'Unsynced': break;\n\t\t\t\t\tcase 'Visible': break;\n\t\t\t\t\tcase 'Print': break;\n\t\t\t\t\tcase 'Panes': break;\n\t\t\t\t\tcase 'Scale': break;\n\t\t\t\t\tcase 'Pane': break;\n\t\t\t\t\tcase 'Number': break;\n\t\t\t\t\tcase 'Layout': break;\n\t\t\t\t\tcase 'Header': break;\n\t\t\t\t\tcase 'Footer': break;\n\t\t\t\t\tcase 'PageSetup': break;\n\t\t\t\t\tcase 'PageMargins': break;\n\t\t\t\t\tcase 'Selected': break;\n\t\t\t\t\tcase 'ProtectObjects': break;\n\t\t\t\t\tcase 'EnableSelection': break;\n\t\t\t\t\tcase 'ProtectScenarios': break;\n\t\t\t\t\tcase 'ValidPrinterInfo': break;\n\t\t\t\t\tcase 'HorizontalResolution': break;\n\t\t\t\t\tcase 'VerticalResolution': break;\n\t\t\t\t\tcase 'NumberofCopies': break;\n\t\t\t\t\tcase 'ActiveRow': break;\n\t\t\t\t\tcase 'ActiveCol': break;\n\t\t\t\t\tcase 'ActivePane': break;\n\t\t\t\t\tcase 'TopRowVisible': break;\n\t\t\t\t\tcase 'TopRowBottomPane': break;\n\t\t\t\t\tcase 'LeftColumnVisible': break;\n\t\t\t\t\tcase 'LeftColumnRightPane': break;\n\t\t\t\t\tcase 'FitToPage': break;\n\t\t\t\t\tcase 'RangeSelection': break;\n\t\t\t\t\tcase 'PaperSizeIndex': break;\n\t\t\t\t\tcase 'PageLayoutZoom': break;\n\t\t\t\t\tcase 'PageBreakZoom': break;\n\t\t\t\t\tcase 'FilterOn': break;\n\t\t\t\t\tcase 'DoNotDisplayGridlines': break;\n\t\t\t\t\tcase 'SplitHorizontal': break;\n\t\t\t\t\tcase 'SplitVertical': break;\n\t\t\t\t\tcase 'FreezePanes': break;\n\t\t\t\t\tcase 'FrozenNoSplit': break;\n\t\t\t\t\tcase 'FitWidth': break;\n\t\t\t\t\tcase 'FitHeight': break;\n\t\t\t\t\tcase 'CommentsLayout': break;\n\t\t\t\t\tcase 'Zoom': break;\n\t\t\t\t\tcase 'LeftToRight': break;\n\t\t\t\t\tcase 'Gridlines': break;\n\t\t\t\t\tcase 'AllowSort': break;\n\t\t\t\t\tcase 'AllowFilter': break;\n\t\t\t\t\tcase 'AllowInsertRows': break;\n\t\t\t\t\tcase 'AllowDeleteRows': break;\n\t\t\t\t\tcase 'AllowInsertCols': break;\n\t\t\t\t\tcase 'AllowDeleteCols': break;\n\t\t\t\t\tcase 'AllowInsertHyperlinks': break;\n\t\t\t\t\tcase 'AllowFormatCells': break;\n\t\t\t\t\tcase 'AllowSizeCols': break;\n\t\t\t\t\tcase 'AllowSizeRows': break;\n\t\t\t\t\tcase 'NoSummaryRowsBelowDetail': break;\n\t\t\t\t\tcase 'TabColorIndex': break;\n\t\t\t\t\tcase 'DoNotDisplayHeadings': break;\n\t\t\t\t\tcase 'ShowPageLayoutZoom': break;\n\t\t\t\t\tcase 'NoSummaryColumnsRightDetail': break;\n\t\t\t\t\tcase 'BlackAndWhite': break;\n\t\t\t\t\tcase 'DoNotDisplayZeros': break;\n\t\t\t\t\tcase 'DisplayPageBreak': break;\n\t\t\t\t\tcase 'RowColHeadings': break;\n\t\t\t\t\tcase 'DoNotDisplayOutline': break;\n\t\t\t\t\tcase 'NoOrientation': break;\n\t\t\t\t\tcase 'AllowUsePivotTables': break;\n\t\t\t\t\tcase 'ZeroHeight': break;\n\t\t\t\t\tcase 'ViewableRange': break;\n\t\t\t\t\tcase 'Selection': break;\n\t\t\t\t\tcase 'ProtectContents': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PivotTable */\n\t\t\t\tcase 'PivotTable': case 'PivotCache': switch(Rn[3]) {\n\t\t\t\t\tcase 'ImmediateItemsOnDrop': break;\n\t\t\t\t\tcase 'ShowPageMultipleItemLabel': break;\n\t\t\t\t\tcase 'CompactRowIndent': break;\n\t\t\t\t\tcase 'Location': break;\n\t\t\t\t\tcase 'PivotField': break;\n\t\t\t\t\tcase 'Orientation': break;\n\t\t\t\t\tcase 'LayoutForm': break;\n\t\t\t\t\tcase 'LayoutSubtotalLocation': break;\n\t\t\t\t\tcase 'LayoutCompactRow': break;\n\t\t\t\t\tcase 'Position': break;\n\t\t\t\t\tcase 'PivotItem': break;\n\t\t\t\t\tcase 'DataType': break;\n\t\t\t\t\tcase 'DataField': break;\n\t\t\t\t\tcase 'SourceName': break;\n\t\t\t\t\tcase 'ParentField': break;\n\t\t\t\t\tcase 'PTLineItems': break;\n\t\t\t\t\tcase 'PTLineItem': break;\n\t\t\t\t\tcase 'CountOfSameItems': break;\n\t\t\t\t\tcase 'Item': break;\n\t\t\t\t\tcase 'ItemType': break;\n\t\t\t\t\tcase 'PTSource': break;\n\t\t\t\t\tcase 'CacheIndex': break;\n\t\t\t\t\tcase 'ConsolidationReference': break;\n\t\t\t\t\tcase 'FileName': break;\n\t\t\t\t\tcase 'Reference': break;\n\t\t\t\t\tcase 'NoColumnGrand': break;\n\t\t\t\t\tcase 'NoRowGrand': break;\n\t\t\t\t\tcase 'BlankLineAfterItems': break;\n\t\t\t\t\tcase 'Hidden': break;\n\t\t\t\t\tcase 'Subtotal': break;\n\t\t\t\t\tcase 'BaseField': break;\n\t\t\t\t\tcase 'MapChildItems': break;\n\t\t\t\t\tcase 'Function': break;\n\t\t\t\t\tcase 'RefreshOnFileOpen': break;\n\t\t\t\t\tcase 'PrintSetTitles': break;\n\t\t\t\t\tcase 'MergeLabels': break;\n\t\t\t\t\tcase 'DefaultVersion': break;\n\t\t\t\t\tcase 'RefreshName': break;\n\t\t\t\t\tcase 'RefreshDate': break;\n\t\t\t\t\tcase 'RefreshDateCopy': break;\n\t\t\t\t\tcase 'VersionLastRefresh': break;\n\t\t\t\t\tcase 'VersionLastUpdate': break;\n\t\t\t\t\tcase 'VersionUpdateableMin': break;\n\t\t\t\t\tcase 'VersionRefreshableMin': break;\n\t\t\t\t\tcase 'Calculation': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* PageBreaks */\n\t\t\t\tcase 'PageBreaks': switch(Rn[3]) {\n\t\t\t\t\tcase 'ColBreaks': break;\n\t\t\t\t\tcase 'ColBreak': break;\n\t\t\t\t\tcase 'RowBreaks': break;\n\t\t\t\t\tcase 'RowBreak': break;\n\t\t\t\t\tcase 'ColStart': break;\n\t\t\t\t\tcase 'ColEnd': break;\n\t\t\t\t\tcase 'RowEnd': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* AutoFilter */\n\t\t\t\tcase 'AutoFilter': switch(Rn[3]) {\n\t\t\t\t\tcase 'AutoFilterColumn': break;\n\t\t\t\t\tcase 'AutoFilterCondition': break;\n\t\t\t\t\tcase 'AutoFilterAnd': break;\n\t\t\t\t\tcase 'AutoFilterOr': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* QueryTable */\n\t\t\t\tcase 'QueryTable': switch(Rn[3]) {\n\t\t\t\t\tcase 'Id': break;\n\t\t\t\t\tcase 'AutoFormatFont': break;\n\t\t\t\t\tcase 'AutoFormatPattern': break;\n\t\t\t\t\tcase 'QuerySource': break;\n\t\t\t\t\tcase 'QueryType': break;\n\t\t\t\t\tcase 'EnableRedirections': break;\n\t\t\t\t\tcase 'RefreshedInXl9': break;\n\t\t\t\t\tcase 'URLString': break;\n\t\t\t\t\tcase 'HTMLTables': break;\n\t\t\t\t\tcase 'Connection': break;\n\t\t\t\t\tcase 'CommandText': break;\n\t\t\t\t\tcase 'RefreshInfo': break;\n\t\t\t\t\tcase 'NoTitles': break;\n\t\t\t\t\tcase 'NextId': break;\n\t\t\t\t\tcase 'ColumnInfo': break;\n\t\t\t\t\tcase 'OverwriteCells': break;\n\t\t\t\t\tcase 'DoNotPromptForFile': break;\n\t\t\t\t\tcase 'TextWizardSettings': break;\n\t\t\t\t\tcase 'Source': break;\n\t\t\t\t\tcase 'Number': break;\n\t\t\t\t\tcase 'Decimal': break;\n\t\t\t\t\tcase 'ThousandSeparator': break;\n\t\t\t\t\tcase 'TrailingMinusNumbers': break;\n\t\t\t\t\tcase 'FormatSettings': break;\n\t\t\t\t\tcase 'FieldType': break;\n\t\t\t\t\tcase 'Delimiters': break;\n\t\t\t\t\tcase 'Tab': break;\n\t\t\t\t\tcase 'Comma': break;\n\t\t\t\t\tcase 'AutoFormatName': break;\n\t\t\t\t\tcase 'VersionLastEdit': break;\n\t\t\t\t\tcase 'VersionLastRefresh': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* Sorting */\n\t\t\t\tcase 'Sorting':\n\t\t\t\t/* ConditionalFormatting */\n\t\t\t\tcase 'ConditionalFormatting':\n\t\t\t\t/* DataValidation */\n\t\t\t\tcase 'DataValidation': switch(Rn[3]) {\n\t\t\t\t\tcase 'Range': break;\n\t\t\t\t\tcase 'Type': break;\n\t\t\t\t\tcase 'Min': break;\n\t\t\t\t\tcase 'Max': break;\n\t\t\t\t\tcase 'Sort': break;\n\t\t\t\t\tcase 'Descending': break;\n\t\t\t\t\tcase 'Order': break;\n\t\t\t\t\tcase 'CaseSensitive': break;\n\t\t\t\t\tcase 'Value': break;\n\t\t\t\t\tcase 'ErrorStyle': break;\n\t\t\t\t\tcase 'ErrorMessage': break;\n\t\t\t\t\tcase 'ErrorTitle': break;\n\t\t\t\t\tcase 'CellRangeList': break;\n\t\t\t\t\tcase 'InputMessage': break;\n\t\t\t\t\tcase 'InputTitle': break;\n\t\t\t\t\tcase 'ComboHide': break;\n\t\t\t\t\tcase 'InputHide': break;\n\t\t\t\t\tcase 'Condition': break;\n\t\t\t\t\tcase 'Qualifier': break;\n\t\t\t\t\tcase 'UseBlank': break;\n\t\t\t\t\tcase 'Value1': break;\n\t\t\t\t\tcase 'Value2': break;\n\t\t\t\t\tcase 'Format': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* MapInfo (schema) */\n\t\t\t\tcase 'MapInfo': case 'Schema': case 'data': switch(Rn[3]) {\n\t\t\t\t\tcase 'Map': break;\n\t\t\t\t\tcase 'Entry': break;\n\t\t\t\t\tcase 'Range': break;\n\t\t\t\t\tcase 'XPath': break;\n\t\t\t\t\tcase 'Field': break;\n\t\t\t\t\tcase 'XSDType': break;\n\t\t\t\t\tcase 'FilterOn': break;\n\t\t\t\t\tcase 'Aggregate': break;\n\t\t\t\t\tcase 'ElementType': break;\n\t\t\t\t\tcase 'AttributeType': break;\n\t\t\t\t/* These are from xsd (XML Schema Definition) */\n\t\t\t\t\tcase 'schema':\n\t\t\t\t\tcase 'element':\n\t\t\t\t\tcase 'complexType':\n\t\t\t\t\tcase 'datatype':\n\t\t\t\t\tcase 'all':\n\t\t\t\t\tcase 'attribute':\n\t\t\t\t\tcase 'extends': break;\n\n\t\t\t\t\tcase 'row': break;\n\t\t\t\t\tdefault: seen = false;\n\t\t\t\t} break;\n\n\t\t\t\t/* SmartTags (can be anything) */\n\t\t\t\tcase 'SmartTags': break;\n\n\t\t\t\tdefault: seen = false; break;\n\t\t\t}\n\t\t\tif(seen) break;\n\t\t\t/* CustomDocumentProperties */\n\t\t\tif(!state[state.length-1][1]) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t\t\tif(state[state.length-1][0]==='CustomDocumentProperties') {\n\t\t\t\tif(Rn[0].slice(-2) === \"/>\") break;\n\t\t\t\telse if(Rn[1]===\"/\") xlml_set_custprop(Custprops, Rn, cp, str.slice(pidx, Rn.index));\n\t\t\t\telse { cp = Rn; pidx = Rn.index + Rn[0].length; }\n\t\t\t\tbreak;\n\t\t\t}\n\t\t\tif(opts.WTF) throw 'Unrecognized tag: ' + Rn[3] + \"|\" + state.join(\"|\");\n\t}\n\tvar out = ({});\n\tif(!opts.bookSheets && !opts.bookProps) out.Sheets = sheets;\n\tout.SheetNames = sheetnames;\n\tout.SSF = SSF.get_table();\n\tout.Props = Props;\n\tout.Custprops = Custprops;\n\treturn out;\n}\n\nfunction parse_xlml(data, opts) {\n\tfix_read_opts(opts=opts||{});\n\tswitch(opts.type||\"base64\") {\n\t\tcase \"base64\": return parse_xlml_xml(Base64.decode(data), opts);\n\t\tcase \"binary\": case \"buffer\": case \"file\": return parse_xlml_xml(data, opts);\n\t\tcase \"array\": return parse_xlml_xml(data.map(_chr).join(\"\"), opts);\n\t}\n}\n\n/* TODO */\nfunction write_xlml(wb, opts) {\n\tvar o = [XML_HEADER];\n\treturn o.join(\"\");\n}\nvar fs;\nif(typeof exports !== 'undefined') {\n\tif(typeof module !== 'undefined' && module.exports) {\n\t\tfs = require('fs');\n\t}\n}\nfunction firstbyte(f,o) {\n\tswitch((o||{}).type || \"base64\") {\n\t\tcase 'buffer': return f[0];\n\t\tcase 'base64': return Base64.decode(f.substr(0,12)).charCodeAt(0);\n\t\tcase 'binary': return f.charCodeAt(0);\n\t\tcase 'array': return f[0];\n\t\tdefault: throw new Error(\"Unrecognized type \" + o.type);\n\t}\n}\n\nfunction xlsread(f, o) {\n\tvar n=0;\n\tif(!o) o = {};\n\tif(!o.type) o.type = (has_buf && Buffer.isBuffer(f)) ? \"buffer\" : \"base64\";\n\tswitch((n = firstbyte(f, o))) {\n\t\tcase 0xD0: return parse_xlscfb(CFB.read(f, o), o);\n\t\tcase 0x09: return parse_xlscfb(s2a(o.type === 'base64' ? Base64.decode(f) : f), o);\n\t\tcase 0x3C: return parse_xlml(f, o);\n\t\tcase 0xEF: return parse_xlml(f, o);\n\t\tdefault: throw new Error(\"Unsupported file \" + n);\n\t}\n}\nvar readFile = function(f,o) {\n\tvar d = fs.readFileSync(f);\n\tif(!o) o = {};\n\tswitch(firstbyte(d, {type:'buffer'})) {\n\t\tcase 0xD0: return parse_xlscfb(CFB.read(d,{type:'buffer'}),o);\n\t\tcase 0x09: return parse_xlscfb(d, o);\n\t\tcase 0x3C: return parse_xlml(d, (o.type=\"buffer\",o));\n\t\tcase 0xEF: return parse_xlml(d, (o.type=\"buffer\",o));\n\t\tdefault: throw \"Unsupported file\";\n\t}\n};\n\nfunction writeSync(wb, opts) {\n\tvar o = opts||{};\n\tswitch(o.bookType) {\n\t\tcase 'xml': return write_xlml(wb, o);\n\t\tdefault: throw 'unsupported output format ' + o.bookType;\n\t}\n}\n\nfunction writeFileSync(wb, filename, opts) {\n\tvar o = opts|{}; o.type = 'file';\n\to.file = filename;\n\tswitch(o.file.substr(-4).toLowerCase()) {\n\t\tcase '.xls': o.bookType = 'xls'; break;\n\t\tcase '.xml': o.bookType = 'xml'; break;\n\t}\n\treturn writeSync(wb, o);\n}\n\nfunction decode_row(rowstr) { return parseInt(unfix_row(rowstr),10) - 1; }\nfunction encode_row(row) { return \"\" + (row + 1); }\nfunction fix_row(cstr) { return cstr.replace(/([A-Z]|^)(\\d+)$/,\"$1$$$2\"); }\nfunction unfix_row(cstr) { return cstr.replace(/\\$(\\d+)$/,\"$1\"); }\n\nfunction decode_col(colstr) { var c = unfix_col(colstr), d = 0, i = 0; for(; i !== c.length; ++i) d = 26*d + c.charCodeAt(i) - 64; return d - 1; }\nfunction encode_col(col) { var s=\"\"; for(++col; col; col=Math.floor((col-1)/26)) s = String.fromCharCode(((col-1)%26) + 65) + s; return s; }\nfunction fix_col(cstr) { return cstr.replace(/^([A-Z])/,\"$$$1\"); }\nfunction unfix_col(cstr) { return cstr.replace(/^\\$([A-Z])/,\"$1\"); }\n\nfunction split_cell(cstr) { return cstr.replace(/(\\$?[A-Z]*)(\\$?\\d*)/,\"$1,$2\").split(\",\"); }\nfunction decode_cell(cstr) { var splt = split_cell(cstr); return { c:decode_col(splt[0]), r:decode_row(splt[1]) }; }\nfunction encode_cell(cell) { return encode_col(cell.c) + encode_row(cell.r); }\nfunction fix_cell(cstr) { return fix_col(fix_row(cstr)); }\nfunction unfix_cell(cstr) { return unfix_col(unfix_row(cstr)); }\nfunction decode_range(range) { var x =range.split(\":\").map(decode_cell); return {s:x[0],e:x[x.length-1]}; }\nfunction encode_range(cs,ce) {\n\tif(ce === undefined || typeof ce === 'number') return encode_range(cs.s, cs.e);\n\tif(typeof cs !== 'string') cs = encode_cell(cs); if(typeof ce !== 'string') ce = encode_cell(ce);\n\treturn cs == ce ? cs : cs + \":\" + ce;\n}\n\nfunction safe_decode_range(range) {\n\tvar o = {s:{c:0,r:0},e:{c:0,r:0}};\n\tvar idx = 0, i = 0, cc = 0;\n\tvar len = range.length;\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.s.c = --idx;\n\n\tfor(idx = 0; i < len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.s.r = --idx;\n\n\tif(i === len || range.charCodeAt(++i) === 58) { o.e.c=o.s.c; o.e.r=o.s.r; return o; }\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-64) < 1 || cc > 26) break;\n\t\tidx = 26*idx + cc;\n\t}\n\to.e.c = --idx;\n\n\tfor(idx = 0; i != len; ++i) {\n\t\tif((cc=range.charCodeAt(i)-48) < 0 || cc > 9) break;\n\t\tidx = 10*idx + cc;\n\t}\n\to.e.r = --idx;\n\treturn o;\n}\n\nfunction safe_format_cell(cell, v) {\n\tif(cell.z !== undefined) try { return (cell.w = SSF.format(cell.z, v)); } catch(e) { }\n\tif(!cell.XF) return v;\n\ttry { return (cell.w = SSF.format(cell.XF.ifmt||0, v)); } catch(e) { return ''+v; }\n}\n\nfunction format_cell(cell, v) {\n\tif(cell == null || cell.t == null) return \"\";\n\tif(cell.w !== undefined) return cell.w;\n\tif(v === undefined) return safe_format_cell(cell, cell.v);\n\treturn safe_format_cell(cell, v);\n}\n\nfunction sheet_to_json(sheet, opts){\n\tvar val, row, range, header = 0, offset = 1, r, hdr = [], isempty, R, C, v;\n\tvar o = opts != null ? opts : {};\n\tvar raw = o.raw;\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\trange = o.range !== undefined ? o.range : sheet[\"!ref\"];\n\tif(o.header === 1) header = 1;\n\telse if(o.header === \"A\") header = 2;\n\telse if(Array.isArray(o.header)) header = 3;\n\tswitch(typeof range) {\n\t\tcase 'string': r = safe_decode_range(range); break;\n\t\tcase 'number': r = safe_decode_range(sheet[\"!ref\"]); r.s.r = range; break;\n\t\tdefault: r = range;\n\t}\n\tif(header > 0) offset = 0;\n\tvar rr = encode_row(r.s.r);\n\tvar cols = new Array(r.e.c-r.s.c+1);\n\tvar out = new Array(r.e.r-r.s.r-offset+1);\n\tvar outi = 0;\n\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\tcols[C] = encode_col(C);\n\t\tval = sheet[cols[C] + rr];\n\t\tswitch(header) {\n\t\t\tcase 1: hdr[C] = C; break;\n\t\t\tcase 2: hdr[C] = cols[C]; break;\n\t\t\tcase 3: hdr[C] = o.header[C - r.s.c]; break;\n\t\t\tdefault:\n\t\t\t\tif(val === undefined) continue;\n\t\t\t\thdr[C] = format_cell(val);\n\t\t}\n\t}\n\n\tfor (R = r.s.r + offset; R <= r.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tisempty = true;\n\t\tif(header === 1) row = [];\n\t\telse {\n\t\t\trow = {};\n\t\t\tif(Object.defineProperty) Object.defineProperty(row, '__rowNum__', {value:R, enumerable:false});\n\t\t\telse row.__rowNum__ = R;\n\t\t}\n\t\tfor (C = r.s.c; C <= r.e.c; ++C) {\n\t\t\tval = sheet[cols[C] + rr];\n\t\t\tif(val === undefined || val.t === undefined) continue;\n\t\t\tv = val.v;\n\t\t\tswitch(val.t){\n\t\t\t\tcase 'e': continue;\n\t\t\t\tcase 's': break;\n\t\t\t\tcase 'b': case 'n': break;\n\t\t\t\tdefault: throw 'unrecognized type ' + val.t;\n\t\t\t}\n\t\t\tif(v !== undefined) {\n\t\t\t\trow[hdr[C]] = raw ? v : format_cell(val,v);\n\t\t\t\tisempty = false;\n\t\t\t}\n\t\t}\n\t\tif(isempty === false || header === 1) out[outi++] = row;\n\t}\n\tout.length = outi;\n\treturn out;\n}\n\nfunction sheet_to_row_object_array(sheet, opts) { return sheet_to_json(sheet, opts != null ? opts : {}); }\n\nfunction sheet_to_csv(sheet, opts) {\n\tvar out = \"\", txt = \"\", qreg = /\"/g;\n\tvar o = opts == null ? {} : opts;\n\tif(sheet == null || sheet[\"!ref\"] == null) return \"\";\n\tvar r = safe_decode_range(sheet[\"!ref\"]);\n\tvar FS = o.FS !== undefined ? o.FS : \",\", fs = FS.charCodeAt(0);\n\tvar RS = o.RS !== undefined ? o.RS : \"\\n\", rs = RS.charCodeAt(0);\n\tvar row = \"\", rr = \"\", cols = [];\n\tvar i = 0, cc = 0, val;\n\tvar R = 0, C = 0;\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\tfor(R = r.s.r; R <= r.e.r; ++R) {\n\t\trow = \"\";\n\t\trr = encode_row(R);\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\tval = sheet[cols[C] + rr];\n\t\t\ttxt = val !== undefined ? ''+format_cell(val) : \"\";\n\t\t\tfor(i = 0, cc = 0; i !== txt.length; ++i) if((cc = txt.charCodeAt(i)) === fs || cc === rs || cc === 34) {\n\t\t\t\ttxt = \"\\\"\" + txt.replace(qreg, '\"\"') + \"\\\"\"; break; }\n\t\t\trow += (C === r.s.c ? \"\" : FS) + txt;\n\t\t}\n\t\tout += row + RS;\n\t}\n\treturn out;\n}\nvar make_csv = sheet_to_csv;\n\nfunction sheet_to_formulae(sheet) {\n\tvar y = \"\", x, val=\"\";\n\tif(sheet == null || sheet[\"!ref\"] == null) return [];\n\tvar r = safe_decode_range(sheet['!ref']), rr = \"\", cols = [], C;\n\tvar cmds = new Array((r.e.r-r.s.r+1)*(r.e.c-r.s.c+1));\n\tvar i = 0;\n\tfor(C = r.s.c; C <= r.e.c; ++C) cols[C] = encode_col(C);\n\tfor(var R = r.s.r; R <= r.e.r; ++R) {\n\t\trr = encode_row(R);\n\t\tfor(C = r.s.c; C <= r.e.c; ++C) {\n\t\t\ty = cols[C] + rr;\n\t\t\tx = sheet[y];\n\t\t\tval = \"\";\n\t\t\tif(x === undefined) continue;\n\t\t\telse if(x.F != null) {\n\t\t\t\ty = x.F;\n\t\t\t\tif(!x.f) continue;\n\t\t\t\tval = x.f;\n\t\t\t\tif(y.indexOf(\":\") == -1) y = y + \":\" + y;\n\t\t\t}\n\t\t\tif(x.f != null) val = x.f;\n\t\t\telse if(x.t == 'n' && x.v != null) val = \"\" + x.v;\n\t\t\telse if(x.t == 'b') val = x.v ? \"TRUE\" : \"FALSE\";\n\t\t\telse if(x.w !== undefined) val = \"'\" + x.w;\n\t\t\telse if(x.v === undefined) continue;\n\t\t\telse if(x.t == 's') val = \"'\" + x.v;\n\t\t\telse val = \"\"+x.v;\n\t\t\tcmds[i++] = y + \"=\" + val;\n\t\t}\n\t}\n\tcmds.length = i;\n\treturn cmds;\n}\n\nvar utils = {\n\tencode_col: encode_col,\n\tencode_row: encode_row,\n\tencode_cell: encode_cell,\n\tencode_range: encode_range,\n\tdecode_col: decode_col,\n\tdecode_row: decode_row,\n\tsplit_cell: split_cell,\n\tdecode_cell: decode_cell,\n\tdecode_range: decode_range,\n\tformat_cell: format_cell,\n\tget_formulae: sheet_to_formulae,\n\tmake_csv: sheet_to_csv,\n\tmake_json: sheet_to_json,\n\tmake_formulae: sheet_to_formulae,\n\tsheet_to_csv: sheet_to_csv,\n\tsheet_to_json: sheet_to_json,\n\tsheet_to_formulae: sheet_to_formulae,\n\tsheet_to_row_object_array: sheet_to_row_object_array\n};\nXLS.parse_xlscfb = parse_xlscfb;\nXLS.read = xlsread;\nXLS.readFile = readFile;\nXLS.readSync = xlsread;\nXLS.readFileSync = readFile;\nXLS.utils = utils;\nXLS.CFB = CFB;\nXLS.SSF = SSF;\n})(typeof exports !== 'undefined' ? exports : XLS);\n"],"mappings":"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,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX,MAAM,EAAE,CAAC;IAAE;IACX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"},"metadata":{},"sourceType":"script","externalDependencies":[]}